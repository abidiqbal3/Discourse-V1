{"version":3,"sources":["scripts/embed-application.js"],"sourcesContent":["(function () {\n  const referer = document.getElementById(\"data-embedded\").dataset.referer;\n\n  function postUp(msg) {\n    if (parent) {\n      parent.postMessage(msg, referer);\n    }\n  }\n\n  function clickPostLink(e) {\n    let postId = e.target.getAttribute(\"data-link-to-post\");\n    if (postId) {\n      let postElement = document.getElementById(\"post-\" + postId);\n      if (postElement) {\n        let rect = postElement.getBoundingClientRect();\n        if (rect && rect.top) {\n          postUp({ type: \"discourse-scroll\", top: rect.top });\n          e.preventDefault();\n          return false;\n        }\n      }\n    }\n  }\n\n  window.onload = function () {\n    // get state info from data attribute\n    let embedState = document.querySelector(\"[data-embed-state]\");\n    let state = \"unknown\";\n    let embedId = null;\n    if (embedState) {\n      state = embedState.getAttribute(\"data-embed-state\");\n      embedId = embedState.getAttribute(\"data-embed-id\");\n    }\n\n    // Send a post message with our loaded height and state\n    postUp({\n      type: \"discourse-resize\",\n      height: document[\"body\"].offsetHeight,\n      state,\n      embedId,\n    });\n\n    let postLinks = document.querySelectorAll(\"a[data-link-to-post]\"),\n      i;\n\n    for (i = 0; i < postLinks.length; i++) {\n      postLinks[i].onclick = clickPostLink;\n    }\n\n    // Make sure all links in the iframe point to _blank\n    let cookedLinks = document.querySelectorAll(\".cooked a\");\n    for (i = 0; i < cookedLinks.length; i++) {\n      cookedLinks[i].target = \"_blank\";\n    }\n\n    // Adjust all names\n    let names = document.querySelectorAll(\".username a\");\n    for (i = 0; i < names.length; i++) {\n      let username = names[i].innerHTML;\n      if (username) {\n        /* global BreakString */\n        names[i].innerHTML = new BreakString(username).break();\n      }\n    }\n  };\n})();\n"],"names":["referer","document","getElementById","dataset","postUp","msg","parent","postMessage","clickPostLink","e","postId","target","getAttribute","postElement","rect","getBoundingClientRect","top","type","preventDefault","window","onload","embedState","querySelector","state","embedId","height","offsetHeight","postLinks","querySelectorAll","i","length","onclick","cookedLinks","names","username","innerHTML","BreakString","break"],"mappings":"AAAA,CAAC,YAAY;EACX,MAAMA,OAAO,GAAGC,QAAQ,CAACC,cAAT,CAAwB,eAAxB,EAAyCC,OAAzC,CAAiDH,OAAjE;;EAEA,SAASI,MAAT,CAAgBC,GAAhB,EAAqB;IACnB,IAAIC,MAAJ,EAAY;MACVA,MAAM,CAACC,WAAP,CAAmBF,GAAnB,EAAwBL,OAAxB;IACD;EACF;;EAED,SAASQ,aAAT,CAAuBC,CAAvB,EAA0B;IACxB,IAAIC,MAAM,GAAGD,CAAC,CAACE,MAAF,CAASC,YAAT,CAAsB,mBAAtB,CAAb;;IACA,IAAIF,MAAJ,EAAY;MACV,IAAIG,WAAW,GAAGZ,QAAQ,CAACC,cAAT,CAAwB,UAAUQ,MAAlC,CAAlB;;MACA,IAAIG,WAAJ,EAAiB;QACf,IAAIC,IAAI,GAAGD,WAAW,CAACE,qBAAZ,EAAX;;QACA,IAAID,IAAI,IAAIA,IAAI,CAACE,GAAjB,EAAsB;UACpBZ,MAAM,CAAC;YAAEa,IAAI,EAAE,kBAAR;YAA4BD,GAAG,EAAEF,IAAI,CAACE;UAAtC,CAAD,CAAN;UACAP,CAAC,CAACS,cAAF;UACA,OAAO,KAAP;QACD;MACF;IACF;EACF;;EAEDC,MAAM,CAACC,MAAP,GAAgB,YAAY;IAC1B;IACA,IAAIC,UAAU,GAAGpB,QAAQ,CAACqB,aAAT,CAAuB,oBAAvB,CAAjB;IACA,IAAIC,KAAK,GAAG,SAAZ;IACA,IAAIC,OAAO,GAAG,IAAd;;IACA,IAAIH,UAAJ,EAAgB;MACdE,KAAK,GAAGF,UAAU,CAACT,YAAX,CAAwB,kBAAxB,CAAR;MACAY,OAAO,GAAGH,UAAU,CAACT,YAAX,CAAwB,eAAxB,CAAV;IACD,CARyB,CAU1B;;;IACAR,MAAM,CAAC;MACLa,IAAI,EAAE,kBADD;MAELQ,MAAM,EAAExB,QAAQ,CAAC,MAAD,CAAR,CAAiByB,YAFpB;MAGLH,KAHK;MAILC;IAJK,CAAD,CAAN;IAOA,IAAIG,SAAS,GAAG1B,QAAQ,CAAC2B,gBAAT,CAA0B,sBAA1B,CAAhB;IAAA,IACEC,CADF;;IAGA,KAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGF,SAAS,CAACG,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;MACrCF,SAAS,CAACE,CAAD,CAAT,CAAaE,OAAb,GAAuBvB,aAAvB;IACD,CAvByB,CAyB1B;;;IACA,IAAIwB,WAAW,GAAG/B,QAAQ,CAAC2B,gBAAT,CAA0B,WAA1B,CAAlB;;IACA,KAAKC,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGG,WAAW,CAACF,MAA5B,EAAoCD,CAAC,EAArC,EAAyC;MACvCG,WAAW,CAACH,CAAD,CAAX,CAAelB,MAAf,GAAwB,QAAxB;IACD,CA7ByB,CA+B1B;;;IACA,IAAIsB,KAAK,GAAGhC,QAAQ,CAAC2B,gBAAT,CAA0B,aAA1B,CAAZ;;IACA,KAAKC,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGI,KAAK,CAACH,MAAtB,EAA8BD,CAAC,EAA/B,EAAmC;MACjC,IAAIK,QAAQ,GAAGD,KAAK,CAACJ,CAAD,CAAL,CAASM,SAAxB;;MACA,IAAID,QAAJ,EAAc;QACZ;QACAD,KAAK,CAACJ,CAAD,CAAL,CAASM,SAAT,GAAqB,IAAIC,WAAJ,CAAgBF,QAAhB,EAA0BG,KAA1B,EAArB;MACD;IACF;EACF,CAxCD;AAyCD,CAjED;","file":"embed-application.js"}