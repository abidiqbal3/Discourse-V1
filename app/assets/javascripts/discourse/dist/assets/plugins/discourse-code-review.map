{"version":3,"sources":["discourse/plugins/discourse-code-review/discourse/activity-route-map.js","discourse/plugins/discourse-code-review/discourse/code-review-route-map.js","discourse/plugins/discourse-code-review/discourse/connectors/user-preferences-notifications/notify-code-review.js","discourse/plugins/discourse-code-review/discourse/controllers/admin-plugins-code-review.js","discourse/plugins/discourse-code-review/discourse/initializers/init-code-review.js","discourse/plugins/discourse-code-review/discourse/routes/admin-plugins-code-review.js","discourse/plugins/discourse-code-review/discourse/routes/user-activity-approval-given.js","discourse/plugins/discourse-code-review/discourse/routes/user-activity-approval-pending.js","discourse/plugins/discourse-code-review/discourse/templates/admin/plugins-code-review.js","discourse/plugins/discourse-code-review/discourse/templates/connectors/user-activity-bottom/approval-given-button.js","discourse/plugins/discourse-code-review/discourse/templates/connectors/user-activity-bottom/approval-pending-button.js","discourse/plugins/discourse-code-review/discourse/templates/connectors/user-preferences-notifications/notify-code-review.js","discourse/plugins/discourse-code-review/discourse/widgets/code-review-commit-approved-notification-item.js"],"sourcesContent":["define(\"discourse/plugins/discourse-code-review/discourse/activity-route-map\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n  0; //eaimeta@70e063a35619d71feaimeta@70e063a35619d71f\n\n  var _default = {\n    resource: \"user.userActivity\",\n\n    map() {\n      this.route(\"approval-given\");\n      this.route(\"approval-pending\");\n    }\n\n  };\n  _exports.default = _default;\n});","define(\"discourse/plugins/discourse-code-review/discourse/code-review-route-map\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n  0; //eaimeta@70e063a35619d71feaimeta@70e063a35619d71f\n\n  var _default = {\n    resource: \"admin.adminPlugins\",\n    path: \"/plugins\",\n\n    map() {\n      this.route(\"code-review\");\n    }\n\n  };\n  _exports.default = _default;\n});","define(\"discourse/plugins/discourse-code-review/discourse/connectors/user-preferences-notifications/notify-code-review\", [\"exports\"], function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n  0; //eaimeta@70e063a35619d71feaimeta@70e063a35619d71f\n\n  var _default = {\n    setupComponent(args, component) {\n      const user = args.model;\n      this.set(\"notifyOnCodeReviews\", user.custom_fields.notify_on_code_reviews !== false);\n      component.addObserver(\"notifyOnCodeReviews\", () => {\n        user.set(\"custom_fields.notify_on_code_reviews\", component.get(\"notifyOnCodeReviews\"));\n      });\n    },\n\n    shouldRender(args, component) {\n      return component.currentUser && component.currentUser.admin;\n    }\n\n  };\n  _exports.default = _default;\n});","define(\"discourse/plugins/discourse-code-review/discourse/controllers/admin-plugins-code-review\", [\"exports\", \"discourse/lib/ajax\", \"rsvp\", \"discourse-common/utils/decorators\", \"discourse/lib/ajax-error\", \"@ember/controller\", \"@ember/object\", \"@ember/array\"], function (_exports, _ajax, _rsvp, _decorators, _ajaxError, _controller, _object, _array) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n\n  var _dec, _obj;\n\n  0; //eaimeta@70e063a35619d71f0,\"discourse/lib/ajax\",0,\"rsvp\",0,\"discourse-common/utils/decorators\",0,\"discourse/lib/ajax-error\",0,\"@ember/controller\",0,\"@ember/object\",0,\"@ember/array\"eaimeta@70e063a35619d71f\n\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }\n\n  const prefix = \"/admin/plugins/code-review\";\n\n  var _default = _controller.default.extend((_dec = (0, _decorators.default)(\"loadError\"), (_obj = {\n    organizations: null,\n    loading: true,\n\n    async loadOrganizations() {\n      try {\n        let orgNames = await (0, _ajax.ajax)(`${prefix}/organizations.json`);\n        this.set(\"organizations\", (0, _array.A)([]));\n\n        for (const orgName of orgNames) {\n          let organization = _object.default.create({\n            name: orgName,\n            repos: (0, _array.A)([])\n          });\n\n          this.organizations.pushObject(organization);\n        }\n\n        await _rsvp.Promise.all(this.organizations.map(this.loadOrganizationRepos.bind(this)));\n      } catch (error) {\n        this.set(\"organizationReposLoadFailed\", true);\n      } finally {\n        this.set(\"loading\", false);\n      }\n    },\n\n    async loadOrganizationRepos(organization) {\n      try {\n        let repoNames = await (0, _ajax.ajax)(`${prefix}/organizations/${organization.name}/repos.json`);\n\n        for (const repoName of repoNames) {\n          let repo = _object.default.create({\n            name: repoName,\n            hasConfiguredWebhook: null,\n            receivedWebhookState: false\n          });\n\n          organization.repos.pushObject(repo);\n        } // No point continuing doing requests for the webhooks if there\n        // is an error with the first request, the token permissions must be fixed first\n\n\n        await this.hasConfiguredWebhook(organization.name, organization.repos[0]);\n        await _rsvp.Promise.all(organization.repos.map(repo => this.hasConfiguredWebhook(organization.name, repo)));\n      } catch (response) {\n        this.set(\"loadError\", true);\n        (0, _ajaxError.popupAjaxError)(response);\n      } finally {\n        this.set(\"loading\", false);\n      }\n    },\n\n    async hasConfiguredWebhook(orgName, repo) {\n      if (repo.receivedWebhookState) {\n        return true;\n      }\n\n      let response = await (0, _ajax.ajax)(`${prefix}/organizations/${orgName}/repos/${repo.name}/has-configured-webhook.json`);\n      repo.set(\"receivedWebhookState\", true);\n      repo.set(\"hasConfiguredWebhook\", response[\"has_configured_webhook\"]);\n    },\n\n    configureWebhooksTitle(loadError) {\n      if (!loadError) {\n        return \"\";\n      }\n\n      return \"code_review.webhooks_load_error\";\n    },\n\n    actions: {\n      async configureWebhook(organization, repo) {\n        if (repo.hasConfiguredWebhook === false) {\n          let response = await (0, _ajax.ajax)(`${prefix}/organizations/${organization.name}/repos/${repo.name}/configure-webhook.json`, {\n            type: \"POST\"\n          });\n          repo.set(\"hasConfiguredWebhook\", response[\"has_configured_webhook\"]);\n        }\n      },\n\n      async configureWebhooks() {\n        for (const organization of this.organizations) {\n          for (const repo of organization.repos) {\n            if (repo.hasConfiguredWebhook === false) {\n              let response = await (0, _ajax.ajax)(`${prefix}/organizations/${organization.name}/repos/${repo.name}/configure-webhook.json`, {\n                type: \"POST\"\n              });\n              repo.set(\"hasConfiguredWebhook\", response[\"has_configured_webhook\"]);\n            }\n          }\n        }\n      }\n\n    }\n  }, (_applyDecoratedDescriptor(_obj, \"configureWebhooksTitle\", [_dec], Object.getOwnPropertyDescriptor(_obj, \"configureWebhooksTitle\"), _obj)), _obj)));\n\n  _exports.default = _default;\n});","define(\"discourse/plugins/discourse-code-review/discourse/initializers/init-code-review\", [\"exports\", \"discourse/lib/plugin-api\", \"discourse/lib/ajax\", \"discourse/lib/ajax-error\", \"discourse/lib/url\", \"discourse/models/login-method\", \"@ember/object\", \"I18n\", \"@ember/template\"], function (_exports, _pluginApi, _ajax, _ajaxError, _url, _loginMethod, _object, _I18n, _template) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n  0; //eaimeta@70e063a35619d71f0,\"discourse/lib/plugin-api\",0,\"discourse/lib/ajax\",0,\"discourse/lib/ajax-error\",0,\"discourse/lib/url\",0,\"discourse/models/login-method\",0,\"@ember/object\",0,\"I18n\",0,\"@ember/template\"eaimeta@70e063a35619d71f\n\n  const PLUGIN_ID = \"discourse-code-review\";\n\n  async function actOnCommit(topic, action) {\n    try {\n      let result = await (0, _ajax.ajax)(`/code-review/${action}.json`, {\n        type: \"POST\",\n        data: {\n          topic_id: topic.id\n        }\n      });\n\n      if (result.next_topic_url) {\n        _url.default.routeTo(result.next_topic_url);\n      } else {\n        _url.default.routeTo(\"/\");\n      }\n    } catch (error) {\n      (0, _ajaxError.popupAjaxError)(error);\n    }\n  }\n\n  function initialize(api) {\n    api.addPostSmallActionIcon(\"followup\", \"far-clock\");\n    api.addPostSmallActionIcon(\"approved\", \"thumbs-up\");\n    api.addPostSmallActionIcon(\"followed_up\", \"backward\");\n    api.addPostSmallActionIcon(\"pr_merge_info\", \"info-circle\"); // we need to allow unconditional association even with 2fa\n    // core hides this section if 2fa is on for a user\n    //\n    // note there are slightly cleaner ways of doing this but we would need\n    // to amend core for the plugin which is not feeling right\n\n    api.modifyClass(\"controller:preferences/account\", {\n      pluginId: PLUGIN_ID,\n      canUpdateAssociatedAccounts: (0, _object.computed)(\"authProviders\", function () {\n        return (0, _loginMethod.findAll)().length > 0;\n      })\n    });\n    api.modifyClass(\"controller:preferences/notifications\", {\n      pluginId: PLUGIN_ID,\n\n      init() {\n        this._super(...arguments);\n\n        this.saveAttrNames.push(\"custom_fields\");\n      }\n\n    });\n\n    function allowSkip(currentUser, topic, siteSettings) {\n      return allowApprove(currentUser, topic, siteSettings);\n    }\n\n    function allowApprove(currentUser, topic, siteSettings) {\n      if (!currentUser) {\n        return false;\n      }\n\n      const allowSelfApprove = siteSettings.code_review_allow_self_approval;\n      const approvedTag = siteSettings.code_review_approved_tag;\n      const pendingTag = siteSettings.code_review_pending_tag;\n      const followupTag = siteSettings.code_review_followup_tag;\n      const tags = topic.tags || [];\n      return (allowSelfApprove || currentUser.id !== topic.user_id) && !tags.includes(approvedTag) && (tags.includes(pendingTag) || tags.includes(followupTag));\n    }\n\n    function allowFollowupButton(topic, siteSettings) {\n      if (!siteSettings.code_review_allow_manual_followup) {\n        return false;\n      }\n\n      const approvedTag = siteSettings.code_review_approved_tag;\n      const pendingTag = siteSettings.code_review_pending_tag;\n      const followupTag = siteSettings.code_review_followup_tag;\n      const tags = topic.tags || [];\n      return !tags.includes(followupTag) && (tags.includes(pendingTag) || tags.includes(approvedTag));\n    }\n\n    function allowFollowedUpButton(currentUser, topic, siteSettings) {\n      const followupTag = siteSettings.code_review_followup_tag;\n      const tags = topic.tags || [];\n      return currentUser.id === topic.user_id && tags.includes(followupTag);\n    }\n\n    api.registerTopicFooterButton({\n      id: \"approve\",\n      icon: \"thumbs-up\",\n      priority: 260,\n      label: \"code_review.approve.label\",\n      title: \"code_review.approve.title\",\n\n      action() {\n        actOnCommit(this.topic, \"approve\");\n      },\n\n      dropdown() {\n        return this.site.mobileView;\n      },\n\n      classNames: [\"approve\"],\n      dependentKeys: [\"topic.tags\"],\n\n      displayed() {\n        return this.get(\"currentUser.can_review_code\") && allowApprove(this.currentUser, this.topic, this.siteSettings);\n      }\n\n    });\n    api.registerTopicFooterButton({\n      id: \"skip\",\n      icon: \"angle-double-right\",\n      priority: 250,\n      label: \"code_review.skip.label\",\n      title: \"code_review.skip.title\",\n\n      action() {\n        actOnCommit(this.topic, \"skip\");\n      },\n\n      dropdown() {\n        return this.site.mobileView;\n      },\n\n      classNames: [\"skip\"],\n      dependentKeys: [\"topic.tags\"],\n\n      displayed() {\n        return this.get(\"currentUser.can_review_code\") && allowSkip(this.currentUser, this.topic, this.siteSettings);\n      }\n\n    });\n    api.registerTopicFooterButton({\n      id: \"followup\",\n      icon: \"far-clock\",\n      priority: 240,\n      label: \"code_review.followup.label\",\n      title: \"code_review.followup.title\",\n\n      action() {\n        actOnCommit(this.topic, \"followup\");\n      },\n\n      dropdown() {\n        return this.site.mobileView;\n      },\n\n      classNames: [\"followup\"],\n      dependentKeys: [\"topic.tags\"],\n\n      displayed() {\n        return this.get(\"currentUser.can_review_code\") && allowFollowupButton(this.topic, this.siteSettings);\n      }\n\n    });\n    api.registerTopicFooterButton({\n      id: \"followed_up\",\n      icon: \"history\",\n      priority: 240,\n      label: \"code_review.followed_up.label\",\n      title: \"code_review.followed_up.title\",\n\n      action() {\n        actOnCommit(this.topic, \"followed_up\");\n      },\n\n      dropdown() {\n        return this.site.mobileView;\n      },\n\n      classNames: [\"followup\"],\n      dependentKeys: [\"topic.tags\"],\n\n      displayed() {\n        return this.get(\"currentUser.can_review_code\") && allowFollowedUpButton(this.currentUser, this.topic, this.siteSettings);\n      }\n\n    });\n    api.replaceIcon(\"notification.code_review_commit_approved\", \"check\");\n\n    if (api.registerNotificationTypeRenderer) {\n      api.registerNotificationTypeRenderer(\"code_review_commit_approved\", NotificationTypeBase => {\n        return class extends NotificationTypeBase {\n          get linkTitle() {\n            return _I18n.default.t(\"notifications.code_review.commit_approved.title\");\n          }\n\n          get icon() {\n            return \"check\";\n          }\n\n          get linkHref() {\n            return super.linkHref || (0, _url.userPath)(`${this.currentUser.username}/activity/approval-given`);\n          }\n\n          get label() {\n            const numApprovedCommits = this.notification.data.num_approved_commits;\n\n            if (numApprovedCommits > 1) {\n              return _I18n.default.t(\"notifications.code_review.commit_approved.multiple\", {\n                count: numApprovedCommits\n              });\n            } else {\n              return (0, _template.htmlSafe)(_I18n.default.t(\"notifications.code_review.commit_approved.single\", {\n                topicTitle: this.notification.fancy_title\n              }));\n            }\n          }\n\n          get description() {\n            return null;\n          }\n\n        };\n      });\n    }\n  }\n\n  var _default = {\n    name: \"discourse-code-review\",\n\n    initialize() {\n      (0, _pluginApi.withPluginApi)(\"0.8.28\", initialize);\n    }\n\n  };\n  _exports.default = _default;\n});","define(\"discourse/plugins/discourse-code-review/discourse/routes/admin-plugins-code-review\", [\"exports\", \"discourse/routes/discourse\"], function (_exports, _discourse) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n  0; //eaimeta@70e063a35619d71f0,\"discourse/routes/discourse\"eaimeta@70e063a35619d71f\n\n  var _default = _discourse.default.extend({\n    controllerName: \"admin-plugins-code-review\",\n\n    activate() {\n      this.controllerFor(this.controllerName).loadOrganizations();\n    }\n\n  });\n\n  _exports.default = _default;\n});","define(\"discourse/plugins/discourse-code-review/discourse/routes/user-activity-approval-given\", [\"exports\", \"discourse/routes/user-topic-list\", \"I18n\"], function (_exports, _userTopicList, _I18n) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n  0; //eaimeta@70e063a35619d71f0,\"discourse/routes/user-topic-list\",0,\"I18n\"eaimeta@70e063a35619d71f\n\n  var _default = _userTopicList.default.extend({\n    model() {\n      const username = this.modelFor(\"user\").username_lower;\n      return this.store.findFiltered(\"topicList\", {\n        filter: `topics/approval-given/${username}`\n      }).then(model => {\n        // andrei: we agreed that this is an anti pattern,\n        // it's better to avoid mutating a rest model like this\n        // this place we'll be refactored later\n        // see https://github.com/discourse/discourse/pull/14313#discussion_r708784704\n        model.set(\"emptyState\", this.emptyState());\n        return model;\n      });\n    },\n\n    emptyState() {\n      const title = _I18n.default.t(\"code_review.approval_given_empty_state_title\");\n\n      const body = \"\";\n      return {\n        title,\n        body\n      };\n    }\n\n  });\n\n  _exports.default = _default;\n});","define(\"discourse/plugins/discourse-code-review/discourse/routes/user-activity-approval-pending\", [\"exports\", \"discourse/routes/user-topic-list\", \"I18n\"], function (_exports, _userTopicList, _I18n) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n  0; //eaimeta@70e063a35619d71f0,\"discourse/routes/user-topic-list\",0,\"I18n\"eaimeta@70e063a35619d71f\n\n  var _default = _userTopicList.default.extend({\n    model() {\n      const username = this.modelFor(\"user\").username_lower;\n      return this.store.findFiltered(\"topicList\", {\n        filter: `topics/approval-pending/${username}`\n      }).then(model => {\n        // andrei: we agreed that this is an anti pattern,\n        // it's better to avoid mutating a rest model like this\n        // this place we'll be refactored later\n        // see https://github.com/discourse/discourse/pull/14313#discussion_r708784704\n        model.set(\"emptyState\", this.emptyState());\n        return model;\n      });\n    },\n\n    emptyState() {\n      const title = _I18n.default.t(\"code_review.approval_pending_empty_state_title\");\n\n      const body = \"\";\n      return {\n        title,\n        body\n      };\n    }\n\n  });\n\n  _exports.default = _default;\n});","define(\"discourse/plugins/discourse-code-review/discourse/templates/admin/plugins-code-review\", [\"exports\", \"@ember/template-factory\"], function (_exports, _templateFactory) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n  0; //eaimeta@70e063a35619d71f0,\"ember-cli-htmlbars\"eaimeta@70e063a35619d71f\n\n  var _default = (0, _templateFactory.createTemplateFactory)(\n  /*\n    <h1>{{i18n \"code_review.github_webhooks\"}}</h1>\n  \n  {{#if this.organizations}}\n    <div class=\"alert alert-warning\">\n      {{html-safe (i18n \"code_review.configure_webhooks_warning\")}}\n    </div>\n  \n    {{d-button\n      action=(action \"configureWebhooks\")\n      label=\"code_review.configure_webhooks\"\n      class=\"code-review-configure-webhooks-button\"\n      disabled=loadError\n      title=configureWebhooksTitle\n    }}\n  {{else}}\n    {{html-safe (i18n \"code_review.no_organizations_configured\")}}\n  {{/if}}\n  \n  {{#conditional-loading-spinner condition=loading}}\n    <div class=\"code-review-webhook-tree\">\n      {{#each this.organizations as |organization|}}\n        <div class=\"code-review-webhook-org\">\n          <h2>{{organization.name}}</h2>\n  \n          {{#each organization.repos as |repo|}}\n            <div class=\"code-review-webhook-repo\">\n              <h3>{{repo.name}}</h3>\n  \n              {{#if repo.receivedWebhookState}}\n                {{#if repo.hasConfiguredWebhook}}\n                  <div class=\"code-review-webhook-configured\">\n                    {{d-icon \"check\"}}\n                  </div>\n                {{else}}\n                  <div class=\"code-review-webhook-not-configured\">\n                    {{d-icon \"times\"}}\n                    {{d-button\n                      action=(action \"configureWebhook\" organization repo)\n                      label=\"code_review.configure_webhook\"\n                    }}\n                  </div>\n                {{/if}}\n              {{/if}}\n            </div>\n          {{/each}}\n        </div>\n      {{/each}}\n    </div>\n  {{/conditional-loading-spinner}}\n  \n  */\n  {\n    \"id\": \"pwI2lcZw\",\n    \"block\": \"[[[10,\\\"h1\\\"],[12],[1,[28,[35,0],[\\\"code_review.github_webhooks\\\"],null]],[13],[1,\\\"\\\\n\\\\n\\\"],[41,[30,0,[\\\"organizations\\\"]],[[[1,\\\"  \\\"],[10,0],[14,0,\\\"alert alert-warning\\\"],[12],[1,\\\"\\\\n    \\\"],[1,[28,[35,2],[[28,[37,0],[\\\"code_review.configure_webhooks_warning\\\"],null]],null]],[1,\\\"\\\\n  \\\"],[13],[1,\\\"\\\\n\\\\n  \\\"],[1,[28,[35,3],null,[[\\\"action\\\",\\\"label\\\",\\\"class\\\",\\\"disabled\\\",\\\"title\\\"],[[28,[37,4],[[30,0],\\\"configureWebhooks\\\"],null],\\\"code_review.configure_webhooks\\\",\\\"code-review-configure-webhooks-button\\\",[33,5],[33,6]]]]],[1,\\\"\\\\n\\\"]],[]],[[[1,\\\"  \\\"],[1,[28,[35,2],[[28,[37,0],[\\\"code_review.no_organizations_configured\\\"],null]],null]],[1,\\\"\\\\n\\\"]],[]]],[1,\\\"\\\\n\\\"],[6,[39,7],null,[[\\\"condition\\\"],[[33,8]]],[[\\\"default\\\"],[[[[1,\\\"  \\\"],[10,0],[14,0,\\\"code-review-webhook-tree\\\"],[12],[1,\\\"\\\\n\\\"],[42,[28,[37,10],[[28,[37,10],[[30,0,[\\\"organizations\\\"]]],null]],null],null,[[[1,\\\"      \\\"],[10,0],[14,0,\\\"code-review-webhook-org\\\"],[12],[1,\\\"\\\\n        \\\"],[10,\\\"h2\\\"],[12],[1,[30,1,[\\\"name\\\"]]],[13],[1,\\\"\\\\n\\\\n\\\"],[42,[28,[37,10],[[28,[37,10],[[30,1,[\\\"repos\\\"]]],null]],null],null,[[[1,\\\"          \\\"],[10,0],[14,0,\\\"code-review-webhook-repo\\\"],[12],[1,\\\"\\\\n            \\\"],[10,\\\"h3\\\"],[12],[1,[30,2,[\\\"name\\\"]]],[13],[1,\\\"\\\\n\\\\n\\\"],[41,[30,2,[\\\"receivedWebhookState\\\"]],[[[41,[30,2,[\\\"hasConfiguredWebhook\\\"]],[[[1,\\\"                \\\"],[10,0],[14,0,\\\"code-review-webhook-configured\\\"],[12],[1,\\\"\\\\n                  \\\"],[1,[28,[35,11],[\\\"check\\\"],null]],[1,\\\"\\\\n                \\\"],[13],[1,\\\"\\\\n\\\"]],[]],[[[1,\\\"                \\\"],[10,0],[14,0,\\\"code-review-webhook-not-configured\\\"],[12],[1,\\\"\\\\n                  \\\"],[1,[28,[35,11],[\\\"times\\\"],null]],[1,\\\"\\\\n                  \\\"],[1,[28,[35,3],null,[[\\\"action\\\",\\\"label\\\"],[[28,[37,4],[[30,0],\\\"configureWebhook\\\",[30,1],[30,2]],null],\\\"code_review.configure_webhook\\\"]]]],[1,\\\"\\\\n                \\\"],[13],[1,\\\"\\\\n\\\"]],[]]]],[]],null],[1,\\\"          \\\"],[13],[1,\\\"\\\\n\\\"]],[2]],null],[1,\\\"      \\\"],[13],[1,\\\"\\\\n\\\"]],[1]],null],[1,\\\"  \\\"],[13],[1,\\\"\\\\n\\\"]],[]]]]]],[\\\"organization\\\",\\\"repo\\\"],false,[\\\"i18n\\\",\\\"if\\\",\\\"html-safe\\\",\\\"d-button\\\",\\\"action\\\",\\\"loadError\\\",\\\"configureWebhooksTitle\\\",\\\"conditional-loading-spinner\\\",\\\"loading\\\",\\\"each\\\",\\\"-track-array\\\",\\\"d-icon\\\"]]\",\n    \"moduleName\": \"discourse/plugins/discourse-code-review/discourse/templates/admin/plugins-code-review.hbs\",\n    \"isStrictMode\": false\n  });\n\n  _exports.default = _default;\n});","define(\"discourse/plugins/discourse-code-review/discourse/templates/connectors/user-activity-bottom/approval-given-button\", [\"exports\", \"@ember/template-factory\"], function (_exports, _templateFactory) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n  0; //eaimeta@70e063a35619d71f0,\"ember-cli-htmlbars\"eaimeta@70e063a35619d71f\n\n  var _default = (0, _templateFactory.createTemplateFactory)(\n  /*\n    <li>\n    {{#link-to \"userActivity.approval-given\"}}\n      {{i18n \"code_review.approval_given\"}}\n    {{/link-to}}\n  </li>\n  \n  */\n  {\n    \"id\": \"x6AaeN5P\",\n    \"block\": \"[[[10,\\\"li\\\"],[12],[1,\\\"\\\\n\\\"],[6,[39,0],null,[[\\\"route\\\"],[\\\"userActivity.approval-given\\\"]],[[\\\"default\\\"],[[[[1,\\\"    \\\"],[1,[28,[35,1],[\\\"code_review.approval_given\\\"],null]],[1,\\\"\\\\n\\\"]],[]]]]],[13],[1,\\\"\\\\n\\\"]],[],false,[\\\"link-to\\\",\\\"i18n\\\"]]\",\n    \"moduleName\": \"discourse/plugins/discourse-code-review/discourse/templates/connectors/user-activity-bottom/approval-given-button.hbs\",\n    \"isStrictMode\": false\n  });\n\n  _exports.default = _default;\n});","define(\"discourse/plugins/discourse-code-review/discourse/templates/connectors/user-activity-bottom/approval-pending-button\", [\"exports\", \"@ember/template-factory\"], function (_exports, _templateFactory) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n  0; //eaimeta@70e063a35619d71f0,\"ember-cli-htmlbars\"eaimeta@70e063a35619d71f\n\n  var _default = (0, _templateFactory.createTemplateFactory)(\n  /*\n    <li>\n    {{#link-to \"userActivity.approval-pending\"}}\n      {{i18n \"code_review.approval_pending\"}}\n    {{/link-to}}\n  </li>\n  \n  */\n  {\n    \"id\": \"KfVvZJXm\",\n    \"block\": \"[[[10,\\\"li\\\"],[12],[1,\\\"\\\\n\\\"],[6,[39,0],null,[[\\\"route\\\"],[\\\"userActivity.approval-pending\\\"]],[[\\\"default\\\"],[[[[1,\\\"    \\\"],[1,[28,[35,1],[\\\"code_review.approval_pending\\\"],null]],[1,\\\"\\\\n\\\"]],[]]]]],[13],[1,\\\"\\\\n\\\"]],[],false,[\\\"link-to\\\",\\\"i18n\\\"]]\",\n    \"moduleName\": \"discourse/plugins/discourse-code-review/discourse/templates/connectors/user-activity-bottom/approval-pending-button.hbs\",\n    \"isStrictMode\": false\n  });\n\n  _exports.default = _default;\n});","define(\"discourse/plugins/discourse-code-review/discourse/templates/connectors/user-preferences-notifications/notify-code-review\", [\"exports\", \"@ember/template-factory\"], function (_exports, _templateFactory) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.default = void 0;\n  0; //eaimeta@70e063a35619d71f0,\"ember-cli-htmlbars\"eaimeta@70e063a35619d71f\n\n  var _default = (0, _templateFactory.createTemplateFactory)(\n  /*\n    <div class=\"control-group\">\n    <label class=\"control-label\">{{i18n \"code_review.title\"}}</label>\n    <div class=\"controls\">\n      {{preference-checkbox\n        labelKey=\"code_review.notify_on_approval\"\n        checked=notifyOnCodeReviews\n      }}\n    </div>\n  </div>\n  \n  */\n  {\n    \"id\": \"od9RJ8q2\",\n    \"block\": \"[[[10,0],[14,0,\\\"control-group\\\"],[12],[1,\\\"\\\\n  \\\"],[10,\\\"label\\\"],[14,0,\\\"control-label\\\"],[12],[1,[28,[35,0],[\\\"code_review.title\\\"],null]],[13],[1,\\\"\\\\n  \\\"],[10,0],[14,0,\\\"controls\\\"],[12],[1,\\\"\\\\n    \\\"],[1,[28,[35,1],null,[[\\\"labelKey\\\",\\\"checked\\\"],[\\\"code_review.notify_on_approval\\\",[33,2]]]]],[1,\\\"\\\\n  \\\"],[13],[1,\\\"\\\\n\\\"],[13],[1,\\\"\\\\n\\\"]],[],false,[\\\"i18n\\\",\\\"preference-checkbox\\\",\\\"notifyOnCodeReviews\\\"]]\",\n    \"moduleName\": \"discourse/plugins/discourse-code-review/discourse/templates/connectors/user-preferences-notifications/notify-code-review.hbs\",\n    \"isStrictMode\": false\n  });\n\n  _exports.default = _default;\n});","define(\"discourse/plugins/discourse-code-review/discourse/widgets/code-review-commit-approved-notification-item\", [\"discourse/widgets/widget\", \"discourse/widgets/default-notification-item\", \"discourse/lib/utilities\", \"discourse/lib/url\", \"I18n\"], function (_widget, _defaultNotificationItem, _utilities, _url, _I18n) {\n  \"use strict\";\n\n  0; //eaimeta@70e063a35619d71f0,\"discourse/widgets/widget\",0,\"discourse/widgets/default-notification-item\",0,\"discourse/lib/utilities\",0,\"discourse/lib/url\",0,\"I18n\"eaimeta@70e063a35619d71f\n\n  (0, _widget.createWidgetFrom)(_defaultNotificationItem.DefaultNotificationItem, \"code-review-commit-approved-notification-item\", {\n    notificationTitle() {\n      return _I18n.default.t(\"notifications.code_review.commit_approved.title\");\n    },\n\n    text(notificationName, data) {\n      const numApprovedCommits = data.num_approved_commits;\n\n      if (numApprovedCommits === 1) {\n        return _I18n.default.t(\"notifications.code_review.commit_approved.single\", {\n          topicTitle: this.attrs.fancy_title\n        });\n      } else {\n        return _I18n.default.t(\"notifications.code_review.commit_approved.multiple\", {\n          count: numApprovedCommits\n        });\n      }\n    },\n\n    url() {\n      const topicId = this.attrs.topic_id;\n\n      if (topicId) {\n        return (0, _utilities.postUrl)(this.attrs.slug, topicId, 1);\n      } else {\n        return (0, _url.userPath)(`${this.currentUser.username}/activity/approval-given`);\n      }\n    }\n\n  });\n});"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;","file":"discourse-code-review.js"}