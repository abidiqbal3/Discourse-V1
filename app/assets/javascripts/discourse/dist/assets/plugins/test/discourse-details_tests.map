{"version":3,"sources":["discourse/plugins/discourse-details/acceptance/details-button-test.js","discourse/plugins/discourse-details/lib/details-cooked-test.js"],"sourcesContent":["define(\"discourse/plugins/discourse-details/acceptance/details-button-test\", [\"discourse/tests/helpers/qunit-helpers\", \"I18n\", \"discourse/controllers/composer\", \"discourse/tests/helpers/select-kit-helper\", \"qunit\", \"@ember/test-helpers\"], function (_qunitHelpers, _I18n, _composer, _selectKitHelper, _qunit, _testHelpers) {\n  \"use strict\";\n\n  0; //eaimeta@70e063a35619d71f0,\"discourse/tests/helpers/qunit-helpers\",0,\"I18n\",0,\"discourse/controllers/composer\",0,\"discourse/tests/helpers/select-kit-helper\",0,\"qunit\",0,\"@ember/test-helpers\"eaimeta@70e063a35619d71f\n\n  (0, _qunitHelpers.acceptance)(\"Details Button\", function (needs) {\n    needs.user();\n    needs.hooks.beforeEach(() => (0, _composer.clearPopupMenuOptionsCallback)());\n    (0, _qunit.test)(\"details button\", async function (assert) {\n      const popupMenu = (0, _selectKitHelper.default)(\".toolbar-popup-menu-options\");\n      await (0, _testHelpers.visit)(\"/\");\n      await (0, _testHelpers.click)(\"#create-topic\");\n      await popupMenu.expand();\n      await popupMenu.selectRowByValue(\"insertDetails\");\n      assert.strictEqual((0, _qunitHelpers.query)(\".d-editor-input\").value, `\\n[details=\"${_I18n.default.t(\"composer.details_title\")}\"]\\n${_I18n.default.t(\"composer.details_text\")}\\n[/details]\\n`, \"it should contain the right output\");\n      await (0, _testHelpers.fillIn)(\".d-editor-input\", \"This is my title\");\n      const textarea = (0, _qunitHelpers.query)(\".d-editor-input\");\n      textarea.selectionStart = 0;\n      textarea.selectionEnd = textarea.value.length;\n      await popupMenu.expand();\n      await popupMenu.selectRowByValue(\"insertDetails\");\n      assert.strictEqual((0, _qunitHelpers.query)(\".d-editor-input\").value, `\\n[details=\"${_I18n.default.t(\"composer.details_title\")}\"]\\nThis is my title\\n[/details]\\n`, \"it should contain the right selected output\");\n      assert.strictEqual(textarea.selectionStart, 21, \"it should start highlighting at the right position\");\n      assert.strictEqual(textarea.selectionEnd, 37, \"it should end highlighting at the right position\");\n      await (0, _testHelpers.fillIn)(\".d-editor-input\", \"Before some text in between After\");\n      textarea.selectionStart = 7;\n      textarea.selectionEnd = 28;\n      await popupMenu.expand();\n      await popupMenu.selectRowByValue(\"insertDetails\");\n      assert.strictEqual((0, _qunitHelpers.query)(\".d-editor-input\").value, `Before \\n[details=\"${_I18n.default.t(\"composer.details_title\")}\"]\\nsome text in between\\n[/details]\\n After`, \"it should contain the right output\");\n      assert.strictEqual(textarea.selectionStart, 28, \"it should start highlighting at the right position\");\n      assert.strictEqual(textarea.selectionEnd, 48, \"it should end highlighting at the right position\");\n      await (0, _testHelpers.fillIn)(\".d-editor-input\", \"Before \\nsome text in between\\n After\");\n      textarea.selectionStart = 8;\n      textarea.selectionEnd = 29;\n      await popupMenu.expand();\n      await popupMenu.selectRowByValue(\"insertDetails\");\n      assert.strictEqual((0, _qunitHelpers.query)(\".d-editor-input\").value, `Before \\n\\n[details=\"${_I18n.default.t(\"composer.details_title\")}\"]\\nsome text in between\\n[/details]\\n\\n After`, \"it should contain the right output\");\n      assert.strictEqual(textarea.selectionStart, 29, \"it should start highlighting at the right position\");\n      assert.strictEqual(textarea.selectionEnd, 49, \"it should end highlighting at the right position\");\n    });\n    (0, _qunit.test)(\"details button surrounds all selected text in a single details block\", async function (assert) {\n      const multilineInput = \"first line\\n\\nsecond line\\n\\nthird line\";\n      const popupMenu = (0, _selectKitHelper.default)(\".toolbar-popup-menu-options\");\n      await (0, _testHelpers.visit)(\"/\");\n      await (0, _testHelpers.click)(\"#create-topic\");\n      await (0, _testHelpers.fillIn)(\".d-editor-input\", multilineInput);\n      const textarea = (0, _qunitHelpers.query)(\".d-editor-input\");\n      textarea.selectionStart = 0;\n      textarea.selectionEnd = textarea.value.length;\n      await popupMenu.expand();\n      await popupMenu.selectRowByValue(\"insertDetails\");\n      assert.strictEqual((0, _qunitHelpers.query)(\".d-editor-input\").value, `\\n[details=\"${_I18n.default.t(\"composer.details_title\")}\"]\\n${multilineInput}\\n[/details]\\n`, \"it should contain the right output\");\n    });\n  });\n});","define(\"discourse/plugins/discourse-details/lib/details-cooked-test\", [\"pretty-text/pretty-text\", \"qunit\"], function (_prettyText, _qunit) {\n  \"use strict\";\n\n  0; //eaimeta@70e063a35619d71f0,\"pretty-text/pretty-text\",0,\"qunit\"eaimeta@70e063a35619d71f\n\n  const defaultOpts = (0, _prettyText.buildOptions)({\n    siteSettings: {\n      enable_emoji: true,\n      emoji_set: \"google_classic\",\n      highlighted_languages: \"json|ruby|javascript\",\n      default_code_lang: \"auto\"\n    },\n    censoredWords: \"shucks|whiz|whizzer\",\n    getURL: url => url\n  });\n  (0, _qunit.module)(\"lib:details-cooked-test\", function () {\n    (0, _qunit.test)(\"details\", function (assert) {\n      const cooked = (input, expected, text) => {\n        assert.strictEqual(new _prettyText.default(defaultOpts).cook(input), expected.replace(/\\/>/g, \">\"), text);\n      };\n\n      cooked(`<details><summary>Info</summary>coucou</details>`, `<details><summary>Info</summary>coucou</details>`, \"manual HTML for details\");\n      cooked(\"[details=testing]\\ntest\\n[/details]\", `<details>\n<summary>\ntesting</summary>\n<p>test</p>\n</details>`);\n    });\n  });\n});"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;","file":"discourse-details_tests.js"}