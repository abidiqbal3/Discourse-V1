{"version":3,"sources":["scripts/start-app.js","scripts/discourse-boot.js"],"sourcesContent":["document.addEventListener(\"discourse-booted\", (e) => {\n  performance.mark(\"discourse-booted\");\n  const config = e.detail;\n  const app = require(`${config.modulePrefix}/app`)[\"default\"].create(config);\n  app.start();\n});\n","(function () {\n  if (window.unsupportedBrowser) {\n    throw \"Unsupported browser detected\";\n  }\n\n  // TODO: Remove this and have resolver find the templates\n  const discoursePrefix = \"discourse/templates/\";\n  const adminPrefix = \"admin/templates/\";\n  const wizardPrefix = \"wizard/templates/\";\n  const discoursePrefixLength = discoursePrefix.length;\n\n  const pluginRegex = /^discourse\\/plugins\\/([^\\/]+)\\//;\n  const themeRegex = /^discourse\\/theme-([^\\/]+)\\//;\n\n  Object.keys(requirejs.entries).forEach(function (key) {\n    let templateKey;\n    let pluginName;\n    let themeId;\n    if (key.startsWith(discoursePrefix)) {\n      templateKey = key.slice(discoursePrefixLength);\n    } else if (key.startsWith(adminPrefix) || key.startsWith(wizardPrefix)) {\n      templateKey = key;\n    } else if (\n      (pluginName = key.match(pluginRegex)?.[1]) &&\n      key.includes(\"/templates/\") &&\n      require(key).default.__id // really is a template\n    ) {\n      // This logic mimics the old sprockets compilation system which used to\n      // output templates directly to `Ember.TEMPLATES` with this naming logic\n      templateKey = key.slice(`discourse/plugins/${pluginName}/`.length);\n      templateKey = templateKey.replace(\"discourse/templates/\", \"\");\n      templateKey = `javascripts/${templateKey}`;\n    } else if (\n      (themeId = key.match(themeRegex)?.[1]) &&\n      key.includes(\"/templates/\")\n    ) {\n      // And likewise for themes - this mimics the old logic\n      templateKey = key.slice(`discourse/theme-${themeId}/`.length);\n      templateKey = templateKey.replace(\"discourse/templates/\", \"\");\n      if (!templateKey.startsWith(\"javascripts/\")) {\n        templateKey = `javascripts/${templateKey}`;\n      }\n    }\n\n    if (templateKey) {\n      Ember.TEMPLATES[templateKey] = require(key).default;\n    }\n  });\n\n  window.__widget_helpers = require(\"discourse-widget-hbs/helpers\").default;\n\n  // TODO: Eliminate this global\n  window.virtualDom = require(\"virtual-dom\");\n\n  let element = document.querySelector(\n    `meta[name=\"discourse/config/environment\"]`\n  );\n  const config = JSON.parse(\n    decodeURIComponent(element.getAttribute(\"content\"))\n  );\n  const event = new CustomEvent(\"discourse-booted\", { detail: config });\n  document.dispatchEvent(event);\n})();\n"],"names":["document","addEventListener","e","performance","mark","config","detail","app","require","modulePrefix","create","start","window","unsupportedBrowser","discoursePrefix","adminPrefix","wizardPrefix","discoursePrefixLength","length","pluginRegex","themeRegex","Object","keys","requirejs","entries","forEach","key","templateKey","pluginName","themeId","startsWith","slice","match","includes","require","default","__id","replace","Ember","TEMPLATES","__widget_helpers","virtualDom","element","document","querySelector","config","JSON","parse","decodeURIComponent","getAttribute","event","CustomEvent","detail","dispatchEvent"],"mappings":"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","file":"start-discourse.js"}