'use strict';

define("discourse/tests/acceptance/about-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("About", function () {
    (0, _qunit.test)("viewing", async function (assert) {
      await (0, _testHelpers.visit)("/about");
      assert.ok(document.body.classList.contains("about-page"), "has body class");
      assert.ok((0, _qunitHelpers.exists)(".about.admins .user-info"), "has admins");
      assert.ok((0, _qunitHelpers.exists)(".about.moderators .user-info"), "has moderators");
      assert.ok((0, _qunitHelpers.exists)(".about.stats tr.about-topic-count td"), "has topic stats");
      assert.ok((0, _qunitHelpers.exists)(".about.stats tr.about-post-count td"), "has post stats");
      assert.ok((0, _qunitHelpers.exists)(".about.stats tr.about-user-count td"), "has user stats");
      assert.ok((0, _qunitHelpers.exists)(".about.stats tr.about-active-user-count td"), "has active user stats");
      assert.ok((0, _qunitHelpers.exists)(".about.stats tr.about-like-count td"), "has like stats");
      assert.ok((0, _qunitHelpers.exists)(".about.stats tr.about-chat_messages-count td"), "has plugin stats");
      assert.notOk((0, _qunitHelpers.exists)(".about.stats tr.about-chat_users-count td"), "does not show hidden plugin stats");
    });
  });
});
define("discourse/tests/acceptance/account-created-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/lib/preload-store", "qunit"], function (_qunitHelpers, _testHelpers, _preloadStore, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/lib/preload-store",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Account Created", function () {
    (0, _qunit.test)("account created - message", async function (assert) {
      _preloadStore.default.store("accountCreated", {
        message: "Hello World"
      });

      await (0, _testHelpers.visit)("/u/account-created");
      assert.ok((0, _qunitHelpers.exists)(".account-created"));
      assert.strictEqual((0, _qunitHelpers.query)(".account-created .success-info").innerText.trim(), "Hello World", "it displays the message");
      assert.notOk((0, _qunitHelpers.exists)(".activation-controls"));
    });
    (0, _qunit.test)("account created - resend email", async function (assert) {
      _preloadStore.default.store("accountCreated", {
        message: "Hello World",
        username: "eviltrout",
        email: "eviltrout@example.com",
        show_controls: true
      });

      await (0, _testHelpers.visit)("/u/account-created");
      assert.ok((0, _qunitHelpers.exists)(".account-created"));
      assert.strictEqual((0, _qunitHelpers.query)(".account-created .success-info").innerText.trim(), "Hello World", "it displays the message");
      await (0, _testHelpers.click)(".activation-controls .resend");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "account-created.resent");
      const email = (0, _qunitHelpers.query)(".account-created b").innerText;
      assert.strictEqual(email, "eviltrout@example.com");
    });
    (0, _qunit.test)("account created - update email - cancel", async function (assert) {
      _preloadStore.default.store("accountCreated", {
        message: "Hello World",
        username: "eviltrout",
        email: "eviltrout@example.com",
        show_controls: true
      });

      await (0, _testHelpers.visit)("/u/account-created");
      await (0, _testHelpers.click)(".activation-controls .edit-email");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "account-created.edit-email");
      assert.ok((0, _qunitHelpers.exists)(".activation-controls .btn-primary:disabled"));
      await (0, _testHelpers.click)(".activation-controls .edit-cancel");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "account-created.index");
    });
    (0, _qunit.test)("account created - update email - submit", async function (assert) {
      _preloadStore.default.store("accountCreated", {
        message: "Hello World",
        username: "eviltrout",
        email: "eviltrout@example.com",
        show_controls: true
      });

      await (0, _testHelpers.visit)("/u/account-created");
      await (0, _testHelpers.click)(".activation-controls .edit-email");
      assert.ok((0, _qunitHelpers.exists)(".activation-controls .btn-primary:disabled"));
      await (0, _testHelpers.fillIn)(".activate-new-email", "newemail@example.com");
      assert.notOk((0, _qunitHelpers.exists)(".activation-controls .btn-primary:disabled"));
      await (0, _testHelpers.click)(".activation-controls .btn-primary");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "account-created.resent");
      const email = (0, _qunitHelpers.query)(".account-created b").innerText;
      assert.strictEqual(email, "newemail@example.com");
    });
  });
});
define("discourse/tests/acceptance/admin-badges-award-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "I18n"], function (_qunitHelpers, _testHelpers, _qunit, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Admin - Badges - Mass Award", function (needs) {
    needs.user();
    (0, _qunit.test)("when the badge can be granted multiple times", async function (assert) {
      await (0, _testHelpers.visit)("/admin/badges/award/new");
      await (0, _testHelpers.click)('.admin-badge-list-item span[data-badge-name="Both image and icon"]');
      assert.strictEqual((0, _qunitHelpers.query)("label.grant-existing-holders").textContent.trim(), _I18n.default.t("admin.badges.mass_award.grant_existing_holders"), "checkbox for granting existing holders is displayed");
    });
    (0, _qunit.test)("when the badge can not be granted multiple times", async function (assert) {
      await (0, _testHelpers.visit)("/admin/badges/award/new");
      await (0, _testHelpers.click)('.admin-badge-list-item span[data-badge-name="Only icon"]');
      assert.ok(!(0, _qunitHelpers.exists)(".grant-existing-holders"), "checkbox for granting existing holders is not displayed");
    });
  });
});
define("discourse/tests/acceptance/admin-badges-show-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "@ember/object"], function (_qunitHelpers, _testHelpers, _qunit, _object) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"@ember/object"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Admin - Badges - Show", function (needs) {
    needs.user();
    (0, _qunit.test)("new badge page", async function (assert) {
      await (0, _testHelpers.visit)("/admin/badges/new");
      assert.ok(!(0, _qunitHelpers.query)("input#badge-icon").checked, "radio button for selecting an icon is off initially");
      assert.ok(!(0, _qunitHelpers.query)("input#badge-image").checked, "radio button for uploading an image is off initially");
      assert.ok(!(0, _qunitHelpers.exists)(".icon-picker"), "icon picker is not visible");
      assert.ok(!(0, _qunitHelpers.exists)(".image-uploader"), "image uploader is not visible");
      await (0, _testHelpers.click)("input#badge-icon");
      assert.ok((0, _qunitHelpers.exists)(".icon-picker"), "icon picker is visible after clicking the select icon radio button");
      assert.ok(!(0, _qunitHelpers.exists)(".image-uploader"), "image uploader remains hidden");
      await (0, _testHelpers.click)("input#badge-image");
      assert.ok(!(0, _qunitHelpers.exists)(".icon-picker"), "icon picker is hidden after clicking the upload image radio button");
      assert.ok((0, _qunitHelpers.exists)(".image-uploader"), "image uploader becomes visible after clicking the upload image radio button"); // SQL fields

      assert.false((0, _qunitHelpers.exists)("label[for=query]"), "sql input is hidden by default");
      (0, _object.set)(this.siteSettings, "enable_badge_sql", true);
      await (0, _testHelpers.settled)();
      assert.true((0, _qunitHelpers.exists)("label[for=query]"), "sql input shows when enabled");
      assert.false((0, _qunitHelpers.exists)("input[name=auto_revoke]"), "does not show sql-specific options when query is blank");
      await (0, _testHelpers.fillIn)(".ace-wrapper textarea", "SELECT 1");
      assert.true((0, _qunitHelpers.exists)("input[name=auto_revoke]"), "shows sql-specific options when query is present");
    });
    (0, _qunit.test)("existing badge that has an icon", async function (assert) {
      await (0, _testHelpers.visit)("/admin/badges/1");
      assert.ok((0, _qunitHelpers.query)("input#badge-icon").checked, "radio button for selecting an icon is on");
      assert.ok(!(0, _qunitHelpers.query)("input#badge-image").checked, "radio button for uploading an image is off");
      assert.ok((0, _qunitHelpers.exists)(".icon-picker"), "icon picker is visible");
      assert.ok(!(0, _qunitHelpers.exists)(".image-uploader"), "image uploader is not visible");
      assert.strictEqual((0, _qunitHelpers.query)(".icon-picker").textContent.trim(), "fa-rocket");
    });
    (0, _qunit.test)("existing badge that has an image URL", async function (assert) {
      await (0, _testHelpers.visit)("/admin/badges/2");
      assert.ok(!(0, _qunitHelpers.query)("input#badge-icon").checked, "radio button for selecting an icon is off");
      assert.ok((0, _qunitHelpers.query)("input#badge-image").checked, "radio button for uploading an image is on");
      assert.ok(!(0, _qunitHelpers.exists)(".icon-picker"), "icon picker is not visible");
      assert.ok((0, _qunitHelpers.exists)(".image-uploader"), "image uploader is visible");
      assert.ok((0, _qunitHelpers.query)(".image-uploader a.lightbox").href.endsWith("/images/avatar.png?2"), "image uploader shows the right image");
    });
    (0, _qunit.test)("existing badge that has both an icon and image URL", async function (assert) {
      await (0, _testHelpers.visit)("/admin/badges/3");
      assert.ok(!(0, _qunitHelpers.query)("input#badge-icon").checked, "radio button for selecting an icon is off because image overrides icon");
      assert.ok((0, _qunitHelpers.query)("input#badge-image").checked, "radio button for uploading an image is on because image overrides icon");
      assert.ok(!(0, _qunitHelpers.exists)(".icon-picker"), "icon picker is not visible");
      assert.ok((0, _qunitHelpers.exists)(".image-uploader"), "image uploader is visible");
      assert.ok((0, _qunitHelpers.query)(".image-uploader a.lightbox").href.endsWith("/images/avatar.png?3"), "image uploader shows the right image");
      await (0, _testHelpers.click)("input#badge-icon");
      assert.ok((0, _qunitHelpers.exists)(".icon-picker"), "icon picker is becomes visible");
      assert.ok(!(0, _qunitHelpers.exists)(".image-uploader"), "image uploader becomes hidden");
      assert.strictEqual((0, _qunitHelpers.query)(".icon-picker").textContent.trim(), "fa-rocket");
    });
  });
});
define("discourse/tests/acceptance/admin-emails-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "discourse/tests/helpers/create-pretender"], function (_qunitHelpers, _testHelpers, _qunit, _createPretender) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"discourse/tests/helpers/create-pretender"eaimeta@70e063a35619d71f

  const EMAIL = `
From: "somebody" <somebody@example.com>
To: someone@example.com
Date: Mon, 3 Dec 2018 00:00:00 -0000
Subject: This is some subject
Content-Type: text/plain; charset="UTF-8"

Hello, this is a test!

---

This part should be elided.`;
  (0, _qunitHelpers.acceptance)("Admin - Emails", function (needs) {
    needs.user();
    (0, _qunit.test)("shows selected and elided text", async function (assert) {
      _createPretender.default.post("/admin/email/advanced-test", () => {
        return (0, _createPretender.response)({
          format: 1,
          text: "Hello, this is a test!",
          elided: "---\n\nThis part should be elided."
        });
      });

      await (0, _testHelpers.visit)("/admin/email/advanced-test");
      await (0, _testHelpers.fillIn)("textarea.email-body", EMAIL.trim());
      await (0, _testHelpers.click)(".email-advanced-test button");
      assert.strictEqual((0, _qunitHelpers.query)(".text pre").innerText, "Hello, this is a test!");
      assert.strictEqual((0, _qunitHelpers.query)(".elided pre").innerText, "---\n\nThis part should be elided.");
    });
    (0, _qunit.test)("displays received errors when testing emails", async function (assert) {
      _createPretender.default.get("/admin/email.json", () => {
        return (0, _createPretender.response)({});
      });

      _createPretender.default.post("/admin/email/test", () => {
        return (0, _createPretender.response)(422, {
          errors: ["some error"]
        });
      });

      await (0, _testHelpers.visit)("/admin/email");
      await (0, _testHelpers.fillIn)(".admin-controls input", "test@example.com");
      await (0, _testHelpers.click)(".btn-primary");
      assert.ok((0, _qunitHelpers.query)("#dialog-holder").innerText.includes("some error"));
      assert.ok((0, _qunitHelpers.query)("#dialog-holder .dialog-body b"), "Error message can contain html");
      await (0, _testHelpers.click)(".dialog-overlay");
    });
  });
});
define("discourse/tests/acceptance/admin-install-theme-modal-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "I18n"], function (_qunitHelpers, _testHelpers, _qunit, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Admin - Themes - Install modal", function (needs) {
    needs.user();
    (0, _qunit.test)("closing the modal resets the modal inputs", async function (assert) {
      const urlInput = ".install-theme-content .repo input";
      const branchInput = ".install-theme-content .branch input";
      const privateRepoCheckbox = ".install-theme-content .check-private input";
      const publicKey = ".install-theme-content .public-key textarea";
      const themeUrl = "git@github.com:discourse/discourse.git";
      await (0, _testHelpers.visit)("/admin/customize/themes");
      await (0, _testHelpers.click)(".create-actions .btn-primary");
      await (0, _testHelpers.click)("#remote");
      await (0, _testHelpers.fillIn)(urlInput, themeUrl);
      await (0, _testHelpers.click)(".install-theme-content .inputs .advanced-repo");
      await (0, _testHelpers.fillIn)(branchInput, "tests-passed");
      await (0, _testHelpers.click)(privateRepoCheckbox);
      assert.strictEqual((0, _qunitHelpers.query)(urlInput).value, themeUrl, "url input is filled");
      assert.strictEqual((0, _qunitHelpers.query)(branchInput).value, "tests-passed", "branch input is filled");
      assert.ok((0, _qunitHelpers.query)(privateRepoCheckbox).checked, "private repo checkbox is checked");
      assert.ok((0, _qunitHelpers.query)(publicKey), "shows public key");
      await (0, _testHelpers.click)(".modal-footer .d-modal-cancel");
      await (0, _testHelpers.click)(".create-actions .btn-primary");
      await (0, _testHelpers.click)("#remote");
      assert.strictEqual((0, _qunitHelpers.query)(urlInput).value, "", "url input is reset");
      assert.strictEqual((0, _qunitHelpers.query)(branchInput).value, "", "branch input is reset");
      assert.ok(!(0, _qunitHelpers.query)(privateRepoCheckbox).checked, "private repo checkbox unchecked");
      assert.notOk((0, _qunitHelpers.query)(publicKey), "hide public key");
    });
    (0, _qunit.test)("show public key for valid ssh theme urls", async function (assert) {
      const urlInput = ".install-theme-content .repo input";
      const privateRepoCheckbox = ".install-theme-content .check-private input";
      const publicKey = ".install-theme-content .public-key textarea"; // Supports backlog repo ssh url format

      const themeUrl = "discourse@discourse.git.backlog.com:/TEST_THEME/test-theme.git";
      await (0, _testHelpers.visit)("/admin/customize/themes");
      await (0, _testHelpers.click)(".create-actions .btn-primary");
      await (0, _testHelpers.click)("#remote");
      await (0, _testHelpers.fillIn)(urlInput, themeUrl);
      await (0, _testHelpers.click)(".install-theme-content .inputs .advanced-repo");
      await (0, _testHelpers.click)(privateRepoCheckbox);
      assert.strictEqual((0, _qunitHelpers.query)(urlInput).value, themeUrl, "url input is filled");
      assert.ok((0, _qunitHelpers.query)(privateRepoCheckbox).checked, "private repo checkbox is checked");
      assert.ok((0, _qunitHelpers.query)(publicKey), "shows public key"); // Supports AWS CodeCommit style repo URLs

      await (0, _testHelpers.fillIn)(urlInput, "ssh://someID@git-codecommit.us-west-2.amazonaws.com/v1/repos/test-repo.git");
      assert.ok((0, _qunitHelpers.query)(publicKey), "shows public key");
      await (0, _testHelpers.fillIn)(urlInput, "https://github.com/discourse/discourse.git");
      assert.notOk((0, _qunitHelpers.query)(publicKey), "does not show public key for https urls");
      await (0, _testHelpers.fillIn)(urlInput, "git@github.com:discourse/discourse.git");
      assert.ok((0, _qunitHelpers.query)(publicKey), "shows public key for valid github repo url");
      await (0, _testHelpers.fillIn)(urlInput, "git@github.com:discourse/discourse");
      assert.ok((0, _qunitHelpers.query)(publicKey), "shows public key for valid github repo url");
      await (0, _testHelpers.fillIn)(urlInput, "git@github.com/discourse/discourse");
      assert.notOk((0, _qunitHelpers.query)(publicKey), "does not shows public key for valid github repo url");
    });
    (0, _qunit.test)("modal can be auto-opened with the right query params", async function (assert) {
      await (0, _testHelpers.visit)("/admin/customize/themes?repoUrl=testUrl&repoName=testName");
      assert.ok((0, _qunitHelpers.query)(".admin-install-theme-modal"), "modal is visible");
      assert.strictEqual((0, _qunitHelpers.query)(".install-theme code").textContent.trim(), "testUrl", "repo url is visible");
    });
    (0, _qunit.test)("installed themes are matched with the popular list by URL", async function (assert) {
      await (0, _testHelpers.visit)("/admin/customize/themes");
      await (0, _testHelpers.click)(".create-actions .btn-primary");
      assert.notOk((0, _qunitHelpers.query)('.popular-theme-item[data-name="Graceful"] .popular-theme-buttons button'), "no install button is shown for installed themes");
      assert.strictEqual((0, _qunitHelpers.query)('.popular-theme-item[data-name="Graceful"] .popular-theme-buttons').textContent.trim(), _I18n.default.t("admin.customize.theme.installed"));
      assert.ok((0, _qunitHelpers.query)('.popular-theme-item[data-name="Minima"] .popular-theme-buttons button'), "install button is shown for not installed themes");
    });
  });
});
define("discourse/tests/acceptance/admin-search-log-term-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Admin - Search Log Term", function (needs) {
    needs.user();
    (0, _qunit.test)("show search log term details", async function (assert) {
      await (0, _testHelpers.visit)("/admin/logs/search_logs/term?term=ruby");
      assert.ok((0, _qunitHelpers.exists)(".search-logs-filter"), "has the search type filter");
      assert.ok((0, _qunitHelpers.exists)("canvas"), "has graph canvas");
      assert.ok((0, _qunitHelpers.exists)("div.header-search-results"), "has header search results");
    });
  });
});
define("discourse/tests/acceptance/admin-search-logs-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Admin - Search Logs", function (needs) {
    needs.user();
    (0, _qunit.test)("show search logs", async function (assert) {
      await (0, _testHelpers.visit)("/admin/logs/search_logs");
      assert.ok((0, _qunitHelpers.exists)("table.search-logs-list.grid"), "has the div class");
      assert.ok((0, _qunitHelpers.exists)(".search-logs-list .admin-list-item .col"), "has a list of search logs");
      await (0, _testHelpers.click)(".term a");
      assert.ok((0, _qunitHelpers.exists)(".search-logs-filter"), "it should show the search log term page");
    });
  });
});
define("discourse/tests/acceptance/admin-silence-user-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "I18n"], function (_qunitHelpers, _testHelpers, _qunit, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Admin - Silence User", function (needs) {
    let clock = null;
    needs.user();
    needs.hooks.beforeEach(() => {
      const timezone = (0, _qunitHelpers.loggedInUser)().timezone;
      clock = (0, _qunitHelpers.fakeTime)("2100-05-03T08:00:00", timezone, true); // Monday morning
    });
    needs.hooks.afterEach(() => {
      clock.restore();
    });
    (0, _qunit.test)("shows correct timeframe options", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/1234/regular");
      await (0, _testHelpers.click)(".silence-user");
      await (0, _testHelpers.click)(".future-date-input-selector-header");
      const options = Array.from((0, _qunitHelpers.queryAll)(`ul.select-kit-collection li span.name`).map((_, x) => x.innerText.trim()));
      const expected = [_I18n.default.t("time_shortcut.later_today"), _I18n.default.t("time_shortcut.tomorrow"), _I18n.default.t("time_shortcut.later_this_week"), _I18n.default.t("time_shortcut.start_of_next_business_week_alt"), _I18n.default.t("time_shortcut.two_weeks"), _I18n.default.t("time_shortcut.next_month"), _I18n.default.t("time_shortcut.two_months"), _I18n.default.t("time_shortcut.three_months"), _I18n.default.t("time_shortcut.four_months"), _I18n.default.t("time_shortcut.six_months"), _I18n.default.t("time_shortcut.one_year"), _I18n.default.t("time_shortcut.forever"), _I18n.default.t("time_shortcut.custom")];
      assert.deepEqual(options, expected, "options are correct");
    });
  });
});
define("discourse/tests/acceptance/admin-site-settings-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/tests/fixtures/site-settings", "qunit", "discourse/tests/helpers/create-pretender"], function (_qunitHelpers, _testHelpers, _siteSettings, _qunit, _createPretender) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/tests/fixtures/site-settings",0,"qunit",0,"discourse/tests/helpers/create-pretender"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Admin - Site Settings", function (needs) {
    let updatedTitle;
    needs.user();
    needs.pretender((server, helper) => {
      server.put("/admin/site_settings/title", body => {
        updatedTitle = body.requestBody.split("=")[1];
        return helper.response({
          success: "OK"
        });
      });
      server.get("/admin/site_settings", () => {
        const fixtures = _siteSettings.default["/admin/site_settings"].site_settings;
        const titleSetting = Object.assign({}, fixtures[0]);

        if (updatedTitle) {
          titleSetting.value = updatedTitle;
        }

        const response = {
          site_settings: [titleSetting, ...fixtures.slice(1)]
        };
        return helper.response(response);
      });
    });
    needs.hooks.beforeEach(() => {
      updatedTitle = null;
    });
    (0, _qunit.test)("upload site setting", async function (assert) {
      await (0, _testHelpers.visit)("/admin/site_settings");
      assert.ok((0, _qunitHelpers.exists)(".row.setting.upload .image-uploader"), "image uploader is present");
      assert.ok((0, _qunitHelpers.exists)(".row.setting.upload .undo"), "undo button is present");
    });
    (0, _qunit.test)("links to staff action log", async function (assert) {
      await (0, _testHelpers.visit)("/admin/site_settings");
      assert.strictEqual((0, _qunitHelpers.query)(".row.setting .setting-label h3 a").getAttribute("href"), "/admin/logs/staff_action_logs?filters=%7B%22subject%22%3A%22title%22%2C%22action_name%22%3A%22change_site_setting%22%7D&force_refresh=true", "it links to the staff action log");
    });
    (0, _qunit.test)("changing value updates dirty state", async function (assert) {
      await (0, _testHelpers.visit)("/admin/site_settings");
      await (0, _testHelpers.fillIn)("#setting-filter", " title ");
      assert.strictEqual((0, _qunitHelpers.count)(".row.setting"), 1, "filter returns 1 site setting");
      assert.ok(!(0, _qunitHelpers.exists)(".row.setting.overridden"), "setting isn't overridden");
      await (0, _testHelpers.fillIn)(".input-setting-string", "Test");
      await (0, _testHelpers.click)("button.cancel");
      assert.ok(!(0, _qunitHelpers.exists)(".row.setting.overridden"), "canceling doesn't mark setting as overridden");
      await (0, _testHelpers.fillIn)(".input-setting-string", "Test");
      await (0, _testHelpers.click)("button.ok");
      assert.ok((0, _qunitHelpers.exists)(".row.setting.overridden"), "saving marks setting as overridden");
      await (0, _testHelpers.click)("button.undo");
      assert.ok(!(0, _qunitHelpers.exists)(".row.setting.overridden"), "setting isn't marked as overridden after undo");
      await (0, _testHelpers.click)("button.cancel");
      assert.ok((0, _qunitHelpers.exists)(".row.setting.overridden"), "setting is marked as overridden after cancel");
      await (0, _testHelpers.click)("button.undo");
      await (0, _testHelpers.click)("button.ok");
      assert.ok(!(0, _qunitHelpers.exists)(".row.setting.overridden"), "setting isn't marked as overridden after undo");
      await (0, _testHelpers.fillIn)(".input-setting-string", "Test");
      await (0, _testHelpers.triggerKeyEvent)(".input-setting-string", "keydown", "Enter");
      assert.ok((0, _qunitHelpers.exists)(".row.setting.overridden"), "saving via Enter key marks setting as overridden");
    });
    (0, _qunit.test)("always shows filtered site settings if a filter is set", async function (assert) {
      await (0, _testHelpers.visit)("/admin/site_settings");
      await (0, _testHelpers.fillIn)("#setting-filter", "title");
      assert.strictEqual((0, _qunitHelpers.count)(".row.setting"), 1); // navigate away to the "Dashboard" page

      await (0, _testHelpers.click)(".nav.nav-pills li:nth-child(1) a");
      assert.strictEqual((0, _qunitHelpers.count)(".row.setting"), 0); // navigate back to the "Settings" page

      await (0, _testHelpers.click)(".nav.nav-pills li:nth-child(2) a");
      assert.strictEqual((0, _qunitHelpers.count)(".row.setting"), 1);
    });
    (0, _qunit.test)("filter settings by plugin name", async function (assert) {
      await (0, _testHelpers.visit)("/admin/site_settings");
      await (0, _testHelpers.fillIn)("#setting-filter", "plugin:discourse-logo");
      assert.strictEqual((0, _qunitHelpers.count)(".row.setting"), 1); // inexistent plugin

      await (0, _testHelpers.fillIn)("#setting-filter", "plugin:discourse-plugin");
      assert.strictEqual((0, _qunitHelpers.count)(".row.setting"), 0);
    });
    (0, _qunit.test)("category name is preserved", async function (assert) {
      await (0, _testHelpers.visit)("admin/site_settings/category/basic?filter=menu");
      assert.strictEqual((0, _testHelpers.currentURL)(), "admin/site_settings/category/basic?filter=menu");
    });
    (0, _qunit.test)("shows all_results if current category has none", async function (assert) {
      await (0, _testHelpers.visit)("admin/site_settings");
      await (0, _testHelpers.click)(".admin-nav .basic a");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/admin/site_settings/category/basic");
      await (0, _testHelpers.fillIn)("#setting-filter", "menu");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/admin/site_settings/category/basic?filter=menu");
      await (0, _testHelpers.fillIn)("#setting-filter", "contact");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/admin/site_settings/category/all_results?filter=contact");
    });
    (0, _qunit.test)("filters * and ? for domain lists", async assert => {
      _createPretender.default.put("/admin/site_settings/blocked_onebox_domains", () => [200]);

      await (0, _testHelpers.visit)("/admin/site_settings");
      await (0, _testHelpers.fillIn)("#setting-filter", "domains");
      await (0, _testHelpers.click)(".select-kit-header.multi-select-header");
      await (0, _testHelpers.fillIn)(".select-kit-filter input", "cat.?.domain");
      await (0, _testHelpers.triggerKeyEvent)(".select-kit-filter input", "keydown", "Enter");
      await (0, _testHelpers.fillIn)(".select-kit-filter input", "*.domain");
      await (0, _testHelpers.triggerKeyEvent)(".select-kit-filter input", "keydown", "Enter");
      await (0, _testHelpers.fillIn)(".select-kit-filter input", "proper.com");
      await (0, _testHelpers.triggerKeyEvent)(".select-kit-filter input", "keydown", "Enter");
      await (0, _testHelpers.click)("button.ok");
      assert.strictEqual(_createPretender.default.handledRequests[_createPretender.default.handledRequests.length - 1].requestBody, "blocked_onebox_domains=proper.com");
    });
  });
});
define("discourse/tests/acceptance/admin-site-text-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Admin - Site Texts", function (needs) {
    needs.user();
    needs.settings({
      available_locales: JSON.stringify([{
        name: "English",
        value: "en"
      }]),
      default_locale: "en"
    });
    (0, _qunit.test)("search for a key", async function (assert) {
      await (0, _testHelpers.visit)("/admin/customize/site_texts");
      await (0, _testHelpers.fillIn)(".site-text-search", "Test");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/admin/customize/site_texts?q=Test");
      assert.ok((0, _qunitHelpers.exists)(".site-text"));
      assert.ok((0, _qunitHelpers.exists)(".site-text:not(.overridden)"));
      assert.ok((0, _qunitHelpers.exists)(".site-text.overridden")); // Only show overridden

      await (0, _testHelpers.click)(".search-area .filter-options input");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/admin/customize/site_texts?overridden=true&q=Test");
      assert.ok(!(0, _qunitHelpers.exists)(".site-text:not(.overridden)"));
      assert.ok((0, _qunitHelpers.exists)(".site-text.overridden"));
    });
    (0, _qunit.test)("edit and revert a site text by key", async function (assert) {
      await (0, _testHelpers.visit)("/admin/customize/site_texts/site.test?locale=en");
      assert.strictEqual((0, _qunitHelpers.query)(".title h3").innerText, "site.test");
      assert.ok(!(0, _qunitHelpers.exists)(".saved"));
      assert.ok(!(0, _qunitHelpers.exists)(".revert-site-text")); // Change the value

      await (0, _testHelpers.fillIn)(".site-text-value", "New Test Value");
      await (0, _testHelpers.click)(".save-changes");
      assert.ok((0, _qunitHelpers.exists)(".saved"));
      assert.ok((0, _qunitHelpers.exists)(".revert-site-text")); // Revert the changes

      await (0, _testHelpers.click)(".revert-site-text");
      assert.ok((0, _qunitHelpers.exists)("#dialog-holder .dialog-content"));
      await (0, _testHelpers.click)("#dialog-holder .btn-primary");
      assert.ok(!(0, _qunitHelpers.exists)(".saved"));
      assert.ok(!(0, _qunitHelpers.exists)(".revert-site-text"));
    });
  });
});
define("discourse/tests/acceptance/admin-suspend-user-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/tests/helpers/select-kit-helper", "qunit", "I18n"], function (_qunitHelpers, _testHelpers, _selectKitHelper, _qunit, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"qunit",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Admin - Suspend User", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.put("/admin/users/:user_id/suspend", () => helper.response(200, {
        suspension: {
          suspended_till: "2099-01-01T12:00:00.000Z"
        }
      }));
      server.put("/admin/users/:user_id/unsuspend", () => helper.response(200, {
        suspension: {
          suspended_till: null
        }
      }));
    });
    (0, _qunit.test)("suspend a user - cancel", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/1234/regular");
      await (0, _testHelpers.click)(".suspend-user");
      assert.strictEqual((0, _qunitHelpers.count)(".suspend-user-modal:visible"), 1);
      await (0, _testHelpers.click)(".d-modal-cancel");
      assert.ok(!(0, _qunitHelpers.exists)(".suspend-user-modal:visible"));
    });
    (0, _qunit.test)("suspend a user - cancel with input", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/1234/regular");
      await (0, _testHelpers.click)(".suspend-user");
      assert.strictEqual((0, _qunitHelpers.count)(".suspend-user-modal:visible"), 1);
      await (0, _testHelpers.fillIn)("input.suspend-reason", "for breaking the rules");
      await (0, _testHelpers.fillIn)(".suspend-message", "this is an email reason why");
      await (0, _testHelpers.click)(".d-modal-cancel");
      assert.strictEqual((0, _qunitHelpers.count)(".bootbox.modal:visible"), 1);
      await (0, _testHelpers.click)(".modal-footer .btn-default");
      assert.strictEqual((0, _qunitHelpers.count)(".suspend-user-modal:visible"), 1);
      assert.strictEqual((0, _qunitHelpers.query)(".suspend-message").value, "this is an email reason why");
      await (0, _testHelpers.click)(".d-modal-cancel");
      assert.strictEqual((0, _qunitHelpers.count)(".bootbox.modal:visible"), 1);
      assert.ok(!(0, _qunitHelpers.exists)(".suspend-user-modal:visible"));
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
      assert.ok(!(0, _qunitHelpers.exists)(".bootbox.modal:visible"));
    });
    (0, _qunit.test)("suspend, then unsuspend a user", async function (assert) {
      const suspendUntilCombobox = (0, _selectKitHelper.default)(".suspend-until .combobox");
      await (0, _testHelpers.visit)("/admin/flags/active");
      await (0, _testHelpers.visit)("/admin/users/1234/regular");
      assert.ok(!(0, _qunitHelpers.exists)(".suspension-info"));
      await (0, _testHelpers.click)(".suspend-user");
      assert.strictEqual((0, _qunitHelpers.count)(".perform-suspend[disabled]"), 1, "disabled by default");
      await suspendUntilCombobox.expand();
      await suspendUntilCombobox.selectRowByValue("tomorrow");
      await (0, _testHelpers.fillIn)("input.suspend-reason", "for breaking the rules");
      await (0, _testHelpers.fillIn)(".suspend-message", "this is an email reason why");
      assert.ok(!(0, _qunitHelpers.exists)(".perform-suspend[disabled]"), "no longer disabled");
      await (0, _testHelpers.click)(".perform-suspend");
      assert.ok(!(0, _qunitHelpers.exists)(".suspend-user-modal:visible"));
      assert.ok((0, _qunitHelpers.exists)(".suspension-info"));
      await (0, _testHelpers.click)(".unsuspend-user");
      assert.ok(!(0, _qunitHelpers.exists)(".suspension-info"));
    });
  });
  (0, _qunitHelpers.acceptance)("Admin - Suspend User - timeframe choosing", function (needs) {
    let clock = null;
    needs.user();
    needs.hooks.beforeEach(() => {
      const timezone = (0, _qunitHelpers.loggedInUser)().timezone;
      clock = (0, _qunitHelpers.fakeTime)("2100-05-03T08:00:00", timezone, true); // Monday morning
    });
    needs.hooks.afterEach(() => {
      clock.restore();
    });
    (0, _qunit.test)("shows correct timeframe options", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/1234/regular");
      await (0, _testHelpers.click)(".suspend-user");
      await (0, _testHelpers.click)(".future-date-input-selector-header");
      const options = Array.from((0, _qunitHelpers.queryAll)(`ul.select-kit-collection li span.name`).map((_, x) => x.innerText.trim()));
      const expected = [_I18n.default.t("time_shortcut.later_today"), _I18n.default.t("time_shortcut.tomorrow"), _I18n.default.t("time_shortcut.later_this_week"), _I18n.default.t("time_shortcut.start_of_next_business_week_alt"), _I18n.default.t("time_shortcut.two_weeks"), _I18n.default.t("time_shortcut.next_month"), _I18n.default.t("time_shortcut.two_months"), _I18n.default.t("time_shortcut.three_months"), _I18n.default.t("time_shortcut.four_months"), _I18n.default.t("time_shortcut.six_months"), _I18n.default.t("time_shortcut.one_year"), _I18n.default.t("time_shortcut.forever"), _I18n.default.t("time_shortcut.custom")];
      assert.deepEqual(options, expected, "options are correct");
    });
  });
});
define("discourse/tests/acceptance/admin-user-badges-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Admin - Users Badges", function (needs) {
    needs.user();
    (0, _qunit.test)("lists badges", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/1/eviltrout/badges");
      assert.ok((0, _qunitHelpers.exists)(`span[data-badge-name="Badge 8"]`));
    });
  });
});
define("discourse/tests/acceptance/admin-user-emails-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "I18n", "qunit"], function (_qunitHelpers, _testHelpers, _I18n, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"I18n",0,"qunit"eaimeta@70e063a35619d71f

  function assertNoSecondary(assert) {
    assert.strictEqual((0, _qunitHelpers.query)(".display-row.email .value a").innerText, "eviltrout@example.com", "it should display the primary email");
    assert.strictEqual((0, _qunitHelpers.query)(".display-row.secondary-emails .value").innerText.trim(), _I18n.default.t("user.email.no_secondary"), "it should not display secondary emails");
  }

  function assertMultipleSecondary(assert, firstEmail, secondEmail) {
    assert.strictEqual((0, _qunitHelpers.query)(".display-row.secondary-emails .value li:first-of-type a").innerText, firstEmail, "it should display the first secondary email");
    assert.strictEqual((0, _qunitHelpers.query)(".display-row.secondary-emails .value li:last-of-type a").innerText, secondEmail, "it should display the second secondary email");
  }

  (0, _qunitHelpers.acceptance)("Admin - User Emails", function (needs) {
    needs.user();
    (0, _qunit.test)("viewing self without secondary emails", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/1/eviltrout");
      assertNoSecondary(assert);
    });
    (0, _qunit.test)("viewing self with multiple secondary emails", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/3/markvanlan");
      assert.strictEqual((0, _qunitHelpers.query)(".display-row.email .value a").innerText, "markvanlan@example.com", "it should display the user's primary email");
      assertMultipleSecondary(assert, "markvanlan1@example.com", "markvanlan2@example.com");
    });
    (0, _qunit.test)("viewing another user with no secondary email", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/1234/regular");
      await (0, _testHelpers.click)(`.display-row.secondary-emails button`);
      assertNoSecondary(assert);
    });
    (0, _qunit.test)("viewing another account with secondary emails", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/1235/regular1");
      await (0, _testHelpers.click)(`.display-row.secondary-emails button`);
      assertMultipleSecondary(assert, "regular2alt1@example.com", "regular2alt2@example.com");
    });
  });
});
define("discourse/tests/acceptance/admin-user-index-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/tests/helpers/select-kit-helper", "qunit", "I18n", "discourse/models/user"], function (_qunitHelpers, _testHelpers, _selectKitHelper, _qunit, _I18n, _user) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"qunit",0,"I18n",0,"discourse/models/user"eaimeta@70e063a35619d71f

  const {
    TOTP,
    BACKUP_CODE,
    SECURITY_KEY
  } = _user.SECOND_FACTOR_METHODS;
  let deleteAndBlock = null;
  (0, _qunitHelpers.acceptance)("Admin - User Index", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/groups/search.json", () => {
        return helper.response([{
          id: 42,
          automatic: false,
          name: "Macdonald",
          user_count: 0,
          alias_level: 99,
          visible: true,
          automatic_membership_email_domains: "",
          primary_group: false,
          title: null,
          grant_trust_level: null,
          has_messages: false,
          flair_url: null,
          flair_bg_color: null,
          flair_color: null,
          bio_raw: null,
          bio_cooked: null,
          public_admission: false,
          allow_membership_requests: true,
          membership_request_template: "Please add me",
          full_name: null
        }]);
      });
      server.put("/users/sam/preferences/username", () => {
        return helper.response({
          id: 2,
          username: "new-sam"
        });
      });
      server.get("/admin/users/3.json", () => {
        return helper.response({
          id: 3,
          username: "user1",
          name: null,
          avatar_template: "/letter_avatar_proxy/v4/letter/b/f0a364/{size}.png",
          active: true,
          admin: false,
          moderator: false,
          can_grant_admin: true,
          can_revoke_admin: false,
          can_grant_moderation: true,
          can_revoke_moderation: false
        });
      });
      server.put("/admin/users/3/grant_admin", () => {
        return helper.response({
          success: "OK",
          email_confirmation_required: true
        });
      });
      server.get("/admin/users/4.json", () => {
        return helper.response({
          id: 4,
          username: "user2",
          name: null,
          avatar_template: "/letter_avatar_proxy/v4/letter/b/f0a364/{size}.png",
          active: true,
          admin: false,
          moderator: false,
          can_grant_admin: true,
          can_revoke_admin: false,
          can_grant_moderation: true,
          can_revoke_moderation: false
        });
      });
      server.put("/admin/users/4/grant_admin", () => {
        return helper.response(403, {
          second_factor_challenge_nonce: "some-nonce"
        });
      });
      server.get("/session/2fa.json", () => {
        return helper.response(200, {
          totp_enabled: true,
          backup_enabled: true,
          security_keys_enabled: true,
          allowed_methods: [TOTP, BACKUP_CODE, SECURITY_KEY]
        });
      });
      server.get("/admin/users/5.json", () => {
        return helper.response({
          id: 5,
          username: "user5",
          name: null,
          avatar_template: "/letter_avatar_proxy/v4/letter/b/f0a364/{size}.png",
          active: true,
          can_be_deleted: true,
          post_count: 0
        });
      });
      server.delete("/admin/users/5.json", request => {
        const data = helper.parsePostData(request.requestBody);

        if (data.block_email || data.block_ip || data.block_urls) {
          deleteAndBlock = true;
        } else {
          deleteAndBlock = false;
        }

        return helper.response({});
      });
    });
    needs.hooks.beforeEach(() => {
      deleteAndBlock = null;
    });
    (0, _qunit.test)("can edit username", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/2/sam");
      assert.strictEqual((0, _qunitHelpers.query)(".display-row.username .value").innerText.trim(), "sam"); // Trying cancel.

      await (0, _testHelpers.click)(".display-row.username button");
      await (0, _testHelpers.fillIn)(".display-row.username .value input", "new-sam");
      await (0, _testHelpers.click)(".display-row.username a");
      assert.strictEqual((0, _qunitHelpers.query)(".display-row.username .value").innerText.trim(), "sam"); // Doing edit.

      await (0, _testHelpers.click)(".display-row.username button");
      await (0, _testHelpers.fillIn)(".display-row.username .value input", "new-sam");
      await (0, _testHelpers.click)(".display-row.username button");
      assert.strictEqual((0, _qunitHelpers.query)(".display-row.username .value").innerText.trim(), "new-sam");
    });
    (0, _qunit.test)("shows the number of post edits", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/1/eviltrout");
      assert.strictEqual((0, _qunitHelpers.query)(".post-edits-count .value").innerText.trim(), "6");
      assert.ok((0, _qunitHelpers.exists)(".post-edits-count .controls .btn.btn-icon"), "View edits button exists");
    });
    (0, _qunit.test)("a link to view post edits report exists", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/1/eviltrout");
      let filter = encodeURIComponent('{"editor":"eviltrout"}');
      await (0, _testHelpers.click)(".post-edits-count .controls .btn.btn-icon");
      assert.strictEqual((0, _testHelpers.currentURL)(), `/admin/reports/post_edits?filters=${filter}`, "it redirects to the right admin report");
    });
    (0, _qunit.test)("hides the 'view Edits' button if the count is zero", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/2/sam");
      assert.ok(!(0, _qunitHelpers.exists)(".post-edits-count .controls .btn.btn-icon"), "View Edits button not present");
    });
    (0, _qunit.test)("will clear unsaved groups when switching user", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/2/sam");
      assert.strictEqual((0, _qunitHelpers.query)(".display-row.username .value").innerText.trim(), "sam", "the name should be correct");
      const groupChooser = (0, _selectKitHelper.default)(".group-chooser");
      await groupChooser.expand();
      await groupChooser.selectRowByValue(42);
      assert.strictEqual(groupChooser.header().value(), "42", "group should be set");
      await (0, _testHelpers.visit)("/admin/users/1/eviltrout");
      assert.strictEqual((0, _qunitHelpers.query)(".display-row.username .value").innerText.trim(), "eviltrout", "the name should be correct");
      assert.ok(!(0, _qunitHelpers.exists)('.group-chooser span[title="Macdonald"]'), "group should not be set");
    });
    (0, _qunit.test)("grant admin - shows the confirmation bootbox", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/3/user1");
      await (0, _testHelpers.click)(".grant-admin");
      assert.ok((0, _qunitHelpers.exists)(".dialog-content"));
      assert.strictEqual(_I18n.default.t("admin.user.grant_admin_confirm"), (0, _qunitHelpers.query)(".dialog-body").textContent.trim());
      await (0, _testHelpers.click)(".dialog-footer .btn-primary");
    });
    (0, _qunit.test)("grant admin - redirects to the 2fa page", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/4/user2");
      await (0, _testHelpers.click)(".grant-admin");
      assert.equal((0, _testHelpers.currentURL)(), "/session/2fa?nonce=some-nonce", "user is redirected to the 2FA page");
    });
    (0, _qunit.test)("delete user - delete without blocking works as expected", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/5/user5");
      await (0, _testHelpers.click)(".btn-user-delete");
      assert.equal((0, _qunitHelpers.query)("#dialog-title").textContent, _I18n.default.t("admin.user.delete_confirm_title"), "dialog has a title");
      await (0, _testHelpers.click)(".dialog-footer .btn-primary");
      assert.notOk(deleteAndBlock, "user does not get blocked");
    });
    (0, _qunit.test)("delete user - delete and block works as expected", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/5/user5");
      await (0, _testHelpers.click)(".btn-user-delete");
      await (0, _testHelpers.click)(".dialog-footer .btn-danger");
      assert.ok(deleteAndBlock, "user does not get blocked");
    });
  });
});
define("discourse/tests/acceptance/admin-users-list-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "I18n", "qunit"], function (_qunitHelpers, _testHelpers, _I18n, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"I18n",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Admin - Users List", function (needs) {
    needs.user();
    (0, _qunit.test)("lists users", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/list/active");
      assert.ok((0, _qunitHelpers.exists)(".users-list .user"));
      assert.ok(!(0, _qunitHelpers.exists)(".user:nth-of-type(1) .email small"), "escapes email");
    });
    (0, _qunit.test)("sorts users", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/list/active");
      assert.ok((0, _qunitHelpers.exists)(".users-list .user"));
      await (0, _testHelpers.click)(".users-list .sortable:nth-child(1)");
      assert.ok((0, _qunitHelpers.query)(".users-list .user:nth-child(1) .username").innerText.includes("eviltrout"), "list should be sorted by username");
      await (0, _testHelpers.click)(".users-list .sortable:nth-child(1)");
      assert.ok((0, _qunitHelpers.query)(".users-list .user:nth-child(1) .username").innerText.includes("discobot"), "list should be sorted ascending by username");
    });
    (0, _qunit.test)("toggles email visibility", async function (assert) {
      await (0, _testHelpers.visit)("/admin/users/list/active");
      assert.ok((0, _qunitHelpers.exists)(".users-list .user"));
      await (0, _testHelpers.click)(".show-emails");
      assert.strictEqual((0, _qunitHelpers.query)(".users-list .user:nth-child(1) .email").innerText, "<small>eviltrout@example.com</small>", "shows the emails");
      await (0, _testHelpers.click)(".hide-emails");
      assert.strictEqual((0, _qunitHelpers.query)(".users-list .user:nth-child(1) .email").innerText, "", "hides the emails");
    });
    (0, _qunit.test)("switching tabs", async function (assert) {
      const activeUser = "eviltrout";
      const suspectUser = "sam";

      const activeTitle = _I18n.default.t("admin.users.titles.active");

      const suspectTitle = _I18n.default.t("admin.users.titles.new");

      await (0, _testHelpers.visit)("/admin/users/list/active");
      assert.strictEqual((0, _qunitHelpers.query)(".admin-title h2").innerText, activeTitle);
      assert.ok((0, _qunitHelpers.query)(".users-list .user:nth-child(1) .username").innerText.includes(activeUser));
      await (0, _testHelpers.click)('a[href="/admin/users/list/new"]');
      assert.strictEqual((0, _qunitHelpers.query)(".admin-title h2").innerText, suspectTitle);
      assert.ok((0, _qunitHelpers.query)(".users-list .user:nth-child(1) .username").innerText.includes(suspectUser));
      await (0, _testHelpers.click)(".users-list .sortable:nth-child(4)");
      assert.strictEqual((0, _qunitHelpers.query)(".admin-title h2").innerText, suspectTitle);
      assert.ok((0, _qunitHelpers.query)(".users-list .user:nth-child(1) .username").innerText.includes(suspectUser));
      await (0, _testHelpers.click)('a[href="/admin/users/list/active"]');
      assert.strictEqual((0, _qunitHelpers.query)(".admin-title h2").innerText, activeTitle);
      assert.ok((0, _qunitHelpers.query)(".users-list .user:nth-child(1) .username").innerText.includes(activeUser));
    });
  });
});
define("discourse/tests/acceptance/admin-watched-words-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "I18n"], function (_qunitHelpers, _testHelpers, _qunit, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Admin - Watched Words", function (needs) {
    needs.user();
    (0, _qunit.test)("list words in groups", async function (assert) {
      await (0, _testHelpers.visit)("/admin/customize/watched_words/action/block");
      assert.ok(!(0, _qunitHelpers.exists)(".admin-watched-words .alert-error"));
      assert.ok(!(0, _qunitHelpers.exists)(".watched-words-list"), "Don't show bad words by default.");
      assert.ok(!(0, _qunitHelpers.exists)(".watched-words-list .watched-word"), "Don't show bad words by default.");
      await (0, _testHelpers.fillIn)(".admin-controls .controls input[type=text]", "li");
      assert.strictEqual((0, _qunitHelpers.count)(".watched-words-list .watched-word"), 1, "When filtering, show words even if checkbox is unchecked.");
      await (0, _testHelpers.fillIn)(".admin-controls .controls input[type=text]", "");
      assert.ok(!(0, _qunitHelpers.exists)(".watched-words-list .watched-word"), "Clearing the filter hides words again.");
      await (0, _testHelpers.click)(".show-words-checkbox");
      assert.ok((0, _qunitHelpers.exists)(".watched-words-list .watched-word"), "Always show the words when checkbox is checked.");
      await (0, _testHelpers.click)(".nav-stacked .censor a");
      assert.ok((0, _qunitHelpers.exists)(".watched-words-list"));
      assert.ok(!(0, _qunitHelpers.exists)(".watched-words-list .watched-word"), "Empty word list.");
    });
    (0, _qunit.test)("add words", async function (assert) {
      await (0, _testHelpers.visit)("/admin/customize/watched_words/action/block");
      await (0, _testHelpers.click)(".show-words-checkbox");
      await (0, _testHelpers.fillIn)(".watched-word-form input", "poutine");
      await (0, _testHelpers.click)(".watched-word-form button");
      let found = [];
      [...(0, _qunitHelpers.queryAll)(".watched-words-list .watched-word")].forEach(elem => {
        if (elem.innerText.trim() === "poutine") {
          found.push(true);
        }
      });
      assert.strictEqual(found.length, 1);
      assert.strictEqual((0, _qunitHelpers.count)(".watched-words-list .case-sensitive"), 0);
    });
    (0, _qunit.test)("add case-sensitive words", async function (assert) {
      await (0, _testHelpers.visit)("/admin/customize/watched_words/action/block");
      await (0, _testHelpers.click)(".show-words-checkbox");
      await (0, _testHelpers.fillIn)(".watched-word-form input", "Discourse");
      await (0, _testHelpers.click)(".case-sensitivity-checkbox");
      await (0, _testHelpers.click)(".watched-word-form button");
      assert.dom(".watched-words-list .watched-word").hasText(`Discourse ${_I18n.default.t("admin.watched_words.case_sensitive")}`);
      await (0, _testHelpers.fillIn)(".watched-word-form input", "discourse");
      await (0, _testHelpers.click)(".case-sensitivity-checkbox");
      await (0, _testHelpers.click)(".watched-word-form button");
      assert.dom(".watched-words-list .watched-word").hasText(`discourse ${_I18n.default.t("admin.watched_words.case_sensitive")}`);
    });
    (0, _qunit.test)("remove words", async function (assert) {
      await (0, _testHelpers.visit)("/admin/customize/watched_words/action/block");
      await (0, _testHelpers.click)(".show-words-checkbox");
      let wordId = null;
      [...(0, _qunitHelpers.queryAll)(".watched-words-list .watched-word")].forEach(elem => {
        if (elem.innerText.trim() === "anise") {
          wordId = elem.getAttribute("id");
        }
      });
      await (0, _testHelpers.click)(`#${wordId} .delete-word-record`);
      assert.strictEqual((0, _qunitHelpers.count)(".watched-words-list .watched-word"), 2);
    });
    (0, _qunit.test)("test modal - replace", async function (assert) {
      await (0, _testHelpers.visit)("/admin/customize/watched_words/action/replace");
      await (0, _testHelpers.click)(".watched-word-test");
      await (0, _testHelpers.fillIn)(".modal-body textarea", "Hi there!");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-body li .match").innerText, "Hi");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-body li .replacement").innerText, "hello");
    });
    (0, _qunit.test)("test modal - tag", async function (assert) {
      await (0, _testHelpers.visit)("/admin/customize/watched_words/action/tag");
      await (0, _testHelpers.click)(".watched-word-test");
      await (0, _testHelpers.fillIn)(".modal-body textarea", "Hello world!");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-body li .match").innerText, "Hello");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-body li .tag").innerText, "greeting");
    });
  });
  (0, _qunitHelpers.acceptance)("Admin - Watched Words - Bad regular expressions", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/admin/customize/watched_words.json", () => {
        return helper.response({
          actions: ["block", "censor", "require_approval", "flag", "replace"],
          words: [{
            id: 1,
            word: "[.*",
            regexp: "[.*",
            action: "block"
          }],
          compiled_regular_expressions: {
            block: null,
            censor: null,
            require_approval: null,
            flag: null,
            replace: null
          }
        });
      });
    });
    (0, _qunit.test)("shows an error message if regex is invalid", async function (assert) {
      await (0, _testHelpers.visit)("/admin/customize/watched_words/action/block");
      assert.strictEqual((0, _qunitHelpers.count)(".admin-watched-words .alert-error"), 1);
    });
  });
});
define("discourse/tests/acceptance/auth-complete-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Auth Complete", function (needs) {
    needs.hooks.beforeEach(() => {
      const node = document.createElement("meta");
      node.dataset.authenticationData = JSON.stringify({
        auth_provider: "test",
        email: "blah@example.com"
      });
      node.id = "data-authentication";
      document.querySelector("head").appendChild(node);
    });
    needs.hooks.afterEach(() => {
      document.querySelector("head").removeChild(document.getElementById("data-authentication"));
    });
    (0, _qunit.test)("when login not required", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "discovery.latest", "it stays on the homepage");
      assert.ok((0, _qunitHelpers.exists)("#discourse-modal div.create-account-body"), "it shows the registration modal");
    });
    (0, _qunit.test)("when login required", async function (assert) {
      this.siteSettings.login_required = true;
      await (0, _testHelpers.visit)("/");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "login", "it redirects to the login page");
      assert.ok((0, _qunitHelpers.exists)("#discourse-modal div.create-account-body"), "it shows the registration modal");
    });
  });
});
define("discourse/tests/acceptance/badges-test", ["discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/select-kit-helper", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _selectKitHelper, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Badges", function (needs) {
    needs.user();
    (0, _qunit.test)("Visit Badge Pages", async function (assert) {
      await (0, _testHelpers.visit)("/badges");
      assert.ok(document.body.classList.contains("badges-page"), "has body class");
      assert.ok((0, _qunitHelpers.exists)(".badge-groups .badge-card"), "has a list of badges");
      await (0, _testHelpers.visit)("/badges/9/autobiographer");
      assert.ok((0, _qunitHelpers.exists)(".badge-card"), "has the badge in the listing");
      assert.ok((0, _qunitHelpers.exists)(".user-info"), "has the list of users with that badge");
      assert.ok(!(0, _qunitHelpers.exists)(".badge-card:nth-of-type(1) script"));
    });
    (0, _qunit.test)("shows correct badge titles to choose from", async function (assert) {
      const availableBadgeTitles = (0, _selectKitHelper.default)(".select-kit");
      await (0, _testHelpers.visit)("/badges/50/custombadge");
      await availableBadgeTitles.expand();
      assert.strictEqual(availableBadgeTitles.rowByIndex(1).name(), "CustomBadge");
    });
  });
});
define("discourse/tests/acceptance/bookmarks-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "I18n", "discourse/tests/helpers/select-kit-helper", "qunit", "discourse/tests/fixtures/topic", "discourse-common/lib/object", "discourse/models/user"], function (_qunitHelpers, _testHelpers, _I18n, _selectKitHelper, _qunit, _topic, _object, _user) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"I18n",0,"discourse/tests/helpers/select-kit-helper",0,"qunit",0,"discourse/tests/fixtures/topic",0,"discourse-common/lib/object",0,"discourse/models/user"eaimeta@70e063a35619d71f

  async function openBookmarkModal() {
    let postNumber = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;

    if ((0, _qunitHelpers.exists)(`#post_${postNumber} button.show-more-actions`)) {
      await (0, _testHelpers.click)(`#post_${postNumber} button.show-more-actions`);
    }

    await (0, _testHelpers.click)(`#post_${postNumber} button.bookmark`);
  }

  async function openEditBookmarkModal() {
    await (0, _testHelpers.click)(".topic-post:first-child button.bookmarked");
  }

  async function testTopicLevelBookmarkButtonIcon(assert, postNumber) {
    const iconWithoutClock = "d-icon-bookmark";
    const iconWithClock = "d-icon-discourse-bookmark-clock";
    await (0, _testHelpers.visit)("/t/internationalization-localization/280");
    assert.ok((0, _qunitHelpers.query)("#topic-footer-button-bookmark svg").classList.contains(iconWithoutClock), "Shows an icon without a clock when there is no a bookmark");
    await openBookmarkModal(postNumber);
    await (0, _testHelpers.click)("#save-bookmark");
    assert.ok((0, _qunitHelpers.query)("#topic-footer-button-bookmark svg").classList.contains(iconWithoutClock), "Shows an icon without a clock when there is a bookmark without a reminder");
    await openBookmarkModal(postNumber);
    await (0, _testHelpers.click)("#tap_tile_tomorrow");
    assert.ok((0, _qunitHelpers.query)("#topic-footer-button-bookmark svg").classList.contains(iconWithClock), "Shows an icon with a clock when there is a bookmark with a reminder");
  }

  (0, _qunitHelpers.acceptance)("Bookmarking", function (needs) {
    needs.user();
    const topicResponse = (0, _object.cloneJSON)(_topic.default["/t/280/1.json"]);
    topicResponse.post_stream.posts[0].cooked += `<span data-date="2036-01-15" data-time="00:35:00" class="discourse-local-date cooked-date past" data-timezone="Europe/London">
  <span>
    <svg class="fa d-icon d-icon-globe-americas svg-icon" xmlns="http://www.w3.org/2000/svg">
      <use href="#globe-americas"></use>
    </svg>
    <span class="relative-time">January 15, 2036 12:35 AM</span>
  </span>
</span>`;
    topicResponse.post_stream.posts[1].cooked += `<span data-date="2021-01-15" data-time="00:35:00" class="discourse-local-date cooked-date past" data-timezone="Europe/London">
  <span>
    <svg class="fa d-icon d-icon-globe-americas svg-icon" xmlns="http://www.w3.org/2000/svg">
      <use href="#globe-americas"></use>
    </svg>
    <span class="relative-time">Today 10:30 AM</span>
  </span>
</span>`;
    needs.pretender((server, helper) => {
      function handleRequest(request) {
        const data = helper.parsePostData(request.requestBody);

        if (data.bookmarkable_id === "398" && data.bookmarkable_type === "Post") {
          return helper.response({
            id: 1,
            success: "OK"
          });
        } else if (data.bookmarkable_type === "Topic") {
          return helper.response({
            id: 3,
            success: "OK"
          });
        } else if (data.bookmarkable_id === "419" && data.bookmarkable_type === "Post") {
          return helper.response({
            id: 2,
            success: "OK"
          });
        }
      }

      server.post("/bookmarks", handleRequest);
      server.put("/bookmarks/1", handleRequest);
      server.put("/bookmarks/2", handleRequest);
      server.put("/bookmarks/3", handleRequest);
      server.delete("/bookmarks/1", () => helper.response({
        success: "OK",
        topic_bookmarked: false
      }));
      server.get("/t/280.json", () => helper.response(topicResponse));
    });
    (0, _qunit.test)("Bookmarks modal opening", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await openBookmarkModal();
      assert.ok((0, _qunitHelpers.exists)("#bookmark-reminder-modal"), "it shows the bookmark modal");
      assert.ok((0, _qunitHelpers.exists)("#tap_tile_none.active"), "it highlights the None option by default");
    });
    (0, _qunit.test)("Bookmarks modal selecting reminder type", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await openBookmarkModal();
      await (0, _testHelpers.click)("#tap_tile_tomorrow");
      await openBookmarkModal();
      await (0, _testHelpers.click)("#tap_tile_start_of_next_business_week");
      await openBookmarkModal();
      await (0, _testHelpers.click)("#tap_tile_next_month");
      await openBookmarkModal();
      await (0, _testHelpers.click)("#tap_tile_custom");
      assert.ok((0, _qunitHelpers.exists)("#tap_tile_custom.active"), "it selects custom");
      assert.ok((0, _qunitHelpers.exists)(".tap-tile-date-input"), "it shows the custom date input");
      assert.ok((0, _qunitHelpers.exists)(".tap-tile-time-input"), "it shows the custom time input");
      await (0, _testHelpers.click)("#save-bookmark");
    });
    (0, _qunit.test)("Saving a bookmark with a reminder", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await openBookmarkModal();
      await (0, _testHelpers.fillIn)("input#bookmark-name", "Check this out later");
      await (0, _testHelpers.click)("#tap_tile_tomorrow");
      assert.ok((0, _qunitHelpers.exists)(".topic-post:first-child button.bookmark.bookmarked"), "it shows the bookmarked icon on the post");
      assert.ok((0, _qunitHelpers.exists)(".topic-post:first-child button.bookmark.bookmarked > .d-icon-discourse-bookmark-clock"), "it shows the bookmark clock icon because of the reminder");
    });
    (0, _qunit.test)("Opening the options panel and remembering the option", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await openBookmarkModal();
      assert.notOk((0, _qunitHelpers.exists)(".bookmark-options-panel"), "it should not open the options panel by default");
      await (0, _testHelpers.click)(".bookmark-options-button");
      assert.ok((0, _qunitHelpers.exists)(".bookmark-options-panel"), "it should open the options panel");
      await (0, _selectKitHelper.default)(".bookmark-option-selector").expand();
      await (0, _selectKitHelper.default)(".bookmark-option-selector").selectRowByValue(1);
      await (0, _testHelpers.click)("#save-bookmark");
      assert.equal(_user.default.current().bookmark_auto_delete_preference, "1");
      await openEditBookmarkModal();
      assert.ok((0, _qunitHelpers.exists)(".bookmark-options-panel"), "it should reopen the options panel");
      assert.strictEqual((0, _selectKitHelper.default)(".bookmark-option-selector").header().value(), "1");
    });
    (0, _qunit.test)("Saving a bookmark with no reminder or name", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await openBookmarkModal();
      await (0, _testHelpers.click)("#save-bookmark");
      assert.ok((0, _qunitHelpers.exists)(".topic-post:first-child button.bookmark.bookmarked"), "it shows the bookmarked icon on the post");
      assert.notOk((0, _qunitHelpers.exists)(".topic-post:first-child button.bookmark.bookmarked > .d-icon-discourse-bookmark-clock"), "it shows the regular bookmark active icon");
    });
    (0, _qunit.test)("Deleting a bookmark with a reminder", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await openBookmarkModal();
      await (0, _testHelpers.click)("#tap_tile_tomorrow");
      await openEditBookmarkModal();
      assert.ok((0, _qunitHelpers.exists)("#bookmark-reminder-modal"), "it shows the bookmark modal");
      await (0, _testHelpers.click)("#delete-bookmark");
      assert.ok((0, _qunitHelpers.exists)(".bootbox.modal"), "it asks for delete confirmation");
      assert.ok((0, _qunitHelpers.query)(".bootbox.modal").innerText.includes(_I18n.default.t("bookmarks.confirm_delete")), "it shows delete confirmation message");
      await (0, _testHelpers.click)(".bootbox.modal .btn-primary");
      assert.notOk((0, _qunitHelpers.exists)(".topic-post:first-child button.bookmark.bookmarked"), "it no longer shows the bookmarked icon on the post after bookmark is deleted");
    });
    (0, _qunit.test)("Cancelling saving a bookmark", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await openBookmarkModal();
      await (0, _testHelpers.click)(".d-modal-cancel");
      assert.notOk((0, _qunitHelpers.exists)(".topic-post:first-child button.bookmark.bookmarked"), "it does not show the bookmarked icon on the post because it is not saved");
    });
    (0, _qunit.test)("Editing a bookmark", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      let now = moment.tz((0, _qunitHelpers.loggedInUser)().timezone);
      let tomorrow = now.add(1, "day").format("YYYY-MM-DD");
      await openBookmarkModal();
      await (0, _testHelpers.fillIn)("input#bookmark-name", "Test name");
      await (0, _testHelpers.click)("#tap_tile_tomorrow");
      await openEditBookmarkModal();
      assert.strictEqual((0, _qunitHelpers.query)("#bookmark-name").value, "Test name", "it should prefill the bookmark name");
      assert.strictEqual((0, _qunitHelpers.query)("#custom-date > input").value, tomorrow, "it should prefill the bookmark date");
      assert.strictEqual((0, _qunitHelpers.query)("#custom-time").value, "08:00", "it should prefill the bookmark time");
    });
    (0, _qunit.test)("Using a post date for the reminder date", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      let postDate = moment.tz("2036-01-15", (0, _qunitHelpers.loggedInUser)().timezone);
      let postDateFormatted = postDate.format("YYYY-MM-DD");
      await openBookmarkModal();
      await (0, _testHelpers.fillIn)("input#bookmark-name", "Test name");
      await (0, _testHelpers.click)("#tap_tile_post_local_date");
      await openEditBookmarkModal();
      assert.strictEqual((0, _qunitHelpers.query)("#bookmark-name").value, "Test name", "it should prefill the bookmark name");
      assert.strictEqual((0, _qunitHelpers.query)("#custom-date > input").value, postDateFormatted, "it should prefill the bookmark date");
      assert.strictEqual((0, _qunitHelpers.query)("#custom-time").value, "10:35", "it should prefill the bookmark time");
    });
    (0, _qunit.test)("Cannot use the post date for a reminder when the post date is in the past", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await openBookmarkModal(2);
      assert.notOk((0, _qunitHelpers.exists)("#tap_tile_post_local_date"), "it does not show the local date tile");
    });
    (0, _qunit.test)("The topic level bookmark button deletes all bookmarks if several posts on the topic are bookmarked", async function (assert) {
      const yesButton = "a.btn-primary";
      const noButton = "a.btn-default";
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await openBookmarkModal(1);
      await (0, _testHelpers.click)("#save-bookmark");
      await openBookmarkModal(2);
      await (0, _testHelpers.click)("#save-bookmark");
      assert.ok((0, _qunitHelpers.exists)(".topic-post:first-child button.bookmark.bookmarked"), "the first bookmark is added");
      assert.ok((0, _qunitHelpers.exists)(".topic-post:nth-child(3) button.bookmark.bookmarked"), "the second bookmark is added"); // open the modal and cancel deleting

      await (0, _testHelpers.click)("#topic-footer-button-bookmark");
      await (0, _testHelpers.click)(noButton);
      assert.ok((0, _qunitHelpers.exists)(".topic-post:first-child button.bookmark.bookmarked"), "the first bookmark isn't deleted");
      assert.ok((0, _qunitHelpers.exists)(".topic-post:nth-child(3) button.bookmark.bookmarked"), "the second bookmark isn't deleted"); // open the modal and accept deleting

      await (0, _testHelpers.click)("#topic-footer-button-bookmark");
      await (0, _testHelpers.click)(yesButton);
      assert.ok(!(0, _qunitHelpers.exists)(".topic-post:first-child button.bookmark.bookmarked"), "the first bookmark is deleted");
      assert.ok(!(0, _qunitHelpers.exists)(".topic-post:nth-child(3) button.bookmark.bookmarked"), "the second bookmark is deleted");
    });
    (0, _qunit.test)("The topic level bookmark button opens the edit modal if only the first post on the topic is bookmarked", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await openBookmarkModal(1);
      await (0, _testHelpers.click)("#save-bookmark");
      assert.strictEqual((0, _qunitHelpers.query)("#topic-footer-button-bookmark").innerText, _I18n.default.t("bookmarked.edit_bookmark"), "A topic level bookmark button has a label 'Edit Bookmark'");
      await (0, _testHelpers.click)("#topic-footer-button-bookmark");
      assert.ok((0, _qunitHelpers.exists)("div.modal.bookmark-with-reminder"), "The edit modal is opened");
    });
    (0, _qunit.test)("Creating and editing a topic level bookmark", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-button-bookmark");
      await (0, _testHelpers.click)("#save-bookmark");
      assert.notOk((0, _qunitHelpers.exists)(".topic-post:first-child button.bookmark.bookmarked"), "the first post is not marked as being bookmarked");
      assert.strictEqual((0, _qunitHelpers.query)("#topic-footer-button-bookmark").innerText, _I18n.default.t("bookmarked.edit_bookmark"), "A topic level bookmark button has a label 'Edit Bookmark'");
      await (0, _testHelpers.click)("#topic-footer-button-bookmark");
      await (0, _testHelpers.fillIn)("input#bookmark-name", "Test name");
      await (0, _testHelpers.click)("#tap_tile_tomorrow");
      await (0, _testHelpers.click)("#topic-footer-button-bookmark");
      assert.strictEqual((0, _qunitHelpers.query)("input#bookmark-name").value, "Test name", "The topic level bookmark editing preserves the values entered");
      await (0, _testHelpers.click)(".d-modal-cancel");
      await openBookmarkModal(1);
      await (0, _testHelpers.click)("#save-bookmark");
      assert.ok((0, _qunitHelpers.exists)(".topic-post:first-child button.bookmark.bookmarked"), "the first post is bookmarked independently of the topic level bookmark"); // deleting all bookmarks in the topic

      assert.strictEqual((0, _qunitHelpers.query)("#topic-footer-button-bookmark").innerText, _I18n.default.t("bookmarked.clear_bookmarks"), "the footer button says Clear Bookmarks because there is more than one");
      await (0, _testHelpers.click)("#topic-footer-button-bookmark");
      await (0, _testHelpers.click)("a.btn-primary");
      assert.ok(!(0, _qunitHelpers.exists)(".topic-post:first-child button.bookmark.bookmarked"), "the first post bookmark is deleted");
      assert.strictEqual((0, _qunitHelpers.query)("#topic-footer-button-bookmark").innerText, _I18n.default.t("bookmarked.title"), "the topic level bookmark is deleted");
    });
    (0, _qunit.test)("Deleting a topic_level bookmark with a reminder", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-button-bookmark");
      await (0, _testHelpers.click)("#save-bookmark");
      assert.strictEqual((0, _qunitHelpers.query)("#topic-footer-button-bookmark").innerText, _I18n.default.t("bookmarked.edit_bookmark"), "A topic level bookmark button has a label 'Edit Bookmark'");
      await (0, _testHelpers.click)("#topic-footer-button-bookmark");
      await (0, _testHelpers.fillIn)("input#bookmark-name", "Test name");
      await (0, _testHelpers.click)("#tap_tile_tomorrow");
      await (0, _testHelpers.click)("#topic-footer-button-bookmark");
      await (0, _testHelpers.click)("#delete-bookmark");
      assert.ok((0, _qunitHelpers.exists)(".bootbox.modal"), "it asks for delete confirmation");
      assert.ok((0, _qunitHelpers.query)(".bootbox.modal").innerText.includes(_I18n.default.t("bookmarks.confirm_delete")), "it shows delete confirmation message");
      await (0, _testHelpers.click)(".bootbox.modal .btn-primary");
      assert.strictEqual((0, _qunitHelpers.query)("#topic-footer-button-bookmark").innerText, _I18n.default.t("bookmarked.title"), "A topic level bookmark button no longer says 'Edit Bookmark' after deletion");
    });
    (0, _qunit.test)("The topic level bookmark button opens the edit modal if only one post in the post stream is bookmarked", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await openBookmarkModal(2);
      await (0, _testHelpers.click)("#save-bookmark");
      assert.strictEqual((0, _qunitHelpers.query)("#topic-footer-button-bookmark").innerText, _I18n.default.t("bookmarked.edit_bookmark"), "A topic level bookmark button has a label 'Edit Bookmark'");
      await (0, _testHelpers.click)("#topic-footer-button-bookmark");
      assert.ok((0, _qunitHelpers.exists)("div.modal.bookmark-with-reminder"), "The edit modal is opened");
    });
    (0, _qunit.test)("The topic level bookmark button shows an icon with a clock if there is a bookmark with a reminder on the first post", async function (assert) {
      const postNumber = 1;
      await testTopicLevelBookmarkButtonIcon(assert, postNumber);
    });
    (0, _qunit.test)("The topic level bookmark button shows an icon with a clock if there is a bookmark with a reminder on the second post", async function (assert) {
      const postNumber = 2;
      await testTopicLevelBookmarkButtonIcon(assert, postNumber);
    });
  });
});
define("discourse/tests/acceptance/bootstrap-mode-notice-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers", "@ember/object"], function (_qunitHelpers, _qunit, _testHelpers, _object) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers",0,"@ember/object"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Bootstrap Mode Notice", function (needs) {
    needs.user();
    needs.site({
      wizard_required: true
    });
    needs.settings({
      bootstrap_mode_enabled: true,
      bootstrap_mode_min_users: 50
    });
    (0, _qunit.test)("Navigation", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)(".bootstrap-mode-notice"), "has the bootstrap mode notice");
      assert.ok((0, _qunitHelpers.exists)(".bootstrap-invite-button"), "bootstrap notice has invite button");
      assert.ok((0, _qunitHelpers.exists)(".bootstrap-wizard-link"), "bootstrap notice has wizard link");
      await (0, _testHelpers.click)(".bootstrap-invite-button");
      assert.ok((0, _qunitHelpers.exists)(".create-invite-modal"), "opens create invite modal");
      await (0, _testHelpers.click)(".bootstrap-wizard-link");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/wizard/steps/hello-world", "it transitions to the wizard page");
      await (0, _testHelpers.visit)("/");
      (0, _object.set)(this.siteSettings, "bootstrap_mode_enabled", false);
      await (0, _testHelpers.settled)();
      assert.ok(!(0, _qunitHelpers.exists)(".bootstrap-mode-notice"), "removes the notice when bootstrap mode is disabled");
    });
  });
});
define("discourse/tests/acceptance/categories-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "discourse/lib/preload-store", "discourse/tests/fixtures/discovery-fixtures", "discourse-common/lib/object"], function (_qunitHelpers, _testHelpers, _qunit, _preloadStore, _discoveryFixtures, _object) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"discourse/lib/preload-store",0,"discourse/tests/fixtures/discovery-fixtures",0,"discourse-common/lib/object"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Categories - 'categories_only'", function (needs) {
    needs.settings({
      desktop_category_page_style: "categories_only"
    });
    (0, _qunit.test)("basic functionality", async function (assert) {
      await (0, _testHelpers.visit)("/categories");
      assert.ok((0, _qunitHelpers.exists)("table.category-list tr[data-category-id=1]"), "shows the topic list");
    });
  });
  (0, _qunitHelpers.acceptance)("Categories - 'categories_and_latest_topics'", function (needs) {
    needs.settings({
      desktop_category_page_style: "categories_and_latest_topics"
    });
    (0, _qunit.test)("basic functionality", async function (assert) {
      await (0, _testHelpers.visit)("/categories");
      assert.ok((0, _qunitHelpers.exists)("table.category-list tr[data-category-id=1]"), "shows a category");
      assert.ok((0, _qunitHelpers.exists)("div.latest-topic-list div[data-topic-id=8]"), "shows the topic list");
      assert.notOk((0, _qunitHelpers.query)(".more-topics a").href.endsWith("?order=created"), "the load more button doesn't include the order=created param");
    });
  });
  (0, _qunitHelpers.acceptance)("Categories - 'categories_and_latest_topics' - order by created date", function (needs) {
    needs.settings({
      desktop_category_page_style: "categories_and_latest_topics_created_date"
    });
    (0, _qunit.test)("order topics by", async function (assert) {
      await (0, _testHelpers.visit)("/categories");
      assert.ok((0, _qunitHelpers.query)(".more-topics a").href.endsWith("?order=created"), "the load more button includes the order=created param");
    });
  });
  (0, _qunitHelpers.acceptance)("Categories - 'categories_with_featured_topics'", function (needs) {
    needs.settings({
      desktop_category_page_style: "categories_with_featured_topics"
    });
    (0, _qunit.test)("basic functionality", async function (assert) {
      await (0, _testHelpers.visit)("/categories");
      assert.ok((0, _qunitHelpers.exists)("table.category-list.with-topics tr[data-category-id=1]"), "shows a category");
      assert.ok((0, _qunitHelpers.exists)("table.category-list.with-topics div[data-topic-id=11994]"), "shows a featured topic");
    });
  });
  (0, _qunitHelpers.acceptance)("Categories - 'subcategories_with_featured_topics'", function (needs) {
    needs.settings({
      desktop_category_page_style: "subcategories_with_featured_topics"
    });
    (0, _qunit.test)("basic functionality", async function (assert) {
      await (0, _testHelpers.visit)("/categories");
      assert.ok((0, _qunitHelpers.exists)("table.subcategory-list.with-topics thead h3 .category-name"), "shows heading for top-level category");
      assert.ok((0, _qunitHelpers.exists)("table.subcategory-list.with-topics tr[data-category-id=26] h3 .category-name"), "shows table row for subcategories");
      assert.ok((0, _qunitHelpers.exists)("table.category-list.with-topics div[data-topic-id=11994]"), "shows a featured topic");
    });
  });
  (0, _qunitHelpers.acceptance)("Categories - preloadStore handling", function () {
    const styles = ["categories_only", "categories_with_featured_topics", "categories_and_latest_topics_created_date", "categories_and_latest_topics", "categories_and_top_topics", "categories_boxes", "categories_boxes_with_topics", "subcategories_with_featured_topics"];

    for (const style of styles) {
      (0, _qunit.test)(`${style} deletes data from PreloadStore to ensure it isn't left for another route`, async function (assert) {
        this.siteSettings.desktop_category_page_style = style;

        _preloadStore.default.store("topic_list", (0, _object.cloneJSON)(_discoveryFixtures.default["/latest.json"]));

        _preloadStore.default.store("categories_list", (0, _object.cloneJSON)(_discoveryFixtures.default["/categories.json"]));

        await (0, _testHelpers.visit)(`/categories`);
        assert.true(_preloadStore.default.get("topic_list") === undefined, `topic_list is removed from preloadStore for ${style}`);
        assert.true(_preloadStore.default.get("categories_list") === undefined, `topic_list is removed from preloadStore for ${style}`);
      });
    }
  });
});
define("discourse/tests/acceptance/category-banner-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/tests/fixtures/discovery-fixtures", "qunit"], function (_qunitHelpers, _testHelpers, _discoveryFixtures, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/tests/fixtures/discovery-fixtures",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Category Banners", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/c/test-read-only-without-banner/5/l/latest.json", () => {
        return helper.response(_discoveryFixtures.default["/latest_can_create_topic.json"]);
      });
      server.get("/c/test-read-only-with-banner/6/l/latest.json", () => {
        return helper.response(_discoveryFixtures.default["/latest_can_create_topic.json"]);
      });
    });
    needs.site({
      categories: [{
        id: 5,
        name: "test read only without banner",
        slug: "test-read-only-without-banner",
        permission: 1
      }, {
        id: 6,
        name: "test read only with banner",
        slug: "test-read-only-with-banner",
        permission: null,
        read_only_banner: "You need to video yourself <div class='inner'>doing</div> the secret handshake to post here"
      }]
    });
    (0, _qunit.test)("Does not display category banners when not set", async function (assert) {
      await (0, _testHelpers.visit)("/c/test-read-only-without-banner");
      await (0, _testHelpers.click)("#create-topic");
      assert.ok(!(0, _qunitHelpers.visible)(".bootbox.modal"), "it does not pop up a modal");
      assert.ok(!(0, _qunitHelpers.visible)(".category-read-only-banner"), "it does not show a banner");
    });
    (0, _qunit.test)("Displays category banners when set", async function (assert) {
      await (0, _testHelpers.visit)("/c/test-read-only-with-banner");
      await (0, _testHelpers.click)("#create-topic");
      assert.ok((0, _qunitHelpers.visible)(".bootbox.modal"), "it pops up a modal");
      await (0, _testHelpers.click)(".modal-footer>.btn-primary");
      assert.ok(!(0, _qunitHelpers.visible)(".bootbox.modal"), "it closes the modal");
      assert.ok((0, _qunitHelpers.visible)(".category-read-only-banner"), "it shows a banner");
      assert.strictEqual((0, _qunitHelpers.count)(".category-read-only-banner .inner"), 1, "it allows staff to embed html in the message");
    });
  });
  (0, _qunitHelpers.acceptance)("Anonymous Category Banners", function (needs) {
    needs.pretender((server, helper) => {
      server.get("/c/test-read-only-with-banner/6/l/latest.json", () => {
        return helper.response(_discoveryFixtures.default["/latest_can_create_topic.json"]);
      });
    });
    needs.site({
      categories: [{
        id: 6,
        name: "test read only with banner",
        slug: "test-read-only-with-banner",
        permission: null,
        read_only_banner: "You need to video yourself doing the secret handshake to post here"
      }]
    });
    (0, _qunit.test)("Does not display category banners when set", async function (assert) {
      await (0, _testHelpers.visit)("/c/test-read-only-with-banner");
      assert.ok(!(0, _qunitHelpers.visible)(".category-read-only-banner"), "it does not show a banner");
    });
  });
});
define("discourse/tests/acceptance/category-chooser-test", ["@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/select-kit-helper", "qunit"], function (_testHelpers, _qunitHelpers, _selectKitHelper, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("CategoryChooser", function (needs) {
    needs.user();
    needs.settings({
      allow_uncategorized_topics: false
    });
    (0, _qunit.test)("does not display uncategorized if not allowed", async function (assert) {
      const categoryChooser = (0, _selectKitHelper.default)(".category-chooser");
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await categoryChooser.expand();
      assert.ok(categoryChooser.rowByIndex(0).name() !== "uncategorized");
    });
    (0, _qunit.test)("prefill category when category_id is set", async function (assert) {
      await (0, _testHelpers.visit)("/new-topic?category_id=1");
      assert.strictEqual((0, _selectKitHelper.default)(".category-chooser").header().value(), "1");
    });
  });
});
define("discourse/tests/acceptance/category-edit-security-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "I18n", "discourse/tests/helpers/select-kit-helper", "qunit"], function (_qunitHelpers, _testHelpers, _I18n, _selectKitHelper, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"I18n",0,"discourse/tests/helpers/select-kit-helper",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Category Edit - Security", function (needs) {
    needs.user();
    (0, _qunit.test)("default", async function (assert) {
      await (0, _testHelpers.visit)("/c/bug/edit/security");
      const firstRow = (0, _qunitHelpers.query)(".row-body");
      const badgeName = firstRow.querySelector(".group-name-label").innerText;
      assert.strictEqual(badgeName, "everyone");
      assert.strictEqual((0, _qunitHelpers.count)(".d-icon-check-square"), 3);
    });
    (0, _qunit.test)("removing a permission", async function (assert) {
      const availableGroups = (0, _selectKitHelper.default)(".available-groups");
      await (0, _testHelpers.visit)("/c/bug/edit/security");
      await availableGroups.expand();
      assert.notOk(availableGroups.rowByValue("everyone").exists(), "everyone is already used and is not in the available groups");
      await (0, _testHelpers.click)(".row-body .remove-permission");
      await availableGroups.expand();
      assert.ok(availableGroups.rowByValue("everyone").exists(), "everyone has been removed and appears in the available groups");
      assert.strictEqual((0, _qunitHelpers.query)(".row-empty").innerText, _I18n.default.t("category.permissions.no_groups_selected"), "shows message when no groups are selected");
    });
    (0, _qunit.test)("adding a permission", async function (assert) {
      const availableGroups = (0, _selectKitHelper.default)(".available-groups");
      await (0, _testHelpers.visit)("/c/bug/edit/security");
      await availableGroups.expand();
      await availableGroups.selectRowByValue("staff");
      const addedRow = [...(0, _qunitHelpers.queryAll)(".row-body")].at(-1);
      assert.strictEqual(addedRow.querySelector(".group-name-label").innerText, "staff");
      assert.strictEqual(addedRow.querySelectorAll(".d-icon-check-square").length, 3, "new row permissions match default 'everyone' permissions");
    });
    (0, _qunit.test)("adding a previously removed permission", async function (assert) {
      const availableGroups = (0, _selectKitHelper.default)(".available-groups");
      await (0, _testHelpers.visit)("/c/bug/edit/security");
      await (0, _testHelpers.click)(".row-body .remove-permission");
      assert.ok(!(0, _qunitHelpers.exists)(".row-body"), "removes the permission from the list");
      await availableGroups.expand();
      await availableGroups.selectRowByValue("everyone");
      assert.strictEqual((0, _qunitHelpers.count)(".row-body"), 1, "adds back the permission tp the list");
      const firstRow = (0, _qunitHelpers.query)(".row-body");
      assert.strictEqual(firstRow.querySelector(".group-name-label").innerText, "everyone");
      assert.strictEqual(firstRow.querySelectorAll(".d-icon-check-square").length, 1, "adds only 'See' permission for a new row");
    });
    (0, _qunit.test)("editing permissions", async function (assert) {
      const availableGroups = (0, _selectKitHelper.default)(".available-groups");
      await (0, _testHelpers.visit)("/c/bug/edit/security");
      const everyoneRow = (0, _qunitHelpers.query)(".row-body");
      assert.strictEqual(everyoneRow.querySelectorAll(".reply-granted, .create-granted").length, 2, "everyone has full permissions by default");
      await availableGroups.expand();
      await availableGroups.selectRowByValue("staff");
      const staffRow = [...(0, _qunitHelpers.queryAll)(".row-body")].at(-1);
      assert.strictEqual(staffRow.querySelectorAll(".reply-granted, .create-granted").length, 2, "staff group also has full permissions");
      await (0, _testHelpers.click)(everyoneRow.querySelector(".reply-toggle"));
      assert.strictEqual(everyoneRow.querySelectorAll(".reply-granted, .create-granted").length, 0, "everyone does not have reply or create");
      assert.strictEqual(staffRow.querySelectorAll(".reply-granted, .create-granted").length, 2, "staff group still has full permissions");
      await (0, _testHelpers.click)(staffRow.querySelector(".reply-toggle"));
      assert.strictEqual(everyoneRow.querySelectorAll(".reply-granted, .create-granted").length, 0, "everyone permission unchanged");
      assert.strictEqual(staffRow.querySelectorAll(".reply-granted").length, 0, "staff does not have reply permission");
      assert.strictEqual(staffRow.querySelectorAll(".create-granted").length, 0, "staff does not have create permission");
      await (0, _testHelpers.click)(everyoneRow.querySelector(".create-toggle"));
      assert.strictEqual(everyoneRow.querySelectorAll(".reply-granted, .create-granted").length, 2, "everyone has full permissions");
      assert.strictEqual(staffRow.querySelectorAll(".reply-granted, .create-granted").length, 2, "staff group has full permissions (inherited from everyone)");
    });
  });
});
define("discourse/tests/acceptance/category-edit-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/lib/url", "discourse/tests/helpers/select-kit-helper", "sinon", "qunit", "discourse/tests/helpers/create-pretender"], function (_qunitHelpers, _testHelpers, _url, _selectKitHelper, _sinon, _qunit, _createPretender) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/lib/url",0,"discourse/tests/helpers/select-kit-helper",0,"sinon",0,"qunit",0,"discourse/tests/helpers/create-pretender"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Category Edit", function (needs) {
    needs.user();
    needs.settings({
      email_in: true,
      tagging_enabled: true
    });
    (0, _qunit.test)("Editing the category", async function (assert) {
      await (0, _testHelpers.visit)("/c/bug");
      await (0, _testHelpers.click)("button.edit-category");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/c/bug/edit/general", "it jumps to the correct screen");
      assert.strictEqual((0, _qunitHelpers.query)(".category-breadcrumb .badge-category").innerText, "bug");
      assert.strictEqual((0, _qunitHelpers.query)(".category-color-editor .badge-category").innerText, "bug");
      await (0, _testHelpers.fillIn)("input.category-name", "testing");
      assert.strictEqual((0, _qunitHelpers.query)(".category-color-editor .badge-category").innerText, "testing");
      await (0, _testHelpers.fillIn)(".edit-text-color input", "ff0000");
      await (0, _testHelpers.click)(".edit-category-topic-template");
      await (0, _testHelpers.fillIn)(".d-editor-input", "this is the new topic template");
      await (0, _testHelpers.click)("#save-category");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/c/bug/edit/general", "it stays on the edit screen");
      await (0, _testHelpers.visit)("/c/bug/edit/settings");
      const searchPriorityChooser = (0, _selectKitHelper.default)("#category-search-priority");
      await searchPriorityChooser.expand();
      await searchPriorityChooser.selectRowByValue(1);
      await (0, _testHelpers.click)("#save-category");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/c/bug/edit/settings", "it stays on the edit screen");

      _sinon.default.stub(_url.default, "routeTo");

      await (0, _testHelpers.click)(".edit-category-security a");
      assert.ok(_url.default.routeTo.calledWith("/c/bug/edit/security"), "tab routing works");
    });
    (0, _qunit.test)("Editing required tag groups", async function (assert) {
      await (0, _testHelpers.visit)("/c/bug/edit/tags");
      assert.ok((0, _qunitHelpers.exists)(".required-tag-groups"));
      assert.strictEqual((0, _qunitHelpers.count)(".required-tag-group-row"), 0);
      await (0, _testHelpers.click)(".add-required-tag-group");
      assert.strictEqual((0, _qunitHelpers.count)(".required-tag-group-row"), 1);
      await (0, _testHelpers.click)(".add-required-tag-group");
      assert.strictEqual((0, _qunitHelpers.count)(".required-tag-group-row"), 2);
      await (0, _testHelpers.click)(".delete-required-tag-group");
      assert.strictEqual((0, _qunitHelpers.count)(".required-tag-group-row"), 1);
      const tagGroupChooser = (0, _selectKitHelper.default)(".required-tag-group-row .tag-group-chooser");
      await tagGroupChooser.expand();
      await tagGroupChooser.selectRowByValue("TagGroup1");
      await (0, _testHelpers.click)("#save-category");
      assert.strictEqual((0, _qunitHelpers.count)(".required-tag-group-row"), 1);
      await (0, _testHelpers.click)(".delete-required-tag-group");
      assert.strictEqual((0, _qunitHelpers.count)(".required-tag-group-row"), 0);
      await (0, _testHelpers.click)("#save-category");
      assert.strictEqual((0, _qunitHelpers.count)(".required-tag-group-row"), 0);
    });
    (0, _qunit.test)("Editing allowed tags and tag groups", async function (assert) {
      await (0, _testHelpers.visit)("/c/bug/edit/tags");
      const allowedTagChooser = (0, _selectKitHelper.default)("#category-allowed-tags");
      await allowedTagChooser.expand();
      await allowedTagChooser.selectRowByValue("monkey");
      const allowedTagGroupChooser = (0, _selectKitHelper.default)("#category-allowed-tag-groups");
      await allowedTagGroupChooser.expand();
      await allowedTagGroupChooser.selectRowByValue("TagGroup1");
      await (0, _testHelpers.click)("#save-category");
      const payload = JSON.parse(_createPretender.default.handledRequests[_createPretender.default.handledRequests.length - 1].requestBody);
      assert.deepEqual(payload.allowed_tags, ["monkey"]);
      assert.deepEqual(payload.allowed_tag_groups, ["TagGroup1"]);
      await allowedTagChooser.expand();
      await allowedTagChooser.deselectItemByValue("monkey");
      await allowedTagGroupChooser.expand();
      await allowedTagGroupChooser.deselectItemByValue("TagGroup1");
      await (0, _testHelpers.click)("#save-category");
      const removePayload = JSON.parse(_createPretender.default.handledRequests[_createPretender.default.handledRequests.length - 1].requestBody);
      assert.deepEqual(removePayload.allowed_tags, []);
      assert.deepEqual(removePayload.allowed_tag_groups, []);
    });
    (0, _qunit.test)("Index Route", async function (assert) {
      await (0, _testHelpers.visit)("/c/bug/edit");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/c/bug/edit/general", "it redirects to the general tab");
    });
    (0, _qunit.test)("Slugless Route", async function (assert) {
      await (0, _testHelpers.visit)("/c/1-category/edit");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/c/1-category/edit/general", "it goes to the general tab");
      assert.strictEqual((0, _qunitHelpers.query)("input.category-name").value, "bug");
    });
    (0, _qunit.test)("Error Saving", async function (assert) {
      await (0, _testHelpers.visit)("/c/bug/edit/settings");
      await (0, _testHelpers.fillIn)(".email-in", "duplicate@example.com");
      await (0, _testHelpers.click)("#save-category");
      assert.ok((0, _qunitHelpers.visible)(".bootbox"));
      assert.strictEqual((0, _qunitHelpers.query)(".bootbox .modal-body").innerHTML, "duplicate email");
      await (0, _testHelpers.click)(".bootbox .btn-primary");
      assert.ok(!(0, _qunitHelpers.visible)(".bootbox"));
    });
    (0, _qunit.test)("Subcategory list settings", async function (assert) {
      await (0, _testHelpers.visit)("/c/bug/edit/settings");
      assert.ok(!(0, _qunitHelpers.visible)(".subcategory-list-style-field"), "subcategory list style isn't visible by default");
      await (0, _testHelpers.click)(".show-subcategory-list-field input[type=checkbox]");
      assert.ok((0, _qunitHelpers.visible)(".subcategory-list-style-field"), "subcategory list style is shown if show subcategory list is checked");
      await (0, _testHelpers.visit)("/c/bug/edit/general");
      const categoryChooser = (0, _selectKitHelper.default)(".edit-category-tab-general .category-chooser");
      await categoryChooser.expand();
      await categoryChooser.selectRowByValue(3);
      await (0, _testHelpers.visit)("/c/bug/edit/settings");
      assert.ok(!(0, _qunitHelpers.visible)(".show-subcategory-list-field"), "show subcategory list isn't visible for child categories");
      assert.ok(!(0, _qunitHelpers.visible)(".subcategory-list-style-field"), "subcategory list style isn't visible for child categories");
    });
  });
  (0, _qunitHelpers.acceptance)("Category Edit - no permission to edit", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/c/bug/find_by_slug.json", () => {
        return helper.response(200, {
          category: {
            id: 1,
            name: "bug",
            color: "e9dd00",
            text_color: "000000",
            slug: "bug",
            can_edit: false
          }
        });
      });
    });
    (0, _qunit.test)("returns 404", async function (assert) {
      await (0, _testHelpers.visit)("/c/bug/edit");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/404");
    });
  });
});
define("discourse/tests/acceptance/category-new-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/lib/url", "I18n", "sinon", "qunit"], function (_qunitHelpers, _testHelpers, _url, _I18n, _sinon, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/lib/url",0,"I18n",0,"sinon",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Category New", function (needs) {
    needs.user();
    (0, _qunit.test)("Creating a new category", async function (assert) {
      await (0, _testHelpers.visit)("/new-category");
      assert.ok((0, _qunitHelpers.exists)(".badge-category"));
      assert.notOk((0, _qunitHelpers.exists)(".category-breadcrumb"));
      await (0, _testHelpers.fillIn)("input.category-name", "testing");
      assert.strictEqual((0, _qunitHelpers.query)(".badge-category").innerText, "testing");
      await (0, _testHelpers.click)("#save-category");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/c/testing/edit/general", "it transitions to the category edit route");
      assert.strictEqual((0, _qunitHelpers.query)(".edit-category-title h2").innerText, _I18n.default.t("category.edit_dialog_title", {
        categoryName: "testing"
      }));
      await (0, _testHelpers.click)(".edit-category-security a");
      assert.ok((0, _qunitHelpers.exists)(".permission-row button.reply-toggle"), "it can switch to the security tab");
      await (0, _testHelpers.click)(".edit-category-settings a");
      assert.ok((0, _qunitHelpers.exists)("#category-search-priority"), "it can switch to the settings tab");

      _sinon.default.stub(_url.default, "routeTo");

      await (0, _testHelpers.click)(".category-back");
      assert.ok(_url.default.routeTo.calledWith("/c/testing/11"), "back routing works");
    });
  });
});
define("discourse/tests/acceptance/click-track-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Click Track", function (needs) {
    let tracked = false;
    needs.pretender((server, helper) => {
      server.post("/clicks/track", () => {
        tracked = true;
        return helper.response({
          success: "OK"
        });
      });
    });
    (0, _qunit.test)("Do not track mentions", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      assert.ok(!(0, _qunitHelpers.exists)(".user-card.show"), "card should not appear");
      await (0, _testHelpers.click)('article[data-post-id="3651"] a.mention');
      assert.strictEqual((0, _qunitHelpers.count)(".user-card.show"), 1, "card appear");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/t/internationalization-localization/280");
      assert.ok(!tracked);
    });
  });
});
define("discourse/tests/acceptance/composer-actions-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/models/draft", "I18n", "discourse/tests/helpers/select-kit-helper", "sinon", "qunit", "discourse/controllers/composer", "discourse/tests/fixtures/user-fixtures", "discourse-common/lib/object"], function (_qunitHelpers, _testHelpers, _draft, _I18n, _selectKitHelper, _sinon, _qunit, _composer, _userFixtures, _object) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/models/draft",0,"I18n",0,"discourse/tests/helpers/select-kit-helper",0,"sinon",0,"qunit",0,"discourse/controllers/composer",0,"discourse/tests/fixtures/user-fixtures",0,"discourse-common/lib/object"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Composer Actions", function (needs) {
    needs.user({
      id: 5,
      username: "kris",
      whisperer: true
    });
    needs.settings({
      prioritize_username_in_ux: true,
      display_name_on_post: false,
      enable_whispers: true
    });
    needs.site({
      can_tag_topics: true
    });
    needs.pretender((server, helper) => {
      const cardResponse = (0, _object.cloneJSON)(_userFixtures.default["/u/shade/card.json"]);
      server.get("/u/shade/card.json", () => helper.response(cardResponse));
    });
    (0, _qunit.test)("replying to post", async function (assert) {
      const composerActions = (0, _selectKitHelper.default)(".composer-actions");
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("article#post_3 button.reply");
      await composerActions.expand();
      assert.strictEqual(composerActions.rowByIndex(0).value(), "reply_as_new_topic");
      assert.strictEqual(composerActions.rowByIndex(1).value(), "reply_to_topic");
      assert.strictEqual(composerActions.rowByIndex(2).value(), "toggle_whisper");
      assert.strictEqual(composerActions.rowByIndex(3).value(), "toggle_topic_bump");
      assert.strictEqual(composerActions.rowByIndex(4).value(), null);
    });
    (0, _qunit.test)("replying to post - reply_to_topic", async function (assert) {
      const composerActions = (0, _selectKitHelper.default)(".composer-actions");
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("article#post_3 button.reply");
      await (0, _testHelpers.fillIn)(".d-editor-input", "test replying to topic when initially replied to post");
      await composerActions.expand();
      await composerActions.selectRowByValue("reply_to_topic");
      assert.strictEqual((0, _qunitHelpers.query)(".action-title .topic-link").innerText.trim(), "Internationalization / localization");
      assert.strictEqual((0, _qunitHelpers.query)(".action-title .topic-link").getAttribute("href"), "/t/internationalization-localization/280");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "test replying to topic when initially replied to post");
    });
    (0, _qunit.test)("replying to post - toggle_whisper for whisperers", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        admin: false,
        moderator: false
      });
      const composerActions = (0, _selectKitHelper.default)(".composer-actions");
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("article#post_3 button.reply");
      await (0, _testHelpers.fillIn)(".d-editor-input", "test replying as whisper to topic when initially not a whisper");
      assert.ok(!(0, _qunitHelpers.exists)(".composer-actions svg.d-icon-far-eye-slash"), "whisper icon is not visible");
      assert.strictEqual((0, _qunitHelpers.count)(".composer-actions svg.d-icon-share"), 1, "reply icon is visible");
      await composerActions.expand();
      await composerActions.selectRowByValue("toggle_whisper");
      assert.strictEqual((0, _qunitHelpers.count)(".composer-actions svg.d-icon-far-eye-slash"), 1, "whisper icon is visible");
      assert.ok(!(0, _qunitHelpers.exists)(".composer-actions svg.d-icon-share"), "reply icon is not visible");
    });
    (0, _qunit.test)("replying to post - reply_as_new_topic", async function (assert) {
      _sinon.default.stub(_draft.default, "get").resolves({
        draft: "",
        draft_sequence: 0
      });

      const composerActions = (0, _selectKitHelper.default)(".composer-actions");
      const categoryChooser = (0, _selectKitHelper.default)(".title-wrapper .category-chooser");
      const categoryChooserReplyArea = (0, _selectKitHelper.default)(".reply-area .category-chooser");
      const quote = "test replying as new topic when initially replied to post";
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-title .d-icon-pencil-alt");
      await categoryChooser.expand();
      await categoryChooser.selectRowByValue(4);
      await (0, _testHelpers.click)("#topic-title .submit-edit");
      await (0, _testHelpers.click)("article#post_3 button.reply");
      await (0, _testHelpers.fillIn)(".d-editor-input", quote);
      await composerActions.expand();
      await composerActions.selectRowByValue("reply_as_new_topic");
      assert.strictEqual(categoryChooserReplyArea.header().name(), "faq");
      assert.strictEqual((0, _qunitHelpers.query)(".action-title").innerText.trim(), _I18n.default.t("topic.create_long"));
      assert.ok((0, _qunitHelpers.query)(".d-editor-input").value.includes(quote));
    });
    (0, _qunit.test)("reply_as_new_topic without a new_topic draft", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)(".create.reply");
      const composerActions = (0, _selectKitHelper.default)(".composer-actions");
      await composerActions.expand();
      await composerActions.selectRowByValue("reply_as_new_topic");
      assert.ok(!(0, _qunitHelpers.exists)(".bootbox"));
    });
    (0, _qunit.test)("reply_as_new_group_message", async function (assert) {
      await (0, _testHelpers.visit)("/t/lorem-ipsum-dolor-sit-amet/130");
      await (0, _testHelpers.click)(".create.reply");
      const composerActions = (0, _selectKitHelper.default)(".composer-actions");
      await composerActions.expand();
      await composerActions.selectRowByValue("reply_as_new_group_message");
      const privateMessageUsers = (0, _selectKitHelper.default)("#private-message-users");
      assert.deepEqual(privateMessageUsers.header().value(), "foo,foo_group");
    });
    (0, _qunit.test)("interactions", async function (assert) {
      const composerActions = (0, _selectKitHelper.default)(".composer-actions");
      const quote = "Life is like riding a bicycle.";
      await (0, _testHelpers.visit)("/t/short-topic-with-two-posts/54077");
      await (0, _testHelpers.click)("article#post_2 button.reply");
      await (0, _testHelpers.fillIn)(".d-editor-input", quote);
      await composerActions.expand();
      await composerActions.selectRowByValue("reply_to_topic");
      assert.strictEqual((0, _qunitHelpers.query)(".action-title").innerText.trim(), "Short topic with two posts");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, quote);
      await composerActions.expand();
      assert.strictEqual(composerActions.rowByIndex(0).value(), "reply_as_new_topic");
      assert.strictEqual(composerActions.rowByIndex(1).value(), "reply_to_post");
      assert.strictEqual(composerActions.rowByIndex(2).value(), "toggle_whisper");
      assert.strictEqual(composerActions.rowByIndex(3).value(), "toggle_topic_bump");
      assert.strictEqual(composerActions.rows().length, 4);
      await composerActions.selectRowByValue("reply_to_post");
      await composerActions.expand();
      assert.ok((0, _qunitHelpers.exists)(".action-title img.avatar"));
      assert.strictEqual((0, _qunitHelpers.query)(".action-title .user-link").innerText.trim(), "tms");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, quote);
      assert.strictEqual(composerActions.rowByIndex(0).value(), "reply_as_new_topic");
      assert.strictEqual(composerActions.rowByIndex(1).value(), "reply_to_topic");
      assert.strictEqual(composerActions.rowByIndex(2).value(), "toggle_whisper");
      assert.strictEqual(composerActions.rowByIndex(3).value(), "toggle_topic_bump");
      assert.strictEqual(composerActions.rows().length, 4);
      await composerActions.selectRowByValue("reply_as_new_topic");
      await composerActions.expand();
      assert.strictEqual((0, _qunitHelpers.query)(".action-title").innerText.trim(), _I18n.default.t("topic.create_long"));
      assert.ok((0, _qunitHelpers.query)(".d-editor-input").value.includes(quote));
      assert.strictEqual(composerActions.rowByIndex(0).value(), "reply_to_post");
      assert.strictEqual(composerActions.rowByIndex(1).value(), "reply_to_topic");
      assert.strictEqual(composerActions.rowByIndex(2).value(), "shared_draft");
      assert.strictEqual(composerActions.rows().length, 3);
    });
    (0, _qunit.test)("interactions - private message", async function (assert) {
      const composerActions = (0, _selectKitHelper.default)(".composer-actions");
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)('#post_4 a[data-user-card="shade"]');
      await (0, _testHelpers.click)(".usercard-controls .compose-pm .btn-primary");
      await composerActions.expand();
      assert.strictEqual((0, _qunitHelpers.query)(".action-title").innerText.trim(), _I18n.default.t("topic.private_message"));
      assert.strictEqual(composerActions.rowByIndex(0).value(), "create_topic");
      assert.strictEqual(composerActions.rows().length, 1);
    });
    (0, _qunit.test)("replying to post - toggle_topic_bump", async function (assert) {
      const composerActions = (0, _selectKitHelper.default)(".composer-actions");
      await (0, _testHelpers.visit)("/t/short-topic-with-two-posts/54077");
      await (0, _testHelpers.click)("article#post_2 button.reply");
      assert.ok(!(0, _qunitHelpers.exists)(".composer-actions svg.d-icon-anchor"), "no-bump icon is not visible");
      assert.strictEqual((0, _qunitHelpers.count)(".composer-actions svg.d-icon-share"), 1, "reply icon is visible");
      await composerActions.expand();
      await composerActions.selectRowByValue("toggle_topic_bump");
      assert.strictEqual((0, _qunitHelpers.count)(".composer-actions svg.d-icon-anchor"), 1, "no-bump icon is visible");
      assert.ok(!(0, _qunitHelpers.exists)(".composer-actions svg.d-icon-share"), "reply icon is not visible");
      await composerActions.expand();
      await composerActions.selectRowByValue("toggle_topic_bump");
      assert.ok(!(0, _qunitHelpers.exists)(".composer-actions svg.d-icon-anchor"), "no-bump icon is not visible");
      assert.strictEqual((0, _qunitHelpers.count)(".composer-actions svg.d-icon-share"), 1, "reply icon is visible");
    });
    (0, _qunit.test)("replying to post - whisper and no bump", async function (assert) {
      const composerActions = (0, _selectKitHelper.default)(".composer-actions");
      await (0, _testHelpers.visit)("/t/short-topic-with-two-posts/54077");
      await (0, _testHelpers.click)("article#post_2 button.reply");
      assert.ok(!(0, _qunitHelpers.exists)(".composer-actions svg.d-icon-far-eye-slash"), "whisper icon is not visible");
      assert.ok(!(0, _qunitHelpers.exists)(".reply-details .whisper .d-icon-anchor"), "no-bump icon is not visible");
      assert.strictEqual((0, _qunitHelpers.count)(".composer-actions svg.d-icon-share"), 1, "reply icon is visible");
      await composerActions.expand();
      await composerActions.selectRowByValue("toggle_topic_bump");
      await composerActions.expand();
      await composerActions.selectRowByValue("toggle_whisper");
      assert.strictEqual((0, _qunitHelpers.count)(".composer-actions svg.d-icon-far-eye-slash"), 1, "whisper icon is visible");
      assert.strictEqual((0, _qunitHelpers.count)(".reply-details .no-bump .d-icon-anchor"), 1, "no-bump icon is visible");
      assert.ok(!(0, _qunitHelpers.exists)(".composer-actions svg.d-icon-share"), "reply icon is not visible");
    });
    (0, _qunit.test)("replying to post as staff", async function (assert) {
      const composerActions = (0, _selectKitHelper.default)(".composer-actions");
      (0, _qunitHelpers.updateCurrentUser)({
        admin: true
      });
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("article#post_3 button.reply");
      await composerActions.expand();
      assert.strictEqual(composerActions.rows().length, 4);
      assert.strictEqual(composerActions.rowByIndex(3).value(), "toggle_topic_bump");
    });
    (0, _qunit.test)("replying to post as TL3 user", async function (assert) {
      const composerActions = (0, _selectKitHelper.default)(".composer-actions");
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: false,
        trust_level: 3,
        whisperer: false,
        groups: [{
          id: 13,
          name: "tl3_group"
        }]
      });
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("article#post_3 button.reply");
      await composerActions.expand();
      assert.strictEqual(composerActions.rows().length, 2);
      Array.from(composerActions.rows()).forEach(row => {
        assert.notStrictEqual(row.value, "toggle_topic_bump", "toggle button is not visible");
      });
    });
    (0, _qunit.test)("replying to post as TL4 user", async function (assert) {
      const composerActions = (0, _selectKitHelper.default)(".composer-actions");
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: false,
        trust_level: 4,
        whisperer: false,
        groups: [{
          id: 13,
          name: "tl4_group"
        }]
      });
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("article#post_3 button.reply");
      await composerActions.expand();
      assert.strictEqual(composerActions.rows().length, 3);
      assert.strictEqual(composerActions.rowByIndex(2).value(), "toggle_topic_bump");
    });
    (0, _qunit.test)("editing post", async function (assert) {
      const composerActions = (0, _selectKitHelper.default)(".composer-actions");
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("article#post_1 button.show-more-actions");
      await (0, _testHelpers.click)("article#post_1 button.edit");
      await composerActions.expand();
      assert.strictEqual(composerActions.rows().length, 1);
      assert.strictEqual(composerActions.rowByIndex(0).value(), "reply_to_post");
    });
  });

  function stubDraftResponse() {
    _sinon.default.stub(_draft.default, "get").resolves({
      draft: '{"reply":"dum de dum da ba.","action":"createTopic","title":"dum da ba dum dum","categoryId":null,"archetypeId":"regular","metaData":null,"composerTime":540879,"typingTime":3400}',
      draft_sequence: 0
    });
  }

  (0, _qunitHelpers.acceptance)("Composer Actions With New Topic Draft", function (needs) {
    needs.user();
    needs.settings({
      enable_whispers: true
    });
    needs.site({
      can_tag_topics: true
    });
    needs.hooks.afterEach(() => (0, _composer.toggleCheckDraftPopup)(false));
    (0, _qunit.test)("shared draft", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        has_topic_draft: true
      });
      stubDraftResponse();
      (0, _composer.toggleCheckDraftPopup)(true);
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("button.open-draft");
      await (0, _testHelpers.fillIn)("#reply-title", "This is the new text for the title using 'quotes'");
      await (0, _testHelpers.fillIn)(".d-editor-input", "This is the new text for the post");
      const tags = (0, _selectKitHelper.default)(".mini-tag-chooser");
      await tags.expand();
      await tags.selectRowByValue("monkey");
      const composerActions = (0, _selectKitHelper.default)(".composer-actions");
      await composerActions.expand();
      await composerActions.selectRowByValue("shared_draft");
      assert.strictEqual(tags.header().value(), "monkey", "tags are not reset");
      assert.strictEqual((0, _qunitHelpers.query)("#reply-title").value, "This is the new text for the title using 'quotes'");
      assert.strictEqual((0, _qunitHelpers.query)("#reply-control .btn-primary.create .d-button-label").innerText, _I18n.default.t("composer.create_shared_draft"));
      assert.strictEqual((0, _qunitHelpers.count)(".composer-actions svg.d-icon-far-clipboard"), 1, "shared draft icon is visible");
    });
    (0, _qunit.test)("reply_as_new_topic with new_topic draft", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)(".create.reply");
      stubDraftResponse();
      const composerActions = (0, _selectKitHelper.default)(".composer-actions");
      await composerActions.expand();
      await composerActions.selectRowByValue("reply_as_new_topic");
      assert.strictEqual((0, _qunitHelpers.query)(".bootbox .modal-body").innerText, _I18n.default.t("composer.composer_actions.reply_as_new_topic.confirm"));
      await (0, _testHelpers.click)(".modal-footer .btn.btn-primary");
      assert.ok((0, _qunitHelpers.query)(".d-editor-input").value.startsWith("Continuing the discussion from"));
    });
  });
  (0, _qunitHelpers.acceptance)("Prioritize Username", function (needs) {
    needs.user();
    needs.settings({
      prioritize_username_in_ux: true,
      display_name_on_post: false
    });
    (0, _qunit.test)("Reply to post use username", async function (assert) {
      await (0, _testHelpers.visit)("/t/short-topic-with-two-posts/54079");
      await (0, _testHelpers.click)("article#post_2 button.reply");
      assert.strictEqual((0, _qunitHelpers.query)(".action-title .user-link").innerText.trim(), "james_john");
    });
    (0, _qunit.test)("Quotes use username", async function (assert) {
      await (0, _testHelpers.visit)("/t/short-topic-with-two-posts/54079");
      await (0, _qunitHelpers.selectText)("#post_2 p");
      await (0, _testHelpers.click)(".insert-quote");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value.trim(), '[quote="james_john, post:2, topic:54079, full:true"]\nThis is a short topic.\n[/quote]');
    });
  });
  (0, _qunitHelpers.acceptance)("Prioritize Full Name", function (needs) {
    needs.user();
    needs.settings({
      prioritize_username_in_ux: false,
      display_name_on_post: true
    });
    (0, _qunit.test)("Reply to post use full name", async function (assert) {
      await (0, _testHelpers.visit)("/t/short-topic-with-two-posts/54079");
      await (0, _testHelpers.click)("article#post_2 button.reply");
      assert.strictEqual((0, _qunitHelpers.query)(".action-title .user-link").innerText.trim(), "james, john, the third");
    });
    (0, _qunit.test)("Quotes use full name", async function (assert) {
      await (0, _testHelpers.visit)("/t/short-topic-with-two-posts/54079");
      await (0, _qunitHelpers.selectText)("#post_2 p");
      await (0, _testHelpers.click)(".insert-quote");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value.trim(), '[quote="james, john, the third, post:2, topic:54079, full:true, username:james_john"]\nThis is a short topic.\n[/quote]');
    });
    (0, _qunit.test)("Quoting a nested quote returns the correct username", async function (assert) {
      await (0, _testHelpers.visit)("/t/short-topic-with-two-posts/54079");
      await (0, _qunitHelpers.selectText)("#post_4 p");
      await (0, _testHelpers.click)(".insert-quote");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value.trim(), '[quote="james_john, post:2, topic:54079"]\nThis is a short topic.\n[/quote]');
    });
  });
  (0, _qunitHelpers.acceptance)("Prioritizing Name fall back", function (needs) {
    needs.user();
    needs.settings({
      prioritize_username_in_ux: false,
      display_name_on_post: true
    });
    (0, _qunit.test)("Quotes fall back to username if name is not present", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/130"); // select a user with no name

      await (0, _qunitHelpers.selectText)("#post_1 p");
      await (0, _testHelpers.click)(".insert-quote");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value.trim(), '[quote="bianca, post:1, topic:130, full:true"]\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas a varius ipsum. Nunc euismod, metus non vulputate malesuada, ligula metus pharetra tortor, vel sodales arcu lacus sed mauris. Nam semper, orci vitae fringilla placerat, dui tellus convallis felis, ultricies laoreet sapien mi et metus. Mauris facilisis, mi fermentum rhoncus feugiat, dolor est vehicula leo, id porta leo ex non enim. In a ligula vel tellus commodo scelerisque non in ex. Pellentesque semper leo quam, nec varius est viverra eget. Donec vehicula sem et massa faucibus tempus.\n[/quote]');
    });
  });
});
define("discourse/tests/acceptance/composer-draft-saving-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "I18n"], function (_qunitHelpers, _testHelpers, _qunit, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Composer - Draft saving", function (needs) {
    needs.user();
    const draftThatWillBeSaved = "This_will_be_saved_successfully";
    needs.pretender((server, helper) => {
      server.post("/drafts.json", request => {
        const success = request.requestBody.includes(draftThatWillBeSaved);
        return success ? helper.response({
          success: true
        }) : helper.response(500, {});
      });
    });
    (0, _qunit.test)("Shows a warning if a draft wasn't saved", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.show-more-actions");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.edit");
      await (0, _testHelpers.fillIn)(".d-editor-input", draftThatWillBeSaved);
      assert.notOk((0, _qunitHelpers.exists)("div#draft-status span"), "the draft was saved, there's no warning");
      await (0, _testHelpers.fillIn)(".d-editor-input", "This won't be saved because of error");
      assert.strictEqual((0, _qunitHelpers.query)("div#draft-status span").innerText.trim(), _I18n.default.t("composer.drafts_offline"), "the draft wasn't saved, a warning is rendered");
      assert.ok((0, _qunitHelpers.exists)("div#draft-status svg.d-icon-exclamation-triangle"), "an exclamation icon is rendered");
      await (0, _testHelpers.fillIn)(".d-editor-input", draftThatWillBeSaved);
      assert.notOk((0, _qunitHelpers.exists)("div#draft-status span"), "the draft was saved again, the warning has disappeared");
    });
  });
});
define("discourse/tests/acceptance/composer-edit-conflict-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Composer - Edit conflict", function (needs) {
    needs.user();
    let lastBody;
    needs.pretender((server, helper) => {
      server.post("/drafts.json", request => {
        lastBody = request.requestBody;
        return helper.response({
          success: true
        });
      });
    });
    (0, _qunit.test)("Should not send originalText when posting a new reply", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.reply");
      await (0, _testHelpers.fillIn)(".d-editor-input", "hello world hello world hello world hello world hello world");
      assert.ok(!lastBody.includes("originalText"));
    });
    (0, _qunit.test)("Should send originalText when editing a reply", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.show-more-actions");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.edit");
      await (0, _testHelpers.fillIn)(".d-editor-input", "hello world hello world hello world hello world hello world");
      assert.ok(lastBody.includes("originalText"));
    });
  });
});
define("discourse/tests/acceptance/composer-editor-mentions-test", ["qunit", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/lib/utilities"], function (_qunit, _testHelpers, _qunitHelpers, _utilities) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/lib/utilities"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Composer - editor mentions", function (needs) {
    let clock = null;
    const status = {
      emoji: "tooth",
      description: "off to dentist",
      ends_at: "2100-02-01T09:00:00.000Z"
    };
    needs.user();
    needs.settings({
      enable_mentions: true
    });
    needs.hooks.afterEach(() => {
      if (clock) {
        clock.restore();
      }
    });
    needs.pretender((server, helper) => {
      server.get("/u/search/users", () => {
        return helper.response({
          users: [{
            username: "user",
            name: "Some User",
            avatar_template: "https://avatars.discourse.org/v3/letter/t/41988e/{size}.png",
            status
          }, {
            username: "user2",
            name: "Some User",
            avatar_template: "https://avatars.discourse.org/v3/letter/t/41988e/{size}.png"
          }]
        });
      });
    });
    (0, _qunit.test)("selecting user mentions", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic"); // Emulate user pressing backspace in the editor

      const editor = (0, _qunitHelpers.query)(".d-editor-input");
      await (0, _testHelpers.triggerKeyEvent)(".d-editor-input", "keydown", "@");
      await (0, _testHelpers.fillIn)(".d-editor-input", "abc @");
      await (0, _utilities.setCaretPosition)(editor, 5);
      await (0, _testHelpers.triggerKeyEvent)(".d-editor-input", "keyup", "@");
      await (0, _testHelpers.triggerKeyEvent)(".d-editor-input", "keydown", "U");
      await (0, _testHelpers.fillIn)(".d-editor-input", "abc @u");
      await (0, _utilities.setCaretPosition)(editor, 6);
      await (0, _testHelpers.triggerKeyEvent)(".d-editor-input", "keyup", "U");
      await (0, _testHelpers.click)(".autocomplete.ac-user .selected");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "abc @user ", "should replace mention correctly");
    });
    (0, _qunit.test)("selecting user mentions after deleting characters", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)(".d-editor-input", "abc @user a"); // Emulate user typing `@` and `u` in the editor

      await (0, _testHelpers.triggerKeyEvent)(".d-editor-input", "keydown", "Backspace");
      await (0, _testHelpers.fillIn)(".d-editor-input", "abc @user ");
      await (0, _testHelpers.triggerKeyEvent)(".d-editor-input", "keyup", "Backspace");
      await (0, _testHelpers.triggerKeyEvent)(".d-editor-input", "keydown", "Backspace");
      await (0, _testHelpers.fillIn)(".d-editor-input", "abc @user");
      await (0, _testHelpers.triggerKeyEvent)(".d-editor-input", "keyup", "Backspace");
      await (0, _testHelpers.click)(".autocomplete.ac-user .selected");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "abc @user ", "should replace mention correctly");
    });
    (0, _qunit.test)("selecting user mentions after deleting characters mid sentence", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic"); // Emulate user pressing backspace in the editor

      const editor = (0, _qunitHelpers.query)(".d-editor-input");
      await (0, _testHelpers.fillIn)(".d-editor-input", "abc @user 123");
      await (0, _utilities.setCaretPosition)(editor, 9);
      await (0, _testHelpers.triggerKeyEvent)(".d-editor-input", "keydown", "Backspace");
      await (0, _testHelpers.fillIn)(".d-editor-input", "abc @use 123");
      await (0, _testHelpers.triggerKeyEvent)(".d-editor-input", "keyup", "Backspace");
      await (0, _utilities.setCaretPosition)(editor, 8);
      await (0, _testHelpers.triggerKeyEvent)(".d-editor-input", "keydown", "Backspace");
      await (0, _testHelpers.fillIn)(".d-editor-input", "abc @us 123");
      await (0, _testHelpers.triggerKeyEvent)(".d-editor-input", "keyup", "Backspace");
      await (0, _utilities.setCaretPosition)(editor, 7);
      await (0, _testHelpers.click)(".autocomplete.ac-user .selected");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "abc @user 123", "should replace mention correctly");
    });
    (0, _qunit.test)("shows status on search results when mentioning a user", async function (assert) {
      const timezone = (0, _qunitHelpers.loggedInUser)().timezone;
      const now = moment(status.ends_at).add(-1, "hour").format();
      clock = (0, _qunitHelpers.fakeTime)(now, timezone, true);
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic"); // emulate typing in "abc @u"

      const editor = (0, _qunitHelpers.query)(".d-editor-input");
      await (0, _testHelpers.fillIn)(".d-editor-input", "@");
      await (0, _utilities.setCaretPosition)(editor, 5);
      await (0, _testHelpers.triggerKeyEvent)(".d-editor-input", "keyup", "@");
      await (0, _testHelpers.fillIn)(".d-editor-input", "@u");
      await (0, _utilities.setCaretPosition)(editor, 6);
      await (0, _testHelpers.triggerKeyEvent)(".d-editor-input", "keyup", "U");
      assert.ok((0, _qunitHelpers.exists)(`.autocomplete .emoji[title='${status.emoji}']`), "status emoji is shown");
      assert.equal((0, _qunitHelpers.query)(".autocomplete .status-description").textContent.trim(), status.description, "status description is shown");
      assert.equal((0, _qunitHelpers.query)(".autocomplete .relative-date").textContent.trim(), "1h", "status expiration time is shown");
    });
  });
});
define("discourse/tests/acceptance/composer-hyperlink-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Composer - Hyperlink", function (needs) {
    needs.user();
    (0, _qunit.test)("add a hyperlink to a reply", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)(".topic-post:first-child button.reply");
      await (0, _testHelpers.fillIn)(".d-editor-input", "This is a link to ");
      assert.ok(!(0, _qunitHelpers.exists)(".insert-link.modal-body"), "no hyperlink modal by default");
      await (0, _testHelpers.click)(".d-editor button.link");
      assert.ok((0, _qunitHelpers.exists)(".insert-link.modal-body"), "hyperlink modal visible");
      await (0, _testHelpers.fillIn)(".modal-body .link-url", "google.com");
      await (0, _testHelpers.fillIn)(".modal-body .link-text", "Google");
      await (0, _testHelpers.click)(".modal-footer button.btn-primary");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "This is a link to [Google](https://google.com)", "adds link with url and text, prepends 'https://'");
      assert.ok(!(0, _qunitHelpers.exists)(".insert-link.modal-body"), "modal dismissed after submitting link");
      await (0, _testHelpers.fillIn)(".d-editor-input", "Reset textarea contents.");
      await (0, _testHelpers.click)(".d-editor button.link");
      await (0, _testHelpers.fillIn)(".modal-body .link-url", "google.com");
      await (0, _testHelpers.fillIn)(".modal-body .link-text", "Google");
      await (0, _testHelpers.click)(".modal-footer button.btn-danger");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "Reset textarea contents.", "doesnt insert anything after cancelling");
      assert.ok(!(0, _qunitHelpers.exists)(".insert-link.modal-body"), "modal dismissed after cancelling");
      const textarea = (0, _qunitHelpers.query)("#reply-control .d-editor-input");
      textarea.selectionStart = 0;
      textarea.selectionEnd = 6;
      await (0, _testHelpers.click)(".d-editor button.link");
      await (0, _testHelpers.fillIn)(".modal-body .link-url", "somelink.com");
      await (0, _testHelpers.click)(".modal-footer button.btn-primary");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "[Reset](https://somelink.com) textarea contents.", "adds link to a selected text");
      await (0, _testHelpers.fillIn)(".d-editor-input", "");
      await (0, _testHelpers.click)(".d-editor button.link");
      await (0, _testHelpers.fillIn)(".modal-body .link-url", "http://google.com");
      await (0, _testHelpers.triggerKeyEvent)(".modal-body .link-url", "keyup", "Space");
      assert.ok(!(0, _qunitHelpers.exists)(".internal-link-results"), "does not show internal links search dropdown when inputting a url");
      await (0, _testHelpers.fillIn)(".modal-body .link-url", "local");
      await (0, _testHelpers.triggerKeyEvent)(".modal-body .link-url", "keyup", "Space");
      assert.ok((0, _qunitHelpers.exists)(".internal-link-results"), "shows internal links search dropdown when entering keywords");
      await (0, _testHelpers.triggerKeyEvent)(".insert-link", "keydown", "ArrowDown");
      await (0, _testHelpers.triggerKeyEvent)(".insert-link", "keydown", "Enter");
      assert.ok(!(0, _qunitHelpers.exists)(".internal-link-results"), "search dropdown dismissed after selecting an internal link");
      assert.ok((0, _qunitHelpers.query)(".link-url").value.includes("http"), "replaces link url field with internal link");
      await (0, _testHelpers.triggerKeyEvent)(".insert-link", "keydown", "Escape");
      assert.strictEqual(document.activeElement.classList.contains("d-editor-input"), true, "focus stays on composer after dismissing modal using Esc key");
    });
  });
});
define("discourse/tests/acceptance/composer-image-preview-test", ["@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "qunit"], function (_testHelpers, _qunitHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Composer - Image Preview", function (needs) {
    needs.user();
    needs.settings({
      enable_whispers: true
    });
    needs.site({
      can_tag_topics: true
    });
    needs.pretender((server, helper) => {
      server.post("/uploads/lookup-urls", () => {
        return helper.response([]);
      });
      server.get("/posts/419", () => {
        return helper.response({
          id: 419
        });
      });
      server.get("/u/is_local_username", () => {
        return helper.response({
          valid: [],
          valid_groups: ["staff"],
          mentionable_groups: [{
            name: "staff",
            user_count: 30
          }],
          cannot_see: [],
          max_users_notified_per_group_mention: 100
        });
      });
    });

    const assertImageResized = (assert, uploads) => {
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, uploads.join("\n"), "it resizes uploaded image");
    };

    (0, _qunit.test)("Image resizing buttons", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      let uploads = [// 0 Default markdown with dimensions- should work
      "<a href='https://example.com'>![test|690x313](upload://test.png)</a>", // 1 Image with scaling percentage, should work
      "![test|690x313,50%](upload://test.png)", // 2 image with scaling percentage and a proceeding whitespace, should work
      "![test|690x313, 50%](upload://test.png)", // 3 No dimensions, should not work
      "![test](upload://test.jpeg)", // 4 Wrapped in backticks should not work
      "`![test|690x313](upload://test.png)`", // 5 html image - should not work
      "<img src='/images/avatar.png' wight='20' height='20'>", // 6 two images one the same line, but both are syntactically correct - both should work
      "![onTheSameLine1|200x200](upload://onTheSameLine1.jpeg) ![onTheSameLine2|250x250](upload://onTheSameLine2.jpeg)", // 7 & 8 Identical images - both should work
      "![identicalImage|300x300](upload://identicalImage.png)", "![identicalImage|300x300](upload://identicalImage.png)", // 9 Image with whitespaces in alt - should work
      "![image with spaces in alt|690x220](upload://test.png)", // 10 Image with markdown title - should work
      `![image|690x220](upload://test.png "image title")`, // 11 bbcode - should not work
      "[img]/images/avatar.png[/img]", // 12 Image with data attributes
      "![test|foo=bar|690x313,50%|bar=baz](upload://test.png)"];
      await (0, _testHelpers.fillIn)(".d-editor-input", uploads.join("\n"));
      assert.strictEqual((0, _qunitHelpers.count)(".button-wrapper"), 10, "it adds correct amount of scaling button groups"); // Default

      uploads[0] = "<a href='https://example.com'>![test|690x313, 50%](upload://test.png)</a>";
      await (0, _testHelpers.click)(".button-wrapper[data-image-index='0'] .scale-btn[data-scale='50']");
      assertImageResized(assert, uploads); // Targets the correct image if two on the same line

      uploads[6] = "![onTheSameLine1|200x200, 50%](upload://onTheSameLine1.jpeg) ![onTheSameLine2|250x250](upload://onTheSameLine2.jpeg)";
      await (0, _testHelpers.click)(".button-wrapper[data-image-index='3'] .scale-btn[data-scale='50']");
      assertImageResized(assert, uploads); // Try the other image on the same line

      uploads[6] = "![onTheSameLine1|200x200, 50%](upload://onTheSameLine1.jpeg) ![onTheSameLine2|250x250, 75%](upload://onTheSameLine2.jpeg)";
      await (0, _testHelpers.click)(".button-wrapper[data-image-index='4'] .scale-btn[data-scale='75']");
      assertImageResized(assert, uploads); // Make sure we target the correct image if there are duplicates

      uploads[7] = "![identicalImage|300x300, 50%](upload://identicalImage.png)";
      await (0, _testHelpers.click)(".button-wrapper[data-image-index='5'] .scale-btn[data-scale='50']");
      assertImageResized(assert, uploads); // Try the other dupe

      uploads[8] = "![identicalImage|300x300, 75%](upload://identicalImage.png)";
      await (0, _testHelpers.click)(".button-wrapper[data-image-index='6'] .scale-btn[data-scale='75']");
      assertImageResized(assert, uploads); // Don't mess with image titles

      uploads[10] = `![image|690x220, 75%](upload://test.png "image title")`;
      await (0, _testHelpers.click)(".button-wrapper[data-image-index='8'] .scale-btn[data-scale='75']");
      assertImageResized(assert, uploads); // Keep data attributes

      uploads[12] = `![test|foo=bar|690x313, 75%|bar=baz](upload://test.png)`;
      await (0, _testHelpers.click)(".button-wrapper[data-image-index='9'] .scale-btn[data-scale='75']");
      assertImageResized(assert, uploads);
      await (0, _testHelpers.fillIn)(".d-editor-input", `
![test|690x313](upload://test.png)

\`<script>alert("xss")</script>\`
    `);
      assert.ok(!(0, _qunitHelpers.exists)("script"), "it does not unescape script tags in code blocks");
    });
    (0, _qunit.test)("Editing alt text (with enter key) for single image in preview updates alt text in composer", async function (assert) {
      const scaleButtonContainer = ".scale-btn-container";
      const readonlyAltText = ".alt-text";
      const editAltTextButton = ".alt-text-edit-btn";
      const altTextInput = ".alt-text-input";
      const altTextEditOk = ".alt-text-edit-ok";
      const altTextEditCancel = ".alt-text-edit-cancel";
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)(".d-editor-input", `![zorro|200x200](upload://zorro.png)`);
      assert.equal((0, _qunitHelpers.query)(readonlyAltText).innerText, "zorro", "correct alt text");
      assert.ok((0, _qunitHelpers.visible)(readonlyAltText), "alt text is visible");
      assert.ok((0, _qunitHelpers.visible)(editAltTextButton), "alt text edit button is visible");
      assert.ok((0, _qunitHelpers.invisible)(altTextInput), "alt text input is hidden");
      assert.ok((0, _qunitHelpers.invisible)(altTextEditOk), "alt text edit ok button is hidden");
      assert.ok((0, _qunitHelpers.invisible)(altTextEditCancel), "alt text edit cancel is hidden");
      await (0, _testHelpers.click)(editAltTextButton);
      assert.ok((0, _qunitHelpers.invisible)(scaleButtonContainer), "scale buttons are hidden");
      assert.ok((0, _qunitHelpers.invisible)(readonlyAltText), "alt text is hidden");
      assert.ok((0, _qunitHelpers.invisible)(editAltTextButton), "alt text edit button is hidden");
      assert.ok((0, _qunitHelpers.visible)(altTextInput), "alt text input is visible");
      assert.ok((0, _qunitHelpers.visible)(altTextEditOk), "alt text edit ok button is visible");
      assert.ok((0, _qunitHelpers.visible)(altTextEditCancel), "alt text edit cancel is hidden");
      assert.equal((0, _qunitHelpers.query)(altTextInput).value, "zorro", "correct alt text in input");
      await (0, _testHelpers.triggerKeyEvent)(altTextInput, "keypress", "[");
      await (0, _testHelpers.triggerKeyEvent)(altTextInput, "keypress", "]");
      assert.equal((0, _qunitHelpers.query)(altTextInput).value, "zorro", "does not input [ ] keys");
      await (0, _testHelpers.fillIn)(altTextInput, "steak");
      await (0, _testHelpers.triggerKeyEvent)(altTextInput, "keypress", 13);
      assert.equal((0, _qunitHelpers.query)(".d-editor-input").value, "![steak|200x200](upload://zorro.png)", "alt text updated");
      assert.equal((0, _qunitHelpers.query)(readonlyAltText).innerText, "steak", "shows the alt text");
      assert.ok((0, _qunitHelpers.visible)(editAltTextButton), "alt text edit button is visible");
      assert.ok((0, _qunitHelpers.visible)(scaleButtonContainer), "scale buttons are visible");
      assert.ok((0, _qunitHelpers.visible)(editAltTextButton), "alt text edit button is visible");
      assert.ok((0, _qunitHelpers.invisible)(altTextInput), "alt text input is hidden");
      assert.ok((0, _qunitHelpers.invisible)(altTextEditOk), "alt text edit ok button is hidden");
      assert.ok((0, _qunitHelpers.invisible)(altTextEditCancel), "alt text edit cancel is hidden");
    });
    (0, _qunit.test)("Editing alt text (with check button) in preview updates alt text in composer", async function (assert) {
      const scaleButtonContainer = ".scale-btn-container";
      const readonlyAltText = ".alt-text";
      const editAltTextButton = ".alt-text-edit-btn";
      const altTextInput = ".alt-text-input";
      const altTextEditOk = ".alt-text-edit-ok";
      const altTextEditCancel = ".alt-text-edit-cancel";
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)(".d-editor-input", `![zorro|200x200](upload://zorro.png)`);
      await (0, _testHelpers.click)(editAltTextButton);
      await (0, _testHelpers.fillIn)(altTextInput, "steak");
      await (0, _testHelpers.click)(altTextEditOk);
      assert.equal((0, _qunitHelpers.query)(".d-editor-input").value, "![steak|200x200](upload://zorro.png)", "alt text updated");
      assert.equal((0, _qunitHelpers.query)(readonlyAltText).innerText, "steak", "shows the alt text");
      assert.ok((0, _qunitHelpers.visible)(editAltTextButton), "alt text edit button is visible");
      assert.ok((0, _qunitHelpers.visible)(scaleButtonContainer), "scale buttons are visible");
      assert.ok((0, _qunitHelpers.visible)(editAltTextButton), "alt text edit button is visible");
      assert.ok((0, _qunitHelpers.invisible)(altTextInput), "alt text input is hidden");
      assert.ok((0, _qunitHelpers.invisible)(altTextEditOk), "alt text edit ok button is hidden");
      assert.ok((0, _qunitHelpers.invisible)(altTextEditCancel), "alt text edit cancel is hidden");
    });
    (0, _qunit.test)("Cancel alt text edit in preview does not update alt text in composer", async function (assert) {
      const scaleButtonContainer = ".scale-btn-container";
      const readonlyAltText = ".alt-text";
      const editAltTextButton = ".alt-text-edit-btn";
      const altTextInput = ".alt-text-input";
      const altTextEditOk = ".alt-text-edit-ok";
      const altTextEditCancel = ".alt-text-edit-cancel";
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)(".d-editor-input", `![zorro|200x200](upload://zorro.png)`);
      await (0, _testHelpers.click)(editAltTextButton);
      await (0, _testHelpers.fillIn)(altTextInput, "steak");
      await (0, _testHelpers.click)(altTextEditCancel);
      assert.equal((0, _qunitHelpers.query)(".d-editor-input").value, "![zorro|200x200](upload://zorro.png)", "alt text not updated");
      assert.equal((0, _qunitHelpers.query)(readonlyAltText).innerText, "zorro", "shows the unedited alt text");
      assert.ok((0, _qunitHelpers.visible)(editAltTextButton), "alt text edit button is visible");
      assert.ok((0, _qunitHelpers.visible)(scaleButtonContainer), "scale buttons are visible");
      assert.ok((0, _qunitHelpers.visible)(editAltTextButton), "alt text edit button is visible");
      assert.ok((0, _qunitHelpers.invisible)(altTextInput), "alt text input is hidden");
      assert.ok((0, _qunitHelpers.invisible)(altTextEditOk), "alt text edit ok button is hidden");
      assert.ok((0, _qunitHelpers.invisible)(altTextEditCancel), "alt text edit cancel is hidden");
    });
    (0, _qunit.test)("Editing alt text for one of two images in preview updates correct alt text in composer", async function (assert) {
      const editAltTextButton = ".alt-text-edit-btn";
      const altTextInput = ".alt-text-input";
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)(".d-editor-input", `![zorro|200x200](upload://zorro.png) ![not-zorro|200x200](upload://not-zorro.png)`);
      await (0, _testHelpers.click)(editAltTextButton);
      await (0, _testHelpers.fillIn)(altTextInput, "tomtom");
      await (0, _testHelpers.triggerKeyEvent)(altTextInput, "keypress", "Enter");
      assert.equal((0, _qunitHelpers.query)(".d-editor-input").value, `![tomtom|200x200](upload://zorro.png) ![not-zorro|200x200](upload://not-zorro.png)`, "the correct image's alt text updated");
    });
    (0, _qunit.test)("Deleting alt text for image empties alt text in composer and allows further modification", async function (assert) {
      const altText = ".alt-text";
      const editAltTextButton = ".alt-text-edit-btn";
      const altTextInput = ".alt-text-input";
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)(".d-editor-input", `![zorro|200x200](upload://zorro.png)`);
      await (0, _testHelpers.click)(editAltTextButton);
      await (0, _testHelpers.fillIn)(altTextInput, "");
      await (0, _testHelpers.triggerKeyEvent)(altTextInput, "keypress", "Enter");
      assert.equal((0, _qunitHelpers.query)(".d-editor-input").value, "![|200x200](upload://zorro.png)", "alt text updated");
      assert.equal((0, _qunitHelpers.query)(altText).innerText, "", "shows the alt text");
      await (0, _testHelpers.click)(editAltTextButton);
      await (0, _testHelpers.fillIn)(altTextInput, "tomtom");
      await (0, _testHelpers.triggerKeyEvent)(altTextInput, "keypress", "Enter");
      assert.equal((0, _qunitHelpers.query)(".d-editor-input").value, "![tomtom|200x200](upload://zorro.png)", "alt text updated");
    });
    (0, _qunit.test)("Image delete button", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      let uploads = ["![image_example_0|666x500](upload://q4iRxcuSAzfnbUaCsbjMXcGrpaK.jpeg)", "![image_example_1|481x480](upload://p1ijebM2iyQcUswBffKwMny3gxu.jpeg)"];
      await (0, _testHelpers.fillIn)(".d-editor-input", uploads.join("\n"));
      uploads[0] = ""; // delete the first image.
      //click on the remove button of the first image

      await (0, _testHelpers.click)(".button-wrapper[data-image-index='0'] .delete-image-button");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, uploads.join("\n"), "Image should be removed from the editor");
      assert.equal((0, _qunitHelpers.query)(".d-editor-input").value.includes("image_example_0"), false, "It shouldn't have the first image");
      assert.equal((0, _qunitHelpers.query)(".d-editor-input").value.includes("image_example_1"), true, "It should have the second image");
    });
  });
});
define("discourse/tests/acceptance/composer-onebox-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Composer - Onebox", function (needs) {
    needs.user();
    needs.settings({
      max_oneboxes_per_post: 2,
      enable_markdown_linkify: true
    });
    (0, _qunit.test)("Preview update should respect max_oneboxes_per_post site setting", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-buttons .btn.create");
      await (0, _testHelpers.fillIn)(".d-editor-input", `
http://www.example.com/has-title.html
This is another test http://www.example.com/has-title.html

http://www.example.com/no-title.html

This is another test http://www.example.com/no-title.html
This is another test http://www.example.com/has-title.html

http://www.example.com/has-title.html
        `);
      assert.ok((0, _qunitHelpers.visible)(".d-editor-preview"));
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-preview").innerHTML.trim(), `
<p><aside class=\"onebox\"><article class=\"onebox-body\"><h3><a href=\"http://www.example.com/article.html\" tabindex=\"-1\">An interesting article</a></h3></article></aside><br>
This is another test <a href=\"http://www.example.com/has-title.html\" class=\"inline-onebox\" tabindex=\"-1\">This is a great title</a></p>
<p><a href=\"http://www.example.com/no-title.html\" class=\"onebox\" target=\"_blank\" tabindex=\"-1\">http://www.example.com/no-title.html</a></p>
<p>This is another test <a href=\"http://www.example.com/no-title.html\" class=\"\" tabindex=\"-1\">http://www.example.com/no-title.html</a><br>
This is another test <a href=\"http://www.example.com/has-title.html\" class=\"inline-onebox\" tabindex=\"-1\">This is a great title</a></p>
<p><aside class=\"onebox\"><article class=\"onebox-body\"><h3><a href=\"http://www.example.com/article.html\" tabindex=\"-1\">An interesting article</a></h3></article></aside></p>
        `.trim());
    });
  });
  (0, _qunitHelpers.acceptance)("Composer - Inline Onebox", function (needs) {
    needs.user();
    needs.settings({
      max_oneboxes_per_post: 2,
      enable_markdown_linkify: true,
      markdown_linkify_tlds: "com"
    });
    let requestsCount;
    needs.pretender((server, helper) => {
      server.get("/inline-onebox", () => {
        ++requestsCount;
        return helper.response({
          "inline-oneboxes": []
        });
      });
    });
    (0, _qunit.test)("Uses cached inline onebox", async function (assert) {
      requestsCount = 0;
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-buttons .btn.create");
      await (0, _testHelpers.fillIn)(".d-editor-input", `Test www.example.com/page`);
      assert.strictEqual(requestsCount, 1);
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-preview").innerHTML.trim(), '<p>Test <a href="http://www.example.com/page" class="inline-onebox-loading" tabindex="-1">www.example.com/page</a></p>');
      await (0, _testHelpers.fillIn)(".d-editor-input", `Test www.example.com/page Test`);
      assert.strictEqual(requestsCount, 1);
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-preview").innerHTML.trim(), '<p>Test <a href="http://www.example.com/page" tabindex="-1">www.example.com/page</a> Test</p>');
    });
  });
});
define("discourse/tests/acceptance/composer-tags-test", ["discourse/tests/helpers/qunit-helpers", "I18n", "@ember/test-helpers", "discourse/models/category", "discourse/tests/helpers/select-kit-helper", "qunit"], function (_qunitHelpers, _I18n, _testHelpers, _category, _selectKitHelper, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"I18n",0,"@ember/test-helpers",0,"discourse/models/category",0,"discourse/tests/helpers/select-kit-helper",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Composer - Tags", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.post("/uploads/lookup-urls", () => {
        return helper.response([]);
      });
    });
    needs.site({
      can_tag_topics: true
    });
    (0, _qunit.test)("staff bypass tag validation rule", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)("#reply-title", "this is my new topic title");
      await (0, _testHelpers.fillIn)(".d-editor-input", "this is the *content* of a post");

      _category.default.findById(2).set("minimum_required_tags", 1);

      const categoryChooser = (0, _selectKitHelper.default)(".category-chooser");
      await categoryChooser.expand();
      await categoryChooser.selectRowByValue(2);
      await (0, _testHelpers.click)("#reply-control button.create");
      assert.notStrictEqual((0, _testHelpers.currentURL)(), "/");
    });
    (0, _qunit.test)("users do not bypass tag validation rule", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)("#reply-title", "this is my new topic title");
      await (0, _testHelpers.fillIn)(".d-editor-input", "this is the *content* of a post");

      _category.default.findById(2).set("minimum_required_tags", 1);

      const categoryChooser = (0, _selectKitHelper.default)(".category-chooser");
      await categoryChooser.expand();
      await categoryChooser.selectRowByValue(2);
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: false,
        trust_level: 1
      });
      await (0, _testHelpers.click)("#reply-control button.create");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/");
      assert.strictEqual((0, _qunitHelpers.query)(".popup-tip.bad").innerText.trim(), _I18n.default.t("composer.error.tags_missing", {
        count: 1
      }), "it should display the right alert");
      const tags = (0, _selectKitHelper.default)(".mini-tag-chooser");
      await tags.expand();
      await tags.selectRowByValue("monkey");
      await (0, _testHelpers.click)("#reply-control button.create");
      assert.notStrictEqual((0, _testHelpers.currentURL)(), "/");
    });
    (0, _qunit.test)("users do not bypass min required tags in tag group validation rule", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)("#reply-title", "this is my new topic title");
      await (0, _testHelpers.fillIn)(".d-editor-input", "this is the *content* of a post");

      _category.default.findById(2).setProperties({
        required_tag_groups: [{
          name: "support tags",
          min_count: 1
        }]
      });

      const categoryChooser = (0, _selectKitHelper.default)(".category-chooser");
      await categoryChooser.expand();
      await categoryChooser.selectRowByValue(2);
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: false,
        trust_level: 1
      });
      await (0, _testHelpers.click)("#reply-control button.create");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/");
      assert.strictEqual((0, _qunitHelpers.query)(".popup-tip.bad").innerText.trim(), _I18n.default.t("composer.error.tags_missing", {
        count: 1
      }), "it should display the right alert");
      const tags = (0, _selectKitHelper.default)(".mini-tag-chooser");
      await tags.expand();
      await tags.selectRowByValue("monkey");
      await (0, _testHelpers.click)("#reply-control button.create");
      assert.notStrictEqual((0, _testHelpers.currentURL)(), "/");
    });
    (0, _qunit.test)("users who cannot tag PMs do not see the selector", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie");
      await (0, _testHelpers.click)("button.compose-pm");
      assert.notOk((0, _qunitHelpers.exists)(".composer-fields .mini-tag-chooser"));
    });
  });
  (0, _qunitHelpers.acceptance)("Composer - Tags (PMs)", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.post("/uploads/lookup-urls", () => {
        return helper.response([]);
      });
    });
    needs.site({
      can_tag_topics: true,
      can_tag_pms: true
    });
    (0, _qunit.test)("users who can tag PMs see the selector", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie");
      await (0, _testHelpers.click)("button.compose-pm");
      assert.ok((0, _qunitHelpers.exists)(".composer-fields .mini-tag-chooser"));
    });
  });
});
define("discourse/tests/acceptance/composer-test", ["@ember/test-helpers", "discourse/controllers/composer", "discourse-common/lib/object", "discourse/tests/fixtures/topic", "discourse/lib/link-lookup", "discourse/lib/plugin-api", "discourse/models/composer", "discourse/models/draft", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/select-kit-helper", "I18n", "qunit", "sinon", "discourse/tests/helpers/create-pretender"], function (_testHelpers, _composer, _object, _topic, _linkLookup, _pluginApi, _composer2, _draft, _qunitHelpers, _selectKitHelper, _I18n, _qunit, _sinon, _createPretender) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"@ember/test-helpers",0,"discourse/controllers/composer",0,"discourse-common/lib/object",0,"discourse/tests/fixtures/topic",0,"discourse/lib/link-lookup",0,"discourse/lib/plugin-api",0,"discourse/models/composer",0,"discourse/models/draft",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"I18n",0,"qunit",0,"sinon",0,"discourse/tests/helpers/create-pretender"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Composer", function (needs) {
    needs.user({
      id: 5,
      username: "kris",
      whisperer: true
    });
    needs.settings({
      enable_whispers: true
    });
    needs.site({
      can_tag_topics: true
    });
    needs.pretender((server, helper) => {
      server.post("/uploads/lookup-urls", () => {
        return helper.response([]);
      });
      server.get("/posts/419", () => {
        return helper.response({
          id: 419
        });
      });
      server.get("/u/is_local_username", () => {
        return helper.response({
          valid: [],
          valid_groups: ["staff"],
          mentionable_groups: [{
            name: "staff",
            user_count: 30
          }],
          cannot_see: [],
          max_users_notified_per_group_mention: 100
        });
      });
      server.get("/t/960.json", () => {
        const topicList = (0, _object.cloneJSON)(_topic.default["/t/9/1.json"]);
        topicList.post_stream.posts[2].post_type = 4;
        return helper.response(topicList);
      });
    });
    needs.hooks.afterEach(() => (0, _composer.toggleCheckDraftPopup)(false));
    (0, _qunit.test)("Composer is opened", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      assert.strictEqual(document.documentElement.style.getPropertyValue("--composer-height"), "var(--new-topic-composer-height, 400px)", "sets --composer-height to 400px when creating topic");
      await (0, _testHelpers.fillIn)(".d-editor-input", "this is the *content* of a new topic post");
      await (0, _testHelpers.click)(".toggle-minimize");
      assert.strictEqual(document.documentElement.style.getPropertyValue("--composer-height"), "40px", "sets --composer-height to 40px when composer is minimized to draft mode");
      await (0, _testHelpers.click)(".toggle-fullscreen");
      assert.strictEqual(document.documentElement.style.getPropertyValue("--composer-height"), "var(--new-topic-composer-height, 400px)", "sets --composer-height back to 400px when composer is opened from draft mode");
      await (0, _testHelpers.fillIn)(".d-editor-input", "");
      await (0, _testHelpers.click)(".toggle-minimize");
      assert.strictEqual(document.documentElement.style.getPropertyValue("--composer-height"), "", "removes --composer-height property when composer is closed");
    });
    (0, _qunit.test)("composer controls", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)("#create-topic"), "the create button is visible");
      await (0, _testHelpers.click)("#create-topic");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-input"), "the composer input is visible");
      assert.ok((0, _qunitHelpers.exists)(".title-input .popup-tip.bad.hide"), "title errors are hidden by default");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-textarea-wrapper .popup-tip.bad.hide"), "body errors are hidden by default");
      await (0, _testHelpers.click)(".toggle-preview");
      assert.ok(!(0, _qunitHelpers.exists)(".d-editor-preview:visible"), "clicking the toggle hides the preview");
      await (0, _testHelpers.click)(".toggle-preview");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-preview:visible"), "clicking the toggle shows the preview again");
      await (0, _testHelpers.click)("#reply-control button.create");
      assert.ok(!(0, _qunitHelpers.exists)(".title-input .popup-tip.bad.hide"), "it shows the empty title error");
      assert.ok(!(0, _qunitHelpers.exists)(".d-editor-wrapper .popup-tip.bad.hide"), "it shows the empty body error");
      await (0, _testHelpers.fillIn)("#reply-title", "this is my new topic title");
      assert.ok((0, _qunitHelpers.exists)(".title-input .popup-tip.good"), "the title is now good");
      await (0, _testHelpers.fillIn)(".d-editor-input", "this is the *content* of a post");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-preview").innerHTML.trim(), "<p>this is the <em>content</em> of a post</p>", "it previews content");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-textarea-wrapper .popup-tip.good"), "the body is now good");
      const textarea = (0, _qunitHelpers.query)("#reply-control .d-editor-input");
      textarea.selectionStart = textarea.value.length;
      textarea.selectionEnd = textarea.value.length; // Testing keyboard events is tough!

      const mac = /Mac|iPod|iPhone|iPad/.test(navigator.platform);
      const event = document.createEvent("Event");
      event.initEvent("keydown", true, true);
      event[mac ? "metaKey" : "ctrlKey"] = true;
      event.key = "B";
      event.keyCode = 66;
      textarea.dispatchEvent(event);
      await (0, _testHelpers.settled)();

      const example = _I18n.default.t(`composer.bold_text`);

      assert.strictEqual((0, _qunitHelpers.query)("#reply-control .d-editor-input").value.trim(), `this is the *content* of a post**${example}**`, "it supports keyboard shortcuts");
      await (0, _testHelpers.click)("#reply-control a.cancel");
      assert.ok((0, _qunitHelpers.exists)(".d-modal"), "it pops up a confirmation dialog");
      await (0, _testHelpers.click)(".modal-footer .discard-draft");
      assert.ok(!(0, _qunitHelpers.exists)(".bootbox.modal"), "the confirmation can be cancelled");
    });
    (0, _qunit.test)("Create a topic with server side errors", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)("#reply-title", "this title triggers an error");
      await (0, _testHelpers.fillIn)(".d-editor-input", "this is the *content* of a post");
      await (0, _testHelpers.click)("#reply-control button.create");
      assert.ok((0, _qunitHelpers.exists)(".bootbox.modal"), "it pops up an error message");
      await (0, _testHelpers.click)(".bootbox.modal a.btn-primary");
      assert.ok(!(0, _qunitHelpers.exists)(".bootbox.modal"), "it dismisses the error");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-input"), "the composer input is visible");
    });
    (0, _qunit.test)("Create a Topic", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)("#reply-title", "Internationalization Localization");
      await (0, _testHelpers.fillIn)(".d-editor-input", "this is the *content* of a new topic post");
      await (0, _testHelpers.click)("#reply-control button.create");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/t/internationalization-localization/280", "it transitions to the newly created topic URL");
    });
    (0, _qunit.test)("Create an enqueued Topic", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)("#reply-title", "Internationalization Localization");
      await (0, _testHelpers.fillIn)(".d-editor-input", "enqueue this content please");
      await (0, _testHelpers.click)("#reply-control button.create");
      assert.ok((0, _qunitHelpers.visible)(".d-modal"), "it pops up a modal");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/", "it doesn't change routes");
      await (0, _testHelpers.click)(".modal-footer button");
      assert.ok((0, _qunitHelpers.invisible)(".d-modal"), "the modal can be dismissed");
    });
    (0, _qunit.test)("Can display a message and route to a URL", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)("#reply-title", "This title doesn't matter");
      await (0, _testHelpers.fillIn)(".d-editor-input", "custom message");
      await (0, _testHelpers.click)("#reply-control button.create");
      assert.strictEqual((0, _qunitHelpers.query)(".bootbox .modal-body").innerText, "This is a custom response");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/", "it doesn't change routes");
      await (0, _testHelpers.click)(".bootbox .btn-primary");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/faq", "can navigate to a `route_to` destination");
    });
    (0, _qunit.test)("Create a Reply", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      assert.ok(!(0, _qunitHelpers.exists)('article[data-post-id="12345"]'), "the post is not in the DOM");
      await (0, _testHelpers.click)("#topic-footer-buttons .btn.create");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-input"), "the composer input is visible");
      assert.ok(!(0, _qunitHelpers.exists)("#reply-title"), "there is no title since this is a reply");
      await (0, _testHelpers.fillIn)(".d-editor-input", "this is the content of my reply");
      await (0, _testHelpers.click)("#reply-control button.create");
      assert.strictEqual((0, _qunitHelpers.query)(".topic-post:last-of-type .cooked p").innerText, "this is the content of my reply");
    });
    (0, _qunit.test)("Can edit a post after starting a reply", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-buttons .create");
      await (0, _testHelpers.fillIn)(".d-editor-input", "this is the content of my reply");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.show-more-actions");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.edit");
      await (0, _testHelpers.click)(".modal-footer button.keep-editing");
      assert.ok((0, _qunitHelpers.invisible)(".discard-draft-modal.modal"));
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "this is the content of my reply", "composer does not switch when using Keep Editing button");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.edit");
      await (0, _testHelpers.click)(".modal-footer button.save-draft");
      assert.ok((0, _qunitHelpers.invisible)(".discard-draft-modal.modal"));
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, (0, _qunitHelpers.query)(".topic-post:nth-of-type(1) .cooked > p").innerText, "composer has contents of post to be edited");
    });
    (0, _qunit.test)("Posting on a different topic", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-buttons .btn.create");
      await (0, _testHelpers.fillIn)(".d-editor-input", "this is the content for a different topic");
      await (0, _testHelpers.visit)("/t/1-3-0beta9-no-rate-limit-popups/28830");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/t/1-3-0beta9-no-rate-limit-popups/28830");
      await (0, _testHelpers.click)("#reply-control button.create");
      assert.ok((0, _qunitHelpers.visible)(".reply-where-modal"), "it pops up a modal");
      await (0, _testHelpers.click)(".btn-reply-here");
      assert.strictEqual((0, _qunitHelpers.query)(".topic-post:last-of-type .cooked p").innerText, "If you use gettext format you could leverage Launchpad 13 translations and the community behind it.");
    });
    (0, _qunit.test)("Discard draft modal works when switching topics", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-buttons .btn.create");
      await (0, _testHelpers.fillIn)(".d-editor-input", "this is the content of the first reply");
      await (0, _testHelpers.visit)("/t/this-is-a-test-topic/9");
      assert.ok((0, _testHelpers.currentURL)().startsWith("/t/this-is-a-test-topic/9"), "moves to second topic");
      await (0, _testHelpers.click)("#topic-footer-buttons .btn.create");
      assert.ok((0, _qunitHelpers.exists)(".discard-draft-modal.modal"), "it pops up the discard drafts modal");
      await (0, _testHelpers.click)(".modal-footer button.keep-editing");
      assert.ok((0, _qunitHelpers.invisible)(".discard-draft-modal.modal"));
      await (0, _testHelpers.click)("#topic-footer-buttons .btn.create");
      assert.ok((0, _qunitHelpers.exists)(".discard-draft-modal.modal"), "it pops up the modal again");
      await (0, _testHelpers.click)(".modal-footer button.discard-draft");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "", "discards draft and reset composer textarea");
    });
    (0, _qunit.test)("Create an enqueued Reply", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      assert.ok(!(0, _qunitHelpers.exists)(".pending-posts .reviewable-item"));
      await (0, _testHelpers.click)("#topic-footer-buttons .btn.create");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-input"), "the composer input is visible");
      assert.ok(!(0, _qunitHelpers.exists)("#reply-title"), "there is no title since this is a reply");
      await (0, _testHelpers.fillIn)(".d-editor-input", "enqueue this content please");
      await (0, _testHelpers.click)("#reply-control button.create");
      assert.ok((0, _qunitHelpers.query)(".topic-post:last-of-type .cooked p").innerText !== "enqueue this content please", "it doesn't insert the post");
      assert.ok((0, _qunitHelpers.visible)(".d-modal"), "it pops up a modal");
      await (0, _testHelpers.click)(".modal-footer button");
      assert.ok((0, _qunitHelpers.invisible)(".d-modal"), "the modal can be dismissed");
      assert.ok((0, _qunitHelpers.exists)(".pending-posts .reviewable-item"));
    });
    (0, _qunit.test)("Edit the first post", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      assert.ok(!(0, _qunitHelpers.exists)(".topic-post:nth-of-type(1) .post-info.edits"), "it has no edits icon at first");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.show-more-actions");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.edit");
      assert.ok((0, _qunitHelpers.query)(".d-editor-input").value.startsWith("Any plans to support"), "it populates the input with the post text");
      await (0, _testHelpers.fillIn)(".d-editor-input", "This is the new text for the post");
      await (0, _testHelpers.fillIn)("#reply-title", "This is the new text for the title");
      await (0, _testHelpers.click)("#reply-control button.create");
      assert.ok(!(0, _qunitHelpers.exists)(".d-editor-input"), "it closes the composer");
      assert.ok((0, _qunitHelpers.exists)(".topic-post:nth-of-type(1) .post-info.edits"), "it has the edits icon");
      assert.ok((0, _qunitHelpers.query)("#topic-title h1").innerText.includes("This is the new text for the title"), "it shows the new title");
      assert.ok((0, _qunitHelpers.query)(".topic-post:nth-of-type(1) .cooked").innerText.includes("This is the new text for the post"), "it updates the post");
    });
    (0, _qunit.test)("Editing a post stages new content", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)(".topic-post button.show-more-actions");
      await (0, _testHelpers.click)(".topic-post button.edit");
      await (0, _testHelpers.fillIn)(".d-editor-input", "will return empty json");
      await (0, _testHelpers.fillIn)("#reply-title", "This is the new text for the title");

      _createPretender.default.put("/posts/:post_id", async () => {
        // at this point, request is in flight, so post is staged
        assert.strictEqual((0, _qunitHelpers.count)(".topic-post.staged"), 1);
        assert.ok((0, _qunitHelpers.query)(".topic-post").classList.contains("staged"));
        assert.strictEqual((0, _qunitHelpers.query)(".topic-post.staged .cooked").innerText.trim(), "will return empty json");
        return (0, _createPretender.response)(200, {});
      });

      await (0, _testHelpers.click)("#reply-control button.create");
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      assert.strictEqual((0, _qunitHelpers.count)(".topic-post.staged"), 0);
    });
    (0, _qunit.test)("Composer can switch between edits", async function (assert) {
      await (0, _testHelpers.visit)("/t/this-is-a-test-topic/9");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.edit");
      assert.ok((0, _qunitHelpers.query)(".d-editor-input").value.startsWith("This is the first post."), "it populates the input with the post text");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(2) button.edit");
      assert.ok((0, _qunitHelpers.query)(".d-editor-input").value.startsWith("This is the second post."), "it populates the input with the post text");
    });
    (0, _qunit.test)("Composer with dirty edit can toggle to another edit", async function (assert) {
      await (0, _testHelpers.visit)("/t/this-is-a-test-topic/9");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.edit");
      await (0, _testHelpers.fillIn)(".d-editor-input", "This is a dirty reply");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(2) button.edit");
      assert.ok((0, _qunitHelpers.exists)(".discard-draft-modal.modal"), "it pops up a confirmation dialog");
      await (0, _testHelpers.click)(".modal-footer button.discard-draft");
      assert.ok((0, _qunitHelpers.query)(".d-editor-input").value.startsWith("This is the second post."), "it populates the input with the post text");
    });
    (0, _qunit.test)("Composer can toggle between edit and reply", async function (assert) {
      await (0, _testHelpers.visit)("/t/this-is-a-test-topic/9");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.edit");
      assert.ok((0, _qunitHelpers.query)(".d-editor-input").value.startsWith("This is the first post."), "it populates the input with the post text");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.reply");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "", "it clears the input");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.edit");
      assert.ok((0, _qunitHelpers.query)(".d-editor-input").value.startsWith("This is the first post."), "it populates the input with the post text");
    });
    (0, _qunit.test)("Composer can toggle whispers when whisperer user", async function (assert) {
      const menu = (0, _selectKitHelper.default)(".toolbar-popup-menu-options");
      await (0, _testHelpers.visit)("/t/this-is-a-test-topic/9");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.reply");
      await menu.expand();
      await menu.selectRowByValue("toggleWhisper");
      assert.strictEqual((0, _qunitHelpers.count)(".composer-actions svg.d-icon-far-eye-slash"), 1, "it sets the post type to whisper");
      await menu.expand();
      await menu.selectRowByValue("toggleWhisper");
      assert.ok(!(0, _qunitHelpers.exists)(".composer-actions svg.d-icon-far-eye-slash"), "it removes the whisper mode");
      await menu.expand();
      await menu.selectRowByValue("toggleWhisper");
      await (0, _testHelpers.click)(".toggle-fullscreen");
      await menu.expand();
      assert.ok(menu.rowByValue("toggleWhisper").exists(), "whisper toggling is still present when going fullscreen");
    });
    (0, _qunit.test)("Composer can toggle layouts (open, fullscreen and draft)", async function (assert) {
      await (0, _testHelpers.visit)("/t/this-is-a-test-topic/9");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.reply");
      assert.strictEqual((0, _qunitHelpers.count)("#reply-control.open"), 1, "it starts in open state by default");
      await (0, _testHelpers.click)(".toggle-fullscreen");
      assert.strictEqual((0, _qunitHelpers.count)("#reply-control.fullscreen"), 1, "it expands composer to full screen");
      assert.strictEqual((0, _qunitHelpers.count)(".composer-fullscreen-prompt"), 1, "the exit fullscreen prompt is visible");
      await (0, _testHelpers.click)(".toggle-fullscreen");
      assert.strictEqual((0, _qunitHelpers.count)("#reply-control.open"), 1, "it collapses composer to regular size");
      await (0, _testHelpers.fillIn)(".d-editor-input", "This is a dirty reply");
      await (0, _testHelpers.click)(".toggler");
      assert.strictEqual((0, _qunitHelpers.count)("#reply-control.draft"), 1, "it collapses composer to draft bar");
      await (0, _testHelpers.click)(".toggle-fullscreen");
      assert.strictEqual((0, _qunitHelpers.count)("#reply-control.open"), 1, "from draft, it expands composer back to open state");
    });
    (0, _qunit.test)("Composer fullscreen submit button", async function (assert) {
      await (0, _testHelpers.visit)("/t/this-is-a-test-topic/9");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.reply");
      assert.strictEqual((0, _qunitHelpers.count)("#reply-control.open"), 1, "it starts in open state by default");
      await (0, _testHelpers.click)(".toggle-fullscreen");
      assert.strictEqual((0, _qunitHelpers.count)("#reply-control button.create"), 1, "it shows composer submit button in fullscreen");
      await (0, _testHelpers.fillIn)(".d-editor-input", "too short");
      await (0, _testHelpers.click)("#reply-control button.create");
      assert.strictEqual((0, _qunitHelpers.count)("#reply-control.open"), 1, "it goes back to open state if there's errors");
    });
    (0, _qunit.test)("Composer can toggle between reply and createTopic", async function (assert) {
      await (0, _testHelpers.visit)("/t/this-is-a-test-topic/9");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.reply");
      await (0, _selectKitHelper.default)(".toolbar-popup-menu-options").expand();
      await (0, _selectKitHelper.default)(".toolbar-popup-menu-options").selectRowByValue("toggleWhisper");
      assert.strictEqual((0, _qunitHelpers.count)(".composer-actions svg.d-icon-far-eye-slash"), 1, "it sets the post type to whisper");
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)("#create-topic"), "the create topic button is visible");
      await (0, _testHelpers.click)("#create-topic");
      assert.ok(!(0, _qunitHelpers.exists)(".reply-details .whisper .d-icon-far-eye-slash"), "it should reset the state of the composer's model");
      await (0, _selectKitHelper.default)(".toolbar-popup-menu-options").expand();
      await (0, _selectKitHelper.default)(".toolbar-popup-menu-options").selectRowByValue("toggleInvisible");
      assert.ok((0, _qunitHelpers.query)(".reply-details .unlist").innerText.includes(_I18n.default.t("composer.unlist")), "it sets the topic to unlisted");
      await (0, _testHelpers.visit)("/t/this-is-a-test-topic/9");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.reply");
      assert.ok(!(0, _qunitHelpers.exists)(".reply-details .whisper"), "it should reset the state of the composer's model");
    });
    (0, _qunit.test)("Composer can toggle whisper when switching from reply to whisper to reply to topic", async function (assert) {
      await (0, _testHelpers.visit)("/t/topic-with-whisper/960");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(3) button.reply");
      await (0, _testHelpers.click)(".reply-details summary div");
      assert.ok(!(0, _qunitHelpers.exists)('.reply-details li[data-value="toggle_whisper"]'), "toggle whisper is not available when reply to whisper");
      await (0, _testHelpers.click)('.reply-details li[data-value="reply_to_topic"]');
      await (0, _testHelpers.click)(".reply-details summary div");
      assert.ok((0, _qunitHelpers.exists)('.reply-details li[data-value="toggle_whisper"]'), "toggle whisper is available when reply to topic");
    });
    (0, _qunit.test)("Composer can toggle whisper when clicking reply to topic after reply to whisper", async function (assert) {
      await (0, _testHelpers.visit)("/t/topic-with-whisper/960");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(3) button.reply");
      await (0, _testHelpers.click)("#reply-control .save-or-cancel a.cancel");
      await (0, _testHelpers.click)(".topic-footer-main-buttons button.create");
      await (0, _testHelpers.click)(".reply-details summary div");
      assert.ok((0, _qunitHelpers.exists)('.reply-details li[data-value="toggle_whisper"]'), "toggle whisper is available when reply to topic");
    });
    (0, _qunit.test)("Composer with dirty reply can toggle to edit", async function (assert) {
      await (0, _testHelpers.visit)("/t/this-is-a-test-topic/9");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.reply");
      await (0, _testHelpers.fillIn)(".d-editor-input", "This is a dirty reply");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.edit");
      assert.ok((0, _qunitHelpers.exists)(".discard-draft-modal.modal"), "it pops up a confirmation dialog");
      await (0, _testHelpers.click)(".modal-footer button.discard-draft");
      assert.ok((0, _qunitHelpers.query)(".d-editor-input").value.startsWith("This is the first post."), "it populates the input with the post text");
    });
    (0, _qunit.test)("Composer draft with dirty reply can toggle to edit", async function (assert) {
      await (0, _testHelpers.visit)("/t/this-is-a-test-topic/9");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.reply");
      await (0, _testHelpers.fillIn)(".d-editor-input", "This is a dirty reply");
      await (0, _testHelpers.click)(".toggler");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(2) button.edit");
      assert.ok((0, _qunitHelpers.exists)(".discard-draft-modal.modal"), "it pops up a confirmation dialog");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-footer button.save-draft").innerText.trim(), _I18n.default.t("post.cancel_composer.save_draft"), "has save draft button");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-footer button.keep-editing").innerText.trim(), _I18n.default.t("post.cancel_composer.keep_editing"), "has keep editing button");
      await (0, _testHelpers.click)(".modal-footer button.save-draft");
      assert.ok((0, _qunitHelpers.query)(".d-editor-input").value.startsWith("This is the second post."), "it populates the input with the post text");
    });
    (0, _qunit.test)("Composer draft can switch to draft in new context without destroying current draft", async function (assert) {
      await (0, _testHelpers.visit)("/t/this-is-a-test-topic/9");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.reply");
      await (0, _testHelpers.fillIn)(".d-editor-input", "This is a dirty reply");
      await (0, _testHelpers.click)("#site-logo");
      await (0, _testHelpers.click)("#create-topic");
      assert.ok((0, _qunitHelpers.exists)(".discard-draft-modal.modal"), "it pops up a confirmation dialog");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-footer button.save-draft").innerText.trim(), _I18n.default.t("post.cancel_composer.save_draft"), "has save draft button");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-footer button.keep-editing").innerText.trim(), _I18n.default.t("post.cancel_composer.keep_editing"), "has keep editing button");
      await (0, _testHelpers.click)(".modal-footer button.save-draft");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "", "it clears the composer input");
    });
    (0, _qunit.test)("Checks for existing draft", async function (assert) {
      (0, _composer.toggleCheckDraftPopup)(true);
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.show-more-actions");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.edit");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-body").innerText, _I18n.default.t("drafts.abandon.confirm"));
      await (0, _testHelpers.click)(".modal-footer .btn.btn-default");
    });
    (0, _qunit.test)("Can switch states without abandon popup", async function (assert) {
      (0, _composer.toggleCheckDraftPopup)(true);
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      const longText = "a".repeat(256);

      _sinon.default.stub(_draft.default, "get").resolves({
        draft: null,
        draft_sequence: 0
      });

      await (0, _testHelpers.click)(".btn-primary.create.btn");
      await (0, _testHelpers.fillIn)(".d-editor-input", longText);
      assert.ok((0, _qunitHelpers.exists)('.action-title a[href="/t/internationalization-localization/280"]'), "the mode should be: reply to post");
      await (0, _testHelpers.click)("article#post_3 button.reply");
      const composerActions = (0, _selectKitHelper.default)(".composer-actions");
      await composerActions.expand();
      await composerActions.selectRowByValue("reply_as_new_topic");
      assert.ok(!(0, _qunitHelpers.exists)(".modal-body"), "abandon popup shouldn't come");
      assert.ok((0, _qunitHelpers.query)(".d-editor-input").value.includes(longText), "entered text should still be there");
      assert.ok(!(0, _qunitHelpers.exists)('.action-title a[href="/t/internationalization-localization/280"]'), "mode should have changed");
    });
    (0, _qunit.test)("Loading draft also replaces the recipients", async function (assert) {
      (0, _composer.toggleCheckDraftPopup)(true);

      _sinon.default.stub(_draft.default, "get").resolves({
        draft: '{"reply":"hello","action":"privateMessage","title":"hello","categoryId":null,"archetypeId":"private_message","metaData":null,"recipients":"codinghorror","composerTime":9159,"typingTime":2500}',
        draft_sequence: 0
      });

      await (0, _testHelpers.visit)("/u/charlie");
      await (0, _testHelpers.click)("button.compose-pm");
      await (0, _testHelpers.click)(".modal .btn-default");
      const privateMessageUsers = (0, _selectKitHelper.default)("#private-message-users");
      assert.strictEqual(privateMessageUsers.header().value(), "codinghorror");
    });
    (0, _qunit.test)("Loads tags and category from draft payload", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        has_topic_draft: true
      });

      _sinon.default.stub(_draft.default, "get").resolves({
        draft: '{"reply":"Hey there","action":"createTopic","title":"Draft topic","categoryId":2,"tags":["fun", "times"],"archetypeId":"regular","metaData":null,"composerTime":25269,"typingTime":8100}',
        draft_sequence: 0,
        draft_key: _composer2.NEW_TOPIC_KEY
      });

      await (0, _testHelpers.visit)("/latest");
      assert.strictEqual((0, _qunitHelpers.query)("#create-topic").innerText.trim(), _I18n.default.t("topic.open_draft"));
      await (0, _testHelpers.click)("#create-topic");
      assert.strictEqual((0, _selectKitHelper.default)(".category-chooser").header().value(), "2");
      assert.strictEqual((0, _selectKitHelper.default)(".mini-tag-chooser").header().value(), "fun,times");
    });
    (0, _qunit.test)("Deleting the text content of the first post in a private message", async function (assert) {
      await (0, _testHelpers.visit)("/t/34");
      await (0, _testHelpers.click)("#post_1 .d-icon-ellipsis-h");
      await (0, _testHelpers.click)("#post_1 .d-icon-pencil-alt");
      await (0, _testHelpers.fillIn)(".d-editor-input", "");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-container textarea").getAttribute("placeholder"), _I18n.default.t("composer.reply_placeholder"), "it should not block because of missing category");
    });
    (0, _qunit.test)("reply button has envelope icon when replying to private message", async function (assert) {
      await (0, _testHelpers.visit)("/t/34");
      await (0, _testHelpers.click)("article#post_3 button.reply");
      assert.strictEqual((0, _qunitHelpers.query)(".save-or-cancel button.create").innerText.trim(), _I18n.default.t("composer.create_pm"), "reply button says Message");
      assert.strictEqual((0, _qunitHelpers.count)(".save-or-cancel button.create svg.d-icon-envelope"), 1, "reply button has envelope icon");
    });
    (0, _qunit.test)("edit button when editing a post in a PM", async function (assert) {
      await (0, _testHelpers.visit)("/t/34");
      await (0, _testHelpers.click)("article#post_3 button.show-more-actions");
      await (0, _testHelpers.click)("article#post_3 button.edit");
      assert.strictEqual((0, _qunitHelpers.query)(".save-or-cancel button.create").innerText.trim(), _I18n.default.t("composer.save_edit"), "save button says Save Edit");
      assert.strictEqual((0, _qunitHelpers.count)(".save-or-cancel button.create svg.d-icon-pencil-alt"), 1, "save button has pencil icon");
    });
    (0, _qunit.test)("Shows duplicate_link notice", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-buttons .create");
      this.container.lookup("controller:composer").set("linkLookup", new _linkLookup.default({
        "github.com": {
          domain: "github.com",
          username: "system",
          posted_at: "2021-01-01T12:00:00.000Z",
          post_number: 1
        }
      }));
      await (0, _testHelpers.fillIn)(".d-editor-input", "[](https://discourse.org)");
      assert.ok(!(0, _qunitHelpers.exists)(".composer-popup"));
      await (0, _testHelpers.fillIn)(".d-editor-input", "[quote][](https://github.com)[/quote]");
      assert.ok(!(0, _qunitHelpers.exists)(".composer-popup"));
      await (0, _testHelpers.fillIn)(".d-editor-input", "[](https://github.com)");
      assert.strictEqual((0, _qunitHelpers.count)(".composer-popup"), 1);
    });
    (0, _qunit.test)("Shows the 'group_mentioned' notice", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-buttons .create");
      await (0, _testHelpers.fillIn)(".d-editor-input", "[quote]\n@staff\n[/quote]");
      assert.notOk((0, _qunitHelpers.exists)(".composer-popup"), "Doesn't show the 'group_mentioned' notice in a quote");
      await (0, _testHelpers.fillIn)(".d-editor-input", "@staff");
      assert.ok((0, _qunitHelpers.exists)(".composer-popup"), "Shows the 'group_mentioned' notice");
    });
    (0, _qunit.test)("Does not save invalid draft", async function (assert) {
      this.siteSettings.min_first_post_length = 20;
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)("#reply-title", "Something");
      await (0, _testHelpers.fillIn)(".d-editor-input", "Something");
      await (0, _testHelpers.click)(".save-or-cancel .cancel");
      assert.notOk((0, _qunitHelpers.exists)(".discard-draft-modal .save-draft"));
    });
    (0, _qunit.test)("Saves drafts that only contain quotes", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-buttons .create");
      await (0, _testHelpers.fillIn)(".d-editor-input", "[quote]some quote[/quote]");
      await (0, _testHelpers.click)(".save-or-cancel .cancel");
      assert.ok((0, _qunitHelpers.exists)(".discard-draft-modal .save-draft"));
    });
  });
  (0, _qunitHelpers.acceptance)("Composer - Customizations", function (needs) {
    needs.user();
    needs.site({
      can_tag_topics: true
    });

    function customComposerAction(composer) {
      return (composer.tags || []).includes("monkey") && composer.action === _composer2.CREATE_TOPIC;
    }

    needs.hooks.beforeEach(() => {
      (0, _pluginApi.withPluginApi)("0.8.14", api => {
        api.customizeComposerText({
          actionTitle(model) {
            if (customComposerAction(model)) {
              return "custom text";
            }
          },

          saveLabel(model) {
            if (customComposerAction(model)) {
              return "composer.emoji";
            }
          }

        });
      });
    });
    (0, _qunit.test)("Supports text customization", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      assert.strictEqual((0, _qunitHelpers.query)(".action-title").innerText, _I18n.default.t("topic.create_long"));
      assert.strictEqual((0, _qunitHelpers.query)(".save-or-cancel button").innerText, _I18n.default.t("composer.create_topic"));
      const tags = (0, _selectKitHelper.default)(".mini-tag-chooser");
      await tags.expand();
      await tags.selectRowByValue("monkey");
      assert.strictEqual((0, _qunitHelpers.query)(".action-title").innerText, "custom text");
      assert.strictEqual((0, _qunitHelpers.query)(".save-or-cancel button").innerText, _I18n.default.t("composer.emoji"));
    });
  });
  (0, _qunitHelpers.acceptance)("Composer - Focus Open and Closed", function (needs) {
    needs.user();
    (0, _qunit.test)("Focusing a composer which is not open with create topic", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      const composer = this.container.lookup("controller:composer");
      await composer.focusComposer({
        fallbackToNewTopic: true
      });
      await (0, _testHelpers.settled)();
      assert.strictEqual(document.activeElement.classList.contains("d-editor-input"), true, "composer is opened and focused");
      assert.strictEqual(composer.model.action, _composer2.default.CREATE_TOPIC);
    });
    (0, _qunit.test)("Focusing a composer which is not open with create topic and append text", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      const composer = this.container.lookup("controller:composer");
      await composer.focusComposer({
        fallbackToNewTopic: true,
        insertText: "this is appended"
      });
      await (0, _testHelpers.settled)();
      assert.strictEqual(document.activeElement.classList.contains("d-editor-input"), true, "composer is opened and focused");
      assert.strictEqual((0, _qunitHelpers.query)("textarea.d-editor-input").value.trim(), "this is appended");
    });
    (0, _qunit.test)("Focusing a composer which is already open", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      const composer = this.container.lookup("controller:composer");
      await composer.focusComposer();
      await (0, _testHelpers.settled)();
      assert.strictEqual(document.activeElement.classList.contains("d-editor-input"), true, "composer is opened and focused");
    });
    (0, _qunit.test)("Focusing a composer which is already open and append text", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      const composer = this.container.lookup("controller:composer");
      await composer.focusComposer({
        insertText: "this is some appended text"
      });
      await (0, _testHelpers.settled)();
      assert.strictEqual(document.activeElement.classList.contains("d-editor-input"), true, "composer is opened and focused");
      assert.strictEqual((0, _qunitHelpers.query)("textarea.d-editor-input").value.trim(), "this is some appended text");
    });
    (0, _qunit.test)("Focusing a composer which is not open that has a draft", async function (assert) {
      await (0, _testHelpers.visit)("/t/this-is-a-test-topic/9");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.edit");
      await (0, _testHelpers.fillIn)(".d-editor-input", "This is a dirty reply");
      await (0, _testHelpers.click)(".toggle-minimize");
      const composer = this.container.lookup("controller:composer");
      await composer.focusComposer({
        insertText: "this is some appended text"
      });
      await (0, _testHelpers.settled)();
      assert.strictEqual(document.activeElement.classList.contains("d-editor-input"), true, "composer is opened and focused");
      assert.strictEqual((0, _qunitHelpers.query)("textarea.d-editor-input").value.trim(), "This is a dirty reply\n\nthis is some appended text");
    });
  });
});
define("discourse/tests/acceptance/composer-topic-links-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Composer topic featured links", function (needs) {
    needs.user();
    needs.settings({
      topic_featured_link_enabled: true,
      max_topic_title_length: 80,
      enable_markdown_linkify: true
    });
    (0, _qunit.test)("onebox with title", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)("#reply-title", "http://www.example.com/has-title.html");
      assert.ok((0, _qunitHelpers.query)(".d-editor-preview").innerHTML.trim().includes("onebox"), "it pastes the link into the body and previews it");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-textarea-wrapper .popup-tip.good"), "the body is now good");
      assert.strictEqual((0, _qunitHelpers.query)(".title-input input").value, "An interesting article", "title is from the oneboxed article");
    });
    (0, _qunit.test)("onebox result doesn't include a title", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)("#reply-title", "http://www.example.com/no-title.html");
      assert.ok((0, _qunitHelpers.query)(".d-editor-preview").innerHTML.trim().includes("onebox"), "it pastes the link into the body and previews it");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-textarea-wrapper .popup-tip.good"), "the body is now good");
      assert.strictEqual((0, _qunitHelpers.query)(".title-input input").value, "http://www.example.com/no-title.html", "title is unchanged");
    });
    (0, _qunit.test)("YouTube onebox with title", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)("#reply-title", "https://www.youtube.com/watch?v=dQw4w9WgXcQ");
      assert.strictEqual((0, _qunitHelpers.query)(".title-input input").value, "Rick Astley - Never Gonna Give You Up (Video)", "title is from the oneboxed article");
    });
    (0, _qunit.test)("no onebox result", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)("#reply-title", "http://www.example.com/nope-onebox.html");
      assert.ok((0, _qunitHelpers.query)(".d-editor-preview").innerHTML.trim().includes("onebox"), "it pastes the link into the body and previews it");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-textarea-wrapper .popup-tip.good"), "link is pasted into body");
      assert.strictEqual((0, _qunitHelpers.query)(".title-input input").value, "http://www.example.com/nope-onebox.html", "title is unchanged");
    });
    (0, _qunit.test)("ignore internal links", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      const title = "http://" + window.location.hostname + "/internal-page.html";
      await (0, _testHelpers.fillIn)("#reply-title", title);
      assert.ok(!(0, _qunitHelpers.query)(".d-editor-preview").innerHTML.trim().includes("onebox"), "onebox preview doesn't show");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value.length, 0, "link isn't put into the post");
      assert.strictEqual((0, _qunitHelpers.query)(".title-input input").value, title, "title is unchanged");
    });
    (0, _qunit.test)("link is longer than max title length", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)("#reply-title", "http://www.example.com/has-title-and-a-url-that-is-more-than-80-characters-because-thats-good-for-seo-i-guess.html");
      assert.ok((0, _qunitHelpers.query)(".d-editor-preview").innerHTML.trim().includes("onebox"), "it pastes the link into the body and previews it");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-textarea-wrapper .popup-tip.good"), "the body is now good");
      assert.strictEqual((0, _qunitHelpers.query)(".title-input input").value, "An interesting article", "title is from the oneboxed article");
    });
    (0, _qunit.test)("onebox with title but extra words in title field", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)("#reply-title", "http://www.example.com/has-title.html test");
      assert.ok(!(0, _qunitHelpers.query)(".d-editor-preview").innerHTML.trim().includes("onebox"), "onebox preview doesn't show");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value.length, 0, "link isn't put into the post");
      assert.strictEqual((0, _qunitHelpers.query)(".title-input input").value, "http://www.example.com/has-title.html test", "title is unchanged");
    });
    (0, _qunit.test)("blank title for Twitter link", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)("#reply-title", "https://twitter.com/discourse/status/1357664660724482048");
      assert.ok((0, _qunitHelpers.query)(".d-editor-preview").innerHTML.trim().includes("onebox"), "it pastes the link into the body and previews it");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-textarea-wrapper .popup-tip.good"), "the body is now good");
      assert.blank((0, _qunitHelpers.query)(".title-input input").value, "title is blank");
    });
  });
  (0, _qunitHelpers.acceptance)("Composer topic featured links when uncategorized is not allowed", function (needs) {
    needs.user({
      moderator: true,
      admin: false,
      trust_level: 1
    });
    needs.settings({
      topic_featured_link_enabled: true,
      max_topic_title_length: 80,
      enable_markdown_linkify: true,
      allow_uncategorized_topics: false
    });
    (0, _qunit.test)("Pasting a link enables the text input area", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-textarea-wrapper.disabled"), "textarea is disabled");
      await (0, _testHelpers.fillIn)("#reply-title", "http://www.example.com/has-title.html");
      assert.ok((0, _qunitHelpers.query)(".d-editor-preview").innerHTML.trim().includes("onebox"), "it pastes the link into the body and previews it");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-textarea-wrapper .popup-tip.good"), "the body is now good");
      assert.strictEqual((0, _qunitHelpers.query)(".title-input input").value, "An interesting article", "title is from the oneboxed article");
      assert.ok(!(0, _qunitHelpers.exists)(".d-editor-textarea-wrapper.disabled"), "textarea is enabled");
    });
  });
});
define("discourse/tests/acceptance/composer-uncategorized-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/tests/helpers/select-kit-helper", "qunit"], function (_qunitHelpers, _testHelpers, _selectKitHelper, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Composer disabled, uncategorized not allowed when any topic_template present", function (needs) {
    needs.user();
    needs.settings({
      enable_whispers: true,
      allow_uncategorized_topics: false
    });
    (0, _qunit.test)("Disable body until category is selected", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-input"), "the composer input is visible");
      assert.ok((0, _qunitHelpers.exists)(".title-input .popup-tip.bad.hide"), "title errors are hidden by default");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-textarea-wrapper .popup-tip.bad.hide"), "body errors are hidden by default");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-textarea-wrapper.disabled"), "textarea is disabled");
      assert.ok(!(0, _qunitHelpers.exists)("button.toggle-fullscreen"), "fullscreen button is not present");
      const categoryChooser = (0, _selectKitHelper.default)(".category-chooser");
      await categoryChooser.expand();
      await categoryChooser.selectRowByValue(2);
      assert.ok(!(0, _qunitHelpers.exists)(".d-editor-textarea-wrapper.disabled"), "textarea is enabled");
      await (0, _testHelpers.fillIn)(".d-editor-input", "Now I can type stuff");
      await categoryChooser.expand();
      await categoryChooser.selectRowByIndex(0);
      assert.ok(!(0, _qunitHelpers.exists)(".d-editor-textarea-wrapper.disabled"), "textarea is still enabled");
      assert.ok((0, _qunitHelpers.exists)("button.toggle-fullscreen"), "fullscreen button is present");
    });
  });
  (0, _qunitHelpers.acceptance)("Composer enabled, uncategorized not allowed when topic_template not present", function (needs) {
    needs.user();
    needs.settings({
      allow_uncategorized_topics: false
    });
    needs.site({
      categories: [{
        id: 1,
        name: "test won",
        slug: "test-won",
        permission: 1,
        topic_template: null
      }, {
        id: 2,
        name: "test too",
        slug: "test-too",
        permission: 1,
        topic_template: ""
      }, {
        id: 3,
        name: "test free",
        slug: "test-free",
        permission: 1,
        topic_template: null
      }]
    });
    (0, _qunit.test)("Enable composer/body if no topic templates present", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-input"), "the composer input is visible");
      assert.ok((0, _qunitHelpers.exists)(".category-input .popup-tip.bad.hide"), "category errors are hidden by default");
      assert.ok(!(0, _qunitHelpers.exists)(".d-editor-textarea-wrapper.disabled"), "textarea is enabled");
      assert.ok((0, _qunitHelpers.exists)("button.toggle-fullscreen"), "fullscreen button is present");
      await (0, _testHelpers.click)("#reply-control button.create");
      assert.ok((0, _qunitHelpers.exists)(".category-input .popup-tip.bad"), "it shows the choose a category error");
      const categoryChooser = (0, _selectKitHelper.default)(".category-chooser");
      await categoryChooser.expand();
      await categoryChooser.selectRowByValue(1);
      assert.ok(!(0, _qunitHelpers.exists)(".category-input .popup-tip.bad"), "category error removed after selecting category");
    });
  });
});
define("discourse/tests/acceptance/composer-uploads-uppy-test", ["discourse/tests/helpers/qunit-helpers", "discourse/lib/plugin-api", "bootbox", "discourse/lib/uploads", "@ember/test-helpers", "I18n", "qunit", "rsvp", "sinon"], function (_qunitHelpers, _pluginApi, _bootbox, _uploads, _testHelpers, _I18n, _qunit, _rsvp, _sinon) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"discourse/lib/plugin-api",0,"bootbox",0,"discourse/lib/uploads",0,"@ember/test-helpers",0,"I18n",0,"qunit",0,"rsvp",0,"sinon"eaimeta@70e063a35619d71f

  function pretender(server, helper) {
    server.post("/uploads/lookup-urls", () => {
      return helper.response([{
        url: "/images/discourse-logo-sketch-small.png",
        short_path: "/uploads/short-url/yoj8pf9DdIeHRRULyw7i57GAYdz.jpeg",
        short_url: "upload://yoj8pf9DdIeHRRULyw7i57GAYdz.jpeg"
      }]);
    });
    server.post("/uploads.json", () => {
      return helper.response({
        extension: "jpeg",
        filesize: 126177,
        height: 800,
        human_filesize: "123 KB",
        id: 202,
        original_filename: "avatar.PNG.jpg",
        retain_hours: null,
        short_path: "/uploads/short-url/yoj8pf9DdIeHRRULyw7i57GAYdz.jpeg",
        short_url: "upload://yoj8pf9DdIeHRRULyw7i57GAYdz.jpeg",
        thumbnail_height: 320,
        thumbnail_width: 690,
        url: "/images/discourse-logo-sketch-small.png",
        width: 1920
      });
    }, 500 // this delay is important to slow down the uploads a bit so we can click elements in the UI like the cancel button
    );
  }

  (0, _qunitHelpers.acceptance)("Uppy Composer Attachment - Upload Placeholder", function (needs) {
    needs.user();
    needs.pretender(pretender);
    needs.settings({
      simultaneous_uploads: 2,
      enable_rich_text_paste: true
    });
    (0, _qunit.test)("should insert the Uploading placeholder then the complete image placeholder", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)(".d-editor-input", "The image:\n");
      const appEvents = (0, _qunitHelpers.loggedInUser)().appEvents;
      const done = assert.async();
      appEvents.on("composer:all-uploads-complete", () => {
        assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "The image:\n![avatar.PNG|690x320](upload://yoj8pf9DdIeHRRULyw7i57GAYdz.jpeg)\n");
        done();
      });
      appEvents.on("composer:upload-started", () => {
        assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "The image:\n[Uploading: avatar.png...]()\n");
      });
      const image = (0, _qunitHelpers.createFile)("avatar.png");
      appEvents.trigger("composer:add-files", image);
    });
    (0, _qunit.test)("should handle placeholders correctly even if the OS rewrites ellipses", async function (assert) {
      const execCommand = document.execCommand;

      _sinon.default.stub(document, "execCommand").callsFake(function () {
        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
          args[_key] = arguments[_key];
        }

        if (args[0] === "insertText") {
          args[2] = args[2].replace("...", "");
        }

        return execCommand.call(document, ...args);
      });

      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)(".d-editor-input", "The image:\n");
      const appEvents = (0, _qunitHelpers.loggedInUser)().appEvents;
      const done = assert.async();
      appEvents.on("composer:all-uploads-complete", () => {
        assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "The image:\n![avatar.PNG|690x320](upload://yoj8pf9DdIeHRRULyw7i57GAYdz.jpeg)\n");
        done();
      });
      appEvents.on("composer:upload-started", () => {
        assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "The image:\n[Uploading: avatar.png]()\n");
      });
      const image = (0, _qunitHelpers.createFile)("avatar.png");
      appEvents.trigger("composer:add-files", image);
    });
    (0, _qunit.test)("should error if too many files are added at once", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      const appEvents = (0, _qunitHelpers.loggedInUser)().appEvents;
      const image = (0, _qunitHelpers.createFile)("avatar.png");
      const image1 = (0, _qunitHelpers.createFile)("avatar1.png");
      const image2 = (0, _qunitHelpers.createFile)("avatar2.png");
      const done = assert.async();
      appEvents.on("composer:uploads-aborted", async () => {
        assert.strictEqual((0, _qunitHelpers.query)(".bootbox .modal-body").innerHTML, _I18n.default.t("post.errors.too_many_dragged_and_dropped_files", {
          count: 2
        }), "it should warn about too many files added");
        await (0, _testHelpers.click)(".modal-footer .btn-primary");
        done();
      });
      appEvents.trigger("composer:add-files", [image, image1, image2]);
    });
    (0, _qunit.test)("should error if an unauthorized extension file is added", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      const appEvents = (0, _qunitHelpers.loggedInUser)().appEvents;
      const jsonFile = (0, _qunitHelpers.createFile)("something.json", "application/json");
      const done = assert.async();
      appEvents.on("composer:uploads-aborted", async () => {
        assert.strictEqual((0, _qunitHelpers.query)(".bootbox .modal-body").innerHTML, _I18n.default.t("post.errors.upload_not_authorized", {
          authorized_extensions: (0, _uploads.authorizedExtensions)(false, this.siteSettings).join(", ")
        }), "it should warn about unauthorized extensions");
        await (0, _testHelpers.click)(".modal-footer .btn-primary");
        done();
      });
      appEvents.trigger("composer:add-files", [jsonFile]);
    });
    (0, _qunit.test)("cancelling uploads clears the placeholders out", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)(".d-editor-input", "The image:\n");
      const image = (0, _qunitHelpers.createFile)("avatar.png");
      const image2 = (0, _qunitHelpers.createFile)("avatar2.png");
      const appEvents = (0, _qunitHelpers.loggedInUser)().appEvents;
      let uploadStarted = 0;
      appEvents.on("composer:upload-started", () => {
        uploadStarted++;

        if (uploadStarted === 2) {
          assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "The image:\n[Uploading: avatar.png...]()\n[Uploading: avatar2.png...]()\n", "it should show the upload placeholders when the upload starts");
        }
      });
      appEvents.on("composer:uploads-cancelled", () => {
        assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "The image:\n", "it should clear the cancelled placeholders");
      });
      await new _rsvp.Promise(function (resolve) {
        appEvents.on("composer:uploads-preprocessing-complete", function () {
          resolve();
        });
        appEvents.trigger("composer:add-files", [image, image2]);
      });
      await (0, _testHelpers.click)("#cancel-file-upload");
    });
    (0, _qunit.test)("should insert a newline before and after an image when pasting in the end of the line", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)(".d-editor-input", "The image:");
      const appEvents = (0, _qunitHelpers.loggedInUser)().appEvents;
      const done = assert.async();
      appEvents.on("composer:upload-started", () => {
        assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "The image:\n[Uploading: avatar.png...]()\n");
      });
      appEvents.on("composer:all-uploads-complete", () => {
        assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "The image:\n![avatar.PNG|690x320](upload://yoj8pf9DdIeHRRULyw7i57GAYdz.jpeg)\n");
        done();
      });
      const image = (0, _qunitHelpers.createFile)("avatar.png");
      appEvents.trigger("composer:add-files", image);
    });
    (0, _qunit.test)("should insert a newline before and after an image when pasting in the middle of the line", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)(".d-editor-input", "The image: Text after the image.");
      const textArea = (0, _qunitHelpers.query)(".d-editor-input");
      textArea.selectionStart = 10;
      textArea.selectionEnd = 10;
      const appEvents = (0, _qunitHelpers.loggedInUser)().appEvents;
      const done = assert.async();
      appEvents.on("composer:upload-started", () => {
        assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "The image:\n[Uploading: avatar.png...]()\n Text after the image.");
      });
      appEvents.on("composer:all-uploads-complete", () => {
        assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "The image:\n![avatar.PNG|690x320](upload://yoj8pf9DdIeHRRULyw7i57GAYdz.jpeg)\n Text after the image.");
        done();
      });
      const image = (0, _qunitHelpers.createFile)("avatar.png");
      appEvents.trigger("composer:add-files", image);
    });
    (0, _qunit.test)("should insert a newline before and after an image when pasting with text selected", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)(".d-editor-input", "The image: [paste here] Text after the image.");
      const textArea = (0, _qunitHelpers.query)(".d-editor-input");
      textArea.selectionStart = 10;
      textArea.selectionEnd = 23;
      const appEvents = (0, _qunitHelpers.loggedInUser)().appEvents;
      const done = assert.async();
      appEvents.on("composer:upload-started", () => {
        assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "The image:\n[Uploading: avatar.png...]()\n Text after the image.");
      });
      appEvents.on("composer:all-uploads-complete", () => {
        assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "The image:\n![avatar.PNG|690x320](upload://yoj8pf9DdIeHRRULyw7i57GAYdz.jpeg)\n Text after the image.");
        done();
      });
      const image = (0, _qunitHelpers.createFile)("avatar.png");
      appEvents.trigger("composer:add-files", image);
    });
    (0, _qunit.test)("should insert a newline only after an image when pasting into an empty composer", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      const appEvents = (0, _qunitHelpers.loggedInUser)().appEvents;
      const done = assert.async();
      appEvents.on("composer:upload-started", () => {
        assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "[Uploading: avatar.png...]()\n");
      });
      appEvents.on("composer:all-uploads-complete", () => {
        assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "![avatar.PNG|690x320](upload://yoj8pf9DdIeHRRULyw7i57GAYdz.jpeg)\n");
        done();
      });
      const image = (0, _qunitHelpers.createFile)("avatar.png");
      appEvents.trigger("composer:add-files", image);
    });
    (0, _qunit.test)("should insert a newline only after an image when pasting into a blank line", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)(".d-editor-input", "The image:\n");
      const appEvents = (0, _qunitHelpers.loggedInUser)().appEvents;
      const done = assert.async();
      appEvents.on("composer:upload-started", () => {
        assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "The image:\n[Uploading: avatar.png...]()\n");
      });
      appEvents.on("composer:all-uploads-complete", () => {
        assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "The image:\n![avatar.PNG|690x320](upload://yoj8pf9DdIeHRRULyw7i57GAYdz.jpeg)\n");
        done();
      });
      const image = (0, _qunitHelpers.createFile)("avatar.png");
      appEvents.trigger("composer:add-files", image);
    });
    (0, _qunit.skip)("should place cursor properly after inserting a placeholder", async function (assert) {
      const appEvents = (0, _qunitHelpers.loggedInUser)().appEvents;
      const done = assert.async();
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)(".d-editor-input", "The image:\ntext after image");
      const input = (0, _qunitHelpers.query)(".d-editor-input");
      input.selectionStart = 10;
      input.selectionEnd = 10;
      appEvents.on("composer:all-uploads-complete", () => {
        // after uploading we have this in the textarea:
        // "The image:\n![avatar.PNG|690x320](upload://yoj8pf9DdIeHRRULyw7i57GAYdz.jpeg)\ntext after image"
        // cursor should be just before "text after image":
        assert.equal(input.selectionStart, 76);
        assert.equal(input.selectionEnd, 76);
        done();
      });
      const image = (0, _qunitHelpers.createFile)("avatar.png");
      appEvents.trigger("composer:add-files", image);
    });
    (0, _qunit.test)("should be able to paste a table with files and not upload the files", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      const appEvents = (0, _qunitHelpers.loggedInUser)().appEvents;
      const done = assert.async();
      let uppyEventFired = false;
      appEvents.on("composer:upload-started", () => {
        uppyEventFired = true;
      });
      let element = (0, _qunitHelpers.query)(".d-editor");
      let inputElement = (0, _qunitHelpers.query)(".d-editor-input");
      inputElement.focus();
      await (0, _qunitHelpers.paste)(element, "\ta\tb\n1\t2\t3", {
        types: ["text/plain", "Files"],
        files: [(0, _qunitHelpers.createFile)("avatar.png")]
      });
      await (0, _testHelpers.settled)();
      assert.strictEqual(inputElement.value, "||a|b|\n|---|---|---|\n|1|2|3|\n", "only the plain text table is pasted");
      assert.strictEqual(uppyEventFired, false, "uppy does not start uploading the file");
      done();
    });
  });
  (0, _qunitHelpers.acceptance)("Uppy Composer Attachment - Upload Error", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.post("/uploads.json", () => {
        return helper.response(422, {
          success: false,
          errors: ["There was an error uploading the file, the gif was way too cool."]
        });
      });
    });
    needs.settings({
      simultaneous_uploads: 2
    });
    (0, _qunit.test)("should show an error message for the failed upload", async function (assert) {
      // Don't log the upload error
      const stub = _sinon.default.stub(console, "error").withArgs(_sinon.default.match(/\[Uppy\]/), _sinon.default.match(/Failed to upload avatar\.png/));

      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.fillIn)(".d-editor-input", "The image:\n");
      const appEvents = (0, _qunitHelpers.loggedInUser)().appEvents;
      const done = assert.async();
      appEvents.on("composer:upload-error", async () => {
        _sinon.default.assert.calledOnce(stub);

        assert.strictEqual((0, _qunitHelpers.query)(".bootbox .modal-body").innerHTML, "There was an error uploading the file, the gif was way too cool.", "it should show the error message from the server");
        await (0, _testHelpers.click)(".modal-footer .btn-primary");
        done();
      });
      const image = (0, _qunitHelpers.createFile)("avatar.png");
      appEvents.trigger("composer:add-files", image);
    });
  });
  (0, _qunitHelpers.acceptance)("Uppy Composer Attachment - Upload Handler", function (needs) {
    needs.user();
    needs.pretender(pretender);
    needs.settings({
      simultaneous_uploads: 2
    });
    needs.hooks.beforeEach(() => {
      (0, _pluginApi.withPluginApi)("0.8.14", api => {
        api.addComposerUploadHandler(["png"], files => {
          const file = files[0];
          const isNativeFile = file instanceof File ? "WAS" : "WAS NOT";

          _bootbox.default.alert(`This is an upload handler test for ${file.name}. The file ${isNativeFile} a native file object.`);
        });
      });
    });
    (0, _qunit.test)("should use upload handler if the matching extension is used and a single file is uploaded", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#create-topic");
      const image = (0, _qunitHelpers.createFile)("handler-test.png");
      const appEvents = (0, _qunitHelpers.loggedInUser)().appEvents;
      const done = assert.async();
      appEvents.on("composer:uploads-aborted", async () => {
        assert.strictEqual((0, _qunitHelpers.query)(".bootbox .modal-body").innerHTML, "This is an upload handler test for handler-test.png. The file WAS a native file object.", "it should show the bootbox triggered by the upload handler");
        await (0, _testHelpers.click)(".modal-footer .btn");
        done();
      });
      appEvents.trigger("composer:add-files", [image]);
    });
  });
});
define("discourse/tests/acceptance/create-account-external-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  function setupAuthData(data) {
    data = {
      auth_provider: "test",
      email: "blah@example.com",
      can_edit_username: true,
      can_edit_name: true,
      ...data
    };
    const node = document.createElement("meta");
    node.dataset.authenticationData = JSON.stringify(data);
    node.id = "data-authentication";
    document.querySelector("head").appendChild(node);
  }

  (0, _qunitHelpers.acceptance)("Create Account - external auth", function (needs) {
    needs.hooks.beforeEach(() => {
      setupAuthData();
    });
    needs.hooks.afterEach(() => {
      document.querySelector("head").removeChild(document.getElementById("data-authentication"));
    });
    (0, _qunit.test)("when skip is disabled (default)", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)("#discourse-modal div.create-account-body"), "it shows the registration modal");
      assert.ok((0, _qunitHelpers.exists)("#new-account-username"), "it shows the fields");
      assert.notOk((0, _qunitHelpers.exists)(".create-account-associate-link"), "it does not show the associate link");
    });
    (0, _qunit.test)("when skip is enabled", async function (assert) {
      this.siteSettings.auth_skip_create_confirm = true;
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)("#discourse-modal div.create-account-body"), "it shows the registration modal");
      assert.notOk((0, _qunitHelpers.exists)("#new-account-username"), "it does not show the fields");
    });
  });
  (0, _qunitHelpers.acceptance)("Create account - with associate link", function (needs) {
    needs.hooks.beforeEach(() => {
      setupAuthData({
        associate_url: "/associate/abcde"
      });
    });
    needs.hooks.afterEach(() => {
      document.querySelector("head").removeChild(document.getElementById("data-authentication"));
    });
    (0, _qunit.test)("displays associate link when allowed", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)("#discourse-modal div.create-account-body"), "it shows the registration modal");
      assert.ok((0, _qunitHelpers.exists)("#new-account-username"), "it shows the fields");
      assert.ok((0, _qunitHelpers.exists)(".create-account-associate-link"), "it shows the associate link");
    });
  });
});
define("discourse/tests/acceptance/create-account-user-fields-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Create Account - User Fields", function (needs) {
    needs.site({
      user_fields: [{
        id: 34,
        name: "I've read the terms of service",
        field_type: "confirm",
        required: true
      }, {
        id: 35,
        name: "What is your pet's name?",
        field_type: "text",
        required: true
      }, {
        id: 36,
        name: "What's your dad like?",
        field_type: "text",
        required: false
      }]
    });
    (0, _qunit.test)("create account with user fields", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("header .sign-up-button");
      assert.ok((0, _qunitHelpers.exists)(".create-account"), "it shows the create account modal");
      assert.ok((0, _qunitHelpers.exists)(".user-field"), "it has at least one user field");
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
      assert.strictEqual((0, _qunitHelpers.query)("#account-email-validation").innerText.trim(), "Please enter an email address");
      await (0, _testHelpers.fillIn)("#new-account-name", "Dr. Good Tuna");
      await (0, _testHelpers.fillIn)("#new-account-password", "cool password bro"); // without this double fill, field will sometimes being empty
      // got consistent repro by having browser search bar focused when starting test

      await (0, _testHelpers.fillIn)("#new-account-email", "good.tuna@test.com");
      await (0, _testHelpers.fillIn)("#new-account-email", "good.tuna@test.com");
      await (0, _testHelpers.fillIn)("#new-account-username", "goodtuna");
      assert.ok((0, _qunitHelpers.exists)("#username-validation.good"), "the username validation is good");
      assert.ok((0, _qunitHelpers.exists)("#account-email-validation.good"), "the email validation is good");
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
      await (0, _testHelpers.fillIn)(".user-field input[type=text]:nth-of-type(1)", "Barky");
      await (0, _testHelpers.click)(".user-field input[type=checkbox]");
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
    });
    (0, _qunit.test)("can submit with enter", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("header .sign-up-button");
      await (0, _testHelpers.triggerKeyEvent)(".modal-footer .btn-primary", "keydown", "Enter");
      assert.strictEqual((0, _qunitHelpers.count)("#modal-alert:visible"), 1, "hitting Enter triggers action");
    });
  });
});
define("discourse/tests/acceptance/create-invite-modal-test", ["@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "I18n", "qunit"], function (_testHelpers, _qunitHelpers, _I18n, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"I18n",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Invites - Create & Edit Invite Modal", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      const inviteData = {
        id: 1,
        invite_key: "52641ae8878790bc7b79916247cfe6ba",
        link: "http://example.com/invites/52641ae8878790bc7b79916247cfe6ba",
        max_redemptions_allowed: 1,
        redemption_count: 0,
        created_at: "2021-01-26T12:00:00.000Z",
        updated_at: "2021-01-26T12:00:00.000Z",
        expires_at: "2121-01-26T12:00:00.000Z",
        expired: false,
        topics: [],
        groups: []
      };
      server.post("/invites", () => helper.response(inviteData));
      server.put("/invites/1", request => {
        const data = helper.parsePostData(request.requestBody);

        if (data.email === "error") {
          return helper.response(422, {
            errors: ["error isn't a valid email address."]
          });
        } else {
          return helper.response(inviteData);
        }
      });
      server.delete("/invites", () => {
        return helper.response({});
      });
    });
    (0, _qunit.test)("basic functionality", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/invited/pending");
      await (0, _testHelpers.click)(".user-invite-buttons .btn:first-child");
      await assert.ok((0, _qunitHelpers.exists)(".invite-to-groups"));
      await assert.ok((0, _qunitHelpers.exists)(".invite-to-topic"));
      await assert.ok((0, _qunitHelpers.exists)(".invite-expires-at"));
    });
    (0, _qunit.test)("saving", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/invited/pending");
      await (0, _testHelpers.click)(".user-invite-buttons .btn:first-child");
      assert.ok(!(0, _qunitHelpers.exists)("tbody tr"), "does not show invite before saving");
      await (0, _testHelpers.click)(".btn-primary");
      assert.strictEqual((0, _qunitHelpers.count)("tbody tr"), 1, "adds invite to list after saving");
    });
    (0, _qunit.test)("copying saves invite", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/invited/pending");
      await (0, _testHelpers.click)(".user-invite-buttons .btn:first-child");
      await (0, _testHelpers.click)(".save-invite");
      assert.ok((0, _qunitHelpers.exists)(".invite-link .btn"));
    });
  });
  (0, _qunitHelpers.acceptance)("Invites - Link Invites", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      const inviteData = {
        id: 1,
        invite_key: "52641ae8878790bc7b79916247cfe6ba",
        link: "http://example.com/invites/52641ae8878790bc7b79916247cfe6ba",
        max_redemptions_allowed: 1,
        redemption_count: 0,
        created_at: "2021-01-26T12:00:00.000Z",
        updated_at: "2021-01-26T12:00:00.000Z",
        expires_at: "2121-01-26T12:00:00.000Z",
        expired: false,
        topics: [],
        groups: []
      };
      server.post("/invites", () => helper.response(inviteData));
      server.put("/invites/1", () => helper.response(inviteData));
      server.delete("/invites", () => helper.response({}));
    });
    (0, _qunit.test)("invite links", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/invited/pending");
      await (0, _testHelpers.click)(".user-invite-buttons .btn:first-child");
      assert.ok((0, _qunitHelpers.exists)("#invite-max-redemptions"), "shows max redemptions field");
    });
  });
  (0, _qunitHelpers.acceptance)("Invites - Email Invites", function (needs) {
    let lastRequest;
    needs.user();
    needs.pretender((server, helper) => {
      const inviteData = {
        id: 1,
        invite_key: "52641ae8878790bc7b79916247cfe6ba",
        link: "http://example.com/invites/52641ae8878790bc7b79916247cfe6ba",
        email: "test@example.com",
        emailed: false,
        custom_message: null,
        created_at: "2021-01-26T12:00:00.000Z",
        updated_at: "2021-01-26T12:00:00.000Z",
        expires_at: "2121-01-26T12:00:00.000Z",
        expired: false,
        topics: [],
        groups: []
      };
      server.post("/invites", request => {
        lastRequest = request;
        return helper.response(inviteData);
      });
      server.put("/invites/1", request => {
        lastRequest = request;
        return helper.response(inviteData);
      });
    });
    needs.hooks.beforeEach(() => {
      lastRequest = null;
    });
    (0, _qunit.test)("invite email", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/invited/pending");
      await (0, _testHelpers.click)(".user-invite-buttons .btn:first-child");
      assert.ok((0, _qunitHelpers.exists)("#invite-email"), "shows email field");
      await (0, _testHelpers.fillIn)("#invite-email", "test@example.com");
      assert.ok((0, _qunitHelpers.exists)(".save-invite"), "shows save without email button");
      await (0, _testHelpers.click)(".save-invite");
      assert.ok(lastRequest.requestBody.includes("skip_email=true"), "sends skip_email to server");
      await (0, _testHelpers.fillIn)("#invite-email", "test2@example.com");
      assert.ok((0, _qunitHelpers.exists)(".send-invite"), "shows save and send email button");
      await (0, _testHelpers.click)(".send-invite");
      assert.ok(lastRequest.requestBody.includes("send_email=true"), "sends send_email to server");
    });
  });
  (0, _qunitHelpers.acceptance)("Invites - Create & Edit Invite Modal - timeframe choosing", function (needs) {
    let clock = null;
    needs.user();
    needs.pretender((server, helper) => {
      const inviteData = {
        id: 1,
        invite_key: "52641ae8878790bc7b79916247cfe6ba",
        link: "http://example.com/invites/52641ae8878790bc7b79916247cfe6ba",
        max_redemptions_allowed: 1,
        redemption_count: 0,
        created_at: "2021-01-26T12:00:00.000Z",
        updated_at: "2021-01-26T12:00:00.000Z",
        expires_at: "2121-01-26T12:00:00.000Z",
        expired: false,
        topics: [],
        groups: []
      };
      server.post("/invites", () => helper.response(inviteData));
      server.put("/invites/1", () => helper.response(inviteData));
    });
    needs.hooks.beforeEach(() => {
      const timezone = (0, _qunitHelpers.loggedInUser)().timezone;
      clock = (0, _qunitHelpers.fakeTime)("2100-05-03T08:00:00", timezone, true); // Monday morning
    });
    needs.hooks.afterEach(() => {
      clock.restore();
    });
    (0, _qunit.test)("shows correct timeframe options", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/invited/pending");
      await (0, _testHelpers.click)(".user-invite-buttons .btn:first-child");
      await (0, _testHelpers.click)(".future-date-input-selector-header");
      const options = Array.from((0, _qunitHelpers.queryAll)(`ul.select-kit-collection li span.name`).map((_, x) => x.innerText.trim()));
      const expected = [_I18n.default.t("time_shortcut.later_today"), _I18n.default.t("time_shortcut.tomorrow"), _I18n.default.t("time_shortcut.later_this_week"), _I18n.default.t("time_shortcut.start_of_next_business_week_alt"), _I18n.default.t("time_shortcut.two_weeks"), _I18n.default.t("time_shortcut.next_month"), _I18n.default.t("time_shortcut.two_months"), _I18n.default.t("time_shortcut.three_months"), _I18n.default.t("time_shortcut.four_months"), _I18n.default.t("time_shortcut.six_months"), _I18n.default.t("time_shortcut.custom")];
      assert.deepEqual(options, expected, "options are correct");
    });
  });
});
define("discourse/tests/acceptance/custom-html-set-test", ["discourse/tests/helpers/qunit-helpers", "discourse/lib/preload-store", "discourse/helpers/custom-html", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _preloadStore, _customHtml, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"discourse/lib/preload-store",0,"discourse/helpers/custom-html",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("CustomHTML set", function () {
    (0, _qunit.test)("has no custom HTML in the top", async function (assert) {
      await (0, _testHelpers.visit)("/static/faq");
      assert.ok(!(0, _qunitHelpers.exists)("span.custom-html-test"), "it has no markup");
    });
    (0, _qunit.test)("renders set HTML", async function (assert) {
      (0, _customHtml.setCustomHTML)("top", '<span class="custom-html-test">HTML</span>');
      await (0, _testHelpers.visit)("/static/faq");
      assert.strictEqual((0, _qunitHelpers.query)("span.custom-html-test").innerText, "HTML", "it inserted the markup");
    });
    (0, _qunit.test)("renders preloaded HTML", async function (assert) {
      _preloadStore.default.store("customHTML", {
        top: "<span class='cookie'>monster</span>"
      });

      await (0, _testHelpers.visit)("/static/faq");
      assert.strictEqual((0, _qunitHelpers.query)("span.cookie").innerText, "monster", "it inserted the markup");
    });
  });
});
define("discourse/tests/acceptance/custom-html-template-test", ["@ember/template-factory", "discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers"], function (_templateFactory, _qunitHelpers, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("CustomHTML template", function (needs) {
    needs.hooks.beforeEach(() => {
      // eslint-disable-next-line no-undef
      Ember.TEMPLATES["top"] = (0, _templateFactory.createTemplateFactory)(
      /*
        <span class='top-span'>TOP</span>
      */
      {
        "id": "0FJmCndm",
        "block": "[[[10,1],[14,0,\"top-span\"],[12],[1,\"TOP\"],[13]],[],false,[]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      });
    });
    needs.hooks.afterEach(() => {
      // eslint-disable-next-line no-undef
      delete Ember.TEMPLATES["top"];
    });
    (0, _qunit.test)("renders custom template", async function (assert) {
      await (0, _testHelpers.visit)("/static/faq");
      assert.strictEqual((0, _qunitHelpers.query)("span.top-span").innerText, "TOP", "it inserted the template");
    });
  });
});
define("discourse/tests/acceptance/dashboard-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/tests/helpers/select-kit-helper", "qunit"], function (_qunitHelpers, _testHelpers, _selectKitHelper, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Dashboard", function (needs) {
    needs.user();
    needs.settings({
      dashboard_visible_tabs: "moderation|security|reports",
      dashboard_general_tab_activity_metrics: "page_view_total_reqs"
    });
    needs.site({
      groups: [{
        id: 88,
        name: "tl1"
      }, {
        id: 89,
        name: "tl2"
      }]
    });
    (0, _qunit.test)("default", async function (assert) {
      await (0, _testHelpers.visit)("/admin");
      assert.ok((0, _qunitHelpers.exists)(".dashboard"), "has dashboard-next class");
    });
    (0, _qunit.test)("tabs", async function (assert) {
      await (0, _testHelpers.visit)("/admin");
      assert.ok((0, _qunitHelpers.exists)(".dashboard .navigation-item.general"), "general tab");
      assert.ok((0, _qunitHelpers.exists)(".dashboard .navigation-item.moderation"), "moderation tab");
      assert.ok((0, _qunitHelpers.exists)(".dashboard .navigation-item.security"), "security tab");
      assert.ok((0, _qunitHelpers.exists)(".dashboard .navigation-item.reports"), "reports tab");
    });
    (0, _qunit.test)("general tab", async function (assert) {
      await (0, _testHelpers.visit)("/admin");
      assert.ok((0, _qunitHelpers.exists)(".admin-report.signups"), "signups report");
      assert.ok((0, _qunitHelpers.exists)(".admin-report.posts"), "posts report");
      assert.ok((0, _qunitHelpers.exists)(".admin-report.dau-by-mau"), "dau-by-mau report");
      assert.ok((0, _qunitHelpers.exists)(".admin-report.daily-engaged-users"), "daily-engaged-users report");
      assert.ok((0, _qunitHelpers.exists)(".admin-report.new-contributors"), "new-contributors report");
      assert.strictEqual((0, _qunitHelpers.query)(".section.dashboard-problems .problem-messages ul li:first-child").innerHTML.trim(), "Houston...", "displays problems");
    });
    (0, _qunit.test)("activity metrics", async function (assert) {
      await (0, _testHelpers.visit)("/admin");
      assert.ok((0, _qunitHelpers.exists)(".admin-report.page-view-total-reqs .today-count"));
      assert.ok((0, _qunitHelpers.exists)(".admin-report.page-view-total-reqs .yesterday-count"));
      assert.ok((0, _qunitHelpers.exists)(".admin-report.page-view-total-reqs .sevendays-count"));
      assert.ok((0, _qunitHelpers.exists)(".admin-report.page-view-total-reqs .thirty-days-count"));
    });
    (0, _qunit.test)("reports tab", async function (assert) {
      await (0, _testHelpers.visit)("/admin");
      await (0, _testHelpers.click)(".dashboard .navigation-item.reports .navigation-link");
      assert.strictEqual((0, _qunitHelpers.count)(".dashboard .reports-index.section .reports-list .report"), 1);
      await (0, _testHelpers.fillIn)(".dashboard .filter-reports-input", "flags");
      assert.strictEqual((0, _qunitHelpers.count)(".dashboard .reports-index.section .reports-list .report"), 0);
      await (0, _testHelpers.click)(".dashboard .navigation-item.security .navigation-link");
      await (0, _testHelpers.click)(".dashboard .navigation-item.reports .navigation-link");
      assert.strictEqual((0, _qunitHelpers.count)(".dashboard .reports-index.section .reports-list .report"), 1, "navigating back and forth resets filter");
      await (0, _testHelpers.fillIn)(".dashboard .filter-reports-input", "activities");
      assert.strictEqual((0, _qunitHelpers.count)(".dashboard .reports-index.section .reports-list .report"), 1, "filter is case insensitive");
    });
    (0, _qunit.test)("reports filters", async function (assert) {
      await (0, _testHelpers.visit)('/admin/reports/signups_with_groups?end_date=2018-07-16&filters=%7B"group"%3A88%7D&start_date=2018-06-16');
      const groupFilter = (0, _selectKitHelper.default)(".group-filter .combo-box");
      assert.strictEqual(groupFilter.header().value(), "88", "its set the value of the filter from the query params");
    });
    (0, _qunit.test)("new features", async function (assert) {
      await (0, _testHelpers.visit)("/admin");
      assert.ok((0, _qunitHelpers.exists)(".dashboard-new-features"));
      assert.ok((0, _qunitHelpers.exists)(".dashboard-new-features .new-features-release-notes"));
    });
  });
  (0, _qunitHelpers.acceptance)("Dashboard: dashboard_visible_tabs", function (needs) {
    needs.user();
    needs.settings({
      dashboard_visible_tabs: "general|security|reports"
    });
    (0, _qunit.test)("visible tabs", async function (assert) {
      await (0, _testHelpers.visit)("/admin");
      assert.ok((0, _qunitHelpers.exists)(".dashboard .navigation-item.general"), "general tab");
      assert.notOk((0, _qunitHelpers.exists)(".dashboard .navigation-item.moderation"), "moderation tab");
      assert.ok((0, _qunitHelpers.exists)(".dashboard .navigation-item.security"), "security tab");
      assert.ok((0, _qunitHelpers.exists)(".dashboard .navigation-item.reports"), "reports tab");
    });
  });
  (0, _qunitHelpers.acceptance)("Dashboard: dashboard_hidden_reports", function (needs) {
    needs.user();
    needs.settings({
      dashboard_visible_tabs: "reports",
      dashboard_hidden_reports: "posts|dau_by_mau"
    });
    (0, _qunit.test)("hidden reports", async function (assert) {
      await (0, _testHelpers.visit)("/admin");
      assert.ok((0, _qunitHelpers.exists)(".admin-report.signups.is-visible"), "signups report");
      assert.notOk((0, _qunitHelpers.exists)(".admin-report.is-visible.posts"), "posts report");
      assert.notOk((0, _qunitHelpers.exists)(".admin-report.is-visible.dau-by-mau"), "dau-by-mau report");
    });
  });
});
define("discourse/tests/acceptance/dismiss-notification-modal-test", ["@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "I18n", "qunit", "discourse/tests/helpers/create-pretender"], function (_testHelpers, _qunitHelpers, _I18n, _qunit, _createPretender) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"I18n",0,"qunit",0,"discourse/tests/helpers/create-pretender"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Dismiss notification confirmation", function (needs) {
    needs.user();
    (0, _qunit.test)("does not show modal when no high priority notifications", async function (assert) {
      _createPretender.default.put("/notifications/mark-read", () => (0, _createPretender.response)({
        success: true
      }));

      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".current-user");
      await (0, _testHelpers.click)(".notifications-dismiss");
      assert.notOk((0, _qunitHelpers.exists)(".dismiss-notification-confirmation"));
    });
    (0, _qunit.test)("shows confirmation modal", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        unread_high_priority_notifications: 2
      });
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".current-user");
      await (0, _testHelpers.click)(".notifications-dismiss");
      assert.ok((0, _qunitHelpers.exists)(".dismiss-notification-confirmation"));
      assert.strictEqual((0, _qunitHelpers.query)(".dismiss-notification-confirmation-modal .modal-body").innerText, _I18n.default.t("notifications.dismiss_confirmation.body.default", {
        count: 2
      }));
    });
    (0, _qunit.test)("marks unread when confirm and closes modal", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        unread_high_priority_notifications: 2
      });
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".current-user");
      await (0, _testHelpers.click)(".notifications-dismiss");
      assert.strictEqual((0, _qunitHelpers.query)(".dismiss-notification-confirmation-modal .btn-primary").innerText, _I18n.default.t("notifications.dismiss_confirmation.dismiss"));

      _createPretender.default.put("/notifications/mark-read", () => (0, _createPretender.response)({
        success: true
      }));

      await (0, _testHelpers.click)(".dismiss-notification-confirmation-modal .btn-primary");
      assert.notOk((0, _qunitHelpers.exists)(".dismiss-notification-confirmation"));
    });
    (0, _qunit.test)("does marks unread when cancel and closes modal", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        unread_high_priority_notifications: 2
      });
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".current-user");
      await (0, _testHelpers.click)(".notifications-dismiss");
      assert.strictEqual((0, _qunitHelpers.query)(".dismiss-notification-confirmation-modal .btn-default").innerText, _I18n.default.t("notifications.dismiss_confirmation.cancel"));
      await (0, _testHelpers.click)(".dismiss-notification-confirmation-modal .btn-default");
      assert.notOk((0, _qunitHelpers.exists)(".dismiss-notification-confirmation"));
    });
  });
});
define("discourse/tests/acceptance/do-not-disturb-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Do not disturb", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.post("/do-not-disturb.json", () => {
        let now = new Date();
        now.setHours(now.getHours() + 1);
        return helper.response({
          ends_at: now
        });
      });
      server.delete("/do-not-disturb.json", () => helper.response({
        success: true
      }));
    });
    (0, _qunit.test)("when turned off, it is turned on from modal", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        do_not_disturb_until: null
      });
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".header-dropdown-toggle.current-user");
      await (0, _testHelpers.click)(".menu-links-row .user-preferences-link");
      await (0, _testHelpers.click)(".do-not-disturb");
      assert.ok((0, _qunitHelpers.exists)(".do-not-disturb-modal"), "modal to choose time appears");
      let tiles = (0, _qunitHelpers.queryAll)(".do-not-disturb-tile");
      assert.ok(tiles.length === 4, "There are 4 duration choices");
      await (0, _testHelpers.click)(tiles[0]);
      assert.ok((0, _qunitHelpers.query)(".do-not-disturb-modal.hidden"), "modal is hidden");
      assert.ok((0, _qunitHelpers.exists)(".header-dropdown-toggle .do-not-disturb-background .d-icon-moon"), "moon icon is present in header");
    });
    (0, _qunit.test)("Can be invoked via keyboard", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        do_not_disturb_until: null
      });
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".header-dropdown-toggle.current-user");
      await (0, _testHelpers.click)(".menu-links-row .user-preferences-link");
      await (0, _testHelpers.click)(".do-not-disturb");
      assert.ok((0, _qunitHelpers.exists)(".do-not-disturb-modal"), "DND modal is displayed");
      assert.strictEqual((0, _qunitHelpers.count)(".do-not-disturb-tile"), 4, "There are 4 duration choices");
      await (0, _testHelpers.triggerKeyEvent)(".do-not-disturb-tile:nth-child(1)", "keydown", "Enter");
      assert.ok((0, _qunitHelpers.query)(".do-not-disturb-modal.hidden"), "DND modal is hidden after making a choice");
      assert.ok((0, _qunitHelpers.exists)(".header-dropdown-toggle .do-not-disturb-background .d-icon-moon"), "moon icon is shown in header avatar");
    });
    (0, _qunit.test)("when turned on, it can be turned off", async function (assert) {
      let now = new Date();
      now.setHours(now.getHours() + 1);
      (0, _qunitHelpers.updateCurrentUser)({
        do_not_disturb_until: now
      });
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".header-dropdown-toggle.current-user");
      await (0, _testHelpers.click)(".menu-links-row .user-preferences-link");
      assert.strictEqual((0, _qunitHelpers.query)(".do-not-disturb .relative-date").textContent, "1h");
      await (0, _testHelpers.click)(".do-not-disturb");
      assert.ok(!(0, _qunitHelpers.exists)(".do-not-disturb-background"), "The active moon icons are removed");
    });
  });
  (0, _qunitHelpers.acceptance)("Do not disturb - new user menu", function (needs) {
    needs.user({
      redesigned_user_menu_enabled: true
    });
    needs.pretender((server, helper) => {
      server.post("/do-not-disturb.json", () => {
        const now = new Date();
        now.setHours(now.getHours() + 1);
        return helper.response({
          ends_at: now
        });
      });
      server.delete("/do-not-disturb.json", () => helper.response({
        success: true
      }));
    });
    (0, _qunit.test)("when turned off, it is turned on from modal", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        do_not_disturb_until: null
      });
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".header-dropdown-toggle.current-user");
      await (0, _testHelpers.click)("#user-menu-button-profile");
      await (0, _testHelpers.click)("#quick-access-profile .do-not-disturb .btn");
      assert.ok((0, _qunitHelpers.exists)(".do-not-disturb-modal"), "modal to choose time appears");
      let tiles = (0, _qunitHelpers.queryAll)(".do-not-disturb-tile");
      assert.ok(tiles.length === 4, "There are 4 duration choices");
      await (0, _testHelpers.click)(tiles[0]);
      assert.ok((0, _qunitHelpers.query)(".do-not-disturb-modal.hidden"), "modal is hidden");
      assert.ok((0, _qunitHelpers.exists)(".header-dropdown-toggle .do-not-disturb-background .d-icon-moon"), "moon icon is present in header");
    });
    (0, _qunit.test)("Can be invoked via keyboard", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        do_not_disturb_until: null
      });
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".header-dropdown-toggle.current-user");
      await (0, _testHelpers.click)("#user-menu-button-profile");
      await (0, _testHelpers.click)("#quick-access-profile .do-not-disturb .btn");
      assert.ok((0, _qunitHelpers.exists)(".do-not-disturb-modal"), "DND modal is displayed");
      assert.strictEqual((0, _qunitHelpers.count)(".do-not-disturb-tile"), 4, "There are 4 duration choices");
      await (0, _testHelpers.triggerKeyEvent)(".do-not-disturb-tile:nth-child(1)", "keydown", "Enter");
      assert.ok((0, _qunitHelpers.query)(".do-not-disturb-modal.hidden"), "DND modal is hidden after making a choice");
      assert.ok((0, _qunitHelpers.exists)(".header-dropdown-toggle .do-not-disturb-background .d-icon-moon"), "moon icon is shown in header avatar");
    });
    (0, _qunit.test)("when turned on, it can be turned off", async function (assert) {
      const now = new Date();
      now.setHours(now.getHours() + 1);
      (0, _qunitHelpers.updateCurrentUser)({
        do_not_disturb_until: now
      });
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)(".do-not-disturb-background"), "The active moon icon is shown");
      await (0, _testHelpers.click)(".header-dropdown-toggle.current-user");
      await (0, _testHelpers.click)("#user-menu-button-profile");
      assert.strictEqual((0, _qunitHelpers.query)(".do-not-disturb .relative-date").textContent.trim(), "1h", "the Do Not Disturb button shows how much time is left for DND mode");
      assert.ok((0, _qunitHelpers.exists)(".do-not-disturb .d-icon-toggle-on"), "the Do Not Disturb button has the toggle-on icon");
      await (0, _testHelpers.click)("#quick-access-profile .do-not-disturb .btn");
      assert.notOk((0, _qunitHelpers.exists)(".do-not-disturb-background"), "The active moon icons are removed");
      assert.notOk((0, _qunitHelpers.exists)(".do-not-disturb .relative-date"), "the text showing how much time is left for DND mode is gone");
      assert.ok((0, _qunitHelpers.exists)(".do-not-disturb .d-icon-toggle-off"), "the Do Not Disturb button has the toggle-off icon");
    });
    (0, _qunit.test)("user menu gets closed when the DnD modal is opened", async function (assert) {
      this.siteSettings.enable_user_status = true;
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".header-dropdown-toggle.current-user");
      await (0, _testHelpers.click)("#user-menu-button-profile");
      await (0, _testHelpers.click)("#quick-access-profile .do-not-disturb .btn");
      assert.notOk((0, _qunitHelpers.exists)(".user-menu"));
    });
  });
});
define("discourse/tests/acceptance/edit-notification-click-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Edit Notification Click", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/posts/133/revisions/1.json", () => {
        return helper.response({
          created_at: "2021-07-30T11:19:59.549Z",
          post_id: 133,
          previous_hidden: false,
          current_hidden: false,
          first_revision: 2,
          previous_revision: null,
          current_revision: 2,
          next_revision: null,
          last_revision: 2,
          current_version: 2,
          version_count: 2,
          username: "velesin",
          display_username: "velesin",
          avatar_template: "/letter_avatar_proxy/v4/letter/j/13edae/{size}.png",
          edit_reason: null,
          body_changes: {
            inline: '<div class="inline-diff"><p>Hello world this is a test</p><p class="diff-ins">another edit!</p></div>',
            side_by_side: '<div class="revision-content"><p>Hello world this is a test</p></div><div class="revision-content"><p>Hello world this is a test</p><p class="diff-ins">This is an edit!</p></div>',
            side_by_side_markdown: '<table class="markdown"><tr><td class="diff-del">Hello world this is a test</td><td class="diff-ins">Hello world this is a test<ins>\n\nThis is an edit!</ins></td></tr></table>'
          },
          title_changes: null,
          user_changes: null,
          wiki: false,
          can_edit: true
        });
      });
    });
    (0, _qunit.test)("history modal is shown when navigating from a non-topic page", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".d-header-icons #current-user");
      await (0, _testHelpers.click)("#quick-access-notifications .edited");
      const [v1, v2] = (0, _qunitHelpers.queryAll)(".history-modal .revision-content");
      assert.strictEqual(v1.textContent.trim(), "Hello world this is a test", "history modal for the edited post is shown");
      assert.strictEqual(v2.textContent.trim(), "Hello world this is a testThis is an edit!", "history modal for the edited post is shown");
    });
  });
});
define("discourse/tests/acceptance/email-notice-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers", "I18n"], function (_qunitHelpers, _qunit, _testHelpers, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Email Disabled Banner", function (needs) {
    needs.user();
    (0, _qunit.test)("when disabled", async function (assert) {
      this.siteSettings.disable_emails = "no";
      await (0, _testHelpers.visit)("/");
      assert.notOk((0, _qunitHelpers.exists)(".alert-emails-disabled"), "alert is not displayed when email enabled");
    });
    (0, _qunit.test)("when enabled", async function (assert) {
      this.siteSettings.disable_emails = "yes";
      await (0, _testHelpers.visit)("/latest");
      assert.ok((0, _qunitHelpers.exists)(".alert-emails-disabled"), "alert is displayed when email disabled");
      assert.strictEqual((0, _qunitHelpers.query)(".alert-emails-disabled").innerText, _I18n.default.t("emails_are_disabled"), "alert uses the correct text");
    });
    (0, _qunit.test)("when non-staff", async function (assert) {
      this.siteSettings.disable_emails = "non-staff";
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)(".alert-emails-disabled"), "alert is displayed when email disabled for non-staff");
      assert.strictEqual((0, _qunitHelpers.query)(".alert-emails-disabled").innerText, _I18n.default.t("emails_are_disabled_non_staff"), "alert uses the correct text");
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true
      });
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)(".alert-emails-disabled"), "alert is displayed to staff when email disabled for non-staff");
      assert.strictEqual((0, _qunitHelpers.query)(".alert-emails-disabled").innerText, _I18n.default.t("emails_are_disabled_non_staff"), "alert uses the correct text");
    });
  });
});
define("discourse/tests/acceptance/emoji-picker-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("EmojiPicker", function (needs) {
    needs.user();
    needs.hooks.beforeEach(function () {
      this.emojiStore = this.container.lookup("service:emoji-store");
      this.emojiStore.reset();
    });
    needs.hooks.afterEach(function () {
      this.emojiStore.reset();
    });
    (0, _qunit.test)("emoji picker can be opened/closed", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-buttons .btn.create");
      await (0, _testHelpers.click)("button.emoji.btn");
      assert.ok((0, _qunitHelpers.exists)(".emoji-picker.opened"), "it opens the picker");
      await (0, _testHelpers.click)("button.emoji.btn");
      assert.notOk((0, _qunitHelpers.exists)(".emoji-picker.opened"), "it closes the picker");
    });
    (0, _qunit.test)("filters emoji", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-buttons .btn.create");
      await (0, _testHelpers.click)("button.emoji.btn");
      await (0, _testHelpers.fillIn)(".emoji-picker input.filter", "guitar");
      assert.strictEqual((0, _qunitHelpers.query)(`.emoji-picker .results img`).title, "guitar");
    });
    (0, _qunit.test)("emoji picker triggers event when picking emoji", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-buttons .btn.create");
      await (0, _testHelpers.click)("button.emoji.btn");
      await (0, _testHelpers.click)(".emoji-picker-emoji-area img.emoji[title='grinning']");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, ":grinning:", "it adds the emoji code in the editor when selected");
    });
    (0, _qunit.test)("emoji picker adds leading whitespace before emoji", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-buttons .btn.create"); // Whitespace should be added on text

      await (0, _testHelpers.fillIn)(".d-editor-input", "This is a test input");
      await (0, _testHelpers.click)("button.emoji.btn");
      await (0, _testHelpers.click)(".emoji-picker-emoji-area img.emoji[title='grinning']");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "This is a test input :grinning:", "it adds the emoji code and a leading whitespace when there is text"); // Whitespace should not be added on whitespace

      await (0, _testHelpers.fillIn)(".d-editor-input", "This is a test input ");
      await (0, _testHelpers.click)(".emoji-picker-emoji-area img.emoji[title='grinning']");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value, "This is a test input :grinning:", "it adds the emoji code and no leading whitespace when user already entered whitespace");
    });
    (0, _qunit.test)("emoji picker has a list of recently used emojis", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-buttons .btn.create");
      await (0, _testHelpers.click)("button.emoji.btn");
      await (0, _testHelpers.click)(".emoji-picker-emoji-area img.emoji[title='grinning']");
      assert.ok((0, _qunitHelpers.exists)(".emoji-picker .section.recent .section-group img.emoji[title='grinning']"), "it shows recent selected emoji");
      assert.ok((0, _qunitHelpers.exists)('.emoji-picker .category-button[data-section="recent"]'), "it shows recent category icon");
      await (0, _testHelpers.click)(".emoji-picker .trash-recent");
      assert.notOk((0, _qunitHelpers.exists)(".emoji-picker .section.recent .section-group img.emoji[title='grinning']"), "it has cleared recent emojis");
      assert.notOk((0, _qunitHelpers.exists)('.emoji-picker .section[data-section="recent"]'), "it hides recent section");
      assert.notOk((0, _qunitHelpers.exists)('.emoji-picker .category-button[data-section="recent"]'), "it hides recent category icon");
    });
    (0, _qunit.test)("emoji picker correctly orders recently used emojis", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-buttons .btn.create");
      await (0, _testHelpers.click)("button.emoji.btn");
      await (0, _testHelpers.click)(".emoji-picker-emoji-area img.emoji[title='sunglasses']");
      await (0, _testHelpers.click)(".emoji-picker-emoji-area img.emoji[title='grinning']");
      assert.strictEqual((0, _qunitHelpers.count)('.section[data-section="recent"] .section-group img.emoji'), 2, "it has multiple recent emojis");
      assert.strictEqual(/grinning/.test((0, _qunitHelpers.query)(".section.recent .section-group img.emoji").getAttribute("src")), true, "it puts the last used emoji in first");
    });
    (0, _qunit.test)("updates the recent list when selecting from it (after you close re-open it or select other emoji)", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-buttons .btn.create");
      await (0, _testHelpers.click)("button.emoji.btn");
      await (0, _testHelpers.click)(`.emoji-picker-emoji-area img.emoji[title="sunglasses"]`);
      await (0, _testHelpers.click)(`.emoji-picker-emoji-area img.emoji[title="grinning"]`);
      let recent = (0, _qunitHelpers.queryAll)(".section.recent .section-group img.emoji");
      assert.strictEqual(recent[0].title, "grinning");
      assert.strictEqual(recent[1].title, "sunglasses");
      await (0, _testHelpers.click)(`.section[data-section="recent"] .section-group img.emoji[title="sunglasses"]`); // The order is still the same

      recent = (0, _qunitHelpers.queryAll)(".section.recent .section-group img.emoji");
      assert.strictEqual(recent[0].title, "grinning");
      assert.strictEqual(recent[1].title, "sunglasses");
      await (0, _testHelpers.click)("button.emoji.btn");
      await (0, _testHelpers.click)("button.emoji.btn"); // but updates when you re-open

      recent = (0, _qunitHelpers.queryAll)(".section.recent .section-group img.emoji");
      assert.strictEqual(recent[0].title, "sunglasses");
      assert.strictEqual(recent[1].title, "grinning");
    });
    (0, _qunit.test)("emoji picker persists state", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-buttons .btn.create");
      await (0, _testHelpers.click)("button.emoji.btn");
      await (0, _testHelpers.click)(".emoji-picker button.diversity-scale.medium-dark");
      await (0, _testHelpers.click)("button.emoji.btn");
      await (0, _testHelpers.click)("button.emoji.btn");
      assert.ok((0, _qunitHelpers.exists)(".emoji-picker button.diversity-scale.medium-dark .d-icon"), "it stores diversity scale");
    });
  });
});
define("discourse/tests/acceptance/emoji-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "pretty-text/emoji/version"], function (_qunitHelpers, _testHelpers, _qunit, _version) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"pretty-text/emoji/version"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Emoji", function (needs) {
    needs.user();
    (0, _qunit.test)("emoji is cooked properly", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-buttons .btn.create");
      await (0, _testHelpers.fillIn)(".d-editor-input", "this is an emoji :blonde_woman:");
      assert.ok((0, _qunitHelpers.visible)(".d-editor-preview"));
      assert.strictEqual((0, _qunitHelpers.normalizeHtml)((0, _qunitHelpers.query)(".d-editor-preview").innerHTML.trim()), (0, _qunitHelpers.normalizeHtml)(`<p>this is an emoji <img src="/images/emoji/google_classic/blonde_woman.png?v=${_version.IMAGE_VERSION}" title=":blonde_woman:" class="emoji" alt=":blonde_woman:" loading="lazy" width="20" height="20" style="aspect-ratio: 20 / 20;"></p>`));
    });
    (0, _qunit.test)("skin toned emoji is cooked properly", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-buttons .btn.create");
      await (0, _testHelpers.fillIn)(".d-editor-input", "this is an emoji :blonde_woman:t5:");
      assert.ok((0, _qunitHelpers.visible)(".d-editor-preview"));
      assert.strictEqual((0, _qunitHelpers.normalizeHtml)((0, _qunitHelpers.query)(".d-editor-preview").innerHTML.trim()), (0, _qunitHelpers.normalizeHtml)(`<p>this is an emoji <img src="/images/emoji/google_classic/blonde_woman/5.png?v=${_version.IMAGE_VERSION}" title=":blonde_woman:t5:" class="emoji" alt=":blonde_woman:t5:" loading="lazy" width="20" height="20" style="aspect-ratio: 20 / 20;"></p>`));
    });
    needs.settings({
      emoji_autocomplete_min_chars: 2
    });
    (0, _qunit.test)("siteSetting:emoji_autocomplete_min_chars", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-buttons .btn.create");
      await (0, _testHelpers.fillIn)(".d-editor-input", ":s");
      await (0, _testHelpers.triggerKeyEvent)(".d-editor-input", "keyup", "ArrowDown"); // ensures a keyup is triggered

      assert.notOk((0, _qunitHelpers.exists)(".autocomplete.ac-emoji"));
      await (0, _testHelpers.fillIn)(".d-editor-input", ":sw");
      await (0, _testHelpers.triggerKeyEvent)(".d-editor-input", "keyup", "ArrowDown"); // ensures a keyup is triggered

      assert.ok((0, _qunitHelpers.exists)(".autocomplete.ac-emoji"));
    });
  });
});
define("discourse/tests/acceptance/encoded-category-test", ["discourse/tests/helpers/qunit-helpers", "discourse/tests/fixtures/discovery-fixtures", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _discoveryFixtures, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"discourse/tests/fixtures/discovery-fixtures",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Encoded Sub Category Discovery", function (needs) {
    needs.settings({
      slug_generation_method: "encoded"
    });
    needs.site({
      categories: [{
        id: 5,
        name: "-parent",
        slug: "%E6%BC%A2%E5%AD%97-parent",
        permission: null
      }, {
        id: 6,
        name: "-subcategory",
        slug: "%E6%BC%A2%E5%AD%97-subcategory",
        permission: null,
        parent_category_id: 5
      }]
    });
    needs.pretender((server, helper) => {
      server.get("/c/%E6%BC%A2%E5%AD%97-parent/%E6%BC%A2%E5%AD%97-subcategory/6/l/latest.json", () => {
        return helper.response(_discoveryFixtures.default["/latest_can_create_topic.json"]);
      });
      server.get("/c/%E6%BC%A2%E5%AD%97-parent/%E6%BC%A2%E5%AD%97-subcategory/find_by_slug.json", () => {
        //respond with an error here: these tests are to check that ember can route this itself without falling back to rails
        return helper.response(500, {});
      });
    });
    (0, _qunit.test)("Visit subcategory by slug", async function (assert) {
      const bodyClass = "category-%E6%BC%A2%E5%AD%97-parent-%E6%BC%A2%E5%AD%97-subcategory";
      await (0, _testHelpers.visit)("/c/%E6%BC%A2%E5%AD%97-parent/%E6%BC%A2%E5%AD%97-subcategory");
      assert.ok(document.body.classList.contains(bodyClass), "has the default navigation");
      assert.ok((0, _qunitHelpers.exists)(".topic-list"), "The list of topics was rendered");
      assert.ok((0, _qunitHelpers.exists)(".topic-list .topic-list-item"), "has topics");
      await (0, _testHelpers.visit)("/c/-parent/-subcategory");
      assert.ok(document.body.classList.contains(bodyClass), "has the default navigation");
      assert.ok((0, _qunitHelpers.exists)(".topic-list"), "The list of topics was rendered");
      assert.ok((0, _qunitHelpers.exists)(".topic-list .topic-list-item"), "has topics");
    });
  });
});
define("discourse/tests/acceptance/enforce-second-factor-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  async function catchAbortedTransition() {
    try {
      await (0, _testHelpers.visit)("/u/eviltrout/summary");
    } catch (e) {
      if (e.message !== "TransitionAborted") {
        throw e;
      }
    }
  }

  (0, _qunitHelpers.acceptance)("Enforce Second Factor", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.post("/u/second_factors.json", () => {
        return helper.response({
          success: "OK",
          password_required: "true"
        });
      });
    });
    (0, _qunit.test)("as an admin", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/second-factor");
      this.siteSettings.enforce_second_factor = "staff";
      await catchAbortedTransition();
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "preferences.second-factor", "it will not transition from second-factor preferences");
      await (0, _testHelpers.click)("#toggle-hamburger-menu");
      await (0, _testHelpers.click)("a.admin-link");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "preferences.second-factor", "it stays at second-factor preferences");
    });
    (0, _qunit.test)("as a user", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: false
      });
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/second-factor");
      this.siteSettings.enforce_second_factor = "all";
      await catchAbortedTransition();
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "preferences.second-factor", "it will not transition from second-factor preferences");
      await (0, _testHelpers.click)("#toggle-hamburger-menu");
      await (0, _testHelpers.click)("a.about-link");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "preferences.second-factor", "it stays at second-factor preferences");
    });
    (0, _qunit.test)("as an anonymous user", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: false,
        is_anonymous: true
      });
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/second-factor");
      this.siteSettings.enforce_second_factor = "all";
      this.siteSettings.allow_anonymous_posting = true;
      await catchAbortedTransition();
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "user.summary", "it will transition from second-factor preferences");
      await (0, _testHelpers.click)("#toggle-hamburger-menu");
      await (0, _testHelpers.click)("a.about-link");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "about", "it is possible to navigate to other pages");
    });
  });
});
define("discourse/tests/acceptance/fast-edit-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "discourse/tests/fixtures/post", "discourse-common/lib/object"], function (_qunitHelpers, _testHelpers, _qunit, _post, _object) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"discourse/tests/fixtures/post",0,"discourse-common/lib/object"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Fast Edit", function (needs) {
    needs.user();
    needs.settings({
      enable_fast_edit: true
    });
    needs.pretender((server, helper) => {
      server.get("/posts/419", () => {
        return helper.response((0, _object.cloneJSON)(_post.default["/posts/398"]));
      });
    });
    (0, _qunit.test)("Fast edit button works", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      const textNode = (0, _qunitHelpers.query)("#post_1 .cooked p").childNodes[0];
      await (0, _qunitHelpers.selectText)(textNode, 9);
      await (0, _testHelpers.click)(".quote-button .quote-edit-label");
      assert.ok((0, _qunitHelpers.exists)("#fast-edit-input"), "fast editor is open");
      assert.strictEqual((0, _qunitHelpers.query)("#fast-edit-input").value, "Any plans", "contains selected text");
      await (0, _testHelpers.fillIn)("#fast-edit-input", "My edit");
      await (0, _testHelpers.click)(".save-fast-edit");
      assert.notOk((0, _qunitHelpers.exists)("#fast-edit-input"), "fast editor is closed");
    });
    (0, _qunit.test)("Works with keyboard shortcut", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      const textNode = (0, _qunitHelpers.query)("#post_1 .cooked p").childNodes[0];
      await (0, _qunitHelpers.selectText)(textNode, 9);
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "E");
      assert.ok((0, _qunitHelpers.exists)("#fast-edit-input"), "fast editor is open");
      assert.strictEqual((0, _qunitHelpers.query)("#fast-edit-input").value, "Any plans", "contains selected text");
      await (0, _testHelpers.fillIn)("#fast-edit-input", "My edit");
      await (0, _testHelpers.click)(".save-fast-edit");
      assert.notOk((0, _qunitHelpers.exists)("#fast-edit-input"), "fast editor is closed");
    });
    (0, _qunit.test)("Opens full composer for multi-line selection", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      const textNode = (0, _qunitHelpers.query)("#post_2 .cooked");
      await (0, _qunitHelpers.selectText)(textNode);
      await (0, _testHelpers.click)(".quote-button .quote-edit-label");
      assert.notOk((0, _qunitHelpers.exists)("#fast-edit-input"), "fast editor is not open");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-input"), "the composer is open");
    });
  });
});
define("discourse/tests/acceptance/flag-post-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/tests/helpers/select-kit-helper", "qunit", "discourse/tests/fixtures/user-fixtures"], function (_qunitHelpers, _testHelpers, _selectKitHelper, _qunit, _userFixtures) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"qunit",0,"discourse/tests/fixtures/user-fixtures"eaimeta@70e063a35619d71f

  async function openFlagModal() {
    if ((0, _qunitHelpers.exists)(".topic-post:first-child button.show-more-actions")) {
      await (0, _testHelpers.click)(".topic-post:first-child button.show-more-actions");
    }

    await (0, _testHelpers.click)(".topic-post:first-child button.create-flag");
  }

  async function pressEnter(element, modifier) {
    const event = document.createEvent("Event");
    event.initEvent("keydown", true, true);
    event.key = "Enter";
    event.keyCode = 13;
    event[modifier] = true;
    element.dispatchEvent(event);
    await (0, _testHelpers.settled)();
  }

  (0, _qunitHelpers.acceptance)("flagging", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/u/uwe_keim.json", () => {
        return helper.response(_userFixtures.default["/u/charlie.json"]);
      });
      server.get("/admin/users/255.json", () => {
        return helper.response({
          id: 255,
          automatic: false,
          name: "admin",
          username: "admin",
          user_count: 0,
          alias_level: 99,
          visible: true,
          automatic_membership_email_domains: "",
          primary_group: false,
          title: null,
          grant_trust_level: null,
          has_messages: false,
          flair_url: null,
          flair_bg_color: null,
          flair_color: null,
          bio_raw: null,
          bio_cooked: null,
          public_admission: false,
          allow_membership_requests: true,
          membership_request_template: "Please add me",
          full_name: null
        });
      });
      server.get("/admin/users/5.json", () => {
        return helper.response({
          id: 5,
          automatic: false,
          name: "user",
          username: "user",
          user_count: 0,
          alias_level: 99,
          visible: true,
          automatic_membership_email_domains: "",
          primary_group: false,
          title: null,
          grant_trust_level: null,
          has_messages: false,
          flair_url: null,
          flair_bg_color: null,
          flair_color: null,
          bio_raw: null,
          bio_cooked: null,
          public_admission: false,
          allow_membership_requests: true,
          membership_request_template: "Please add me",
          full_name: null
        });
      });
      server.put("/admin/users/5/silence", () => {
        return helper.response({
          silenced: true
        });
      });
      server.post("/post_actions", () => {
        return helper.response({
          response: true
        });
      });
    });
    (0, _qunit.test)("Flag modal opening", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await openFlagModal();
      assert.ok((0, _qunitHelpers.exists)(".flag-modal-body"), "it shows the flag modal");
    });
    (0, _qunit.test)("Flag take action dropdown exists", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await openFlagModal();
      await (0, _testHelpers.click)("#radio_inappropriate");
      await (0, _selectKitHelper.default)(".reviewable-action-dropdown").expand();
      assert.ok((0, _qunitHelpers.exists)("[data-value='agree_and_silence']"), "it shows the silence action option");
      await (0, _testHelpers.click)("[data-value='agree_and_silence']");
      assert.ok((0, _qunitHelpers.exists)(".silence-user-modal"), "it shows the silence modal");
    });
    (0, _qunit.test)("Can silence from take action", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await openFlagModal();
      await (0, _testHelpers.click)("#radio_inappropriate");
      await (0, _selectKitHelper.default)(".reviewable-action-dropdown").expand();
      await (0, _testHelpers.click)("[data-value='agree_and_silence']");
      const silenceUntilCombobox = (0, _selectKitHelper.default)(".silence-until .combobox");
      await silenceUntilCombobox.expand();
      await silenceUntilCombobox.selectRowByValue("tomorrow");
      await (0, _testHelpers.fillIn)(".silence-reason", "for breaking the rules");
      await (0, _testHelpers.click)(".perform-silence");
      assert.ok(!(0, _qunitHelpers.exists)(".bootbox.modal:visible"));
    });
    (0, _qunit.test)("Gets dismissable warning from canceling incomplete silence from take action", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await openFlagModal();
      await (0, _testHelpers.click)("#radio_inappropriate");
      await (0, _selectKitHelper.default)(".reviewable-action-dropdown").expand();
      await (0, _testHelpers.click)("[data-value='agree_and_silence']");
      const silenceUntilCombobox = (0, _selectKitHelper.default)(".silence-until .combobox");
      await silenceUntilCombobox.expand();
      await silenceUntilCombobox.selectRowByValue("tomorrow");
      await (0, _testHelpers.fillIn)(".silence-reason", "for breaking the rules");
      await (0, _testHelpers.click)(".d-modal-cancel");
      assert.strictEqual((0, _qunitHelpers.count)(".bootbox.modal:visible"), 1);
      await (0, _testHelpers.click)(".modal-footer .btn-default");
      assert.ok(!(0, _qunitHelpers.exists)(".bootbox.modal:visible"));
      assert.ok((0, _qunitHelpers.exists)(".silence-user-modal"), "it shows the silence modal");
      await (0, _testHelpers.click)(".d-modal-cancel");
      assert.strictEqual((0, _qunitHelpers.count)(".bootbox.modal:visible"), 1);
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
      assert.ok(!(0, _qunitHelpers.exists)(".bootbox.modal:visible"));
    });
    (0, _qunit.test)("CTRL + ENTER accepts the modal", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await openFlagModal();
      const modal = (0, _qunitHelpers.query)("#discourse-modal");
      await pressEnter(modal, "ctrlKey");
      assert.ok((0, _qunitHelpers.exists)("#discourse-modal:visible"), "The modal wasn't closed because the accept button was disabled");
      await (0, _testHelpers.click)("#radio_inappropriate"); // this enables the accept button

      await pressEnter(modal, "ctrlKey");
      assert.ok(!(0, _qunitHelpers.exists)("#discourse-modal:visible"), "The modal was closed");
    });
    (0, _qunit.test)("CMD or WINDOWS-KEY + ENTER accepts the modal", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await openFlagModal();
      const modal = (0, _qunitHelpers.query)("#discourse-modal");
      await pressEnter(modal, "metaKey");
      assert.ok((0, _qunitHelpers.exists)("#discourse-modal:visible"), "The modal wasn't closed because the accept button was disabled");
      await (0, _testHelpers.click)("#radio_inappropriate"); // this enables the accept button

      await pressEnter(modal, "ctrlKey");
      assert.ok(!(0, _qunitHelpers.exists)("#discourse-modal:visible"), "The modal was closed");
    });
  });
});
define("discourse/tests/acceptance/forgot-password-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "I18n", "qunit"], function (_qunitHelpers, _testHelpers, _I18n, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"I18n",0,"qunit"eaimeta@70e063a35619d71f

  let userFound = false;
  (0, _qunitHelpers.acceptance)("Forgot password", function (needs) {
    needs.pretender((server, helper) => {
      server.post("/session/forgot_password", () => {
        return helper.response({
          user_found: userFound
        });
      });
    });
    (0, _qunit.test)("requesting password reset", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("header .login-button");
      await (0, _testHelpers.click)("#forgot-password-link");
      assert.ok((0, _qunitHelpers.query)(".forgot-password-reset").disabled, "it should disable the button until the field is filled");
      await (0, _testHelpers.fillIn)("#username-or-email", "someuser");
      await (0, _testHelpers.click)(".forgot-password-reset");
      assert.strictEqual((0, _qunitHelpers.query)(".alert-error").innerHTML.trim(), _I18n.default.t("forgot_password.complete_username_not_found", {
        username: "someuser"
      }), "it should display an error for an invalid username");
      await (0, _testHelpers.fillIn)("#username-or-email", "someuser@gmail.com");
      await (0, _testHelpers.click)(".forgot-password-reset");
      assert.strictEqual((0, _qunitHelpers.query)(".alert-error").innerHTML.trim(), _I18n.default.t("forgot_password.complete_email_not_found", {
        email: "someuser@gmail.com"
      }), "it should display an error for an invalid email");
      await (0, _testHelpers.fillIn)("#username-or-email", "someuser");
      userFound = true;
      await (0, _testHelpers.click)(".forgot-password-reset");
      assert.notOk((0, _qunitHelpers.exists)(".alert-error"), "it should remove the flash error when succeeding");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-body").innerHTML.trim(), _I18n.default.t("forgot_password.complete_username_found", {
        username: "someuser"
      }), "it should display a success message for a valid username");
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("header .login-button");
      await (0, _testHelpers.click)("#forgot-password-link");
      await (0, _testHelpers.fillIn)("#username-or-email", "someuser@gmail.com");
      await (0, _testHelpers.click)(".forgot-password-reset");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-body").innerHTML.trim(), _I18n.default.t("forgot_password.complete_email_found", {
        email: "someuser@gmail.com"
      }), "it should display a success message for a valid email");
    });
  });
  (0, _qunitHelpers.acceptance)("Forgot password - hide_email_address_taken enabled", function (needs) {
    needs.pretender((server, helper) => {
      server.post("/session/forgot_password", () => {
        return helper.response({});
      });
    });
    (0, _qunit.test)("requesting password reset", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("header .login-button");
      await (0, _testHelpers.click)("#forgot-password-link");
      assert.ok((0, _qunitHelpers.query)(".forgot-password-reset").disabled, "it should disable the button until the field is filled");
      await (0, _testHelpers.fillIn)("#username-or-email", "someuser");
      await (0, _testHelpers.click)(".forgot-password-reset");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-body").innerHTML.trim(), _I18n.default.t("forgot_password.complete_username", {
        username: "someuser"
      }), "it should display a success message");
    });
  });
});
define("discourse/tests/acceptance/group-index-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "I18n", "discourse/tests/helpers/select-kit-helper", "qunit"], function (_qunitHelpers, _testHelpers, _I18n, _selectKitHelper, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"I18n",0,"discourse/tests/helpers/select-kit-helper",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Group Members - Anonymous", function () {
    (0, _qunit.test)("Viewing Members as anon user", async function (assert) {
      await (0, _testHelpers.visit)("/g/discourse");
      assert.strictEqual((0, _qunitHelpers.count)(".avatar-flair .d-icon-adjust"), 1, "it displays the group's avatar flair");
      assert.ok((0, _qunitHelpers.exists)(".group-members tr"), "it lists group members");
      assert.ok(!(0, _qunitHelpers.exists)(".group-member-dropdown"), "it does not allow anon user to manage group members");
      assert.strictEqual((0, _qunitHelpers.query)(".group-username-filter").getAttribute("placeholder"), _I18n.default.t("groups.members.filter_placeholder"), "it should display the right filter placeholder");
    });
  });
  (0, _qunitHelpers.acceptance)("Group Members", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.put("/admin/groups/47/owners.json", () => {
        return helper.response({
          success: true
        });
      });
    });
    (0, _qunit.test)("Viewing Members as a group owner", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: false
      });
      await (0, _testHelpers.visit)("/g/discourse");
      await (0, _testHelpers.click)(".group-members-add");
      assert.strictEqual((0, _qunitHelpers.count)(".user-chooser"), 1, "it should display the add members modal");
    });
    (0, _qunit.test)("Viewing Members as an admin user", async function (assert) {
      await (0, _testHelpers.visit)("/g/discourse");
      assert.ok((0, _qunitHelpers.exists)(".group-member-dropdown"), "it allows admin user to manage group members");
      assert.strictEqual((0, _qunitHelpers.query)(".group-username-filter").getAttribute("placeholder"), _I18n.default.t("groups.members.filter_placeholder_admin"), "it should display the right filter placeholder");
    });
    (0, _qunit.test)("Shows bulk actions", async function (assert) {
      await (0, _testHelpers.visit)("/g/discourse");
      assert.ok((0, _qunitHelpers.exists)("button.bulk-select"));
      await (0, _testHelpers.click)("button.bulk-select");
      await (0, _testHelpers.click)((0, _qunitHelpers.queryAll)("input.bulk-select")[0]);
      await (0, _testHelpers.click)((0, _qunitHelpers.queryAll)("input.bulk-select")[1]);
      const memberDropdown = (0, _selectKitHelper.default)(".bulk-group-member-dropdown");
      await memberDropdown.expand();
      await memberDropdown.selectRowByValue("makeOwners");
    });
    (0, _qunit.test)("Bulk actions - Menu, Select all and Clear all buttons", async function (assert) {
      await (0, _testHelpers.visit)("/g/discourse");
      assert.ok(!(0, _qunitHelpers.exists)(".bulk-select-buttons-wrap details"), "it does not show menu button if nothing is selected");
      await (0, _testHelpers.click)("button.bulk-select");
      await (0, _testHelpers.click)(".bulk-select-buttons button:nth-child(1)");
      assert.ok((0, _qunitHelpers.exists)(".bulk-select-buttons-wrap details"), "it shows menu button if something is selected");
    });
  });
});
define("discourse/tests/acceptance/group-manage-categories-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Managing Group Category Notification Defaults", function () {
    (0, _qunit.test)("As an anonymous user", async function (assert) {
      await (0, _testHelpers.visit)("/g/discourse/manage/categories");
      assert.ok((0, _qunitHelpers.exists)(".group-members tr"), "it should redirect to members page for an anonymous user");
    });
  });
  (0, _qunitHelpers.acceptance)("Managing Group Category Notification Defaults", function (needs) {
    needs.user();
    (0, _qunit.test)("As an admin", async function (assert) {
      await (0, _testHelpers.visit)("/g/discourse/manage/categories");
      assert.strictEqual((0, _qunitHelpers.count)(".groups-notifications-form .category-selector"), 5, "it should display category inputs");
    });
    (0, _qunit.test)("As a group owner", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: false
      });
      await (0, _testHelpers.visit)("/g/discourse/manage/categories");
      assert.strictEqual((0, _qunitHelpers.count)(".groups-notifications-form .category-selector"), 5, "it should display category inputs");
    });
  });
});
define("discourse/tests/acceptance/group-manage-email-settings-test", ["discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/select-kit-helper", "@ember/test-helpers", "I18n", "qunit"], function (_qunitHelpers, _selectKitHelper, _testHelpers, _I18n, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"@ember/test-helpers",0,"I18n",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Managing Group Email Settings - SMTP Disabled", function (needs) {
    needs.user();
    (0, _qunit.test)("When SiteSetting.enable_smtp is false", async function (assert) {
      await (0, _testHelpers.visit)("/g/discourse/manage/email");
      assert.notOk((0, _qunitHelpers.query)(".user-secondary-navigation").innerText.includes("Email"), "email link is not shown in the sidebar");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "group.manage.profile", "it redirects to the group profile page");
    });
  });
  (0, _qunitHelpers.acceptance)("Managing Group Email Settings - SMTP Enabled, IMAP Disabled", function (needs) {
    needs.user();
    needs.settings({
      enable_smtp: true
    });
    (0, _qunit.test)("When SiteSetting.enable_smtp is true but SiteSetting.enable_imap is false", async function (assert) {
      await (0, _testHelpers.visit)("/g/discourse/manage/email");
      assert.ok((0, _qunitHelpers.query)(".user-secondary-navigation").innerText.includes("Email"), "email link is shown in the sidebar");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "group.manage.email", "it redirects to the group email page");
      assert.notOk((0, _qunitHelpers.exists)(".group-manage-email-imap-wrapper"), "does not show IMAP settings");
    });
  });
  (0, _qunitHelpers.acceptance)("Managing Group Email Settings - SMTP and IMAP Enabled", function (needs) {
    needs.user();
    needs.settings({
      enable_smtp: true,
      enable_imap: true
    });
    needs.pretender((server, helper) => {
      server.post("/groups/47/test_email_settings", () => {
        return helper.response({
          success: "OK"
        });
      });
      server.put("/groups/47", () => {
        return helper.response({
          success: "OK"
        });
      });
    });
    (0, _qunit.test)("enabling SMTP, testing, and saving", async function (assert) {
      await (0, _testHelpers.visit)("/g/discourse/manage/email");
      assert.ok((0, _qunitHelpers.query)(".user-secondary-navigation").innerText.includes("Email"), "email link is shown in the sidebar");
      assert.ok((0, _qunitHelpers.exists)("#enable_imap:disabled"), "IMAP is disabled until SMTP settings are valid");
      await (0, _testHelpers.click)("#enable_smtp");
      assert.ok((0, _qunitHelpers.exists)(".group-smtp-email-settings"));
      await (0, _testHelpers.click)("#prefill_smtp_gmail");
      assert.strictEqual((0, _qunitHelpers.query)("input[name='smtp_server']").value, "smtp.gmail.com", "prefills SMTP server settings for gmail");
      assert.strictEqual((0, _qunitHelpers.query)("input[name='smtp_port']").value, "587", "prefills SMTP port settings for gmail");
      assert.ok((0, _qunitHelpers.exists)("#enable_ssl:checked"), "prefills SMTP ssl settings for gmail");
      assert.ok((0, _qunitHelpers.exists)(".test-smtp-settings:disabled"), "does not allow testing settings if not all fields are filled");
      await (0, _testHelpers.fillIn)('input[name="username"]', "myusername@gmail.com");
      await (0, _testHelpers.fillIn)('input[name="password"]', "password@gmail.com");
      await (0, _testHelpers.fillIn)("#from_alias", "akasomegroup@example.com");
      await (0, _testHelpers.click)(".test-smtp-settings");
      assert.ok((0, _qunitHelpers.exists)(".smtp-settings-ok"), "tested settings are ok");
      await (0, _testHelpers.click)(".group-manage-save");
      assert.strictEqual((0, _qunitHelpers.query)(".group-manage-save-button > span").innerText, "Saved!");
      assert.notOk((0, _qunitHelpers.exists)("#enable_imap:disabled"), "IMAP is able to be enabled now that SMTP is saved");
      await (0, _testHelpers.click)("#enable_smtp");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-body").innerText, _I18n.default.t("groups.manage.email.smtp_disable_confirm"), "shows a confirm dialogue warning SMTP settings will be wiped");
      await (0, _testHelpers.click)(".modal-footer .btn.btn-primary");
    });
    (0, _qunit.test)("enabling IMAP, testing, and saving", async function (assert) {
      await (0, _testHelpers.visit)("/g/discourse/manage/email");
      await (0, _testHelpers.click)("#enable_smtp");
      await (0, _testHelpers.click)("#prefill_smtp_gmail");
      await (0, _testHelpers.fillIn)('input[name="username"]', "myusername@gmail.com");
      await (0, _testHelpers.fillIn)('input[name="password"]', "password@gmail.com");
      await (0, _testHelpers.click)(".test-smtp-settings");
      await (0, _testHelpers.click)(".group-manage-save");
      assert.notOk((0, _qunitHelpers.exists)("#enable_imap:disabled"), "IMAP is able to be enabled now that IMAP is saved");
      await (0, _testHelpers.click)("#enable_imap");
      assert.ok((0, _qunitHelpers.exists)(".test-imap-settings:disabled"), "does not allow testing settings if not all fields are filled");
      await (0, _testHelpers.click)("#prefill_imap_gmail");
      assert.strictEqual((0, _qunitHelpers.query)("input[name='imap_server']").value, "imap.gmail.com", "prefills IMAP server settings for gmail");
      assert.strictEqual((0, _qunitHelpers.query)("input[name='imap_port']").value, "993", "prefills IMAP port settings for gmail");
      assert.ok((0, _qunitHelpers.exists)("#enable_ssl:checked"), "prefills IMAP ssl settings for gmail");
      await (0, _testHelpers.click)(".test-imap-settings");
      assert.ok((0, _qunitHelpers.exists)(".imap-settings-ok"), "tested settings are ok");
      await (0, _testHelpers.click)(".group-manage-save");
      assert.strictEqual((0, _qunitHelpers.query)(".group-manage-save-button > span").innerText, "Saved!");
      assert.ok((0, _qunitHelpers.exists)(".imap-no-mailbox-selected"), "shows a message saying no IMAP mailbox is selected");
      await (0, _selectKitHelper.default)(".control-group.group-imap-mailboxes .combo-box").expand();
      await (0, _selectKitHelper.default)(".control-group.group-imap-mailboxes .combo-box").selectRowByValue("All Mail");
      await (0, _testHelpers.click)(".group-manage-save");
      assert.notOk((0, _qunitHelpers.exists)(".imap-no-mailbox-selected"), "no longer shows a no mailbox selected message");
      await (0, _testHelpers.click)("#enable_imap");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-body").innerText, _I18n.default.t("groups.manage.email.imap_disable_confirm"), "shows a confirm dialogue warning IMAP settings will be wiped");
      await (0, _testHelpers.click)(".modal-footer .btn.btn-primary");
    });
  });
  (0, _qunitHelpers.acceptance)("Managing Group Email Settings - SMTP and IMAP Enabled - Settings Preflled", function (needs) {
    needs.user();
    needs.settings({
      enable_smtp: true,
      enable_imap: true
    });
    needs.pretender((server, helper) => {
      server.get("/groups/discourse.json", () => {
        return helper.response(200, {
          group: {
            id: 47,
            automatic: false,
            name: "discourse",
            full_name: "Awesome Team",
            user_count: 8,
            alias_level: 99,
            visible: true,
            public_admission: true,
            public_exit: false,
            flair_url: "fa-adjust",
            is_group_owner: true,
            mentionable: true,
            messageable: true,
            can_see_members: true,
            has_messages: true,
            message_count: 2,
            smtp_server: "smtp.gmail.com",
            smtp_port: 587,
            smtp_ssl: true,
            smtp_enabled: true,
            smtp_updated_at: "2021-06-16T02:58:12.739Z",
            smtp_updated_by: {
              id: 19,
              username: "eviltrout",
              name: "Robin Ward",
              avatar_template: "/letter_avatar/eviltrout/{size}/3_f9720745f5ce6dfc2b5641fca999d934.png"
            },
            imap_server: "imap.gmail.com",
            imap_port: 993,
            imap_ssl: true,
            imap_mailbox_name: "INBOX",
            imap_mailboxes: ["INBOX", "[Gmail]/All Mail", "[Gmail]/Important"],
            imap_enabled: true,
            imap_updated_at: "2021-06-16T02:58:12.738Z",
            imap_updated_by: {
              id: 19,
              username: "eviltrout",
              name: "Robin Ward",
              avatar_template: "/letter_avatar/eviltrout/{size}/3_f9720745f5ce6dfc2b5641fca999d934.png"
            },
            email_username: "test@test.com",
            email_password: "password"
          },
          extras: {
            visible_group_names: ["discourse"]
          }
        });
      });
    });
    (0, _qunit.test)("prefills smtp and imap saved settings and shows last updated details", async function (assert) {
      await (0, _testHelpers.visit)("/g/discourse/manage/email");
      assert.notOk((0, _qunitHelpers.exists)("#enable_smtp:disabled"), "SMTP is not disabled");
      assert.notOk((0, _qunitHelpers.exists)("#enable_imap:disabled"), "IMAP is not disabled");
      assert.strictEqual((0, _qunitHelpers.query)("[name='username']").value, "test@test.com", "email username is prefilled");
      assert.strictEqual((0, _qunitHelpers.query)("[name='password']").value, "password", "email password is prefilled");
      assert.strictEqual((0, _qunitHelpers.query)("[name='smtp_server']").value, "smtp.gmail.com", "smtp server is prefilled");
      assert.strictEqual((0, _qunitHelpers.query)("[name='smtp_port']").value, "587", "smtp port is prefilled");
      assert.strictEqual((0, _qunitHelpers.query)("[name='imap_server']").value, "imap.gmail.com", "imap server is prefilled");
      assert.strictEqual((0, _qunitHelpers.query)("[name='imap_port']").value, "993", "imap port is prefilled");
      assert.strictEqual((0, _selectKitHelper.default)("#imap_mailbox").header().value(), "INBOX", "imap mailbox is prefilled");
      const regex = /updated: (.*?) by eviltrout/;
      assert.ok((0, _qunitHelpers.exists)(".group-email-last-updated-details.for-imap"));
      assert.ok(regex.test((0, _qunitHelpers.query)(".group-email-last-updated-details.for-imap").innerText.trim()), "shows last updated imap details");
      assert.ok((0, _qunitHelpers.exists)(".group-email-last-updated-details.for-smtp"));
      assert.ok(regex.test((0, _qunitHelpers.query)(".group-email-last-updated-details.for-smtp").innerText.trim()), "shows last updated smtp details");
    });
  });
  (0, _qunitHelpers.acceptance)("Managing Group Email Settings - SMTP and IMAP Enabled - Email Test Invalid", function (needs) {
    needs.user();
    needs.settings({
      enable_smtp: true,
      enable_imap: true
    });
    needs.pretender((server, helper) => {
      server.post("/groups/47/test_email_settings", () => {
        return helper.response(422, {
          success: false,
          errors: ["There was an issue with the SMTP credentials provided, check the username and password and try again."]
        });
      });
    });
    (0, _qunit.test)("enabling IMAP, testing, and saving", async function (assert) {
      await (0, _testHelpers.visit)("/g/discourse/manage/email");
      await (0, _testHelpers.click)("#enable_smtp");
      await (0, _testHelpers.click)("#prefill_smtp_gmail");
      await (0, _testHelpers.fillIn)('input[name="username"]', "myusername@gmail.com");
      await (0, _testHelpers.fillIn)('input[name="password"]', "password@gmail.com");
      await (0, _testHelpers.click)(".test-smtp-settings");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-body").innerText, "There was an issue with the SMTP credentials provided, check the username and password and try again.", "shows a dialogue with the error message from the server");
      await (0, _testHelpers.click)(".modal-footer .btn.btn-primary");
    });
  });
});
define("discourse/tests/acceptance/group-manage-interaction-test", ["discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/select-kit-helper", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _selectKitHelper, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Managing Group Interaction Settings", function (needs) {
    needs.user();
    needs.settings({
      email_in: true
    });
    (0, _qunit.test)("As an admin", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: true,
        can_create_group: true
      });
      await (0, _testHelpers.visit)("/g/alternative-group/manage/interaction");
      assert.strictEqual((0, _qunitHelpers.count)(".groups-form-visibility-level"), 1, "it should display visibility level selector");
      assert.strictEqual((0, _qunitHelpers.count)(".groups-form-mentionable-level"), 1, "it should display mentionable level selector");
      assert.strictEqual((0, _qunitHelpers.count)(".groups-form-messageable-level"), 1, "it should display messageable level selector");
      assert.strictEqual((0, _qunitHelpers.count)(".groups-form-incoming-email"), 1, "it should display incoming email input");
      assert.strictEqual((0, _qunitHelpers.count)(".groups-form-default-notification-level"), 1, "it should display default notification level input");
    });
    (0, _qunit.test)("As a group owner", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: false,
        can_create_group: false
      });
      await (0, _testHelpers.visit)("/g/discourse/manage/interaction");
      assert.strictEqual((0, _qunitHelpers.count)(".groups-form-visibility-level"), 0, "it should not display visibility level selector");
      assert.strictEqual((0, _qunitHelpers.count)(".groups-form-mentionable-level"), 1, "it should display mentionable level selector");
      assert.strictEqual((0, _qunitHelpers.count)(".groups-form-messageable-level"), 1, "it should display messageable level selector");
      assert.strictEqual((0, _qunitHelpers.count)(".groups-form-incoming-email"), 0, "it should not display incoming email input");
      assert.strictEqual((0, _qunitHelpers.count)(".groups-form-default-notification-level"), 1, "it should display default notification level input");
    });
  });
  (0, _qunitHelpers.acceptance)("Managing Group Interaction Settings - Notification Levels", function (needs) {
    needs.user({
      admin: true
    });
    (0, _qunit.test)("For a group with a default_notification_level of 0", async function (assert) {
      await (0, _testHelpers.visit)("/g/alternative-group/manage/interaction");
      await assert.ok((0, _qunitHelpers.exists)(".groups-form"), "should have the form");
      await assert.strictEqual((0, _selectKitHelper.default)(".groups-form-default-notification-level").header().value(), "0", "it should select Muted as the notification level");
    });
    (0, _qunit.test)("For a group with a null default_notification_level", async function (assert) {
      await (0, _testHelpers.visit)("/g/discourse/manage/interaction");
      await assert.ok((0, _qunitHelpers.exists)(".groups-form"), "should have the form");
      await assert.strictEqual((0, _selectKitHelper.default)(".groups-form-default-notification-level").header().value(), "3", "it should select Watching as the notification level");
    });
    (0, _qunit.test)("For a group with a selected default_notification_level", async function (assert) {
      await (0, _testHelpers.visit)("/g/support/manage/interaction");
      await assert.ok((0, _qunitHelpers.exists)(".groups-form"), "should have the form");
      await assert.strictEqual((0, _selectKitHelper.default)(".groups-form-default-notification-level").header().value(), "2", "it should select Tracking as the notification level");
    });
  });
});
define("discourse/tests/acceptance/group-manage-logs-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Group logs", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/groups/snorlax.json", () => {
        return helper.response({
          group: {
            id: 41,
            automatic: false,
            name: "snorlax",
            user_count: 1,
            alias_level: 0,
            visible: true,
            automatic_membership_email_domains: "",
            primary_group: true,
            title: "Team Snorlax",
            grant_trust_level: null,
            incoming_email: null,
            has_messages: false,
            flair_url: "",
            flair_bg_color: "",
            flair_color: "",
            bio_raw: "",
            bio_cooked: null,
            public: true,
            is_group_user: true,
            is_group_owner: true
          }
        });
      }); // Workaround while awaiting https://github.com/tildeio/route-recognizer/issues/53

      server.get("/groups/snorlax/logs.json", request => {
        if (request.queryParams["filters[action]"]) {
          return helper.response({
            logs: [{
              action: "change_group_setting",
              subject: "title",
              prev_value: null,
              new_value: "Team Snorlax",
              created_at: "2016-12-12T08:27:46.408Z",
              acting_user: {
                id: 1,
                username: "tgx",
                avatar_template: "/images/avatar.png"
              },
              target_user: null
            }],
            all_loaded: true
          });
        } else {
          return helper.response({
            logs: [{
              action: "change_group_setting",
              subject: "title",
              prev_value: null,
              new_value: "Team Snorlax",
              created_at: "2016-12-12T08:27:46.408Z",
              acting_user: {
                id: 1,
                username: "tgx",
                avatar_template: "/images/avatar.png"
              },
              target_user: null
            }, {
              action: "add_user_to_group",
              subject: null,
              prev_value: null,
              new_value: null,
              created_at: "2016-12-12T08:27:27.725Z",
              acting_user: {
                id: 1,
                username: "tgx",
                avatar_template: "/images/avatar.png"
              },
              target_user: {
                id: 1,
                username: "tgx",
                avatar_template: "/images/avatar.png"
              }
            }],
            all_loaded: true
          });
        }
      });
    });
    (0, _qunit.test)("Browsing group logs", async function (assert) {
      await (0, _testHelpers.visit)("/g/snorlax/manage/logs");
      assert.strictEqual((0, _qunitHelpers.count)("tr.group-manage-logs-row"), 2, "it should display the right number of logs");
      await (0, _testHelpers.click)((0, _qunitHelpers.query)(".group-manage-logs-row button"));
      assert.strictEqual((0, _qunitHelpers.count)("tr.group-manage-logs-row"), 1, "it should display the right number of logs");
    });
  });
});
define("discourse/tests/acceptance/group-manage-membership-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/tests/helpers/select-kit-helper", "qunit", "discourse/models/site"], function (_qunitHelpers, _testHelpers, _selectKitHelper, _qunit, _site) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"qunit",0,"discourse/models/site"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Managing Group Membership", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/associated_groups", () => helper.response({
        associated_groups: [{
          id: 123,
          name: "test-group",
          provider_name: "google_oauth2",
          label: "google_oauth2:test-group"
        }]
      }));
    });
    (0, _qunit.test)("As an admin", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        can_create_group: true
      });
      await (0, _testHelpers.visit)("/g/alternative-group/manage/membership");
      assert.strictEqual((0, _qunitHelpers.count)('label[for="automatic_membership"]'), 1, "it should display automatic membership label");
      assert.strictEqual((0, _qunitHelpers.count)(".groups-form-primary-group"), 1, "it should display set as primary group checkbox");
      assert.strictEqual((0, _qunitHelpers.count)(".groups-form-grant-trust-level"), 1, "it should display grant trust level selector");
      assert.strictEqual((0, _qunitHelpers.count)(".group-form-public-admission"), 1, "it should display group public admission input");
      assert.strictEqual((0, _qunitHelpers.count)(".group-form-public-exit"), 1, "it should display group public exit input");
      assert.strictEqual((0, _qunitHelpers.count)(".group-form-allow-membership-requests"), 1, "it should display group allow_membership_request input");
      assert.strictEqual((0, _qunitHelpers.count)(".group-form-allow-membership-requests[disabled]"), 1, "it should disable group allow_membership_request input");
      assert.strictEqual((0, _qunitHelpers.count)(".group-flair-inputs"), 1, "it should display avatar flair inputs");
      await (0, _testHelpers.click)(".group-form-public-admission");
      await (0, _testHelpers.click)(".group-form-allow-membership-requests");
      assert.strictEqual((0, _qunitHelpers.count)(".group-form-public-admission[disabled]"), 1, "it should disable group public admission input");
      assert.ok(!(0, _qunitHelpers.exists)(".group-form-public-exit[disabled]"), "it should not disable group public exit input");
      assert.strictEqual((0, _qunitHelpers.count)(".group-form-membership-request-template"), 1, "it should display the membership request template field");
      const emailDomains = (0, _selectKitHelper.default)(".group-form-automatic-membership-automatic");
      await emailDomains.expand();
      await emailDomains.fillInFilter("foo.com");
      await emailDomains.selectRowByValue("foo.com");
      assert.strictEqual(emailDomains.header().value(), "foo.com");
    });
    (0, _qunit.test)("As an admin on a site that can associate groups", async function (assert) {
      let site = _site.default.current();

      site.set("can_associate_groups", true);
      (0, _qunitHelpers.updateCurrentUser)({
        can_create_group: true
      });
      await (0, _testHelpers.visit)("/g/alternative-group/manage/membership");
      const associatedGroups = (0, _selectKitHelper.default)(".group-form-automatic-membership-associated-groups");
      await associatedGroups.expand();
      await associatedGroups.selectRowByName("google_oauth2:test-group");
      await associatedGroups.keyboard("enter");
      assert.equal(associatedGroups.header().name(), "google_oauth2:test-group");
    });
    (0, _qunit.test)("As an admin on a site that can't associate groups", async function (assert) {
      let site = _site.default.current();

      site.set("can_associate_groups", false);
      (0, _qunitHelpers.updateCurrentUser)({
        can_create_group: true
      });
      await (0, _testHelpers.visit)("/g/alternative-group/manage/membership");
      assert.ok(!(0, _qunitHelpers.exists)('label[for="automatic_membership_associated_groups"]'), "it should not display associated groups automatic membership label");
    });
    (0, _qunit.test)("As a group owner", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: false
      });
      await (0, _testHelpers.visit)("/g/discourse/manage/membership");
      assert.ok(!(0, _qunitHelpers.exists)('label[for="automatic_membership"]'), "it should not display automatic membership label");
      assert.ok(!(0, _qunitHelpers.exists)('label[for="automatic_membership_associated_groups"]'), "it should not display associated groups automatic membership label");
      assert.ok(!(0, _qunitHelpers.exists)(".groups-form-automatic-membership-retroactive"), "it should not display automatic membership retroactive checkbox");
      assert.ok(!(0, _qunitHelpers.exists)(".groups-form-primary-group"), "it should not display set as primary group checkbox");
      assert.ok(!(0, _qunitHelpers.exists)(".groups-form-grant-trust-level"), "it should not display grant trust level selector");
      assert.strictEqual((0, _qunitHelpers.count)(".group-form-public-admission"), 1, "it should display group public admission input");
      assert.strictEqual((0, _qunitHelpers.count)(".group-form-public-exit"), 1, "it should display group public exit input");
      assert.strictEqual((0, _qunitHelpers.count)(".group-form-allow-membership-requests"), 1, "it should display group allow_membership_request input");
      assert.strictEqual((0, _qunitHelpers.count)(".group-form-allow-membership-requests[disabled]"), 1, "it should disable group allow_membership_request input");
    });
  });
});
define("discourse/tests/acceptance/group-manage-profile-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Managing Group Profile", function () {
    (0, _qunit.test)("As an anonymous user", async function (assert) {
      await (0, _testHelpers.visit)("/g/discourse/manage/profile");
      assert.ok((0, _qunitHelpers.exists)(".group-members tr"), "it should redirect to members page for an anonymous user");
    });
  });
  (0, _qunitHelpers.acceptance)("Managing Group Profile", function (needs) {
    needs.user();
    (0, _qunit.test)("As an admin", async function (assert) {
      await (0, _testHelpers.visit)("/g/discourse/manage/profile");
      assert.strictEqual((0, _qunitHelpers.count)(".group-form-bio"), 1, "it should display group bio input");
      assert.strictEqual((0, _qunitHelpers.count)(".group-form-name"), 1, "it should display group name input");
      assert.strictEqual((0, _qunitHelpers.count)(".group-form-full-name"), 1, "it should display group full name input");
    });
    (0, _qunit.test)("As a group owner", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: false,
        can_create_group: false
      });
      await (0, _testHelpers.visit)("/g/discourse/manage/profile");
      assert.ok(!(0, _qunitHelpers.exists)(".group-form-name"), "it should not display group name input");
    });
  });
});
define("discourse/tests/acceptance/group-manage-tags-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Managing Group Tag Notification Defaults", function () {
    (0, _qunit.test)("As an anonymous user", async function (assert) {
      await (0, _testHelpers.visit)("/g/discourse/manage/tags");
      assert.ok((0, _qunitHelpers.exists)(".group-members tr"), "it should redirect to members page for an anonymous user");
    });
  });
  (0, _qunitHelpers.acceptance)("Managing Group Tag Notification Defaults", function (needs) {
    needs.user();
    (0, _qunit.test)("As an admin", async function (assert) {
      await (0, _testHelpers.visit)("/g/discourse/manage/tags");
      assert.strictEqual((0, _qunitHelpers.count)(".groups-notifications-form .tag-chooser"), 5, "it should display tag inputs");
    });
    (0, _qunit.test)("As a group owner", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: false
      });
      await (0, _testHelpers.visit)("/g/discourse/manage/tags");
      assert.strictEqual((0, _qunitHelpers.count)(".groups-notifications-form .tag-chooser"), 5, "it should display tag inputs");
    });
  });
});
define("discourse/tests/acceptance/group-requests-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Group Requests", function (needs) {
    let requests;
    needs.user();
    needs.hooks.beforeEach(() => requests = []);
    needs.pretender((server, helper) => {
      server.get("/groups/Macdonald.json", () => {
        return helper.response({
          group: {
            id: 42,
            automatic: false,
            name: "Macdonald",
            user_count: 1,
            mentionable_level: 0,
            messageable_level: 0,
            visibility_level: 0,
            automatic_membership_email_domains: "",
            primary_group: false,
            title: "Macdonald",
            grant_trust_level: null,
            incoming_email: null,
            has_messages: false,
            flair_url: null,
            flair_bg_color: "",
            flair_color: "",
            bio_raw: null,
            bio_cooked: null,
            public_admission: false,
            public_exit: false,
            allow_membership_requests: true,
            full_name: "Macdonald",
            default_notification_level: 3,
            membership_request_template: "",
            is_group_user: true,
            is_group_owner: true,
            is_group_owner_display: true,
            can_see_members: true,
            mentionable: false,
            messageable: false
          },
          extras: {
            visible_group_names: ["discourse", "Macdonald"]
          }
        });
      });
      server.get("/groups/Macdonald/members.json", () => {
        return helper.response({
          members: [{
            id: 19,
            username: "eviltrout",
            name: "Robin Ward",
            avatar_template: "/user_avatar/meta.discourse.org/eviltrout/{size}/5275_2.png",
            reason: "Please accept my membership request.",
            requested_at: "2019-01-31T12:00:00.000Z"
          }, {
            id: 20,
            username: "eviltrout2",
            name: "Robin Ward",
            avatar_template: "/user_avatar/meta.discourse.org/eviltrout/{size}/5275_2.png",
            reason: "Please accept another membership request.",
            requested_at: "2019-01-31T14:00:00.000Z"
          }],
          meta: {
            total: 2,
            limit: 50,
            offset: 0
          }
        });
      });
      server.put("/groups/42/handle_membership_request.json", request => {
        const body = helper.parsePostData(request.requestBody);
        requests.push([body["user_id"], body["accept"]]);
        return helper.success();
      });
    });
    (0, _qunit.test)("Group Requests", async function (assert) {
      await (0, _testHelpers.visit)("/g/Macdonald/requests");
      assert.strictEqual((0, _qunitHelpers.count)(".group-members tr"), 2);
      assert.strictEqual((0, _qunitHelpers.query)(".group-members tr:first-child td:nth-child(1)").innerText.trim().replace(/\s+/g, " "), "Robin Ward eviltrout");
      assert.strictEqual((0, _qunitHelpers.query)(".group-members tr:first-child td:nth-child(3)").innerText.trim(), "Please accept my membership request.");
      assert.strictEqual((0, _qunitHelpers.query)(".group-members tr:first-child .btn-primary").innerText.trim(), "Accept");
      assert.strictEqual((0, _qunitHelpers.query)(".group-members tr:first-child .btn-danger").innerText.trim(), "Deny");
      await (0, _testHelpers.click)(".group-members tr:first-child .btn-primary");
      assert.ok((0, _qunitHelpers.query)(".group-members tr:first-child td:nth-child(4)").innerText.trim().startsWith("accepted"));
      assert.deepEqual(requests, [["19", "true"]]);
      await (0, _testHelpers.click)(".group-members tr:last-child .btn-danger");
      assert.strictEqual((0, _qunitHelpers.query)(".group-members tr:last-child td:nth-child(4)").innerText.trim(), "denied");
      assert.deepEqual(requests, [["19", "true"], ["20", undefined]]);
    });
  });
});
define("discourse/tests/acceptance/group-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "I18n", "discourse/tests/helpers/select-kit-helper", "qunit"], function (_qunitHelpers, _testHelpers, _I18n, _selectKitHelper, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"I18n",0,"discourse/tests/helpers/select-kit-helper",0,"qunit"eaimeta@70e063a35619d71f

  function setupGroupPretender(server, helper) {
    server.post("/groups/Macdonald/request_membership", () => {
      return helper.response({
        relative_url: "/t/internationalization-localization/280"
      });
    });
  }

  function setupGroupTest(needs) {
    needs.settings({
      enable_group_directory: true
    });
  }

  (0, _qunitHelpers.acceptance)("Group - Anonymous", function (needs) {
    setupGroupTest(needs);
    needs.pretender(setupGroupPretender);
    (0, _qunit.test)("Anonymous Viewing Group", async function (assert) {
      await (0, _testHelpers.visit)("/g/discourse");
      assert.ok(!(0, _qunitHelpers.exists)(".nav-pills li a[title='Messages']"), "it does not show group messages navigation link");
      await (0, _testHelpers.click)(".nav-pills li a[title='Activity']");
      assert.ok((0, _qunitHelpers.exists)(".user-stream-item"), "it lists stream items");
      await (0, _testHelpers.click)(".activity-nav li a[href='/g/discourse/activity/topics']");
      assert.ok((0, _qunitHelpers.query)(".topic-list"), "it shows the topic list");
      assert.strictEqual((0, _qunitHelpers.count)(".topic-list-item"), 2, "it lists stream items");
      await (0, _testHelpers.click)(".activity-nav li a[href='/g/discourse/activity/mentions']");
      assert.ok((0, _qunitHelpers.exists)(".user-stream-item"), "it lists stream items");
      assert.ok(!(0, _qunitHelpers.exists)(".nav-pills li a[title='Edit Group']"), "it should not show messages tab if user is not admin");
      assert.ok(!(0, _qunitHelpers.exists)(".nav-pills li a[title='Logs']"), "it should not show Logs tab if user is not admin");
      assert.ok((0, _qunitHelpers.exists)(".user-stream-item"), "it lists stream items");
      const groupDropdown = (0, _selectKitHelper.default)(".group-dropdown");
      await groupDropdown.expand();
      assert.strictEqual(groupDropdown.rowByIndex(1).name(), "discourse");
      assert.strictEqual(groupDropdown.rowByIndex(0).name(), _I18n.default.t("groups.index.all"));
      this.siteSettings.enable_group_directory = false;
      await (0, _testHelpers.visit)("/g");
      await (0, _testHelpers.visit)("/g/discourse");
      await groupDropdown.expand();
      assert.ok(!(0, _qunitHelpers.exists)(".group-dropdown-filter"), "it should not display the default header");
    });
    (0, _qunit.test)("Anonymous Viewing Automatic Group", async function (assert) {
      await (0, _testHelpers.visit)("/g/moderators");
      assert.ok(!(0, _qunitHelpers.exists)(".nav-pills li a[title='Manage']"), "it does not show group messages navigation link");
    });
  });
  (0, _qunitHelpers.acceptance)("Group - Authenticated", function (needs) {
    setupGroupTest(needs);
    needs.user();
    needs.pretender((server, helper) => {
      setupGroupPretender(server, helper);
      server.get("/topics/private-messages-group/eviltrout/alternative-group.json", () => {
        return helper.response({
          topic_list: {
            topics: []
          }
        });
      });
      server.get("/topics/private-messages-group/eviltrout/discourse.json", () => {
        return helper.response({
          users: [{
            id: 2,
            username: "bruce1",
            avatar_template: "/user_avatar/meta.discourse.org/bruce1/{size}/5245.png"
          }, {
            id: 3,
            username: "CodingHorror",
            avatar_template: "/user_avatar/meta.discourse.org/codinghorror/{size}/5245.png"
          }],
          primary_groups: [],
          topic_list: {
            can_create_topic: true,
            draft: null,
            draft_key: "new_topic",
            draft_sequence: 0,
            per_page: 30,
            topics: [{
              id: 12199,
              title: "This is a private message 1",
              fancy_title: "This is a private message 1",
              slug: "this-is-a-private-message-1",
              posts_count: 0,
              reply_count: 0,
              highest_post_number: 0,
              image_url: null,
              created_at: "2018-03-16T03:38:45.583Z",
              last_posted_at: null,
              bumped: true,
              bumped_at: "2018-03-16T03:38:45.583Z",
              unseen: false,
              pinned: false,
              unpinned: null,
              visible: true,
              closed: false,
              archived: false,
              bookmarked: null,
              liked: null,
              views: 0,
              like_count: 0,
              has_summary: false,
              archetype: "private_message",
              last_poster_username: "bruce1",
              category_id: null,
              pinned_globally: false,
              featured_link: null,
              posters: [{
                extras: "latest single",
                description: "Original Poster, Most Recent Poster",
                user_id: 2,
                primary_group_id: null
              }],
              participants: [{
                extras: "latest",
                description: null,
                user_id: 2,
                primary_group_id: null
              }, {
                extras: null,
                description: null,
                user_id: 3,
                primary_group_id: null
              }]
            }]
          }
        });
      });
    });
    (0, _qunit.test)("User Viewing Group", async function (assert) {
      await (0, _testHelpers.visit)("/g");
      await (0, _testHelpers.click)(".group-index-request");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-header .title").innerText.trim(), _I18n.default.t("groups.membership_request.title", {
        group_name: "Macdonald"
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".request-group-membership-form textarea").value, "Please add me");
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
      assert.strictEqual((0, _qunitHelpers.query)(".fancy-title").innerText.trim(), "Internationalization / localization");
      await (0, _testHelpers.visit)("/g/discourse");
      await (0, _testHelpers.click)(".group-message-button");
      assert.strictEqual((0, _qunitHelpers.count)("#reply-control"), 1, "it opens the composer");
      const privateMessageUsers = (0, _selectKitHelper.default)("#private-message-users");
      assert.strictEqual(privateMessageUsers.header().value(), "discourse", "it prefills the group name");
      assert.ok(!(0, _qunitHelpers.exists)(".add-warning"), "groups can't receive warnings");
    });
    (0, _qunit.test)("Admin viewing group messages when there are no messages", async function (assert) {
      await (0, _testHelpers.visit)("/g/alternative-group");
      await (0, _testHelpers.click)(".nav-pills li a[title='Messages']");
      assert.strictEqual((0, _qunitHelpers.query)("span.empty-state-title").innerText.trim(), _I18n.default.t("no_group_messages_title"), "it should display the right text");
    });
    (0, _qunit.test)("Admin viewing group messages", async function (assert) {
      await (0, _testHelpers.visit)("/g/discourse");
      await (0, _testHelpers.click)(".nav-pills li a[title='Messages']");
      assert.strictEqual((0, _qunitHelpers.query)(".topic-list-item .link-top-line").innerText.trim(), "This is a private message 1", "it should display the list of group topics");
      await (0, _testHelpers.click)("#search-button");
      await (0, _testHelpers.fillIn)("#search-term", "something");
      assert.ok((0, _qunitHelpers.query)(".search-menu .btn.search-context"), "'in messages' toggle is active by default");
    });
    (0, _qunit.test)("Admin Viewing Group", async function (assert) {
      await (0, _testHelpers.visit)("/g/discourse");
      assert.strictEqual((0, _qunitHelpers.count)(".nav-pills li a[title='Manage']"), 1, "it should show manage group tab if user is admin");
      assert.strictEqual((0, _qunitHelpers.count)(".group-message-button"), 1, "it displays show group message button");
      assert.strictEqual((0, _qunitHelpers.query)(".group-info-name").innerText, "Awesome Team", "it should display the group name");
      await (0, _testHelpers.click)(".group-details-button button.btn-danger");
      assert.strictEqual((0, _qunitHelpers.query)(".bootbox .modal-body").innerHTML, _I18n.default.t("admin.groups.delete_with_messages_confirm", {
        count: 2
      }), "it should warn about orphan messages");
      await (0, _testHelpers.click)(".modal-footer .btn-default");
    });
    (0, _qunit.test)("Moderator Viewing Group", async function (assert) {
      await (0, _testHelpers.visit)("/g/alternative-group");
      assert.strictEqual((0, _qunitHelpers.count)(".nav-pills li a[title='Manage']"), 1, "it should show manage group tab if user can_admin_group");
      await (0, _testHelpers.click)(".group-members-add.btn");
      assert.ok((0, _qunitHelpers.exists)(".group-add-members-modal #set-owner"), "it allows moderators to set group owners");
      await (0, _testHelpers.click)(".group-add-members-modal .modal-close");
      const memberDropdown = (0, _selectKitHelper.default)(".group-member-dropdown:nth-of-type(1)");
      await memberDropdown.expand();
      assert.strictEqual(memberDropdown.rowByIndex(0).name(), _I18n.default.t("groups.members.remove_member"));
      assert.strictEqual(memberDropdown.rowByIndex(1).name(), _I18n.default.t("groups.members.make_owner"));
    });
  });
});
define("discourse/tests/acceptance/groups-index-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Groups", function () {
    (0, _qunit.test)("Browsing Groups", async function (assert) {
      await (0, _testHelpers.visit)("/g?username=eviltrout");
      assert.strictEqual((0, _qunitHelpers.count)(".group-box"), 1, "it displays user's groups");
      await (0, _testHelpers.visit)("/g");
      assert.strictEqual((0, _qunitHelpers.count)(".group-box"), 2, "it displays visible groups");
      assert.strictEqual((0, _qunitHelpers.count)(".group-index-join"), 1, "it shows button to join group");
      assert.strictEqual((0, _qunitHelpers.count)(".group-index-request"), 1, "it shows button to request for group membership");
      await (0, _testHelpers.click)(".group-index-join");
      assert.ok((0, _qunitHelpers.exists)(".modal.login-modal"), "it shows the login modal");
      await (0, _testHelpers.click)(".login-modal .close");
      assert.ok((0, _qunitHelpers.invisible)(".modal.login-modal"), "it closes the login modal");
      await (0, _testHelpers.click)(".group-index-request");
      assert.ok((0, _qunitHelpers.exists)(".modal.login-modal"), "it shows the login modal");
      await (0, _testHelpers.click)("a[href='/g/discourse/members']");
      assert.strictEqual((0, _qunitHelpers.query)(".group-info-name").innerText.trim(), "Awesome Team", "it displays the group page");
      await (0, _testHelpers.click)(".group-index-join");
      assert.ok((0, _qunitHelpers.exists)(".modal.login-modal"), "it shows the login modal");
    });
  });
});
define("discourse/tests/acceptance/groups-new-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "I18n", "qunit"], function (_qunitHelpers, _testHelpers, _I18n, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"I18n",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("New Group - Anonymous", function () {
    (0, _qunit.test)("As an anon user", async function (assert) {
      await (0, _testHelpers.visit)("/g");
      assert.ok(!(0, _qunitHelpers.exists)(".groups-header-new"), "it should not display the button to create a group");
    });
  });
  (0, _qunitHelpers.acceptance)("New Group - Authenticated", function (needs) {
    needs.user();
    (0, _qunit.test)("Creating a new group", async function (assert) {
      await (0, _testHelpers.visit)("/g");
      await (0, _testHelpers.click)(".groups-header-new");
      assert.strictEqual((0, _qunitHelpers.count)(".group-form-save[disabled]"), 1, "save button should be disabled");
      await (0, _testHelpers.fillIn)("input[name='name']", "1");
      assert.strictEqual((0, _qunitHelpers.query)(".tip.bad").innerText.trim(), _I18n.default.t("admin.groups.new.name.too_short"), "it should show the right validation tooltip");
      assert.strictEqual((0, _qunitHelpers.count)(".group-form-save:disabled"), 1, "it should disable the save button");
      await (0, _testHelpers.fillIn)("input[name='name']", "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa");
      assert.strictEqual((0, _qunitHelpers.query)(".tip.bad").innerText.trim(), _I18n.default.t("admin.groups.new.name.too_long"), "it should show the right validation tooltip");
      await (0, _testHelpers.fillIn)("input[name='name']", "");
      assert.strictEqual((0, _qunitHelpers.query)(".tip.bad").innerText.trim(), _I18n.default.t("admin.groups.new.name.blank"), "it should show the right validation tooltip");
      await (0, _testHelpers.fillIn)("input[name='name']", "good-username");
      assert.strictEqual((0, _qunitHelpers.query)(".tip.good").innerText.trim(), _I18n.default.t("admin.groups.new.name.available"), "it should show the right validation tooltip");
      await (0, _testHelpers.click)(".group-form-public-admission");
      assert.ok(!(0, _qunitHelpers.exists)("groups-new-allow-membership-requests"), "it should disable the membership requests checkbox");
      assert.strictEqual((0, _qunitHelpers.query)(".groups-form-default-notification-level .selected-name .name").innerText.trim(), _I18n.default.t("groups.notifications.watching.title"), "it has a default selection for notification level");
    });
  });
});
define("discourse/tests/acceptance/hamburger-menu-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Opening the hamburger menu with some reviewables", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/review/count.json", () => helper.response({
        count: 3
      }));
    });
    (0, _qunit.test)("As a staff member", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true,
        admin: false
      });
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".hamburger-dropdown");
      assert.strictEqual((0, _qunitHelpers.query)(".review .badge-notification.reviewables").innerText, "3");
    });
  });
});
define("discourse/tests/acceptance/hashtags-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Category and Tag Hashtags", function (needs) {
    needs.user();
    needs.settings({
      tagging_enabled: true
    });
    needs.pretender((server, helper) => {
      server.get("/hashtags", () => {
        return helper.response({
          categories: {
            bug: "/c/bugs"
          },
          tags: {
            monkey: "/tag/monkey",
            bug: "/tag/bug"
          }
        });
      });
    });
    (0, _qunit.test)("hashtags are cooked properly", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-buttons .btn.create");
      await (0, _testHelpers.fillIn)(".d-editor-input", `this is a category hashtag #bug

this is a tag hashtag #monkey

category vs tag: #bug vs #bug::tag

uppercase hashtag works too #BUG, #BUG::tag`);
      assert.ok((0, _qunitHelpers.visible)(".d-editor-preview"));
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-preview").innerHTML.trim(), `<p>this is a category hashtag <a href="/c/bugs" class="hashtag" tabindex=\"-1\">#<span>bug</span></a></p>
<p>this is a tag hashtag <a href="/tag/monkey" class="hashtag" tabindex=\"-1\">#<span>monkey</span></a></p>
<p>category vs tag: <a href="/c/bugs" class="hashtag" tabindex=\"-1\">#<span>bug</span></a> vs <a href="/tag/bug" class="hashtag" tabindex=\"-1\">#<span>bug</span></a></p>
<p>uppercase hashtag works too <a href="/c/bugs" class="hashtag" tabindex=\"-1\">#<span>BUG</span></a>, <a href="/tag/bug" class="hashtag" tabindex=\"-1\">#<span>BUG</span></a></p>`);
    });
  });
});
define("discourse/tests/acceptance/image-aspect-ratio-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Image aspect ratio", function () {
    (0, _qunit.test)("it applies the aspect ratio", async function (assert) {
      await (0, _testHelpers.visit)("/t/2480");
      const image = (0, _qunitHelpers.query)("#post_3 img[src='/assets/logo.png']");
      assert.strictEqual(image.style.aspectRatio, "690 / 388");
    });
  });
});
define("discourse/tests/acceptance/invite-accept-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/lib/preload-store", "I18n", "qunit"], function (_qunitHelpers, _testHelpers, _preloadStore, _I18n, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/lib/preload-store",0,"I18n",0,"qunit"eaimeta@70e063a35619d71f

  function setAuthenticationData(hooks, json) {
    hooks.beforeEach(() => {
      const node = document.createElement("meta");
      node.dataset.authenticationData = JSON.stringify(json);
      node.id = "data-authentication";
      document.querySelector("head").appendChild(node);
    });
    hooks.afterEach(() => {
      document.querySelector("head").removeChild(document.getElementById("data-authentication"));
    });
  }

  function preloadInvite() {
    let {
      link = false,
      email_verified_by_link = false,
      different_external_email = false,
      hidden_email = false
    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    const info = {
      invited_by: {
        id: 123,
        username: "foobar",
        avatar_template: "/user_avatar/localhost/neil/{size}/25_1.png",
        name: "foobar",
        title: "team"
      },
      username: "invited",
      email_verified_by_link,
      different_external_email,
      hidden_email
    };

    if (link) {
      info.email = "null";
      info.is_invite_link = true;
    } else {
      info.email = "foobar@example.com";
      info.is_invite_link = false;
    }

    _preloadStore.default.store("invite_info", info);
  }

  (0, _qunitHelpers.acceptance)("Invite accept", function (needs) {
    needs.settings({
      full_name_required: true
    });
    (0, _qunit.test)("email invite link", async function (assert) {
      _preloadStore.default.store("invite_info", {
        invited_by: {
          id: 123,
          username: "foobar",
          avatar_template: "/user_avatar/localhost/neil/{size}/25_1.png",
          name: "foobar",
          title: "team"
        },
        email: "foobar@example.com",
        username: "invited",
        is_invite_link: false
      });

      await (0, _testHelpers.visit)("/invites/my-valid-invite-token");
      assert.ok((0, _qunitHelpers.query)(".col-form").innerText.includes(_I18n.default.t("invites.social_login_available")), "shows social login hint");
      assert.ok(!(0, _qunitHelpers.exists)("#new-account-email"), "hides the email input");
    });
    (0, _qunit.test)("invite link", async function (assert) {
      _preloadStore.default.store("invite_info", {
        invited_by: {
          id: 123,
          username: "neil",
          avatar_template: "/user_avatar/localhost/neil/{size}/25_1.png",
          name: "Neil Lalonde",
          title: "team"
        },
        email: null,
        username: "invited",
        is_invite_link: true
      });

      await (0, _testHelpers.visit)("/invites/my-valid-invite-token");
      assert.ok((0, _qunitHelpers.exists)("#new-account-email"), "shows the email input");
      assert.ok((0, _qunitHelpers.exists)("#new-account-username"), "shows the username input");
      assert.strictEqual((0, _qunitHelpers.query)("#new-account-username").value, "invited", "username is prefilled");
      assert.ok((0, _qunitHelpers.exists)("#new-account-name"), "shows the name input");
      assert.ok((0, _qunitHelpers.exists)("#new-account-password"), "shows the password input");
      assert.ok((0, _qunitHelpers.exists)(".invites-show .btn-primary:disabled"), "submit is disabled because name and email is not filled");
      await (0, _testHelpers.fillIn)("#new-account-name", "John Doe");
      assert.ok((0, _qunitHelpers.exists)(".invites-show .btn-primary:disabled"), "submit is disabled because email is not filled");
      await (0, _testHelpers.fillIn)("#new-account-email", "john.doe@example.com");
      assert.ok((0, _qunitHelpers.exists)(".invites-show .btn-primary:disabled"), "submit is disabled because password is not filled");
      await (0, _testHelpers.fillIn)("#new-account-password", "top$ecret");
      assert.notOk((0, _qunitHelpers.exists)(".invites-show .btn-primary:disabled"), "submit is enabled");
      await (0, _testHelpers.fillIn)("#new-account-username", "a");
      assert.ok((0, _qunitHelpers.exists)(".username-input .bad"), "username is not valid");
      assert.ok((0, _qunitHelpers.exists)(".invites-show .btn-primary:disabled"), "submit is disabled");
      await (0, _testHelpers.fillIn)("#new-account-password", "aaa");
      assert.ok((0, _qunitHelpers.exists)(".password-input .bad"), "password is not valid");
      assert.ok((0, _qunitHelpers.exists)(".invites-show .btn-primary:disabled"), "submit is disabled");
      await (0, _testHelpers.fillIn)("#new-account-email", "john.doe@example");
      assert.ok((0, _qunitHelpers.exists)(".email-input .bad"), "email is not valid");
      assert.ok((0, _qunitHelpers.exists)(".invites-show .btn-primary:disabled"), "submit is disabled");
      await (0, _testHelpers.fillIn)("#new-account-username", "valid-name");
      await (0, _testHelpers.fillIn)("#new-account-password", "secur3ty4Y0uAndMe");
      await (0, _testHelpers.fillIn)("#new-account-email", "john.doe@example.com");
      assert.ok((0, _qunitHelpers.exists)(".username-input .good"), "username is valid");
      assert.ok((0, _qunitHelpers.exists)(".password-input .good"), "password is valid");
      assert.ok((0, _qunitHelpers.exists)(".email-input .good"), "email is valid");
      assert.notOk((0, _qunitHelpers.exists)(".invites-show .btn-primary:disabled"), "submit is enabled");
    });
    (0, _qunit.test)("invite name is required only if full name is required", async function (assert) {
      preloadInvite();
      await (0, _testHelpers.visit)("/invites/my-valid-invite-token");
      assert.ok((0, _qunitHelpers.exists)(".name-input .required"), "Full name is required");
    });
  });
  (0, _qunitHelpers.acceptance)("Invite accept when local login is disabled", function (needs) {
    needs.settings({
      enable_local_logins: false
    });
    (0, _qunit.test)("invite link", async function (assert) {
      preloadInvite({
        link: true
      });
      await (0, _testHelpers.visit)("/invites/my-valid-invite-token");
      assert.ok((0, _qunitHelpers.exists)(".btn-social.facebook"), "shows Facebook login button");
      assert.ok(!(0, _qunitHelpers.exists)("form"), "does not display the form");
    });
    (0, _qunit.test)("email invite link", async function (assert) {
      preloadInvite();
      await (0, _testHelpers.visit)("/invites/my-valid-invite-token");
      assert.ok((0, _qunitHelpers.exists)(".btn-social.facebook"), "shows Facebook login button");
      assert.ok(!(0, _qunitHelpers.exists)("form"), "does not display the form");
    });
  });
  (0, _qunitHelpers.acceptance)("Invite accept when DiscourseConnect SSO is enabled and local login is disabled", function (needs) {
    needs.settings({
      enable_local_logins: false,
      enable_discourse_connect: true
    });
    (0, _qunit.test)("invite link", async function (assert) {
      preloadInvite({
        link: true
      });
      await (0, _testHelpers.visit)("/invites/my-valid-invite-token");
      assert.ok(!(0, _qunitHelpers.exists)(".btn-social.facebook"), "does not show Facebook login button");
      assert.ok(!(0, _qunitHelpers.exists)("form"), "does not display the form");
      assert.ok(!(0, _qunitHelpers.exists)(".email-message"), "does not show the email message with the prefilled email");
      assert.ok((0, _qunitHelpers.exists)(".discourse-connect"), "shows the Continue button");
    });
    (0, _qunit.test)("email invite link", async function (assert) {
      preloadInvite();
      await (0, _testHelpers.visit)("/invites/my-valid-invite-token");
      assert.ok(!(0, _qunitHelpers.exists)(".btn-social.facebook"), "does not show Facebook login button");
      assert.ok(!(0, _qunitHelpers.exists)("form"), "does not display the form");
      assert.ok((0, _qunitHelpers.exists)(".email-message"), "shows the email message with the prefilled email");
      assert.ok((0, _qunitHelpers.exists)(".discourse-connect"), "shows the Continue button");
      assert.ok((0, _qunitHelpers.query)(".email-message").innerText.includes("foobar@example.com"));
    });
  });
  (0, _qunitHelpers.acceptance)("Invite accept when DiscourseConnect SSO is enabled and local login is enabled (bad config)", function (needs) {
    needs.settings({
      enable_local_logins: true,
      enable_discourse_connect: true
    });
    (0, _qunit.test)("invite link", async function (assert) {
      preloadInvite({
        link: true
      });
      await (0, _testHelpers.visit)("/invites/my-valid-invite-token");
      assert.ok(!(0, _qunitHelpers.exists)("form"), "does not display the form");
    });
  });
  (0, _qunitHelpers.acceptance)("Invite link with authentication data", function (needs) {
    needs.settings({
      enable_local_logins: false
    });
    setAuthenticationData(needs.hooks, {
      auth_provider: "facebook",
      email: "blah@example.com",
      email_valid: true,
      username: "foobar",
      name: "barfoo"
    });
    (0, _qunit.test)("form elements and buttons are correct ", async function (assert) {
      preloadInvite({
        link: true
      });
      await (0, _testHelpers.visit)("/invites/my-valid-invite-token");
      assert.ok(!(0, _qunitHelpers.exists)(".btn-social.facebook"), "does not show Facebook login button");
      assert.ok(!(0, _qunitHelpers.exists)("#new-account-password"), "does not show password field");
      assert.ok((0, _qunitHelpers.exists)("#new-account-email[disabled]"), "email field is disabled");
      assert.strictEqual((0, _qunitHelpers.query)("#account-email-validation").innerText.trim(), _I18n.default.t("user.email.authenticated", {
        provider: "Facebook"
      }));
      assert.strictEqual((0, _qunitHelpers.query)("#new-account-username").value, "foobar", "username is prefilled");
      assert.strictEqual((0, _qunitHelpers.query)("#new-account-name").value, "barfoo", "name is prefilled");
    });
  });
  (0, _qunitHelpers.acceptance)("Email Invite link with authentication data", function (needs) {
    needs.settings({
      enable_local_logins: false
    });
    setAuthenticationData(needs.hooks, {
      auth_provider: "facebook",
      email: "blah@example.com",
      email_valid: true,
      username: "foobar",
      name: "barfoo"
    });
    (0, _qunit.test)("email invite link with authentication data when email does not match", async function (assert) {
      preloadInvite();
      await (0, _testHelpers.visit)("/invites/my-valid-invite-token");
      assert.strictEqual((0, _qunitHelpers.query)("#account-email-validation").innerText.trim(), _I18n.default.t("user.email.invite_auth_email_invalid", {
        provider: "Facebook"
      }));
      assert.ok(!(0, _qunitHelpers.exists)("form"), "does not display the form");
    });
  });
  (0, _qunitHelpers.acceptance)("Email Invite link with valid authentication data", function (needs) {
    needs.settings({
      enable_local_logins: false
    });
    setAuthenticationData(needs.hooks, {
      auth_provider: "facebook",
      email: "foobar@example.com",
      email_valid: true,
      username: "foobar",
      name: "barfoo"
    });
    (0, _qunit.test)("confirm form and buttons", async function (assert) {
      preloadInvite();
      await (0, _testHelpers.visit)("/invites/my-valid-invite-token");
      assert.ok(!(0, _qunitHelpers.exists)(".btn-social.facebook"), "does not show Facebook login button");
      assert.ok(!(0, _qunitHelpers.exists)("#new-account-password"), "does not show password field");
      assert.ok(!(0, _qunitHelpers.exists)("#new-account-email"), "does not show email field");
      assert.strictEqual((0, _qunitHelpers.query)("#account-email-validation").innerText.trim(), _I18n.default.t("user.email.authenticated", {
        provider: "Facebook"
      }));
      assert.strictEqual((0, _qunitHelpers.query)("#new-account-username").value, "foobar", "username is prefilled");
      assert.strictEqual((0, _qunitHelpers.query)("#new-account-name").value, "barfoo", "name is prefilled");
    });
  });
  (0, _qunitHelpers.acceptance)("Email Invite link with different external email address", function (needs) {
    needs.settings({
      enable_local_logins: false
    });
    setAuthenticationData(needs.hooks, {
      auth_provider: "facebook",
      email: "foobar+different@example.com",
      email_valid: true,
      username: "foobar",
      name: "barfoo"
    });
    (0, _qunit.test)("display information that email is invalid", async function (assert) {
      preloadInvite({
        different_external_email: true,
        hidden_email: true
      });
      await (0, _testHelpers.visit)("/invites/my-valid-invite-token");
      assert.strictEqual((0, _qunitHelpers.query)(".bad").textContent.trim(), "Your invitation email does not match the email authenticated by Facebook");
    });
  });
  (0, _qunitHelpers.acceptance)("Email Invite link with valid authentication data, valid email token, unverified authentication email", function (needs) {
    needs.settings({
      enable_local_logins: false
    });
    setAuthenticationData(needs.hooks, {
      auth_provider: "facebook",
      email: "foobar@example.com",
      email_valid: false,
      username: "foobar",
      name: "barfoo"
    });
    (0, _qunit.test)("confirm form and buttons", async function (assert) {
      preloadInvite({
        email_verified_by_link: true
      });
      await (0, _testHelpers.visit)("/invites/my-valid-invite-token");
      assert.ok(!(0, _qunitHelpers.exists)("#new-account-email"), "does not show email field");
      assert.strictEqual((0, _qunitHelpers.query)("#account-email-validation").innerText.trim(), _I18n.default.t("user.email.authenticated_by_invite"));
    });
  });
  (0, _qunitHelpers.acceptance)("Email Invite link with valid authentication data, no email token, unverified authentication email", function (needs) {
    needs.settings({
      enable_local_logins: false
    });
    setAuthenticationData(needs.hooks, {
      auth_provider: "facebook",
      email: "foobar@example.com",
      email_valid: false,
      username: "foobar",
      name: "barfoo"
    });
    (0, _qunit.test)("confirm form and buttons", async function (assert) {
      preloadInvite({
        email_verified_by_link: false
      });
      await (0, _testHelpers.visit)("/invites/my-valid-invite-token");
      assert.ok(!(0, _qunitHelpers.exists)("#new-account-email"), "does not show email field");
      assert.strictEqual((0, _qunitHelpers.query)("#account-email-validation").innerText.trim(), _I18n.default.t("user.email.ok"));
    });
  });
  (0, _qunitHelpers.acceptance)("Invite link with authentication data, and associate link", function (needs) {
    needs.settings({
      enable_local_logins: false
    });
    setAuthenticationData(needs.hooks, {
      auth_provider: "facebook",
      email: "blah@example.com",
      email_valid: true,
      username: "foobar",
      name: "barfoo",
      associate_url: "/associate/abcde"
    });
    (0, _qunit.test)("shows the associate link", async function (assert) {
      preloadInvite({
        link: true
      });
      await (0, _testHelpers.visit)("/invites/my-valid-invite-token");
      assert.ok((0, _qunitHelpers.exists)(".create-account-associate-link"), "shows the associate account link");
    });
  });
});
define("discourse/tests/acceptance/invite-show-user-fields-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/lib/preload-store", "qunit"], function (_qunitHelpers, _testHelpers, _preloadStore, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/lib/preload-store",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Accept Invite - User Fields", function (needs) {
    needs.site({
      user_fields: [{
        id: 34,
        name: "I've read the terms of service",
        field_type: "confirm",
        required: true
      }, {
        id: 35,
        name: "What is your pet's name?",
        field_type: "text",
        required: true
      }, {
        id: 36,
        name: "What's your dad like?",
        field_type: "text",
        required: false
      }]
    });
    (0, _qunit.test)("accept invite with user fields", async function (assert) {
      _preloadStore.default.store("invite_info", {
        invited_by: {
          id: 123,
          username: "neil",
          avatar_template: "/user_avatar/localhost/neil/{size}/25_1.png",
          name: "Neil Lalonde",
          title: "team"
        },
        email: "invited@asdf.com",
        username: "invited",
        is_invite_link: false
      });

      await (0, _testHelpers.visit)("/invites/myvalidinvitetoken");
      assert.ok((0, _qunitHelpers.exists)(".invites-show"), "shows the accept invite page");
      assert.ok((0, _qunitHelpers.exists)(".user-field"), "it has at least one user field");
      assert.ok((0, _qunitHelpers.exists)(".invites-show .btn-primary:disabled"), "submit is disabled");
      await (0, _testHelpers.fillIn)("#new-account-name", "John Doe");
      await (0, _testHelpers.fillIn)("#new-account-username", "validname");
      await (0, _testHelpers.fillIn)("#new-account-password", "secur3ty4Y0uAndMe");
      assert.ok((0, _qunitHelpers.exists)(".username-input .good"), "username is valid");
      assert.ok((0, _qunitHelpers.exists)(".invites-show .btn-primary:disabled"), "submit is still disabled due to lack of user fields");
      await (0, _testHelpers.fillIn)(".user-field input[type=text]:nth-of-type(1)", "Barky");
      assert.ok((0, _qunitHelpers.exists)(".invites-show .btn-primary:disabled"), "submit is disabled because field is not checked");
      await (0, _testHelpers.click)(".user-field input[type=checkbox]");
      assert.notOk((0, _qunitHelpers.exists)(".invites-show .btn-primary:disabled"), "submit is enabled because field is checked");
      await (0, _testHelpers.click)(".user-field input[type=checkbox]");
      assert.ok((0, _qunitHelpers.exists)(".invites-show .btn-primary:disabled"), "unclicking the checkbox disables the submit");
    });
  });
});
define("discourse/tests/acceptance/jump-to-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Jump to", function (needs) {
    needs.user();
    needs.mobileView();
    needs.pretender((server, helper) => {
      server.get("/t/280/excerpts.json", () => helper.response(200, []));
      server.get("/t/280/3.json", () => helper.response(200, {}));
      server.get("/posts/by-date/280/:date", req => {
        if (req.params["date"] === "2014-02-24") {
          return helper.response(200, {
            post_number: 3
          });
        }

        return helper.response(404, null);
      });
    });
    (0, _qunit.test)("default", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("nav#topic-progress .nums");
      await (0, _testHelpers.click)("button.jump-to-post");
      assert.ok((0, _qunitHelpers.exists)(".jump-to-post-modal"), "it shows the modal");
      await (0, _testHelpers.fillIn)("input.date-picker", "2014-02-24");
      await (0, _testHelpers.click)(".jump-to-post-modal .btn-primary");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/t/internationalization-localization/280/3", "it jumps to the correct post");
    });
  });
});
define("discourse/tests/acceptance/keyboard-shortcuts-test", ["@ember/test-helpers", "discourse-common/lib/object", "I18n", "discourse/tests/helpers/qunit-helpers", "discourse/tests/fixtures/discovery-fixtures", "qunit"], function (_testHelpers, _object, _I18n, _qunitHelpers, _discoveryFixtures, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"@ember/test-helpers",0,"discourse-common/lib/object",0,"I18n",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/tests/fixtures/discovery-fixtures",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Keyboard Shortcuts - Anonymous Users", function (needs) {
    needs.pretender((server, helper) => {
      server.get("/t/27331/4.json", () => helper.response({}));
      server.get("/t/27331.json", () => helper.response({}));
      server.get("/t/27331/last.json", () => helper.response({})); // No suggested topics exist.

      server.get("/t/9/last.json", () => helper.response({})); // Suggested topic is returned by server.

      server.get("/t/28830/last.json", () => {
        return helper.response({
          suggested_topics: [{
            id: 27331,
            slug: "keyboard-shortcuts-are-awesome"
          }]
        });
      });
    });
    (0, _qunit.test)("go to first suggested topic", async function (assert) {
      await (0, _testHelpers.visit)("/t/this-is-a-test-topic/9");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "G");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "S");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/t/this-is-a-test-topic/9"); // Suggested topics elements exist.

      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "G");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "S");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/t/polls-are-still-very-buggy/27331/4");
      await (0, _testHelpers.visit)("/t/1-3-0beta9-no-rate-limit-popups/28830");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "G");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "S");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/t/keyboard-shortcuts-are-awesome/27331");
    });
    (0, _qunit.test)("j/k navigation moves selection up/down", async function (assert) {
      await (0, _testHelpers.visit)("/t/this-is-a-test-topic/9");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "J");
      assert.ok((0, _qunitHelpers.exists)(".post-stream .topic-post.selected #post_1"), "first post is selected");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "J");
      assert.ok((0, _qunitHelpers.exists)(".post-stream .topic-post.selected #post_2"), "pressing j moves selection to next post");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "K");
      assert.ok((0, _qunitHelpers.exists)(".post-stream .topic-post.selected #post_1"), "pressing k moves selection to previous post");
    });
  });
  (0, _qunitHelpers.acceptance)("Keyboard Shortcuts - Authenticated Users", function (needs) {
    let resetNewCalled;
    let markReadCalled;
    let topicList;
    needs.user();
    needs.hooks.beforeEach(() => {
      resetNewCalled = 0;
      markReadCalled = 0;
      topicList = (0, _object.cloneJSON)(_discoveryFixtures.default["/latest.json"]); // get rid of some of the topics and the more_topics_url
      // so we consider them allLoaded and show the footer with
      // the bottom dismiss button

      topicList.topic_list.topics.splice(20, 30);
      topicList.topic_list.more_topics_url = null;
    });
    needs.pretender((server, helper) => {
      server.get("/unread.json", () => {
        return helper.response(topicList);
      });
      server.get("/new.json", () => {
        return helper.response(topicList);
      });
      server.put("/topics/reset-new", () => {
        resetNewCalled += 1;
        return helper.response({});
      });
      server.put("/topics/bulk", () => {
        markReadCalled += 1;
        return helper.response({});
      });
    });
    (0, _qunit.test)("dismiss unread from top and bottom button", async function (assert) {
      // need to scroll to top so the viewport shows the top of the page
      // and top dismiss button
      await (0, _testHelpers.visit)("/");
      document.getElementById("ember-testing-container").scrollTop = 0;
      await (0, _testHelpers.visit)("/unread");
      assert.ok((0, _qunitHelpers.exists)("#dismiss-topics-top"), "dismiss unread top button is present");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "X");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "T");
      assert.ok((0, _qunitHelpers.exists)("#dismiss-read-confirm"), "confirmation modal to dismiss unread is present");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-body").innerText, _I18n.default.t("topics.bulk.also_dismiss_topics"));
      await (0, _testHelpers.click)("#dismiss-read-confirm");
      assert.strictEqual(markReadCalled, 1, "mark read has been called on the backend once"); // we get rid of all but one topic so the top dismiss button doesn't
      // show up, as it only appears if there are too many topics pushing
      // the bottom button out of the viewport

      let originalTopics = [...topicList.topic_list.topics];
      topicList.topic_list.topics = [topicList.topic_list.topics[0]]; // visit root first so topic list starts fresh

      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.visit)("/unread");
      assert.notOk((0, _qunitHelpers.exists)("#dismiss-topics-top"), "dismiss unread top button is hidden");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "X");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "T");
      assert.ok((0, _qunitHelpers.exists)("#dismiss-read-confirm"), "confirmation modal to dismiss unread is present");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-body").innerText, "Stop tracking these topics so they never show up as unread for me again");
      await (0, _testHelpers.click)("#dismiss-read-confirm");
      assert.strictEqual(markReadCalled, 2, "mark read has been called on the backend twice"); // restore the original topic list

      topicList.topic_list.topics = originalTopics;
    });
    (0, _qunit.test)("dismiss new from top and bottom button", async function (assert) {
      // need to scroll to top so the viewport shows the top of the page
      // and top dismiss button
      await (0, _testHelpers.visit)("/");
      document.getElementById("ember-testing-container").scrollTop = 0;
      await (0, _testHelpers.visit)("/new");
      assert.ok((0, _qunitHelpers.exists)("#dismiss-new-top"), "dismiss new top button is present");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "X");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "R");
      assert.strictEqual(resetNewCalled, 1); // we get rid of all but one topic so the top dismiss button doesn't
      // show up, as it only appears if there are too many topics pushing
      // the bottom button out of the viewport

      let originalTopics = [...topicList.topic_list.topics];
      topicList.topic_list.topics = [topicList.topic_list.topics[0]]; // visit root first so topic list starts fresh

      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.visit)("/new");
      assert.notOk((0, _qunitHelpers.exists)("#dismiss-new-top"), "dismiss new top button has been hidden");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "X");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "R");
      assert.strictEqual(resetNewCalled, 2); // restore the original topic list

      topicList.topic_list.topics = originalTopics;
    });
    (0, _qunit.test)("click event not fired twice when both dismiss buttons are present", async function (assert) {
      // need to scroll to top so the viewport shows the top of the page
      // and top dismiss button
      await (0, _testHelpers.visit)("/");
      document.getElementById("ember-testing-container").scrollTop = 0;
      await (0, _testHelpers.visit)("/new");
      assert.ok((0, _qunitHelpers.exists)("#dismiss-new-top"), "dismiss new top button is present before double click test");
      assert.ok((0, _qunitHelpers.exists)("#dismiss-new-bottom"), "dismiss new bottom button is present");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "X");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "R");
      assert.strictEqual(resetNewCalled, 1);
    });
  });
});
define("discourse/tests/acceptance/last-visited-topic-focus-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers", "discourse-common/lib/object", "discourse/tests/fixtures/topic"], function (_qunitHelpers, _qunit, _testHelpers, _object, _topic) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers",0,"discourse-common/lib/object",0,"discourse/tests/fixtures/topic"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Last Visited Topic Focus", function (needs) {
    needs.pretender((server, helper) => {
      const fixture = (0, _object.cloneJSON)(_topic.default["/t/54077.json"]);
      fixture.id = 11996;
      fixture.slug = "its-really-hard-to-navigate-the-create-topic-reply-pane-with-the-keyboard";
      server.get("/t/11996.json", () => helper.response(fixture));
    });
    (0, _qunit.test)("last visited topic receives focus when you return back to the topic list", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.visit)("/t/its-really-hard-to-navigate-the-create-topic-reply-pane-with-the-keyboard/11996");
      await (0, _testHelpers.visit)("/");
      const visitedTopicTitle = (0, _qunitHelpers.query)('.topic-list-body tr[data-topic-id="11996"] .main-link');
      assert.ok(visitedTopicTitle.classList.contains("focused"));
    });
  });
});
define("discourse/tests/acceptance/lightbox-test", ["@ember/test-helpers", "discourse-common/lib/object", "discourse/tests/fixtures/topic", "discourse/tests/helpers/qunit-helpers", "qunit"], function (_testHelpers, _object, _topic, _qunitHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"@ember/test-helpers",0,"discourse-common/lib/object",0,"discourse/tests/fixtures/topic",0,"discourse/tests/helpers/qunit-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Lightbox", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      const topicResponse = (0, _object.cloneJSON)(_topic.default["/t/280/1.json"]);
      topicResponse.post_stream.posts[0].cooked += `<div class="lightbox-wrapper">
      <a class="lightbox" href="/images/d-logo-sketch.png" data-download-href="//discourse.local/uploads/default/ad768537789cdf4679a18161ac0b0b6f0f4ccf9e" title="image">
        <img src="/images/d-logo-sketch-small.png" alt="image" data-base62-sha1="oKwwVE8qLWFBkE5UJeCs2EwxHHg" width="690" height="387" srcset="/images/d-logo-sketch-small.png" data-small-upload="/images/d-logo-sketch-small.png">
        <div class="meta">
          <svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg>
          <span class="filename">image</span><span class="informations">1500842 234 KB</span>
          <svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
        </div>
      </a>
    </div>`;
      server.get("/t/280.json", () => helper.response(topicResponse));
      server.get("/t/280/:post_number.json", () => helper.response(topicResponse));
    });
    (0, _qunit.test)("Shows download and direct URL", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)(".lightbox");
      assert.equal((0, _qunitHelpers.query)(".mfp-title").textContent, "image  1500842 234 KB  download  original image");
      assert.equal((0, _qunitHelpers.query)(".image-source-link:nth-child(1)").href, "http://discourse.local/uploads/default/ad768537789cdf4679a18161ac0b0b6f0f4ccf9e");
      assert.equal((0, _qunitHelpers.query)(".image-source-link:nth-child(2)").href, `${document.location.origin}/images/d-logo-sketch.png`);
      await (0, _testHelpers.click)(".mfp-close");
    });
  });
});
define("discourse/tests/acceptance/login-redirect-test", ["@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "qunit"], function (_testHelpers, _qunitHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Login redirect - anonymous", function () {
    (0, _qunit.test)("redirects login to default homepage", async function (assert) {
      await (0, _testHelpers.visit)("/login");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "discovery.latest", "it works when latest is the homepage");
    });
  });
  (0, _qunitHelpers.acceptance)("Login redirect - categories default", function (needs) {
    needs.settings({
      top_menu: "categories|latest|top|hot"
    });
    (0, _qunit.test)("when site setting is categories", async function (assert) {
      await (0, _testHelpers.visit)("/login");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "discovery.categories", "it works when categories is the homepage");
    });
  });
});
define("discourse/tests/acceptance/login-required-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Login Required", function (needs) {
    needs.settings({
      login_required: true
    });
    (0, _qunit.test)("redirect", async function (assert) {
      await (0, _testHelpers.visit)("/latest");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "login", "it redirects them to login");
      await (0, _testHelpers.click)("#site-logo");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "login", "clicking the logo keeps them on login");
      await (0, _testHelpers.click)("header .login-button");
      assert.ok((0, _qunitHelpers.exists)(".login-modal"), "they can still access the login modal");
      await (0, _testHelpers.click)(".modal-header .close");
      assert.ok((0, _qunitHelpers.invisible)(".login-modal"), "it closes the login modal");
    });
  });
});
define("discourse/tests/acceptance/login-with-email-and-hide-email-address-taken-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "I18n", "qunit"], function (_qunitHelpers, _testHelpers, _I18n, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"I18n",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Login with email - hide email address taken", function (needs) {
    needs.settings({
      enable_local_logins_via_email: true,
      hide_email_address_taken: true
    });
    needs.pretender((server, helper) => {
      server.post("/u/email-login", () => {
        return helper.response({
          success: "OK"
        });
      });
    });
    (0, _qunit.test)("with hide_email_address_taken enabled", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("header .login-button");
      await (0, _testHelpers.fillIn)("#login-account-name", "someuser@example.com");
      await (0, _testHelpers.click)("#email-login-link");
      assert.strictEqual((0, _qunitHelpers.query)(".alert-success").innerHTML.trim(), _I18n.default.t("email_login.complete_email_found", {
        email: "someuser@example.com"
      }), "it should display the success message for any email address");
    });
  });
});
define("discourse/tests/acceptance/login-with-email-and-no-social-logins-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Login with email - no social logins", function (needs) {
    needs.settings({
      enable_local_logins_via_email: true
    });
    needs.pretender((server, helper) => {
      server.post("/u/email-login", () => helper.response({
        success: "OK"
      }));
    });
    (0, _qunit.test)("with login with email enabled", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("header .login-button");
      assert.ok((0, _qunitHelpers.exists)("#email-login-link"));
    });
    (0, _qunit.test)("with login with email disabled", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("header .login-button");
      assert.notOk((0, _qunitHelpers.queryAll)(".login-buttons").is(":visible"));
    });
  });
});
define("discourse/tests/acceptance/login-with-email-disabled-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Login with email disabled", function (needs) {
    needs.settings({
      enable_local_logins_via_email: false,
      enable_facebook_logins: true
    });
    (0, _qunit.test)("with email button", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("header .login-button");
      assert.ok((0, _qunitHelpers.exists)(".btn-social.facebook"), "it displays the facebook login button");
      assert.notOk((0, _qunitHelpers.exists)("#email-login-link"), "it displays the login with email button");
    });
  });
});
define("discourse/tests/acceptance/login-with-email-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "I18n", "qunit", "discourse/lib/url", "sinon"], function (_qunitHelpers, _testHelpers, _I18n, _qunit, _url, _sinon) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"I18n",0,"qunit",0,"discourse/lib/url",0,"sinon"eaimeta@70e063a35619d71f

  const TOKEN = "sometoken";
  (0, _qunitHelpers.acceptance)("Login with email", function (needs) {
    needs.settings({
      enable_local_logins_via_email: true,
      enable_facebook_logins: true
    });
    let userFound = false;
    needs.pretender((server, helper) => {
      server.post("/u/email-login", () => helper.response({
        success: "OK",
        user_found: userFound
      }));
      server.get(`/session/email-login/${TOKEN}.json`, () => helper.response({
        token: TOKEN,
        can_login: true,
        token_email: "blah@example.com"
      }));
      server.post(`/session/email-login/${TOKEN}`, () => helper.response({
        success: true
      }));
    });
    (0, _qunit.test)("with email button", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("header .login-button");
      assert.ok((0, _qunitHelpers.exists)(".btn-social.facebook"), "it displays the facebook login button");
      assert.ok((0, _qunitHelpers.exists)("#email-login-link"), "it displays the login with email button");
      await (0, _testHelpers.fillIn)("#login-account-name", "someuser");
      await (0, _testHelpers.click)("#email-login-link");
      assert.strictEqual((0, _qunitHelpers.query)(".alert-error").innerHTML, _I18n.default.t("email_login.complete_username_not_found", {
        username: "someuser"
      }), "it should display an error for an invalid username");
      await (0, _testHelpers.fillIn)("#login-account-name", "someuser@gmail.com");
      await (0, _testHelpers.click)("#email-login-link");
      assert.strictEqual((0, _qunitHelpers.query)(".alert-error").innerHTML, _I18n.default.t("email_login.complete_email_not_found", {
        email: "someuser@gmail.com"
      }), "it should display an error for an invalid email");
      await (0, _testHelpers.fillIn)("#login-account-name", "someuser");
      userFound = true;
      await (0, _testHelpers.click)("#email-login-link");
      assert.strictEqual((0, _qunitHelpers.query)(".alert-success").innerHTML.trim(), _I18n.default.t("email_login.complete_username_found", {
        username: "someuser"
      }), "it should display a success message for a valid username");
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("header .login-button");
      await (0, _testHelpers.fillIn)("#login-account-name", "someuser@gmail.com");
      await (0, _testHelpers.click)("#email-login-link");
      assert.strictEqual((0, _qunitHelpers.query)(".alert-success").innerHTML.trim(), _I18n.default.t("email_login.complete_email_found", {
        email: "someuser@gmail.com"
      }), "it should display a success message for a valid email");
      userFound = false;
    });
    (0, _qunit.test)("finish login UI", async function (assert) {
      await (0, _testHelpers.visit)(`/session/email-login/${TOKEN}`);

      _sinon.default.stub(_url.default, "redirectTo");

      await (0, _testHelpers.click)(".email-login .btn-primary");
      assert.true(_url.default.redirectTo.calledWith("/"), "redirects to home");
    });
    (0, _qunit.test)("finish login UI - safe mode", async function (assert) {
      await (0, _testHelpers.visit)(`/session/email-login/${TOKEN}?safe_mode=no_themes,no_plugins`);

      _sinon.default.stub(_url.default, "redirectTo");

      await (0, _testHelpers.click)(".email-login .btn-primary");
      assert.true(_url.default.redirectTo.calledWith("/?safe_mode=no_themes%2Cno_plugins"), "redirects to home with safe mode");
    });
  });
});
define("discourse/tests/acceptance/mobile-discovery-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic Discovery - Mobile", function (needs) {
    needs.mobileView();
    (0, _qunit.test)("Visit Discovery Pages", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)(".topic-list"), "The list of topics was rendered");
      assert.ok((0, _qunitHelpers.exists)(".topic-list .topic-list-item"), "has topics");
      assert.strictEqual((0, _qunitHelpers.query)("a[data-user-card=codinghorror] img.avatar").getAttribute("loading"), "lazy", "it adds loading=`lazy` to topic list avatars");
      await (0, _testHelpers.visit)("/categories");
      assert.ok((0, _qunitHelpers.exists)(".category"), "has a list of categories");
    });
  });
});
define("discourse/tests/acceptance/mobile-pan-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers"], function (_qunitHelpers, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  async function triggerSwipeStart(touchTarget) {
    // Other tests are shown in a transformed viewport, and this is a multiple for the offsets
    let scale = parseFloat(window.getComputedStyle(document.querySelector("#ember-testing")).transform.replace("matrix(", "") || 1);
    const touchStart = {
      touchTarget,
      x: touchTarget.getBoundingClientRect().x + scale * touchTarget.offsetWidth / 2,
      y: touchTarget.getBoundingClientRect().y + scale * touchTarget.offsetHeight / 2
    };
    const touch = new Touch({
      identifier: "test",
      target: touchTarget,
      clientX: touchStart.x,
      clientY: touchStart.y
    });
    await (0, _testHelpers.triggerEvent)(touchTarget, "touchstart", {
      touches: [touch],
      targetTouches: [touch]
    });
    return touchStart;
  }

  async function triggerSwipeMove(_ref) {
    let {
      x,
      y,
      touchTarget
    } = _ref;
    const touch = new Touch({
      identifier: "test",
      target: touchTarget,
      clientX: x,
      clientY: y
    });
    await (0, _testHelpers.triggerEvent)(touchTarget, "touchmove", {
      touches: [touch],
      targetTouches: [touch]
    });
  }

  async function triggerSwipeEnd(_ref2) {
    let {
      x,
      y,
      touchTarget
    } = _ref2;
    const touch = new Touch({
      identifier: "test",
      target: touchTarget,
      clientX: x,
      clientY: y
    });
    await (0, _testHelpers.triggerEvent)(touchTarget, "touchend", {
      touches: [touch],
      targetTouches: [touch]
    });
  } // new Touch() isn't available in Firefox, so this is skipped there


  (0, _qunitHelpers.acceptance)("Mobile - menu swipes", function (needs) {
    needs.mobileView();
    needs.user();
    (0, _qunitHelpers.chromeTest)("swipe to close hamburger", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".hamburger-dropdown");
      const touchTarget = document.querySelector(".panel-body");
      let swipe = await triggerSwipeStart(touchTarget);
      swipe.x -= 20;
      await triggerSwipeMove(swipe);
      await triggerSwipeEnd(swipe);
      assert.ok(!(0, _qunitHelpers.exists)(".panel-body"), "it should close hamburger on a left swipe");
    });
    (0, _qunitHelpers.chromeTest)("swipe back and flick to re-open hamburger", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".hamburger-dropdown");
      const touchTarget = document.querySelector(".panel-body");
      let swipe = await triggerSwipeStart(touchTarget);
      swipe.x -= 100;
      await triggerSwipeMove(swipe);
      swipe.x += 20;
      await triggerSwipeMove(swipe);
      await triggerSwipeEnd(swipe);
      assert.strictEqual((0, _qunitHelpers.count)(".panel-body"), 1, "it should re-open hamburger on a right swipe");
    });
    (0, _qunitHelpers.chromeTest)("swipe to user menu", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#current-user");
      const touchTarget = document.querySelector(".panel-body");
      let swipe = await triggerSwipeStart(touchTarget);
      swipe.x += 20;
      await triggerSwipeMove(swipe);
      await triggerSwipeEnd(swipe);
      assert.ok(!(0, _qunitHelpers.exists)(".panel-body"), "it should close user menu on a left swipe");
    });
  });
});
define("discourse/tests/acceptance/mobile-sign-in-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Signing In - Mobile", function (needs) {
    needs.mobileView();
    (0, _qunit.test)("sign in", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("header .login-button");
      assert.ok((0, _qunitHelpers.exists)("#login-form"), "it shows the login modal");
    });
  });
});
define("discourse/tests/acceptance/mobile-topic-bulk-actions-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "I18n"], function (_qunitHelpers, _testHelpers, _qunit, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic - Bulk Actions - Mobile", function (needs) {
    needs.user();
    needs.mobileView();
    needs.settings({
      tagging_enabled: true
    });
    needs.pretender((server, helper) => {
      server.put("/topics/bulk", () => {
        return helper.response({
          topic_ids: []
        });
      });
    });
    (0, _qunit.test)("bulk select - modal", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true,
        enable_defer: true
      });
      await (0, _testHelpers.visit)("/latest");
      await (0, _testHelpers.click)("button.bulk-select");
      await (0, _testHelpers.click)((0, _qunitHelpers.queryAll)("input.bulk-select")[0]);
      await (0, _testHelpers.click)((0, _qunitHelpers.queryAll)("input.bulk-select")[1]);
      await (0, _testHelpers.click)(".bulk-select-actions");
      assert.ok((0, _qunitHelpers.query)("#discourse-modal-title").innerHTML.includes(_I18n.default.t("topics.bulk.actions")), "it opens bulk-select modal");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.change_category")), "it shows an option to change category");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.close_topics")), "it shows an option to close topics");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.archive_topics")), "it shows an option to archive topics");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.notification_level")), "it shows an option to update notification level");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.defer")), "it shows an option to reset read");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.unlist_topics")), "it shows an option to unlist topics");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.reset_bump_dates")), "it shows an option to reset bump dates");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.change_tags")), "it shows an option to replace tags");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.append_tags")), "it shows an option to append tags");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.remove_tags")), "it shows an option to remove all tags");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.delete")), "it shows an option to delete topics");
    });
    (0, _qunit.test)("bulk select - delete topics", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true
      });
      await (0, _testHelpers.visit)("/latest");
      await (0, _testHelpers.click)("button.bulk-select");
      await (0, _testHelpers.click)((0, _qunitHelpers.queryAll)("input.bulk-select")[0]);
      await (0, _testHelpers.click)((0, _qunitHelpers.queryAll)("input.bulk-select")[1]);
      await (0, _testHelpers.click)(".bulk-select-actions");
      await (0, _testHelpers.click)(".modal-body .delete-topics");
      assert.ok((0, _qunitHelpers.invisible)(".topic-bulk-actions-modal"), "it closes the bulk select modal");
    });
  });
});
define("discourse/tests/acceptance/mobile-users-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User Directory - Mobile", function (needs) {
    needs.mobileView();
    (0, _qunit.test)("Visit Page", async function (assert) {
      await (0, _testHelpers.visit)("/u");
      assert.ok((0, _qunitHelpers.exists)(".directory .user"), "has a list of users");
    });
  });
});
define("discourse/tests/acceptance/modal-test", ["@ember/template-factory", "discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "I18n", "discourse/lib/show-modal"], function (_templateFactory, _qunitHelpers, _testHelpers, _qunit, _I18n, _showModal) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"I18n",0,"ember-cli-htmlbars",0,"discourse/lib/show-modal"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Modal", function (needs) {
    let _translations;

    needs.hooks.beforeEach(() => {
      _translations = _I18n.default.translations;
      _I18n.default.translations = {
        en: {
          js: {
            test_title: "Test title"
          }
        }
      };
    });
    needs.hooks.afterEach(() => {
      _I18n.default.translations = _translations;
    });
    (0, _qunit.test)("modal", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.ok(!(0, _qunitHelpers.exists)(".d-modal:visible"), "there is no modal at first");
      await (0, _testHelpers.click)(".login-button");
      assert.strictEqual((0, _qunitHelpers.count)(".d-modal:visible"), 1, "modal should appear");
      let controller = (0, _qunitHelpers.controllerFor)("modal");
      assert.strictEqual(controller.name, "login");
      await (0, _testHelpers.click)(".modal-outer-container");
      assert.ok(!(0, _qunitHelpers.exists)(".d-modal:visible"), "modal should disappear when you click outside");
      assert.strictEqual(controller.name, null);
      await (0, _testHelpers.click)(".login-button");
      assert.strictEqual((0, _qunitHelpers.count)(".d-modal:visible"), 1, "modal should reappear");
      await (0, _testHelpers.triggerKeyEvent)("#main-outlet", "keydown", "Escape");
      assert.ok(!(0, _qunitHelpers.exists)(".d-modal:visible"), "ESC should close the modal"); // eslint-disable-next-line no-undef

      Ember.TEMPLATES["modal/not-dismissable"] = (0, _templateFactory.createTemplateFactory)(
      /*
        {{#d-modal-body title="" class="" dismissable=false}}test{{/d-modal-body}}
      */
      {
        "id": "pbPRPzsk",
        "block": "[[[6,[39,0],null,[[\"title\",\"class\",\"dismissable\"],[\"\",\"\",false]],[[\"default\"],[[[[1,\"test\"]],[]]]]]],[],false,[\"d-modal-body\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      });
      (0, _showModal.default)("not-dismissable", {});
      await (0, _testHelpers.settled)();
      assert.strictEqual((0, _qunitHelpers.count)(".d-modal:visible"), 1, "modal should appear");
      await (0, _testHelpers.click)(".modal-outer-container");
      assert.strictEqual((0, _qunitHelpers.count)(".d-modal:visible"), 1, "modal should not disappear when you click outside");
      await (0, _testHelpers.triggerKeyEvent)("#main-outlet", "keyup", "Escape");
      assert.strictEqual((0, _qunitHelpers.count)(".d-modal:visible"), 1, "ESC should not close the modal");
    });
    (0, _qunit.test)("rawTitle in modal panels", async function (assert) {
      // eslint-disable-next-line no-undef
      Ember.TEMPLATES["modal/test-raw-title-panels"] = (0, _templateFactory.createTemplateFactory)(
      /*
        
      */
      {
        "id": "BD59E4Lo",
        "block": "[[],[],false,[]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      });
      const panels = [{
        id: "test1",
        rawTitle: "Test 1"
      }, {
        id: "test2",
        rawTitle: "Test 2"
      }];
      await (0, _testHelpers.visit)("/");
      (0, _showModal.default)("test-raw-title-panels", {
        panels
      });
      await (0, _testHelpers.settled)();
      assert.strictEqual((0, _qunitHelpers.query)(".d-modal .modal-tab:first-child").innerText.trim(), "Test 1", "it should display the raw title");
    });
    (0, _qunit.test)("modal title", async function (assert) {
      // eslint-disable-next-line no-undef
      Ember.TEMPLATES["modal/test-title"] = (0, _templateFactory.createTemplateFactory)(
      /*
        
      */
      {
        "id": "BD59E4Lo",
        "block": "[[],[],false,[]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }); // eslint-disable-next-line no-undef

      Ember.TEMPLATES["modal/test-title-with-body"] = (0, _templateFactory.createTemplateFactory)(
      /*
        {{#d-modal-body}}test{{/d-modal-body}}
      */
      {
        "id": "B7l8d03Z",
        "block": "[[[6,[39,0],null,null,[[\"default\"],[[[[1,\"test\"]],[]]]]]],[],false,[\"d-modal-body\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      });
      await (0, _testHelpers.visit)("/");
      (0, _showModal.default)("test-title", {
        title: "test_title"
      });
      await (0, _testHelpers.settled)();
      assert.strictEqual((0, _qunitHelpers.query)(".d-modal .title").innerText.trim(), "Test title", "it should display the title");
      await (0, _testHelpers.click)(".d-modal .close");
      (0, _showModal.default)("test-title-with-body", {
        title: "test_title"
      });
      await (0, _testHelpers.settled)();
      assert.strictEqual((0, _qunitHelpers.query)(".d-modal .title").innerText.trim(), "Test title", "it should display the title when used with d-modal-body");
      await (0, _testHelpers.click)(".d-modal .close");
      (0, _showModal.default)("test-title");
      await (0, _testHelpers.settled)();
      assert.ok(!(0, _qunitHelpers.exists)(".d-modal .title"), "it should not re-use the previous title");
    });
  });
  (0, _qunitHelpers.acceptance)("Modal Keyboard Events", function (needs) {
    needs.user();
    (0, _qunit.test)("modal-keyboard-events", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".admin-topic-timer-update button");
      await (0, _testHelpers.triggerKeyEvent)(".d-modal", "keydown", "Enter");
      assert.strictEqual((0, _qunitHelpers.count)("#modal-alert:visible"), 1, "hitting Enter triggers modal action");
      assert.strictEqual((0, _qunitHelpers.count)(".d-modal:visible"), 1, "hitting Enter does not dismiss modal due to alert error");
      assert.ok((0, _qunitHelpers.exists)(".d-modal:visible"), "modal should be visible");
      await (0, _testHelpers.triggerKeyEvent)("#main-outlet", "keydown", "Escape");
      assert.ok(!(0, _qunitHelpers.exists)(".d-modal:visible"), "ESC should close the modal");
      await (0, _testHelpers.click)(".topic-body button.reply");
      await (0, _testHelpers.click)(".d-editor-button-bar .btn.link");
      await (0, _testHelpers.triggerKeyEvent)(".d-modal", "keydown", "Enter");
      assert.ok(!(0, _qunitHelpers.exists)(".d-modal:visible"), "modal should disappear on hitting Enter");
    });
  });
});
define("discourse/tests/acceptance/new-message-test", ["discourse/tests/helpers/select-kit-helper", "discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers"], function (_selectKitHelper, _qunitHelpers, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/select-kit-helper",0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("New Message - Anonymous", function () {
    (0, _qunit.test)("accessing new-message route when logged out", async function (assert) {
      await (0, _testHelpers.visit)("/new-message?username=charlie&title=message%20title&body=message%20body");
      assert.ok((0, _qunitHelpers.exists)(".modal.login-modal"), "it shows the login modal");
    });
  });
  (0, _qunitHelpers.acceptance)("New Message - Authenticated", function (needs) {
    needs.user();
    (0, _qunit.test)("accessing new-message route when logged in", async function (assert) {
      await (0, _testHelpers.visit)("/new-message?username=charlie,john&title=message%20title&body=message%20body");
      assert.ok((0, _qunitHelpers.exists)(".composer-fields"), "it opens composer");
      assert.strictEqual((0, _qunitHelpers.query)("#reply-title").value.trim(), "message title", "it pre-fills message title");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value.trim(), "message body", "it pre-fills message body");
      const privateMessageUsers = (0, _selectKitHelper.default)("#private-message-users");
      assert.strictEqual(privateMessageUsers.header().value(), "charlie,john", "it selects correct username");
    });
  });
});
define("discourse/tests/acceptance/new-topic-test", ["discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/select-kit-helper", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _selectKitHelper, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("New Topic - Anonymous", function () {
    (0, _qunit.test)("accessing new-topic route when logged out", async function (assert) {
      await (0, _testHelpers.visit)("/new-topic?title=topic%20title&body=topic%20body");
      assert.ok((0, _qunitHelpers.exists)(".modal.login-modal"), "it shows the login modal");
    });
  });
  (0, _qunitHelpers.acceptance)("New Topic - Authenticated", function (needs) {
    needs.user();
    (0, _qunit.test)("accessing new-topic route when logged in", async function (assert) {
      await (0, _testHelpers.visit)("/new-topic?title=topic%20title&body=topic%20body&category=bug");
      assert.ok((0, _qunitHelpers.exists)(".composer-fields"), "it opens composer");
      assert.strictEqual((0, _qunitHelpers.query)("#reply-title").value.trim(), "topic title", "it pre-fills topic title");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value.trim(), "topic body", "it pre-fills topic body");
      assert.strictEqual((0, _selectKitHelper.default)(".category-chooser").header().value(), "1", "it selects desired category");
    });
  });
});
define("discourse/tests/acceptance/notifications-filter-test", ["discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/select-kit-helper", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _selectKitHelper, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Notifications filter", function (needs) {
    needs.user();
    (0, _qunit.test)("Notifications filter true", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/notifications");
      assert.ok((0, _qunitHelpers.exists)(".large-notification"));
    });
    (0, _qunit.test)("Notifications filter read", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/notifications");
      const dropdown = (0, _selectKitHelper.default)(".notifications-filter");
      await dropdown.expand();
      await dropdown.selectRowByValue("read");
      assert.ok((0, _qunitHelpers.exists)(".large-notification"));
    });
    (0, _qunit.test)("Notifications filter unread", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/notifications");
      const dropdown = (0, _selectKitHelper.default)(".notifications-filter");
      await dropdown.expand();
      await dropdown.selectRowByValue("unread");
      assert.ok((0, _qunitHelpers.exists)(".large-notification"));
    });
  });
});
define("discourse/tests/acceptance/notifications-test", ["@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "qunit", "discourse/models/user"], function (_testHelpers, _qunitHelpers, _qunit, _user) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"discourse/models/user"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User Notifications", function (needs) {
    needs.user();
    (0, _qunit.test)("Update works correctly", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("li.current-user"); // set older notifications to read

      await (0, _qunitHelpers.publishToMessageBus)("/notification/19", {
        unread_notifications: 5,
        unread_private_messages: 0,
        unread_high_priority_notifications: 0,
        read_first_notification: false,
        last_notification: {},
        recent: [[123, false], [456, false], [789, true], [1234, true], [5678, true]],
        seen_notification_id: null
      });
      assert.strictEqual((0, _qunitHelpers.count)("#quick-access-notifications li"), 6); // high priority, unread notification - should be first

      await (0, _qunitHelpers.publishToMessageBus)("/notification/19", {
        unread_notifications: 6,
        unread_private_messages: 0,
        unread_high_priority_notifications: 1,
        read_first_notification: false,
        last_notification: {
          notification: {
            id: 42,
            user_id: 1,
            notification_type: 5,
            read: false,
            high_priority: true,
            created_at: "2021-01-01 12:00:00 UTC",
            post_number: 1,
            topic_id: 42,
            fancy_title: "First notification",
            slug: "topic",
            data: {
              topic_title: "First notification",
              original_post_id: 42,
              original_post_type: 1,
              original_username: "foo",
              revision_number: null,
              display_username: "foo"
            }
          }
        },
        recent: [[42, false], [123, false], [456, false], [789, true], [1234, true], [5678, true]],
        seen_notification_id: null
      });
      assert.strictEqual((0, _qunitHelpers.count)("#quick-access-notifications li"), 6);
      assert.strictEqual((0, _qunitHelpers.query)("#quick-access-notifications li span[data-topic-id]").innerText, "First notification"); // high priority, read notification - should be second

      await (0, _qunitHelpers.publishToMessageBus)("/notification/19", {
        unread_notifications: 7,
        unread_private_messages: 0,
        unread_high_priority_notifications: 1,
        read_first_notification: false,
        last_notification: {
          notification: {
            id: 43,
            user_id: 1,
            notification_type: 5,
            read: true,
            high_priority: false,
            created_at: "2021-01-01 12:00:00 UTC",
            post_number: 1,
            topic_id: 42,
            fancy_title: "Second notification",
            slug: "topic",
            data: {
              topic_title: "Second notification",
              original_post_id: 42,
              original_post_type: 1,
              original_username: "foo",
              revision_number: null,
              display_username: "foo"
            }
          }
        },
        recent: [[42, false], [43, true], [123, false], [456, false], [789, true], [1234, true], [5678, true]],
        seen_notification_id: null
      });
      assert.strictEqual((0, _qunitHelpers.count)("#quick-access-notifications li"), 7);
      assert.strictEqual((0, _qunitHelpers.queryAll)("#quick-access-notifications li span[data-topic-id]")[1].innerText, "Second notification"); // updates existing notifications

      await (0, _qunitHelpers.publishToMessageBus)("/notification/19", {
        unread_notifications: 8,
        unread_private_messages: 0,
        unread_high_priority_notifications: 1,
        read_first_notification: false,
        last_notification: {
          notification: {
            id: 44,
            user_id: 1,
            notification_type: 5,
            read: true,
            high_priority: false,
            created_at: "2021-01-01 12:00:00 UTC",
            post_number: 1,
            topic_id: 42,
            fancy_title: "Third notification",
            slug: "topic",
            data: {
              topic_title: "Third notification",
              original_post_id: 42,
              original_post_type: 1,
              original_username: "foo",
              revision_number: null,
              display_username: "foo"
            }
          }
        },
        recent: [[5678, false], [1234, false], [789, false], [456, true], [123, true], [44, false], [43, false], [42, true]],
        seen_notification_id: null
      });
      assert.strictEqual((0, _qunitHelpers.count)("#quick-access-notifications li"), 8);
      const texts = [];
      [...(0, _qunitHelpers.queryAll)("#quick-access-notifications li")].forEach(element => {
        texts.push(element.innerText.trim());
      });
      assert.deepEqual(texts, ["foo First notification", "foo Third notification", "foo Second notification", "velesin some title", "aquaman liked 5 of your posts", "5 messages in your test inbox", "test1 accepted your invitation", "Membership accepted in 'test'"]);
    });
  });
  (0, _qunitHelpers.acceptance)("Category Notifications", function (needs) {
    needs.user({
      muted_category_ids: [1],
      indirectly_muted_category_ids: [2]
    });
    (0, _qunit.test)("New category is muted when parent category is muted", async function (assert) {
      await (0, _testHelpers.visit)("/");

      const user = _user.default.current();

      await (0, _qunitHelpers.publishToMessageBus)("/categories", {
        categories: [{
          id: 3,
          parent_category_id: 99
        }, {
          id: 4
        }]
      });
      assert.deepEqual(user.indirectly_muted_category_ids, [2]);
      await (0, _qunitHelpers.publishToMessageBus)("/categories", {
        categories: [{
          id: 4,
          parent_category_id: 1
        }, {
          id: 5,
          parent_category_id: 2
        }]
      });
      assert.deepEqual(user.indirectly_muted_category_ids, [2, 4, 5]);
    });
  });
  (0, _qunitHelpers.acceptance)("User Notifications - there is no notifications yet", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/notifications", () => {
        return helper.response({
          notifications: []
        });
      });
    });
    (0, _qunit.test)("It renders the empty state panel", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/notifications");
      assert.ok((0, _qunitHelpers.exists)("div.empty-state"));
    });
    (0, _qunit.test)("It does not render filter", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/notifications");
      assert.notOk((0, _qunitHelpers.exists)("div.user-notifications-filter"));
    });
  });
});
define("discourse/tests/acceptance/opengraph-tag-updater-test", ["@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "qunit"], function (_testHelpers, _qunitHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Opengraph Tag Updater", function (needs) {
    needs.pretender((server, helper) => {
      server.get("/about", () => {
        return helper.response({});
      });
    });
    (0, _qunit.test)("updates OG title and URL", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#toggle-hamburger-menu");
      await (0, _testHelpers.click)("a.about-link");
      assert.strictEqual(document.querySelector("meta[property='og:title']").getAttribute("content"), document.title, "it should update OG title");
      assert.ok(document.querySelector("meta[property='og:url']").getAttribute("content").endsWith("/about"), "it should update OG URL");
    });
  });
});
define("discourse/tests/acceptance/page-publishing-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Page Publishing", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      const validSlug = helper.response({
        valid_slug: true
      });
      server.put("/pub/by-topic/280", () => {
        return helper.response({});
      });
      server.get("/pub/by-topic/280", () => {
        return helper.response({});
      });
      server.get("/pub/check-slug", req => {
        if (req.queryParams.slug === "internationalization-localization") {
          return validSlug;
        }

        return helper.response({
          valid_slug: false,
          reason: "i don't need a reason"
        });
      });
    });
    (0, _qunit.test)("can publish a page via modal", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.show-more-actions");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.show-post-admin-menu");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) .publish-page");
      await (0, _testHelpers.fillIn)(".publish-slug", "bad-slug");
      assert.ok(!(0, _qunitHelpers.exists)(".valid-slug"));
      assert.ok((0, _qunitHelpers.exists)(".invalid-slug"));
      await (0, _testHelpers.fillIn)(".publish-slug", "internationalization-localization");
      assert.ok((0, _qunitHelpers.exists)(".valid-slug"));
      assert.ok(!(0, _qunitHelpers.exists)(".invalid-slug"));
      await (0, _testHelpers.click)(".publish-page");
      assert.ok((0, _qunitHelpers.exists)(".current-url"));
    });
  });
});
define("discourse/tests/acceptance/password-reset-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/lib/url", "I18n", "discourse/lib/preload-store", "discourse/tests/helpers/create-pretender", "sinon", "qunit"], function (_qunitHelpers, _testHelpers, _url, _I18n, _preloadStore, _createPretender, _sinon, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/lib/url",0,"I18n",0,"discourse/lib/preload-store",0,"discourse/tests/helpers/create-pretender",0,"sinon",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Password Reset", function (needs) {
    needs.pretender((server, helper) => {
      server.get("/u/confirm-email-token/myvalidtoken.json", () => helper.response({
        success: "OK"
      }));
      server.get("/u/confirm-email-token/requiretwofactor.json", () => helper.response({
        success: "OK"
      }));
      server.put("/u/password-reset/myvalidtoken.json", request => {
        const body = (0, _createPretender.parsePostData)(request.requestBody);

        if (body.password === "jonesyAlienSlayer") {
          return helper.response({
            success: false,
            errors: {
              password: ["is the name of your cat"]
            }
          });
        } else {
          return helper.response({
            success: "OK",
            message: _I18n.default.t("password_reset.success")
          });
        }
      });
      server.put("/u/password-reset/requiretwofactor.json", request => {
        const body = (0, _createPretender.parsePostData)(request.requestBody);

        if (body.password === "perf3ctly5ecur3" && body.second_factor_token === "123123") {
          return helper.response({
            success: "OK",
            message: _I18n.default.t("password_reset.success")
          });
        } else if (body.second_factor_token === "123123") {
          return helper.response({
            success: false,
            errors: {
              password: ["invalid"]
            }
          });
        } else {
          return helper.response({
            success: false,
            message: "invalid token",
            errors: {
              user_second_factors: ["invalid token"]
            }
          });
        }
      });
    });
    (0, _qunit.test)("Password Reset Page", async function (assert) {
      _preloadStore.default.store("password_reset", {
        is_developer: false
      });

      await (0, _testHelpers.visit)("/u/password-reset/myvalidtoken");
      assert.ok((0, _qunitHelpers.exists)(".password-reset input"), "shows the input");
      await (0, _testHelpers.fillIn)(".password-reset input", "perf3ctly5ecur3");
      assert.ok((0, _qunitHelpers.exists)(".password-reset .tip.good"), "input looks good");
      await (0, _testHelpers.fillIn)(".password-reset input", "123");
      assert.ok((0, _qunitHelpers.exists)(".password-reset .tip.bad"), "input is not valid");
      assert.ok((0, _qunitHelpers.query)(".password-reset .tip.bad").innerHTML.includes(_I18n.default.t("user.password.too_short")), "password too short");
      await (0, _testHelpers.fillIn)(".password-reset input", "jonesyAlienSlayer");
      await (0, _testHelpers.click)(".password-reset form button");
      assert.ok((0, _qunitHelpers.exists)(".password-reset .tip.bad"), "input is not valid");
      assert.ok((0, _qunitHelpers.query)(".password-reset .tip.bad").innerHTML.includes("is the name of your cat"), "server validation error message shows");
      await (0, _testHelpers.fillIn)(".password-reset input", "perf3ctly5ecur3");

      _sinon.default.stub(_url.default, "redirectTo");

      await (0, _testHelpers.click)(".password-reset form button");
      assert.ok(_url.default.redirectTo.calledWith("/"), "form is gone");
    });
    (0, _qunit.test)("Password Reset Page With Second Factor", async function (assert) {
      _preloadStore.default.store("password_reset", {
        is_developer: false,
        second_factor_required: true
      });

      await (0, _testHelpers.visit)("/u/password-reset/requiretwofactor");
      assert.notOk((0, _qunitHelpers.exists)("#new-account-password"), "does not show the input");
      assert.ok((0, _qunitHelpers.exists)("#second-factor"), "shows the second factor prompt");
      await (0, _testHelpers.fillIn)("input#second-factor", "0000");
      await (0, _testHelpers.click)(".password-reset form button");
      assert.ok((0, _qunitHelpers.exists)(".alert-error"), "shows 2 factor error");
      assert.ok((0, _qunitHelpers.query)(".alert-error").innerHTML.includes("invalid token"), "shows server validation error message");
      await (0, _testHelpers.fillIn)("input#second-factor", "123123");
      await (0, _testHelpers.click)(".password-reset form button");
      assert.notOk((0, _qunitHelpers.exists)(".alert-error"), "hides error");
      assert.ok((0, _qunitHelpers.exists)("#new-account-password"), "shows the input");
      await (0, _testHelpers.fillIn)(".password-reset input", "perf3ctly5ecur3");

      _sinon.default.stub(_url.default, "redirectTo");

      await (0, _testHelpers.click)(".password-reset form button");
      assert.ok(_url.default.redirectTo.calledWith("/"), "it redirects after submitting form");
    });
  });
});
define("discourse/tests/acceptance/pending-posts-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Pending posts - no existing pending posts", function (needs) {
    needs.user();
    (0, _qunit.test)("No link to pending posts", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout");
      assert.ok(!(0, _qunitHelpers.exists)(".action-list [href='/u/eviltrout/activity/pending']"));
    });
  });
  (0, _qunitHelpers.acceptance)("Pending posts - existing pending posts", function (needs) {
    needs.user({
      pending_posts_count: 2
    });
    (0, _qunit.test)("Navigate to pending posts", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout");
      await (0, _testHelpers.click)("[href='/u/eviltrout/activity/pending']");
      assert.strictEqual((0, _qunitHelpers.count)(".user-stream-item"), 2);
    });
  });
});
define("discourse/tests/acceptance/personal-message-test", ["discourse/tests/helpers/qunit-helpers", "I18n", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _I18n, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"I18n",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Personal Message", function (needs) {
    needs.user();
    (0, _qunit.test)("footer edit button", async function (assert) {
      await (0, _testHelpers.visit)("/t/pm-for-testing/12");
      assert.ok(!(0, _qunitHelpers.exists)(".edit-message"), "does not show edit first post button on footer by default");
    });
    (0, _qunit.test)("suggested messages", async function (assert) {
      await (0, _testHelpers.visit)("/t/pm-for-testing/12");
      assert.strictEqual((0, _qunitHelpers.query)("#suggested-topics .suggested-topics-title").innerText.trim(), _I18n.default.t("suggested_topics.pm_title"));
    });
  });
});
define("discourse/tests/acceptance/plugin-keyboard-shortcut-test", ["@ember/test-helpers", "discourse/lib/keyboard-shortcuts", "discourse/tests/helpers/qunit-helpers", "sinon", "qunit", "discourse/lib/plugin-api"], function (_testHelpers, _keyboardShortcuts, _qunitHelpers, _sinon, _qunit, _pluginApi) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"@ember/test-helpers",0,"discourse/lib/keyboard-shortcuts",0,"discourse/tests/helpers/qunit-helpers",0,"sinon",0,"qunit",0,"discourse/lib/plugin-api"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Plugin Keyboard Shortcuts - Logged In", function (needs) {
    needs.user();
    (0, _qunit.test)("a plugin can add a keyboard shortcut", async function (assert) {
      (0, _pluginApi.withPluginApi)("0.8.38", api => {
        api.addKeyboardShortcut("]", () => {
          document.querySelector("#qunit-fixture").innerHTML = `<div id="added-element">Test adding plugin shortcut</div>`;
        });
      });
      await (0, _testHelpers.visit)("/t/this-is-a-test-topic/9");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "]".charCodeAt(0));
      assert.ok(document.querySelector("#added-element"), "the keyboard shortcut callback fires successfully");
    });
  });
  (0, _qunitHelpers.acceptance)("Plugin Keyboard Shortcuts - Anonymous", function () {
    (0, _qunit.test)("a plugin can add a keyboard shortcut with an option", async function (assert) {
      let spy = _sinon.default.spy(_keyboardShortcuts.default, "_bindToPath");

      (0, _pluginApi.withPluginApi)("0.8.38", api => {
        api.addKeyboardShortcut("]", () => {}, {
          anonymous: true,
          path: "test-path"
        });
      });
      assert.ok(spy.calledWith("test-path", "]"), "bindToPath is called due to options provided");
    });
    (0, _qunit.test)("a plugin can add a shortcut and create a new category in the shortcut help modal", async function (assert) {
      (0, _pluginApi.withPluginApi)("0.8.38", api => {
        api.addKeyboardShortcut("meta+]", () => {}, {
          help: {
            category: "new_category",
            name: "new_category.test",
            definition: {
              keys1: ["meta", "]"],
              keys2: ["meta", "["],
              keysDelimiter: "plus",
              shortcutsDelimiter: "slash"
            }
          }
        });
      });
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "?".charCodeAt(0));
      assert.ok((0, _qunitHelpers.exists)(".shortcut-category-new_category"));
      assert.strictEqual((0, _qunitHelpers.count)(".shortcut-category-new_category li"), 1);
    });
    (0, _qunit.test)("a plugin can add a shortcut to and existing category in the shortcut help modal", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "?".charCodeAt(0));
      const countBefore = (0, _qunitHelpers.count)(".shortcut-category-application li");
      await (0, _testHelpers.click)(".modal-close");
      (0, _pluginApi.withPluginApi)("0.8.38", api => {
        api.addKeyboardShortcut("meta+]", () => {}, {
          help: {
            category: "application",
            name: "application.test",
            definition: {
              keys1: ["]"]
            }
          }
        });
      });
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "?".charCodeAt(0));
      assert.strictEqual((0, _qunitHelpers.count)(".shortcut-category-application li"), countBefore + 1);
    });
  });
});
define("discourse/tests/acceptance/plugin-outlet-connector-class-test", ["@ember/template-factory", "discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "@ember/object", "discourse/lib/plugin-connectors", "qunit"], function (_templateFactory, _qunitHelpers, _testHelpers, _object, _pluginConnectors, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"@ember/object",0,"discourse/lib/plugin-connectors",0,"ember-cli-htmlbars",0,"qunit"eaimeta@70e063a35619d71f

  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }

  const PREFIX = "javascripts/single-test/connectors";
  (0, _qunitHelpers.acceptance)("Plugin Outlet - Connector Class", function (needs) {
    needs.hooks.beforeEach(() => {
      var _obj;

      (0, _pluginConnectors.extraConnectorClass)("user-profile-primary/hello", {
        actions: {
          sayHello() {
            this.set("hello", "hello!");
          }

        }
      });
      (0, _pluginConnectors.extraConnectorClass)("user-profile-primary/hi", (_obj = {
        setupComponent() {
          this.appEvents.on("hi:sayHi", this, this.say);
        },

        teardownComponent() {
          this.appEvents.off("hi:sayHi", this, this.say);
        },

        say() {
          this.set("hi", "hi!");
        },

        sayHi() {
          this.appEvents.trigger("hi:sayHi");
        }

      }, (_applyDecoratedDescriptor(_obj, "say", [_object.action], Object.getOwnPropertyDescriptor(_obj, "say"), _obj), _applyDecoratedDescriptor(_obj, "sayHi", [_object.action], Object.getOwnPropertyDescriptor(_obj, "sayHi"), _obj)), _obj));
      (0, _pluginConnectors.extraConnectorClass)("user-profile-primary/dont-render", {
        shouldRender(args) {
          return args.model.get("username") !== "eviltrout";
        }

      }); // eslint-disable-next-line no-undef

      Ember.TEMPLATES[`${PREFIX}/user-profile-primary/hello`] = (0, _templateFactory.createTemplateFactory)(
      /*
        <span class='hello-username'>{{model.username}}</span>
              <button class='say-hello' {{action "sayHello"}}></button>
              <span class='hello-result'>{{hello}}</span>
      */
      {
        "id": "MLvELNsm",
        "block": "[[[10,1],[14,0,\"hello-username\"],[12],[1,[33,0,[\"username\"]]],[13],[1,\"\\n        \"],[11,\"button\"],[24,0,\"say-hello\"],[4,[38,1],[[30,0],\"sayHello\"],null],[12],[13],[1,\"\\n        \"],[10,1],[14,0,\"hello-result\"],[12],[1,[34,2]],[13]],[],false,[\"model\",\"action\",\"hello\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }); // eslint-disable-next-line no-undef

      Ember.TEMPLATES[`${PREFIX}/user-profile-primary/hi`] = (0, _templateFactory.createTemplateFactory)(
      /*
        <button class='say-hi' {{action "sayHi"}}></button>
              <span class='hi-result'>{{hi}}</span>
      */
      {
        "id": "n09Q3Otn",
        "block": "[[[11,\"button\"],[24,0,\"say-hi\"],[4,[38,0],[[30,0],\"sayHi\"],null],[12],[13],[1,\"\\n        \"],[10,1],[14,0,\"hi-result\"],[12],[1,[34,1]],[13]],[],false,[\"action\",\"hi\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }); // eslint-disable-next-line no-undef

      Ember.TEMPLATES[`${PREFIX}/user-profile-primary/dont-render`] = (0, _templateFactory.createTemplateFactory)(
      /*
        I'm not rendered!
      */
      {
        "id": "4jy7q5FL",
        "block": "[[[1,\"I'm not rendered!\"]],[],false,[]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      });
    });
    needs.hooks.afterEach(() => {
      // eslint-disable-next-line no-undef
      delete Ember.TEMPLATES[`${PREFIX}/user-profile-primary/hello`]; // eslint-disable-next-line no-undef

      delete Ember.TEMPLATES[`${PREFIX}/user-profile-primary/hi`]; // eslint-disable-next-line no-undef

      delete Ember.TEMPLATES[`${PREFIX}/user-profile-primary/dont-render`];
    });
    (0, _qunit.test)("Renders a template into the outlet", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout");
      assert.strictEqual((0, _qunitHelpers.count)(".user-profile-primary-outlet.hello"), 1, "it has class names");
      assert.ok(!(0, _qunitHelpers.exists)(".user-profile-primary-outlet.dont-render"), "doesn't render");
      await (0, _testHelpers.click)(".say-hello");
      assert.strictEqual((0, _qunitHelpers.query)(".hello-result").innerText, "hello!", "actions delegate properly");
      await (0, _testHelpers.click)(".say-hi");
      assert.strictEqual((0, _qunitHelpers.query)(".hi-result").innerText, "hi!", "actions delegate properly");
    });
  });
});
define("discourse/tests/acceptance/plugin-outlet-decorator-test", ["@ember/template-factory", "discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers", "discourse/lib/plugin-api"], function (_templateFactory, _qunitHelpers, _qunit, _testHelpers, _pluginApi) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"qunit",0,"@ember/test-helpers",0,"discourse/lib/plugin-api"eaimeta@70e063a35619d71f

  const PREFIX = "javascripts/single-test/connectors";
  (0, _qunitHelpers.acceptance)("Plugin Outlet - Decorator", function (needs) {
    needs.user();
    needs.hooks.beforeEach(() => {
      // eslint-disable-next-line no-undef
      Ember.TEMPLATES[`${PREFIX}/discovery-list-container-top/foo`] = (0, _templateFactory.createTemplateFactory)(
      /*
        FOO
      */
      {
        "id": "PE3Ia39i",
        "block": "[[[1,\"FOO\"]],[],false,[]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }); // eslint-disable-next-line no-undef

      Ember.TEMPLATES[`${PREFIX}/discovery-list-container-top/bar`] = (0, _templateFactory.createTemplateFactory)(
      /*
        BAR
      */
      {
        "id": "3SpYCMnG",
        "block": "[[[1,\"BAR\"]],[],false,[]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      });
      (0, _pluginApi.withPluginApi)("0.8.38", api => {
        api.decoratePluginOutlet("discovery-list-container-top", (elem, args) => {
          if (elem.classList.contains("foo")) {
            elem.style.backgroundColor = "yellow";

            if (args.category) {
              elem.classList.add("in-category");
            } else {
              elem.classList.remove("in-category");
            }
          }
        }, {
          id: "yellow-decorator"
        });
      });
    });
    needs.hooks.afterEach(() => {
      // eslint-disable-next-line no-undef
      delete Ember.TEMPLATES[`${PREFIX}/discovery-list-container-top/foo`]; // eslint-disable-next-line no-undef

      delete Ember.TEMPLATES[`${PREFIX}/discovery-list-container-top/bar`];
    });
    (0, _qunit.test)("Calls the plugin callback with the rendered outlet", async function (assert) {
      await (0, _testHelpers.visit)("/");
      const fooConnector = (0, _qunitHelpers.queryAll)(".discovery-list-container-top-outlet.foo ")[0];
      const barConnector = (0, _qunitHelpers.queryAll)(".discovery-list-container-top-outlet.bar ")[0];
      assert.ok((0, _qunitHelpers.exists)(fooConnector));
      assert.strictEqual(fooConnector.style.backgroundColor, "yellow");
      assert.strictEqual(barConnector.style.backgroundColor, "");
      await (0, _testHelpers.visit)("/c/bug");
      assert.ok(fooConnector.classList.contains("in-category"));
      await (0, _testHelpers.visit)("/");
      assert.notOk(fooConnector.classList.contains("in-category"));
    });
  });
});
define("discourse/tests/acceptance/plugin-outlet-multi-template-test", ["@ember/template-factory", "discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers"], function (_templateFactory, _qunitHelpers, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  const HELLO = "javascripts/multi-test/connectors/user-profile-primary/hello";
  const GOODBYE = "javascripts/multi-test/connectors/user-profile-primary/goodbye";
  (0, _qunitHelpers.acceptance)("Plugin Outlet - Multi Template", function (needs) {
    needs.hooks.beforeEach(() => {
      // eslint-disable-next-line no-undef
      Ember.TEMPLATES[HELLO] = (0, _templateFactory.createTemplateFactory)(
      /*
        <span class='hello-span'>Hello</span>
      */
      {
        "id": "MVfzaK7f",
        "block": "[[[10,1],[14,0,\"hello-span\"],[12],[1,\"Hello\"],[13]],[],false,[]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }); // eslint-disable-next-line no-undef

      Ember.TEMPLATES[GOODBYE] = (0, _templateFactory.createTemplateFactory)(
      /*
        <span class='bye-span'>Goodbye</span>
      */
      {
        "id": "+n6nFI8H",
        "block": "[[[10,1],[14,0,\"bye-span\"],[12],[1,\"Goodbye\"],[13]],[],false,[]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      });
    });
    needs.hooks.afterEach(() => {
      // eslint-disable-next-line no-undef
      delete Ember.TEMPLATES[HELLO]; // eslint-disable-next-line no-undef

      delete Ember.TEMPLATES[GOODBYE];
    });
    (0, _qunit.test)("Renders a template into the outlet", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout");
      assert.strictEqual((0, _qunitHelpers.count)(".user-profile-primary-outlet.hello"), 1, "it has class names");
      assert.strictEqual((0, _qunitHelpers.count)(".user-profile-primary-outlet.goodbye"), 1, "it has class names");
      assert.strictEqual((0, _qunitHelpers.query)(".hello-span").innerText, "Hello", "it renders into the outlet");
      assert.strictEqual((0, _qunitHelpers.query)(".bye-span").innerText, "Goodbye", "it renders into the outlet");
    });
  });
});
define("discourse/tests/acceptance/plugin-outlet-single-template-test", ["@ember/template-factory", "discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers"], function (_templateFactory, _qunitHelpers, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  const CONNECTOR = "javascripts/single-test/connectors/user-profile-primary/hello";
  (0, _qunitHelpers.acceptance)("Plugin Outlet - Single Template", function (needs) {
    needs.hooks.beforeEach(() => {
      // eslint-disable-next-line no-undef
      Ember.TEMPLATES[CONNECTOR] = (0, _templateFactory.createTemplateFactory)(
      /*
        <span class='hello-username'>{{model.username}}</span>
      */
      {
        "id": "WHVQNEYG",
        "block": "[[[10,1],[14,0,\"hello-username\"],[12],[1,[33,0,[\"username\"]]],[13]],[],false,[\"model\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      });
    });
    needs.hooks.afterEach(() => {
      // eslint-disable-next-line no-undef
      delete Ember.TEMPLATES[CONNECTOR];
    });
    (0, _qunit.test)("Renders a template into the outlet", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout");
      assert.strictEqual((0, _qunitHelpers.count)(".user-profile-primary-outlet.hello"), 1, "it has class names");
      assert.strictEqual((0, _qunitHelpers.query)(".hello-username").innerText, "eviltrout", "it renders into the outlet");
    });
  });
});
define("discourse/tests/acceptance/post-admin-menu-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Post - Admin Menu - Anonymous", function () {
    (0, _qunit.test)("Enter as a anon user", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)(".show-more-actions");
      assert.ok((0, _qunitHelpers.exists)("#topic"), "The topic was rendered");
      assert.ok((0, _qunitHelpers.exists)("#post_1 .post-controls .edit"), "The edit button was not rendered");
      assert.ok(!(0, _qunitHelpers.exists)(".show-post-admin-menu"), "The wrench button was not rendered");
    });
  });
  (0, _qunitHelpers.acceptance)("Post - Admin Menu - Authenticated", function (needs) {
    needs.user();
    (0, _qunit.test)("Enter as a user with group moderator permissions", async function (assert) {
      await (0, _testHelpers.visit)("/t/topic-for-group-moderators/2480");
      await (0, _testHelpers.click)(".show-more-actions");
      await (0, _testHelpers.click)(".show-post-admin-menu");
      assert.ok((0, _qunitHelpers.exists)("#post_1 .post-controls .edit"), "The edit button was rendered");
      assert.ok((0, _qunitHelpers.exists)(".add-notice"), "The add notice button was rendered");
    });
  });
});
define("discourse/tests/acceptance/post-controls-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "I18n"], function (_qunitHelpers, _testHelpers, _qunit, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Post controls", function () {
    (0, _qunit.test)("accessibility of the likes list below the post", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      const showLikesButton = (0, _qunitHelpers.query)("#post_2 button.like-count");
      assert.equal(showLikesButton.getAttribute("aria-pressed"), "false", "show likes button isn't pressed");
      assert.equal(showLikesButton.getAttribute("aria-label"), _I18n.default.t("post.sr_post_like_count_button", {
        count: 4
      }), "show likes button has aria-label");
      await (0, _testHelpers.click)(showLikesButton);
      assert.equal(showLikesButton.getAttribute("aria-pressed"), "true", "show likes button is now pressed");
      const likesContainer = (0, _qunitHelpers.query)("#post_2 .small-user-list.who-liked");
      assert.equal(likesContainer.getAttribute("role"), "list", "likes container has list role");
      assert.equal(likesContainer.getAttribute("aria-label"), _I18n.default.t("post.actions.people.sr_post_likers_list_description"), "likes container has aria-label");
      assert.equal(likesContainer.querySelector(".list-description").getAttribute("aria-hidden"), "true", "list description is aria-hidden");
      const likesAvatars = likesContainer.querySelectorAll("a.trigger-user-card");
      assert.ok(likesAvatars.length > 0, "avatars are rendered");
      likesAvatars.forEach(avatar => {
        assert.equal(avatar.getAttribute("aria-hidden"), "false", "avatars are not aria-hidden");
        assert.equal(avatar.getAttribute("role"), "listitem", "avatars have listitem role");
      });
    });
    (0, _qunit.test)("accessibility of the embedded replies below the post", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      const showRepliesButton = (0, _qunitHelpers.query)("#post_1 button.show-replies");
      assert.equal(showRepliesButton.getAttribute("aria-pressed"), "false", "show replies button isn't pressed");
      assert.equal(showRepliesButton.getAttribute("aria-label"), _I18n.default.t("post.sr_expand_replies", {
        count: 1
      }), "show replies button has aria-label");
      await (0, _testHelpers.click)(showRepliesButton);
      assert.equal(showRepliesButton.getAttribute("aria-pressed"), "true", "show replies button is now pressed");
      const replies = Array.from((0, _qunitHelpers.queryAll)("#post_1 .embedded-posts .reply"));
      assert.equal(replies.length, 1, "replies are rendered");
      replies.forEach(reply => {
        assert.equal(reply.getAttribute("role"), "region", "replies have region role");
        assert.equal(reply.getAttribute("aria-label"), _I18n.default.t("post.sr_embedded_reply_description", {
          post_number: 1,
          username: "somebody"
        }), "replies have aria-label");
      });
      assert.equal((0, _qunitHelpers.query)("#post_1 .embedded-posts .btn.collapse-up").getAttribute("aria-label"), _I18n.default.t("post.sr_collapse_replies"), "collapse button has aria-label");
    });
  });
});
define("discourse/tests/acceptance/post-history-test", ["@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "qunit"], function (_testHelpers, _qunitHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Post - History", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/posts/419/revisions/latest.json", () => {
        return helper.response({
          created_at: "2021-11-24T10:59:36.163Z",
          post_id: 419,
          previous_hidden: false,
          current_hidden: false,
          first_revision: 1,
          previous_revision: 1,
          current_revision: 2,
          next_revision: null,
          last_revision: 2,
          current_version: 2,
          version_count: 2,
          username: "bianca",
          display_username: "bianca",
          avatar_template: "/letter_avatar_proxy/v4/letter/b/3be4f8/{size}.png",
          edit_reason: null,
          body_changes: {
            inline: '<div class="inline-diff"><p>Welcome to Discourse!</p</div>',
            side_by_side: '<div class="revision-content"><p>Welcome to Discourse!</p</div><div class="revision-content"><p>Welcome to Discourse!</p</div>',
            side_by_side_markdown: '<table class="markdown"><tr><td>Welcome to Discourse!</td><td>Welcome to Discourse!</td></tr></table>'
          },
          title_changes: {
            inline: '<div class="inline-diff"><div>Welcome to Discourse!</div></div>',
            side_by_side: '<div class="revision-content"><div>Welcome to Discourse!</div></div><div class="revision-content"><div>Welcome to Discourse!</div></div>'
          },
          user_changes: null,
          tags_changes: {
            previous: ["tag1", "tag2"],
            current: ["tag2", "tag3"]
          },
          wiki: false,
          can_edit: true
        });
      });
    });
    (0, _qunit.test)("Shows highlighted tag changes", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("article[data-post-id='419'] .edits button");
      assert.equal((0, _qunitHelpers.count)(".discourse-tag"), 4);
      assert.equal((0, _qunitHelpers.count)(".discourse-tag.diff-del"), 1);
      assert.equal((0, _qunitHelpers.query)(".discourse-tag.diff-del").textContent, "tag1");
      assert.equal((0, _qunitHelpers.count)(".discourse-tag.diff-ins"), 1);
      assert.equal((0, _qunitHelpers.query)(".discourse-tag.diff-ins").textContent, "tag3");
    });
  });
});
define("discourse/tests/acceptance/preferences-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "I18n", "discourse/models/user", "discourse/tests/helpers/select-kit-helper", "qunit"], function (_qunitHelpers, _testHelpers, _I18n, _user, _selectKitHelper, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"I18n",0,"discourse/models/user",0,"discourse/tests/helpers/select-kit-helper",0,"qunit"eaimeta@70e063a35619d71f

  function preferencesPretender(server, helper) {
    server.post("/u/second_factors.json", () => {
      return helper.response({
        success: "OK",
        password_required: "true"
      });
    });
    server.post("/u/create_second_factor_totp.json", () => {
      return helper.response({
        key: "rcyryaqage3jexfj",
        qr: "data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="
      });
    });
    server.post("/u/create_second_factor_security_key.json", () => {
      return helper.response({
        challenge: "a6d393d12654c130b2273e68ca25ca232d1d7f4c2464c2610fb8710a89d4",
        rp_id: "localhost",
        rp_name: "Discourse",
        supported_algorithms: [-7, -257]
      });
    });
    server.post("/u/enable_second_factor_totp.json", () => {
      return helper.response({
        error: "invalid token"
      });
    });
    server.put("/u/second_factors_backup.json", () => {
      return helper.response({
        backup_codes: ["dsffdsd", "fdfdfdsf", "fddsds"]
      });
    });
    server.post("/u/eviltrout/preferences/revoke-account", () => {
      return helper.response({
        success: true
      });
    });
    server.put("/u/eviltrout/preferences/email", () => {
      return helper.response({
        success: true
      });
    });
    server.post("/user_avatar/eviltrout/refresh_gravatar.json", () => {
      return helper.response({
        gravatar_upload_id: 6543,
        gravatar_avatar_template: "/images/avatar.png"
      });
    });
    server.get("/u/eviltrout/activity.json", () => {
      return helper.response({});
    });
  }

  (0, _qunitHelpers.acceptance)("User Preferences", function (needs) {
    needs.user();
    needs.pretender(preferencesPretender);
    (0, _qunit.test)("update some fields", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences");
      assert.ok(document.body.classList.contains("user-preferences-page"), "has the body class");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/u/eviltrout/preferences/account", "defaults to account tab");
      assert.ok((0, _qunitHelpers.exists)(".user-preferences"), "it shows the preferences");

      const savePreferences = async () => {
        assert.ok(!(0, _qunitHelpers.exists)(".saved"), "it hasn't been saved yet");
        await (0, _testHelpers.click)(".save-changes");
        assert.ok((0, _qunitHelpers.exists)(".saved"), "it displays the saved message");
        (0, _qunitHelpers.query)(".saved").remove();
      };

      await (0, _testHelpers.fillIn)(".pref-name input[type=text]", "Jon Snow");
      await savePreferences();
      await (0, _testHelpers.click)(".preferences-nav .nav-profile a");
      await (0, _testHelpers.fillIn)("#edit-location", "Westeros");
      await savePreferences();
      await (0, _testHelpers.click)(".preferences-nav .nav-emails a");
      await (0, _testHelpers.click)(".pref-activity-summary input[type=checkbox]");
      await savePreferences();
      await (0, _testHelpers.click)(".preferences-nav .nav-notifications a");
      await (0, _selectKitHelper.default)(".control-group.notifications .combo-box.duration").expand();
      await (0, _selectKitHelper.default)(".control-group.notifications .combo-box.duration").selectRowByValue(1440);
      await savePreferences();
      await (0, _testHelpers.click)(".preferences-nav .nav-categories a");
      const categorySelector = (0, _selectKitHelper.default)(".tracking-controls .category-selector ");
      await categorySelector.expand();
      await categorySelector.fillInFilter("faq");
      await savePreferences();
      assert.ok(!(0, _qunitHelpers.exists)(".preferences-nav .nav-tags a"), "tags tab isn't there when tags are disabled");
      await (0, _testHelpers.click)(".preferences-nav .nav-interface a");
      await (0, _testHelpers.click)(".control-group.other input[type=checkbox]:nth-of-type(1)");
      await savePreferences();
      assert.ok(!(0, _qunitHelpers.exists)(".preferences-nav .nav-apps a"), "apps tab isn't there when you have no authorized apps");
    });
    (0, _qunit.test)("username", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/username");
      assert.ok((0, _qunitHelpers.exists)("#change_username"), "it has the input element");
    });
    (0, _qunit.test)("email", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/email");
      assert.ok((0, _qunitHelpers.exists)("#change-email"), "it has the input element");
      await (0, _testHelpers.fillIn)("#change-email", "invalid-email");
      assert.strictEqual((0, _qunitHelpers.query)(".tip.bad").innerText.trim(), _I18n.default.t("user.email.invalid"), "it should display invalid email tip");
    });
    (0, _qunit.test)("email field always shows up", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/email");
      assert.ok((0, _qunitHelpers.exists)("#change-email"), "it has the input element");
      await (0, _testHelpers.fillIn)("#change-email", "eviltrout@discourse.org");
      await (0, _testHelpers.click)(".user-preferences button.btn-primary");
      await (0, _testHelpers.visit)("/u/eviltrout/preferences");
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/email");
      assert.ok((0, _qunitHelpers.exists)("#change-email"), "it has the input element");
    });
    (0, _qunit.test)("connected accounts", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/account");
      assert.ok((0, _qunitHelpers.exists)(".pref-associated-accounts"), "it has the connected accounts section");
      assert.ok((0, _qunitHelpers.query)(".pref-associated-accounts table tr:nth-of-type(1) td:nth-of-type(1)").innerHTML.includes("Facebook"), "it lists facebook");
      await (0, _testHelpers.click)(".pref-associated-accounts table tr:nth-of-type(1) td:last-child button");
      assert.ok((0, _qunitHelpers.query)(".pref-associated-accounts table tr:nth-of-type(1) td:last-of-type").innerHTML.includes("Connect"));
    });
    (0, _qunit.test)("second factor totp", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/second-factor");
      assert.ok((0, _qunitHelpers.exists)("#password"), "it has a password input");
      await (0, _testHelpers.fillIn)("#password", "secrets");
      await (0, _testHelpers.click)(".user-preferences .btn-primary");
      assert.notOk((0, _qunitHelpers.exists)("#password"), "it hides the password input");
      await (0, _testHelpers.click)(".new-totp");
      assert.ok((0, _qunitHelpers.exists)(".qr-code img"), "shows qr code image");
      await (0, _testHelpers.click)(".add-totp");
      assert.ok((0, _qunitHelpers.query)(".alert-error").innerHTML.includes("provide a name and the code"), "shows name/token missing error message");
    });
    (0, _qunit.test)("second factor security keys", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/second-factor");
      assert.ok((0, _qunitHelpers.exists)("#password"), "it has a password input");
      await (0, _testHelpers.fillIn)("#password", "secrets");
      await (0, _testHelpers.click)(".user-preferences .btn-primary");
      assert.notOk((0, _qunitHelpers.exists)("#password"), "it hides the password input");
      await (0, _testHelpers.click)(".new-security-key");
      assert.ok((0, _qunitHelpers.exists)("#security-key-name"), "shows security key name input");
      await (0, _testHelpers.fillIn)("#security-key-name", ""); // The following tests can only run when Webauthn is enabled. This is not
      // always the case, for example on a browser running on a non-standard port

      if (typeof PublicKeyCredential !== "undefined") {
        await (0, _testHelpers.click)(".add-security-key");
        assert.ok((0, _qunitHelpers.query)(".alert-error").innerHTML.includes("provide a name"), "shows name missing error message");
      }
    });
    (0, _qunit.test)("default avatar selector", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences");
      await (0, _testHelpers.click)(".pref-avatar .btn");
      assert.ok((0, _qunitHelpers.exists)(".avatar-choice", "opens the avatar selection modal"));
      await (0, _testHelpers.click)(".avatar-selector-refresh-gravatar");
      assert.strictEqual(_user.default.currentProp("gravatar_avatar_upload_id"), 6543, "it should set the gravatar_avatar_upload_id property");
    });
  });
  (0, _qunitHelpers.acceptance)("Second Factor Backups", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.post("/u/second_factors.json", () => {
        return helper.response({
          success: "OK",
          totps: [{
            id: 1,
            name: "one of them"
          }]
        });
      });
      server.put("/u/second_factors_backup.json", () => {
        return helper.response({
          backup_codes: ["dsffdsd", "fdfdfdsf", "fddsds"]
        });
      });
      server.get("/u/eviltrout/activity.json", () => {
        return helper.response({});
      });
    });
    (0, _qunit.test)("second factor backup", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        second_factor_enabled: true
      });
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/second-factor");
      await (0, _testHelpers.click)(".edit-2fa-backup");
      assert.ok((0, _qunitHelpers.exists)(".second-factor-backup-preferences"), "shows the 2fa backup panel");
      await (0, _testHelpers.click)(".second-factor-backup-preferences .btn-primary");
      assert.ok((0, _qunitHelpers.exists)(".backup-codes-area"), "shows backup codes");
    });
  });
  (0, _qunitHelpers.acceptance)("Avatar selector when selectable avatars is enabled", function (needs) {
    needs.user();
    needs.settings({
      selectable_avatars_mode: "no_one"
    });
    needs.pretender((server, helper) => {
      server.get("/site/selectable-avatars.json", () => helper.response(["https://www.discourse.org", "https://meta.discourse.org"]));
    });
    (0, _qunit.test)("selectable avatars", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences");
      await (0, _testHelpers.click)(".pref-avatar .btn");
      assert.ok((0, _qunitHelpers.exists)(".selectable-avatars", "opens the avatar selection modal"));
      assert.notOk((0, _qunitHelpers.exists)("#uploaded-avatar", "avatar selection modal does not include option to upload"));
    });
  });
  (0, _qunitHelpers.acceptance)("Avatar selector when selectable avatars allows staff to upload", function (needs) {
    needs.user();
    needs.settings({
      selectable_avatars_mode: "staff"
    });
    needs.pretender((server, helper) => {
      server.get("/site/selectable-avatars.json", () => helper.response(["https://www.discourse.org", "https://meta.discourse.org"]));
    });
    (0, _qunit.test)("allows staff to upload", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        trust_level: 3,
        moderator: true,
        admin: false
      });
      await (0, _testHelpers.visit)("/u/eviltrout/preferences");
      await (0, _testHelpers.click)(".pref-avatar .btn");
      assert.ok((0, _qunitHelpers.exists)(".selectable-avatars", "opens the avatar selection modal"));
      assert.ok((0, _qunitHelpers.exists)("#uploaded-avatar", "avatar selection modal includes option to upload"));
    });
    (0, _qunit.test)("disallow non-staff", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences");
      (0, _qunitHelpers.updateCurrentUser)({
        trust_level: 3,
        moderator: false,
        admin: false
      });
      await (0, _testHelpers.click)(".pref-avatar .btn");
      assert.ok((0, _qunitHelpers.exists)(".selectable-avatars", "opens the avatar selection modal"));
      assert.notOk((0, _qunitHelpers.exists)("#uploaded-avatar", "avatar selection modal does not include option to upload"));
    });
  });
  (0, _qunitHelpers.acceptance)("Avatar selector when selectable avatars allows trust level 3+ to upload", function (needs) {
    needs.user();
    needs.settings({
      selectable_avatars_mode: "tl3"
    });
    needs.pretender((server, helper) => {
      server.get("/site/selectable-avatars.json", () => helper.response(["https://www.discourse.org", "https://meta.discourse.org"]));
    });
    (0, _qunit.test)("with a tl3 user", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences");
      (0, _qunitHelpers.updateCurrentUser)({
        trust_level: 3,
        moderator: false,
        admin: false
      });
      await (0, _testHelpers.click)(".pref-avatar .btn");
      assert.ok((0, _qunitHelpers.exists)(".selectable-avatars", "opens the avatar selection modal"));
      assert.ok((0, _qunitHelpers.exists)("#uploaded-avatar", "avatar selection modal does includes option to upload"));
    });
    (0, _qunit.test)("with a tl2 user", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences");
      (0, _qunitHelpers.updateCurrentUser)({
        trust_level: 2,
        moderator: false,
        admin: false
      });
      await (0, _testHelpers.click)(".pref-avatar .btn");
      assert.ok((0, _qunitHelpers.exists)(".selectable-avatars", "opens the avatar selection modal"));
      assert.notOk((0, _qunitHelpers.exists)("#uploaded-avatar", "avatar selection modal does not include option to upload"));
    });
    (0, _qunit.test)("always allow staff to upload", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences");
      (0, _qunitHelpers.updateCurrentUser)({
        trust_level: 2,
        moderator: true,
        admin: false
      });
      await (0, _testHelpers.click)(".pref-avatar .btn");
      assert.ok((0, _qunitHelpers.exists)(".selectable-avatars", "opens the avatar selection modal"));
      assert.ok((0, _qunitHelpers.exists)("#uploaded-avatar", "avatar selection modal includes option to upload"));
    });
  });
  (0, _qunitHelpers.acceptance)("User Preferences when badges are disabled", function (needs) {
    needs.user();
    needs.settings({
      enable_badges: false
    });
    needs.pretender(preferencesPretender);
    (0, _qunit.test)("visit my preferences", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences");
      assert.ok(document.body.classList.contains("user-preferences-page"), "has the body class");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/u/eviltrout/preferences/account", "defaults to account tab");
      assert.ok((0, _qunitHelpers.exists)(".user-preferences"), "it shows the preferences");
    });
  });
  (0, _qunitHelpers.acceptance)("Custom User Fields", function (needs) {
    needs.user();
    needs.site({
      user_fields: [{
        id: 30,
        name: "What kind of pet do you have?",
        field_type: "dropdown",
        options: ["Dog", "Cat", "Hamster"],
        required: true
      }]
    });
    needs.pretender(preferencesPretender);
    (0, _qunit.test)("can select an option from a dropdown", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/profile");
      assert.ok((0, _qunitHelpers.exists)(".user-field"), "it has at least one user field");
      await (0, _testHelpers.click)(".user-field.dropdown");
      const field = (0, _selectKitHelper.default)(".user-field-what-kind-of-pet-do-you-have .combo-box");
      await field.expand();
      await field.selectRowByValue("Cat");
      assert.strictEqual(field.header().value(), "Cat", "it sets the value of the field");
    });
  });
  (0, _qunitHelpers.acceptance)("User Preferences, selecting bookmarks discovery as user's default homepage", function (needs) {
    needs.user();
    needs.settings({
      top_menu: "categories|latest|top|bookmarks"
    });
    (0, _qunit.test)("selecting bookmarks as home directs home to bookmarks", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/interface");
      assert.ok((0, _qunitHelpers.exists)(".home .combo-box"), "it has a home selector combo-box");
      const field = (0, _selectKitHelper.default)(".home .combo-box");
      await field.expand();
      await field.selectRowByValue("6");
      await (0, _testHelpers.click)(".save-changes");
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)(".topic-list"), "The list of topics was rendered");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "discovery.bookmarks", "it navigates to bookmarks");
    });
  });
  (0, _qunitHelpers.acceptance)("Ignored users", function (needs) {
    needs.user();
    needs.settings({
      min_trust_level_to_allow_ignore: 1
    });
    (0, _qunit.test)("when trust level < min level to ignore", async function (assert) {
      await (0, _testHelpers.visit)(`/u/eviltrout/preferences/users`);
      (0, _qunitHelpers.updateCurrentUser)({
        trust_level: 0,
        moderator: false,
        admin: false
      });
      assert.ok(!(0, _qunitHelpers.exists)(".user-ignore"), "it does not show the list of ignored users");
    });
    (0, _qunit.test)("when trust level >= min level to ignore", async function (assert) {
      await (0, _testHelpers.visit)(`/u/eviltrout/preferences/users`);
      (0, _qunitHelpers.updateCurrentUser)({
        trust_level: 1
      });
      assert.ok((0, _qunitHelpers.exists)(".user-ignore"), "it shows the list of ignored users");
    });
    (0, _qunit.test)("staff can always see ignored users", async function (assert) {
      await (0, _testHelpers.visit)(`/u/eviltrout/preferences/users`);
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true
      });
      assert.ok((0, _qunitHelpers.exists)(".user-ignore"), "it shows the list of ignored users");
    });
  });
  (0, _qunitHelpers.acceptance)("Security", function (needs) {
    needs.user();
    needs.pretender(preferencesPretender);
    (0, _qunit.test)("recently connected devices", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/security");
      assert.strictEqual((0, _qunitHelpers.query)(".auth-tokens > .auth-token:nth-of-type(1) .auth-token-device").innerText.trim(), "Linux Computer", "it should display active token first");
      assert.strictEqual((0, _qunitHelpers.query)(".pref-auth-tokens > a:nth-of-type(1)").innerText.trim(), _I18n.default.t("user.auth_tokens.show_all", {
        count: 3
      }), "it should display two tokens");
      assert.strictEqual((0, _qunitHelpers.count)(".pref-auth-tokens .auth-token"), 2, "it should display two tokens");
      await (0, _testHelpers.click)(".pref-auth-tokens > a:nth-of-type(1)");
      assert.strictEqual((0, _qunitHelpers.count)(".pref-auth-tokens .auth-token"), 3, "it should display three tokens");
      const authTokenDropdown = (0, _selectKitHelper.default)(".auth-token-dropdown");
      await authTokenDropdown.expand();
      await authTokenDropdown.selectRowByValue("notYou");
      assert.strictEqual((0, _qunitHelpers.count)(".d-modal:visible"), 1, "modal should appear");
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
      assert.strictEqual((0, _qunitHelpers.count)(".pref-password.highlighted"), 1, "it should highlight password preferences");
    });
  });
  (0, _qunitHelpers.acceptance)("User Preferences for staged user and don't allow tracking prefs", function (needs) {
    needs.settings({
      allow_changing_staged_user_tracking: false,
      tagging_enabled: true
    });
    needs.pretender(preferencesPretender);
    (0, _qunit.test)("staged user doesn't show category and tag preferences", async function (assert) {
      await (0, _testHelpers.visit)("/u/staged/preferences");
      assert.ok(document.body.classList.contains("user-preferences-page"), "has the body class");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/u/staged/preferences/account", "defaults to account tab");
      assert.ok((0, _qunitHelpers.exists)(".user-preferences"), "it shows the preferences");
      assert.ok(!(0, _qunitHelpers.exists)(".preferences-nav .nav-categories a"), "categories tab isn't there for staged users");
      assert.ok(!(0, _qunitHelpers.exists)(".preferences-nav .nav-tags a"), "tags tab isn't there for staged users");
    });
  });
});
define("discourse/tests/acceptance/raw-plugin-outlet-test", ["discourse/tests/helpers/qunit-helpers", "discourse-common/lib/raw-templates", "handlebars", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _rawTemplates, _handlebars, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"discourse-common/lib/raw-templates",0,"handlebars",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  const CONNECTOR = "javascripts/raw-test/connectors/topic-list-before-status/lala";
  (0, _qunitHelpers.acceptance)("Raw Plugin Outlet", function (needs) {
    needs.hooks.beforeEach(() => {
      (0, _rawTemplates.addRawTemplate)(CONNECTOR, (0, _handlebars.compile)(`<span class='topic-lala'>{{context.topic.id}}</span>`));
    });
    needs.hooks.afterEach(() => {
      (0, _rawTemplates.removeRawTemplate)(CONNECTOR);
    });
    (0, _qunit.test)("Renders the raw plugin outlet", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)(".topic-lala"), "it renders the outlet");
      assert.strictEqual((0, _qunitHelpers.query)(".topic-lala:nth-of-type(1)").innerText, "11557", "it has the topic id");
    });
  });
});
define("discourse/tests/acceptance/redirect-to-top-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/tests/fixtures/discovery-fixtures", "qunit"], function (_qunitHelpers, _testHelpers, _discoveryFixtures, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/tests/fixtures/discovery-fixtures",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Redirect to Top", function (needs) {
    needs.pretender((server, helper) => {
      server.get("/top.json?period=weekly", () => {
        return helper.response(_discoveryFixtures.default["/latest.json"]);
      });
      server.get("/top/monthly.json", () => {
        return helper.response(_discoveryFixtures.default["/latest.json"]);
      });
      server.get("/top/all.json", () => {
        return helper.response(_discoveryFixtures.default["/latest.json"]);
      });
    });
    needs.user();
    (0, _qunit.test)("redirects categories to weekly top", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        should_be_redirected_to_top: true,
        redirected_to_top: {
          period: "weekly",
          reason: "Welcome back!"
        }
      });
      await (0, _testHelpers.visit)("/categories");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/top?period=weekly", "it works for categories");
    });
    (0, _qunit.test)("redirects latest to monthly top", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        should_be_redirected_to_top: true,
        redirected_to_top: {
          period: "monthly",
          reason: "Welcome back!"
        }
      });
      await (0, _testHelpers.visit)("/latest");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/top?period=monthly", "it works for latest");
    });
    (0, _qunit.test)("redirects root to All top", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        should_be_redirected_to_top: true,
        redirected_to_top: {
          period: null,
          reason: "Welcome back!"
        }
      });
      await (0, _testHelpers.visit)("/");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/top?period=all", "it works for root");
    });
  });
});
define("discourse/tests/acceptance/reports-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Reports", function (needs) {
    needs.user();
    (0, _qunit.test)("Visit reports page", async function (assert) {
      await (0, _testHelpers.visit)("/admin/reports");
      assert.strictEqual((0, _qunitHelpers.count)(".reports-list .report"), 1);
      const report = (0, _qunitHelpers.query)(".reports-list .report:first-child");
      assert.strictEqual(report.querySelector(".report-title").innerHTML.trim(), "My report");
      assert.strictEqual(report.querySelector(".report-description").innerHTML.trim(), "List of my activities");
    });
    (0, _qunit.test)("Visit report page", async function (assert) {
      await (0, _testHelpers.visit)("/admin/reports/staff_logins");
      assert.ok((0, _qunitHelpers.exists)(".export-csv-btn"));
    });
  });
});
define("discourse/tests/acceptance/review-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "I18n", "discourse/tests/helpers/select-kit-helper", "qunit"], function (_qunitHelpers, _testHelpers, _I18n, _selectKitHelper, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"I18n",0,"discourse/tests/helpers/select-kit-helper",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Review", function (needs) {
    needs.user();
    let requests = [];
    needs.pretender((server, helper) => {
      server.get("/tags/filter/search", request => {
        requests.push(request);
        return helper.response({
          results: [{
            id: "monkey",
            name: "monkey",
            count: 1
          }, {
            id: "not-monkey",
            name: "not-monkey",
            count: 1
          }, {
            id: "happy-monkey",
            name: "happy-monkey",
            count: 1
          }]
        });
      });
    });
    const user = '.reviewable-item[data-reviewable-id="1234"]';
    (0, _qunit.test)("It returns a list of reviewable items", async function (assert) {
      await (0, _testHelpers.visit)("/review");
      assert.ok((0, _qunitHelpers.exists)(".reviewable-item"), "has a list of items");
      assert.ok((0, _qunitHelpers.exists)(user));
      assert.ok((0, _qunitHelpers.exists)(`${user}.reviewable-user`), "applies a class for the type");
      assert.ok((0, _qunitHelpers.exists)(`${user} .reviewable-action.approve`), "creates a button for approve");
      assert.ok((0, _qunitHelpers.exists)(`${user} .reviewable-action.reject`), "creates a button for reject");
    });
    (0, _qunit.test)("Grouped by topic", async function (assert) {
      await (0, _testHelpers.visit)("/review/topics");
      assert.ok((0, _qunitHelpers.exists)(".reviewable-topic"), "it has a list of reviewable topics");
    });
    (0, _qunit.test)("Reject user", async function (assert) {
      let reviewableActionDropdown = (0, _selectKitHelper.default)(`${user} .reviewable-action-dropdown`);
      await (0, _testHelpers.visit)("/review");
      await reviewableActionDropdown.expand();
      await reviewableActionDropdown.selectRowByValue("reject_user_delete");
      assert.ok((0, _qunitHelpers.visible)(".reject-reason-reviewable-modal"));
      assert.ok((0, _qunitHelpers.query)(".reject-reason-reviewable-modal .title").innerHTML.includes(_I18n.default.t("review.reject_reason.title")), "it opens reject reason modal when user is rejected");
      await (0, _testHelpers.click)(".modal-footer .cancel");
      await reviewableActionDropdown.expand();
      await reviewableActionDropdown.selectRowByValue("reject_user_block");
      assert.ok((0, _qunitHelpers.visible)(".reject-reason-reviewable-modal"));
      assert.ok((0, _qunitHelpers.query)(".reject-reason-reviewable-modal .title").innerHTML.includes(_I18n.default.t("review.reject_reason.title")), "it opens reject reason modal when user is rejected and blocked");
    });
    (0, _qunit.test)("Settings", async function (assert) {
      await (0, _testHelpers.visit)("/review/settings");
      assert.ok((0, _qunitHelpers.exists)(".reviewable-score-type"), "has a list of bonuses");
      const field = (0, _selectKitHelper.default)(".reviewable-score-type:nth-of-type(1) .field .combo-box");
      await field.expand();
      await field.selectRowByValue("5");
      await (0, _testHelpers.click)(".save-settings");
      assert.ok((0, _qunitHelpers.exists)(".reviewable-settings .saved"), "it saved");
    });
    (0, _qunit.test)("Flag related", async function (assert) {
      await (0, _testHelpers.visit)("/review");
      assert.ok((0, _qunitHelpers.exists)(".reviewable-flagged-post .post-contents .username a[href]"), "it has a link to the user");
      assert.strictEqual((0, _qunitHelpers.query)(".reviewable-flagged-post .post-body").innerHTML.trim(), "<b>cooked content</b>");
      assert.strictEqual((0, _qunitHelpers.count)(".reviewable-flagged-post .reviewable-score"), 2);
    });
    (0, _qunit.test)("Flag related", async function (assert) {
      await (0, _testHelpers.visit)("/review/1");
      assert.ok((0, _qunitHelpers.exists)(".reviewable-flagged-post"), "it shows the flagged post");
    });
    (0, _qunit.test)("Clicking the buttons triggers actions", async function (assert) {
      await (0, _testHelpers.visit)("/review");
      await (0, _testHelpers.click)(`${user} .reviewable-action.approve`);
      assert.ok(!(0, _qunitHelpers.exists)(user), "it removes the reviewable on success");
    });
    (0, _qunit.test)("Editing a reviewable", async function (assert) {
      const topic = '.reviewable-item[data-reviewable-id="4321"]';
      await (0, _testHelpers.visit)("/review");
      assert.ok((0, _qunitHelpers.exists)(`${topic} .reviewable-action.approve`));
      assert.ok(!(0, _qunitHelpers.exists)(`${topic} .category-name`));
      assert.strictEqual((0, _qunitHelpers.query)(`${topic} .discourse-tag:nth-of-type(1)`).innerText, "hello");
      assert.strictEqual((0, _qunitHelpers.query)(`${topic} .discourse-tag:nth-of-type(2)`).innerText, "world");
      assert.strictEqual((0, _qunitHelpers.query)(`${topic} .post-body`).innerText.trim(), "existing body");
      await (0, _testHelpers.click)(`${topic} .reviewable-action.edit`);
      await (0, _testHelpers.click)(`${topic} .reviewable-action.save-edit`);
      assert.ok((0, _qunitHelpers.exists)(`${topic} .reviewable-action.approve`), "saving without changes is a cancel");
      await (0, _testHelpers.click)(`${topic} .reviewable-action.edit`);
      assert.ok(!(0, _qunitHelpers.exists)(`${topic} .reviewable-action.approve`), "when editing actions are disabled");
      await (0, _testHelpers.fillIn)(".editable-field.payload-raw textarea", "new raw contents");
      await (0, _testHelpers.click)(`${topic} .reviewable-action.cancel-edit`);
      assert.strictEqual((0, _qunitHelpers.query)(`${topic} .post-body`).innerText.trim(), "existing body", "cancelling does not update the value");
      await (0, _testHelpers.click)(`${topic} .reviewable-action.edit`);
      let category = (0, _selectKitHelper.default)(`${topic} .category-id .select-kit`);
      await category.expand();
      await category.selectRowByValue("6");
      let tags = (0, _selectKitHelper.default)(`${topic} .payload-tags .mini-tag-chooser`);
      requests = [];
      await tags.expand();
      assert.equal(requests.length, 1);
      assert.equal(requests[0].queryParams.categoryId, "6");
      await tags.fillInFilter("monkey");
      await tags.selectRowByValue("monkey");
      await (0, _testHelpers.fillIn)(".editable-field.payload-raw textarea", "new raw contents");
      await (0, _testHelpers.click)(`${topic} .reviewable-action.save-edit`);
      assert.strictEqual((0, _qunitHelpers.query)(`${topic} .discourse-tag:nth-of-type(1)`).innerText, "hello");
      assert.strictEqual((0, _qunitHelpers.query)(`${topic} .discourse-tag:nth-of-type(2)`).innerText, "world");
      assert.strictEqual((0, _qunitHelpers.query)(`${topic} .discourse-tag:nth-of-type(3)`).innerText, "monkey");
      assert.strictEqual((0, _qunitHelpers.query)(`${topic} .post-body`).innerText.trim(), "new raw contents");
      assert.strictEqual((0, _qunitHelpers.query)(`${topic} .category-name`).innerText.trim(), "support");
    });
    (0, _qunit.test)("Reviewables can become stale", async function (assert) {
      await (0, _testHelpers.visit)("/review");
      const reviewable = (0, _qunitHelpers.query)(`[data-reviewable-id="1234"]`);
      assert.notOk(reviewable.className.includes("reviewable-stale"));
      assert.strictEqual((0, _qunitHelpers.count)(`[data-reviewable-id="1234"] .status .pending`), 1);
      assert.ok(!(0, _qunitHelpers.exists)(".stale-help"));
      await (0, _qunitHelpers.publishToMessageBus)("/reviewable_counts", {
        review_count: 1,
        updates: {
          1234: {
            last_performing_username: "foo",
            status: 1
          }
        }
      });
      assert.ok(reviewable.className.includes("reviewable-stale"));
      assert.strictEqual((0, _qunitHelpers.count)("[data-reviewable-id=1234] .status .approved"), 1);
      assert.strictEqual((0, _qunitHelpers.count)(".stale-help"), 1);
      assert.ok((0, _qunitHelpers.query)(".stale-help").innerText.includes("foo"));
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.visit)("/review"); // reload review

      assert.strictEqual((0, _qunitHelpers.count)(".stale-help"), 0);
    });
  });
});
define("discourse/tests/acceptance/search-full-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "discourse/controllers/full-page-search", "discourse/tests/helpers/select-kit-helper"], function (_qunitHelpers, _testHelpers, _qunit, _fullPageSearch, _selectKitHelper) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"discourse/controllers/full-page-search",0,"discourse/tests/helpers/select-kit-helper"eaimeta@70e063a35619d71f

  let lastBody;
  let searchResultClickTracked = false;
  (0, _qunitHelpers.acceptance)("Search - Full Page", function (needs) {
    needs.user();
    needs.settings({
      tagging_enabled: true
    });
    needs.pretender((server, helper) => {
      server.get("/u/search/users", () => {
        return helper.response({
          users: [{
            username: "admin",
            name: "admin",
            avatar_template: "/images/avatar.png"
          }]
        });
      });
      server.get("/admin/groups.json", () => {
        return helper.response({
          id: 2,
          automatic: true,
          name: "moderators",
          user_count: 4,
          alias_level: 0,
          visible: true,
          automatic_membership_email_domains: null,
          primary_group: false,
          title: null,
          grant_trust_level: null,
          incoming_email: null,
          notification_level: null,
          has_messages: true,
          is_member: true,
          mentionable: false,
          flair_url: null,
          flair_bg_color: null,
          flair_color: null
        });
      });
      server.get("/badges.json", () => {
        return helper.response({
          badge_types: [{
            id: 3,
            name: "Bronze",
            sort_order: 7
          }],
          badge_groupings: [{
            id: 1,
            name: "Getting Started",
            description: null,
            position: 10,
            system: true
          }],
          badges: [{
            id: 17,
            name: "Reader",
            description: "Read every reply in a topic with more than 100 replies",
            grant_count: 0,
            allow_title: false,
            multiple_grant: false,
            icon: "fa-certificate",
            image: null,
            listable: true,
            enabled: true,
            badge_grouping_id: 1,
            system: true,
            long_description: "This badge is granted the first time you read a long topic with more than 100 replies. Reading a conversation closely helps you follow the discussion, understand different viewpoints, and leads to more interesting conversations. The more you read, the better the conversation gets. As we like to say, Reading is Fundamental! :slight_smile:\n",
            slug: "reader",
            has_badge: false,
            badge_type_id: 3
          }]
        });
      });
      server.put("/topics/bulk", request => {
        lastBody = helper.parsePostData(request.requestBody);
        return helper.response({
          topic_ids: [130]
        });
      });
      server.post("/search/click", () => {
        searchResultClickTracked = true;
        return helper.response({
          success: "OK"
        });
      });
    });
    needs.hooks.afterEach(() => {
      searchResultClickTracked = false;
    });
    (0, _qunit.test)("perform various searches", async function (assert) {
      await (0, _testHelpers.visit)("/search");
      assert.ok(document.body.classList.contains("search-page"), "has body class");
      assert.ok((0, _qunitHelpers.exists)(".search-container"), "has container class");
      assert.ok((0, _qunitHelpers.exists)(".search-query"));
      assert.ok(!(0, _qunitHelpers.exists)(".fps-topic"));
      await (0, _testHelpers.fillIn)(".search-query", "none");
      await (0, _testHelpers.click)(".search-cta");
      assert.ok(!(0, _qunitHelpers.exists)(".fps-topic"), "has no results");
      assert.ok((0, _qunitHelpers.exists)(".no-results-suggestion"));
      assert.ok((0, _qunitHelpers.exists)(".google-search-form"));
      await (0, _testHelpers.fillIn)(".search-query", "discourse");
      await (0, _testHelpers.click)(".search-cta");
      assert.strictEqual((0, _qunitHelpers.count)(".fps-topic"), 1, "has one post");
    });
    (0, _qunit.test)("search for personal messages", async function (assert) {
      await (0, _testHelpers.visit)("/search");
      await (0, _testHelpers.fillIn)(".search-query", "discourse in:messages");
      await (0, _testHelpers.click)(".search-cta");
      assert.strictEqual((0, _qunitHelpers.count)(".fps-topic"), 1, "has one post");
      assert.strictEqual((0, _qunitHelpers.count)(".topic-status .personal_message"), 1, "shows the right icon");
      assert.strictEqual((0, _qunitHelpers.count)(".search-highlight"), 1, "search highlights work");
    });
    (0, _qunit.test)("escape search term", async function (assert) {
      await (0, _testHelpers.visit)("/search");
      await (0, _testHelpers.fillIn)(".search-query", "@<script>prompt(1337)</script>gmail.com");
      assert.ok((0, _qunitHelpers.exists)('.search-advanced-options span:contains("&lt;script&gt;prompt(1337)&lt;/script&gt;gmail.com")'), "it escapes search term");
    });
    (0, _qunit.test)("update category through advanced search ui", async function (assert) {
      const categoryChooser = (0, _selectKitHelper.default)(".search-advanced-options .category-chooser");
      await (0, _testHelpers.visit)("/search");
      await (0, _testHelpers.fillIn)(".search-query", "none");
      await categoryChooser.expand();
      await categoryChooser.fillInFilter("faq");
      await categoryChooser.selectRowByValue(4);
      assert.ok((0, _qunitHelpers.exists)('.search-advanced-options .badge-category:contains("faq")'), 'has "faq" populated');
      assert.strictEqual((0, _qunitHelpers.query)(".search-query").value, "none #faq", 'has updated search term to "none #faq"');
    });
    (0, _qunit.test)("update category without slug through advanced search ui", async function (assert) {
      const categoryChooser = (0, _selectKitHelper.default)(".search-advanced-options .category-chooser");
      await (0, _testHelpers.visit)("/search");
      await (0, _testHelpers.fillIn)(".search-query", "none");
      await categoryChooser.expand();
      await categoryChooser.fillInFilter("");
      await categoryChooser.selectRowByValue(240);
      assert.ok((0, _qunitHelpers.exists)('.search-advanced-options .badge-category:contains("")'), 'has "" populated');
      assert.strictEqual((0, _qunitHelpers.query)(".search-query").value, "none category:240", 'has updated search term to "none category:240"');
    });
    (0, _qunit.test)("update in:title filter through advanced search ui", async function (assert) {
      await (0, _testHelpers.visit)("/search");
      await (0, _testHelpers.fillIn)(".search-query", "none");
      await (0, _testHelpers.click)(".search-advanced-options .in-title");
      assert.ok((0, _qunitHelpers.exists)(".search-advanced-options .in-title:checked"), 'has "in title" populated');
      assert.strictEqual((0, _qunitHelpers.query)(".search-query").value, "none in:title", 'has updated search term to "none in:title"');
      await (0, _testHelpers.fillIn)(".search-query", "none in:titleasd");
      assert.notOk((0, _qunitHelpers.exists)(".search-advanced-options .in-title:checked"), "does not populate title only checkbox");
    });
    (0, _qunit.test)("update in:likes filter through advanced search ui", async function (assert) {
      await (0, _testHelpers.visit)("/search");
      await (0, _testHelpers.fillIn)(".search-query", "none");
      await (0, _testHelpers.click)(".search-advanced-options .in-likes");
      assert.ok((0, _qunitHelpers.exists)(".search-advanced-options .in-likes:checked"), 'has "I liked" populated');
      assert.strictEqual((0, _qunitHelpers.query)(".search-query").value, "none in:likes", 'has updated search term to "none in:likes"');
    });
    (0, _qunit.test)("update in:messages filter through advanced search ui", async function (assert) {
      await (0, _testHelpers.visit)("/search");
      await (0, _testHelpers.fillIn)(".search-query", "none");
      await (0, _testHelpers.click)(".search-advanced-options .in-private");
      assert.ok((0, _qunitHelpers.exists)(".search-advanced-options .in-private:checked"), 'has "are in my messages" populated');
      assert.strictEqual((0, _qunitHelpers.query)(".search-query").value, "none in:messages", 'has updated search term to "none in:messages"');
      await (0, _testHelpers.fillIn)(".search-query", "none in:personal-direct");
      assert.notOk((0, _qunitHelpers.exists)(".search-advanced-options .in-private:checked"), "does not populate messages checkbox");
    });
    (0, _qunit.test)("update in:seen filter through advanced search ui", async function (assert) {
      await (0, _testHelpers.visit)("/search");
      await (0, _testHelpers.fillIn)(".search-query", "none");
      await (0, _testHelpers.click)(".search-advanced-options .in-seen");
      assert.ok((0, _qunitHelpers.exists)(".search-advanced-options .in-seen:checked"), "it should check the right checkbox");
      assert.strictEqual((0, _qunitHelpers.query)(".search-query").value, "none in:seen", "it should update the search term");
      await (0, _testHelpers.fillIn)(".search-query", "none in:seenasdan");
      assert.notOk((0, _qunitHelpers.exists)(".search-advanced-options .in-seen:checked"), "does not populate seen checkbox");
    });
    (0, _qunit.test)("update in filter through advanced search ui", async function (assert) {
      const inSelector = (0, _selectKitHelper.default)(".search-advanced-options .select-kit#in");
      await (0, _testHelpers.visit)("/search");
      await (0, _testHelpers.click)(".advanced-filters > summary");
      await (0, _testHelpers.fillIn)(".search-query", "none");
      await inSelector.expand();
      await inSelector.selectRowByValue("bookmarks");
      assert.strictEqual(inSelector.header().label(), "I bookmarked", 'has "I bookmarked" populated');
      assert.strictEqual((0, _qunitHelpers.query)(".search-query").value, "none in:bookmarks", 'has updated search term to "none in:bookmarks"');
    });
    (0, _qunit.test)("update status through advanced search ui", async function (assert) {
      const statusSelector = (0, _selectKitHelper.default)(".search-advanced-options .select-kit#search-status-options");
      await (0, _testHelpers.visit)("/search");
      await (0, _testHelpers.click)(".advanced-filters > summary");
      await (0, _testHelpers.fillIn)(".search-query", "none");
      await statusSelector.expand();
      await statusSelector.selectRowByValue("closed");
      assert.strictEqual(statusSelector.header().label(), "are closed", 'has "are closed" populated');
      assert.strictEqual((0, _qunitHelpers.query)(".search-query").value, "none status:closed", 'has updated search term to "none status:closed"');
    });
    (0, _qunit.test)("doesn't update status filter header if wrong value entered through searchbox", async function (assert) {
      const statusSelector = (0, _selectKitHelper.default)(".search-advanced-options .select-kit#search-status-options");
      await (0, _testHelpers.visit)("/search");
      await (0, _testHelpers.click)(".advanced-filters > summary");
      await (0, _testHelpers.fillIn)(".search-query", "status:none");
      assert.strictEqual(statusSelector.header().label(), "any", 'has "any" populated');
    });
    (0, _qunit.test)("doesn't update in filter header if wrong value entered through searchbox", async function (assert) {
      const inSelector = (0, _selectKitHelper.default)(".search-advanced-options .select-kit#in");
      await (0, _testHelpers.visit)("/search");
      await (0, _testHelpers.click)(".advanced-filters > summary");
      await (0, _testHelpers.fillIn)(".search-query", "in:none");
      assert.strictEqual(inSelector.header().label(), "any", 'has "any" populated');
    });
    (0, _qunit.test)("update post time through advanced search ui", async function (assert) {
      await (0, _testHelpers.visit)("/search?expanded=true&q=after:2018-08-22");
      assert.strictEqual((0, _qunitHelpers.query)(".search-query").value, "after:2018-08-22", "it should update the search term correctly");
      await (0, _testHelpers.visit)("/search");
      await (0, _testHelpers.click)(".advanced-filters > summary");
      await (0, _testHelpers.fillIn)(".search-query", "none");
      await (0, _qunitHelpers.selectDate)(".date-picker#search-post-date", "2016-10-05");
      const postTimeSelector = (0, _selectKitHelper.default)(".search-advanced-options .select-kit#postTime");
      await postTimeSelector.expand();
      await postTimeSelector.selectRowByValue("after");
      assert.strictEqual(postTimeSelector.header().label(), "after", 'has "after" populated');
      assert.strictEqual((0, _qunitHelpers.query)(".search-query").value, "none after:2016-10-05", 'has updated search term to "none after:2016-10-05"');
    });
    (0, _qunit.test)("update min post count through advanced search ui", async function (assert) {
      await (0, _testHelpers.visit)("/search");
      await (0, _testHelpers.click)(".advanced-filters > summary");
      await (0, _testHelpers.fillIn)(".search-query", "none");
      await (0, _testHelpers.fillIn)("#search-min-post-count", "5");
      assert.strictEqual((0, _qunitHelpers.query)(".search-advanced-additional-options #search-min-post-count").value, "5", 'has "5" populated');
      assert.strictEqual((0, _qunitHelpers.query)(".search-query").value, "none min_posts:5", 'has updated search term to "none min_posts:5"');
    });
    (0, _qunit.test)("update max post count through advanced search ui", async function (assert) {
      await (0, _testHelpers.visit)("/search");
      await (0, _testHelpers.click)(".advanced-filters > summary");
      await (0, _testHelpers.fillIn)(".search-query", "none");
      await (0, _testHelpers.fillIn)("#search-max-post-count", "5");
      assert.strictEqual((0, _qunitHelpers.query)(".search-advanced-additional-options #search-max-post-count").value, "5", 'has "5" populated');
      assert.strictEqual((0, _qunitHelpers.query)(".search-query").value, "none max_posts:5", 'has updated search term to "none max_posts:5"');
    });
    (0, _qunit.test)("validate advanced search when initially empty", async function (assert) {
      await (0, _testHelpers.visit)("/search?expanded=true");
      await (0, _testHelpers.click)(".search-advanced-options .in-likes");
      assert.ok((0, _selectKitHelper.default)(".search-advanced-options .in-likes:checked"), 'has "I liked" populated');
      assert.strictEqual((0, _qunitHelpers.query)(".search-query").value, "in:likes", 'has updated search term to "in:likes"');
      await (0, _testHelpers.fillIn)(".search-query", "in:likesasdas");
      assert.notOk((0, _qunitHelpers.exists)(".search-advanced-options .in-likes:checked"), "does not populate the likes checkbox");
    });
    (0, _qunit.test)("all tags checkbox only visible for two or more tags", async function (assert) {
      await (0, _testHelpers.visit)("/search?expanded=true");
      const tagSelector = (0, _selectKitHelper.default)("#search-with-tags");
      await tagSelector.expand();
      await tagSelector.selectRowByValue("monkey");
      assert.ok(!(0, _qunitHelpers.visible)("input.all-tags"), "all tags checkbox not visible");
      await tagSelector.selectRowByValue("gazelle");
      assert.ok((0, _qunitHelpers.visible)("input.all-tags"), "all tags checkbox is visible");
    });
    (0, _qunit.test)("search for users", async function (assert) {
      await (0, _testHelpers.visit)("/search");
      const typeSelector = (0, _selectKitHelper.default)(".search-bar .select-kit#search-type");
      await (0, _testHelpers.fillIn)(".search-query", "admin");
      assert.ok(!(0, _qunitHelpers.exists)(".fps-user-item"), "has no user results");
      await (0, _testHelpers.click)(".advanced-filters > summary");
      await typeSelector.expand();
      await typeSelector.selectRowByValue(_fullPageSearch.SEARCH_TYPE_USERS);
      assert.ok(!(0, _qunitHelpers.exists)(".search-filters"), "has no filters");
      await (0, _testHelpers.click)(".search-cta");
      assert.strictEqual((0, _qunitHelpers.count)(".fps-user-item"), 1, "has one user result");
      await typeSelector.expand();
      await typeSelector.selectRowByValue(_fullPageSearch.SEARCH_TYPE_DEFAULT);
      assert.ok((0, _qunitHelpers.exists)(".search-filters"), "returning to topic/posts shows filters");
      assert.ok(!(0, _qunitHelpers.exists)(".fps-user-item"), "has no user results");
    });
    (0, _qunit.test)("search for categories/tags", async function (assert) {
      await (0, _testHelpers.visit)("/search");
      await (0, _testHelpers.fillIn)(".search-query", "none");
      const typeSelector = (0, _selectKitHelper.default)(".search-bar .select-kit#search-type");
      assert.ok(!(0, _qunitHelpers.exists)(".fps-tag-item"), "has no category/tag results");
      await (0, _testHelpers.click)(".advanced-filters > summary");
      await typeSelector.expand();
      await typeSelector.selectRowByValue(_fullPageSearch.SEARCH_TYPE_CATS_TAGS);
      await (0, _testHelpers.click)(".search-cta");
      assert.ok(!(0, _qunitHelpers.exists)(".search-filters"), "has no filters");
      assert.strictEqual((0, _qunitHelpers.count)(".fps-tag-item"), 2, "has two tag results");
      await typeSelector.expand();
      await typeSelector.selectRowByValue(_fullPageSearch.SEARCH_TYPE_DEFAULT);
      assert.ok((0, _qunitHelpers.exists)(".search-filters"), "returning to topic/posts shows filters");
      assert.ok(!(0, _qunitHelpers.exists)(".fps-tag-item"), "has no tag results");
    });
    (0, _qunit.test)("filters expand/collapse as expected", async function (assert) {
      await (0, _testHelpers.visit)("/search?expanded=true");
      assert.ok((0, _qunitHelpers.visible)(".search-advanced-options"), "advanced filters are expanded when url query param is included");
      await (0, _testHelpers.fillIn)(".search-query", "none");
      await (0, _testHelpers.click)(".search-cta");
      assert.notOk((0, _qunitHelpers.exists)(".advanced-filters[open]"), "launching a search collapses advanced filters");
      await (0, _testHelpers.visit)("/search");
      assert.notOk((0, _qunitHelpers.exists)(".advanced-filters[open]"), "filters are collapsed when query param is not present");
      await (0, _testHelpers.click)(".advanced-filters > summary");
      assert.ok((0, _qunitHelpers.visible)(".search-advanced-options"), "clicking on element expands filters");
    });
    (0, _qunit.test)("bulk operations work", async function (assert) {
      await (0, _testHelpers.visit)("/search");
      await (0, _testHelpers.fillIn)(".search-query", "discourse");
      await (0, _testHelpers.click)(".search-cta");
      await (0, _testHelpers.click)(".bulk-select"); // toggle bulk

      await (0, _testHelpers.click)(".bulk-select-visible .btn:nth-child(2)"); // select all

      await (0, _testHelpers.click)(".bulk-select-btn"); // show bulk actions

      await (0, _testHelpers.click)(".topic-bulk-actions-modal .btn:nth-child(2)"); // close topics

      assert.equal(lastBody["topic_ids[]"], 130);
    });
    (0, _qunit.test)("adds visited class to visited topics", async function (assert) {
      await (0, _testHelpers.visit)("/search");
      await (0, _testHelpers.fillIn)(".search-query", "discourse");
      await (0, _testHelpers.click)(".search-cta");
      assert.equal((0, _qunitHelpers.count)(".visited"), 0);
      await (0, _testHelpers.fillIn)(".search-query", "discourse visited");
      await (0, _testHelpers.click)(".search-cta");
      assert.equal((0, _qunitHelpers.count)(".visited"), 1);
    });
    (0, _qunit.test)("result link click tracking is invoked", async function (assert) {
      await (0, _testHelpers.visit)("/search");
      await (0, _testHelpers.fillIn)(".search-query", "discourse");
      await (0, _testHelpers.click)(".search-cta");
      await (0, _testHelpers.click)("a.search-link:first-child");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/t/lorem-ipsum-dolor-sit-amet/130");
      assert.ok(searchResultClickTracked);
    });
  });
});
define("discourse/tests/acceptance/search-mobile-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Search - Mobile", function (needs) {
    needs.mobileView();
    (0, _qunit.test)("search", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#search-button");
      assert.ok((0, _qunitHelpers.exists)("input.full-page-search"), "it shows the full page search form");
      assert.ok(!(0, _qunitHelpers.exists)(".search-results .fps-topic"), "no results by default");
      await (0, _testHelpers.click)(".advanced-filters summary");
      assert.ok((0, _qunitHelpers.exists)(".advanced-filters[open]"), "it should expand advanced search filters");
      await (0, _testHelpers.fillIn)(".search-query", "discourse");
      await (0, _testHelpers.click)(".search-cta");
      assert.strictEqual((0, _qunitHelpers.count)(".fps-topic"), 1, "has one post");
      assert.notOk((0, _qunitHelpers.exists)(".advanced-filters[open]"), "it should collapse advanced search filters");
      await (0, _testHelpers.click)("#search-button");
      assert.strictEqual((0, _qunitHelpers.query)("input.full-page-search").value, "discourse", "it does not reset input when hitting search icon again");
    });
  });
});
define("discourse/tests/acceptance/search-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "I18n", "discourse/tests/fixtures/search-fixtures", "discourse/tests/helpers/select-kit-helper", "qunit", "discourse/widgets/search-menu"], function (_qunitHelpers, _testHelpers, _I18n, _searchFixtures, _selectKitHelper, _qunit, _searchMenu) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"I18n",0,"discourse/tests/fixtures/search-fixtures",0,"discourse/tests/helpers/select-kit-helper",0,"qunit",0,"discourse/widgets/search-menu"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Search - Anonymous", function (needs) {
    needs.pretender((server, helper) => {
      server.get("/search/query", request => {
        if (request.queryParams.type_filter === _searchMenu.DEFAULT_TYPE_FILTER) {
          // posts/topics are not present in the payload by default
          return helper.response({
            users: _searchFixtures.default["search/query"]["users"],
            categories: _searchFixtures.default["search/query"]["categories"],
            tags: _searchFixtures.default["search/query"]["tags"],
            groups: _searchFixtures.default["search/query"]["groups"],
            grouped_search_result: _searchFixtures.default["search/query"]["grouped_search_result"]
          });
        }

        return helper.response(_searchFixtures.default["search/query"]);
      });
      server.get("/u/search/users", () => {
        return helper.response({
          users: [{
            username: "admin",
            name: "admin",
            avatar_template: "/images/avatar.png"
          }]
        });
      });
    });
    (0, _qunit.test)("search", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#search-button");
      assert.ok((0, _qunitHelpers.exists)("#search-term"), "it shows the search input");
      assert.ok((0, _qunitHelpers.exists)(".show-advanced-search"), "it shows full page search button");
      assert.ok((0, _qunitHelpers.exists)(".search-menu .results ul li.search-random-quick-tip"), "shows random quick tip by default");
      await (0, _testHelpers.fillIn)("#search-term", "dev");
      assert.ok(!(0, _qunitHelpers.exists)(".search-menu .results ul li.search-random-quick-tip"), "quick tip no longer shown");
      assert.strictEqual((0, _qunitHelpers.query)(".search-menu .results ul.search-menu-initial-options li:first-child .search-item-slug").innerText.trim(), `dev ${_I18n.default.t("search.in_topics_posts")}`, "shows topic search as first dropdown item");
      assert.ok((0, _qunitHelpers.exists)(".search-menu .search-result-category ul li"), "shows matching category results");
      assert.ok((0, _qunitHelpers.exists)(".search-menu .search-result-user ul li"), "shows matching user results");
      await (0, _testHelpers.triggerKeyEvent)(".search-menu", "keydown", "ArrowDown");
      await (0, _testHelpers.click)(document.activeElement);
      assert.ok((0, _qunitHelpers.exists)(".search-menu .search-result-topic ul li"), "shows topic results");
      assert.ok((0, _qunitHelpers.exists)(".search-menu .results ul li .topic-title[data-topic-id]"), "topic has data-topic-id");
      await (0, _testHelpers.click)(".show-advanced-search");
      assert.strictEqual((0, _qunitHelpers.query)(".full-page-search").value, "dev", "it goes to full search page and preserves the search term");
      assert.ok((0, _qunitHelpers.exists)(".search-advanced-options"), "advanced search is expanded");
    }); // TODO: This feature doesn't work currently (/t/69760)

    (0, _qunit.skip)("search button toggles search menu", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#search-button");
      assert.ok((0, _qunitHelpers.exists)(".search-menu"));
      await (0, _testHelpers.click)(".d-header"); // click outside

      assert.ok(!(0, _qunitHelpers.exists)(".search-menu"));
      await (0, _testHelpers.click)("#search-button");
      assert.ok((0, _qunitHelpers.exists)(".search-menu"));
      await (0, _testHelpers.click)("#search-button"); // toggle same button

      assert.ok(!(0, _qunitHelpers.exists)(".search-menu"));
    });
    (0, _qunit.test)("search scope", async function (assert) {
      const firstResult = ".search-menu .results .search-menu-assistant-item:first-child";
      await (0, _testHelpers.visit)("/tag/important");
      await (0, _testHelpers.click)("#search-button");
      assert.strictEqual((0, _qunitHelpers.query)(firstResult).textContent.trim(), `${_I18n.default.t("search.in")} test`, "contextual tag search is first available option with no term");
      await (0, _testHelpers.fillIn)("#search-term", "smth");
      assert.strictEqual((0, _qunitHelpers.query)(firstResult).textContent.trim(), `smth ${_I18n.default.t("search.in")} test`, "tag-scoped search is first available option");
      await (0, _testHelpers.visit)("/c/bug");
      await (0, _testHelpers.click)("#search-button");
      assert.strictEqual((0, _qunitHelpers.query)(firstResult).textContent.trim(), `smth ${_I18n.default.t("search.in")} bug`, "category-scoped search is first available option");
      assert.ok((0, _qunitHelpers.exists)(`${firstResult} span.badge-wrapper`), "category badge is a span (i.e. not a link)");
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#search-button");
      assert.strictEqual((0, _qunitHelpers.query)(firstResult).textContent.trim(), `smth ${_I18n.default.t("search.in_this_topic")}`, "topic-scoped search is first available option");
      await (0, _testHelpers.visit)("/u/eviltrout");
      await (0, _testHelpers.click)("#search-button");
      assert.strictEqual((0, _qunitHelpers.query)(firstResult).textContent.trim(), `smth ${_I18n.default.t("search.in_posts_by", {
        username: "eviltrout"
      })}`, "user-scoped search is first available option");
    });
    (0, _qunit.test)("search scope for topics", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280/1");
      await (0, _testHelpers.click)("#search-button");
      const firstResult = ".search-menu .results .search-menu-assistant-item:first-child";
      assert.strictEqual((0, _qunitHelpers.query)(firstResult).textContent.trim(), _I18n.default.t("search.in_this_topic"), "contextual topic search is first available option");
      await (0, _testHelpers.fillIn)("#search-term", "a proper");
      await (0, _qunitHelpers.query)("input#search-term").focus();
      await (0, _testHelpers.triggerKeyEvent)(".search-menu", "keydown", "ArrowDown");
      await (0, _testHelpers.click)(document.activeElement);
      assert.ok((0, _qunitHelpers.exists)(".search-menu .search-result-post ul li"), "clicking first option formats results as posts");
      assert.strictEqual((0, _qunitHelpers.query)("#post_7 span.highlighted").textContent.trim(), "a proper", "highlights the post correctly");
      assert.ok((0, _qunitHelpers.exists)(".search-menu .search-context"), "search context indicator is visible");
      await (0, _testHelpers.click)(".clear-search");
      assert.strictEqual((0, _qunitHelpers.query)("#search-term").value, "", "clear button works");
      await (0, _testHelpers.click)(".search-context");
      assert.ok(!(0, _qunitHelpers.exists)(".search-menu .search-context"), "search context indicator is no longer visible");
      await (0, _testHelpers.fillIn)("#search-term", "dev");
      await (0, _qunitHelpers.query)("input#search-term").focus();
      await (0, _testHelpers.triggerKeyEvent)(".search-menu", "keydown", "ArrowDown");
      await (0, _testHelpers.click)(document.activeElement);
      assert.ok((0, _qunitHelpers.exists)(".search-menu .search-context"), "search context indicator is visible");
      await (0, _testHelpers.fillIn)("#search-term", "");
      await (0, _qunitHelpers.query)("input#search-term").focus();
      await (0, _testHelpers.triggerKeyEvent)("input#search-term", "keydown", "Backspace");
      assert.ok(!(0, _qunitHelpers.exists)(".search-menu .search-context"), "backspace resets search context");
    });
    (0, _qunit.test)("topic search scope - keep 'in this topic' filter in full page search", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280/1");
      await (0, _testHelpers.click)("#search-button");
      const firstResult = ".search-menu .results .search-menu-assistant-item:first-child";
      assert.strictEqual((0, _qunitHelpers.query)(firstResult).textContent.trim(), _I18n.default.t("search.in_this_topic"), "contextual topic search is first available option");
      await (0, _testHelpers.fillIn)("#search-term", "proper");
      await (0, _qunitHelpers.query)("input#search-term").focus();
      await (0, _testHelpers.triggerKeyEvent)(".search-menu", "keydown", "ArrowDown");
      await (0, _testHelpers.click)(document.activeElement);
      assert.ok((0, _qunitHelpers.exists)(".search-menu .search-context"), "search context indicator is visible");
      await (0, _testHelpers.click)(".show-advanced-search");
      assert.strictEqual((0, _qunitHelpers.query)(".full-page-search").value, "proper topic:280", "it goes to full search page and preserves search term + context");
      assert.ok((0, _qunitHelpers.exists)(".search-advanced-options"), "advanced search is expanded");
    });
    (0, _qunit.test)("topic search scope - special case when matching a single user", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280/1");
      await (0, _testHelpers.click)("#search-button");
      await (0, _testHelpers.fillIn)("#search-term", "@admin");
      assert.strictEqual((0, _qunitHelpers.count)(".search-menu-assistant-item"), 2);
      assert.strictEqual((0, _qunitHelpers.query)(".search-menu-assistant-item:first-child .search-item-user .label-suffix").textContent.trim(), _I18n.default.t("search.in_this_topic"), "first result hints in this topic search");
      assert.strictEqual((0, _qunitHelpers.query)(".search-menu-assistant-item:nth-child(2) .search-item-user .label-suffix").textContent.trim(), _I18n.default.t("search.in_topics_posts"), "second result hints global search");
    });
    (0, _qunit.test)("Right filters are shown in full page search", async function (assert) {
      const inSelector = (0, _selectKitHelper.default)(".select-kit#in");
      await (0, _testHelpers.visit)("/search?expanded=true");
      await inSelector.expand();
      assert.ok(inSelector.rowByValue("first").exists());
      assert.ok(inSelector.rowByValue("pinned").exists());
      assert.ok(inSelector.rowByValue("wiki").exists());
      assert.ok(inSelector.rowByValue("images").exists());
      assert.notOk(inSelector.rowByValue("unseen").exists());
      assert.notOk(inSelector.rowByValue("posted").exists());
      assert.notOk(inSelector.rowByValue("watching").exists());
      assert.notOk(inSelector.rowByValue("tracking").exists());
      assert.notOk(inSelector.rowByValue("bookmarks").exists());
      assert.notOk((0, _qunitHelpers.exists)(".search-advanced-options .in-likes"));
      assert.notOk((0, _qunitHelpers.exists)(".search-advanced-options .in-private"));
      assert.notOk((0, _qunitHelpers.exists)(".search-advanced-options .in-seen"));
    });
  });
  (0, _qunitHelpers.acceptance)("Search - Authenticated", function (needs) {
    needs.user();
    needs.settings({
      log_search_queries: true
    });
    needs.pretender((server, helper) => {
      server.get("/search/query", request => {
        if (request.queryParams.term.includes("empty")) {
          return helper.response({
            posts: [],
            users: [],
            categories: [],
            tags: [],
            groups: [],
            grouped_search_result: {
              more_posts: null,
              more_users: null,
              more_categories: null,
              term: "plans test",
              search_log_id: 1,
              more_full_page_results: null,
              can_create_topic: true,
              error: null,
              type_filter: null,
              post_ids: [],
              user_ids: [],
              category_ids: [],
              tag_ids: [],
              group_ids: []
            }
          });
        }

        return helper.response(_searchFixtures.default["search/query"]);
      });
    });
    (0, _qunit.test)("Right filters are shown in full page search", async function (assert) {
      const inSelector = (0, _selectKitHelper.default)(".select-kit#in");
      await (0, _testHelpers.visit)("/search?expanded=true");
      await inSelector.expand();
      assert.ok(inSelector.rowByValue("first").exists());
      assert.ok(inSelector.rowByValue("pinned").exists());
      assert.ok(inSelector.rowByValue("wiki").exists());
      assert.ok(inSelector.rowByValue("images").exists());
      assert.ok(inSelector.rowByValue("unseen").exists());
      assert.ok(inSelector.rowByValue("posted").exists());
      assert.ok(inSelector.rowByValue("watching").exists());
      assert.ok(inSelector.rowByValue("tracking").exists());
      assert.ok(inSelector.rowByValue("bookmarks").exists());
      assert.ok((0, _qunitHelpers.exists)(".search-advanced-options .in-likes"));
      assert.ok((0, _qunitHelpers.exists)(".search-advanced-options .in-private"));
      assert.ok((0, _qunitHelpers.exists)(".search-advanced-options .in-seen"));
    });
    (0, _qunit.test)("Works with empty result sets", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#search-button");
      await (0, _testHelpers.fillIn)("#search-term", "plans");
      await (0, _qunitHelpers.query)("input#search-term").focus();
      await (0, _testHelpers.triggerKeyEvent)(".search-menu", "keydown", "ArrowDown");
      await (0, _testHelpers.click)(document.activeElement);
      assert.notStrictEqual((0, _qunitHelpers.count)(".search-menu .results .item"), 0);
      await (0, _testHelpers.fillIn)("#search-term", "plans empty");
      await (0, _testHelpers.triggerKeyEvent)("#search-term", "keydown", 13);
      assert.strictEqual((0, _qunitHelpers.count)(".search-menu .results .item"), 0);
      assert.strictEqual((0, _qunitHelpers.count)(".search-menu .results .no-results"), 1);
    });
    (0, _qunit.test)("search dropdown keyboard navigation", async function (assert) {
      const container = ".search-menu .results";
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#search-button");
      await (0, _testHelpers.fillIn)("#search-term", "dev");
      assert.ok((0, _qunitHelpers.exists)((0, _qunitHelpers.query)(`${container} ul li`)), "has a list of items");
      await (0, _testHelpers.triggerKeyEvent)("#search-term", "keydown", "Enter");
      assert.ok((0, _qunitHelpers.exists)((0, _qunitHelpers.query)(`${container} .search-result-topic`)), "has topic results");
      await (0, _testHelpers.triggerKeyEvent)("#search-term", "keydown", "ArrowDown");
      assert.strictEqual(document.activeElement.getAttribute("href"), (0, _qunitHelpers.query)(`${container} li:first-child a`).getAttribute("href"), "arrow down selects first element");
      await (0, _testHelpers.triggerKeyEvent)("#search-term", "keydown", "ArrowDown");
      assert.strictEqual(document.activeElement.getAttribute("href"), (0, _qunitHelpers.query)(`${container} li:nth-child(2) a`).getAttribute("href"), "arrow down selects next element");
      await (0, _testHelpers.triggerKeyEvent)("#search-term", "keydown", "ArrowDown");
      await (0, _testHelpers.triggerKeyEvent)("#search-term", "keydown", "ArrowDown");
      await (0, _testHelpers.triggerKeyEvent)("#search-term", "keydown", "ArrowDown");
      await (0, _testHelpers.triggerKeyEvent)("#search-term", "keydown", "ArrowDown");
      assert.strictEqual(document.activeElement.getAttribute("href"), "/search?q=dev", "arrow down sets focus to more results link");
      await (0, _testHelpers.triggerKeyEvent)(".search-menu", "keydown", "Escape");
      assert.ok(!(0, _qunitHelpers.exists)(".search-menu:visible"), "Esc removes search dropdown");
      await (0, _testHelpers.click)("#search-button");
      await (0, _testHelpers.triggerKeyEvent)(".search-menu", "keydown", "ArrowDown");
      await (0, _testHelpers.triggerKeyEvent)(".search-menu", "keydown", "ArrowUp");
      assert.strictEqual(document.activeElement.tagName.toLowerCase(), "input", "arrow up sets focus to search term input");
      await (0, _testHelpers.triggerKeyEvent)(".search-menu", "keydown", "Escape");
      await (0, _testHelpers.click)("#create-topic");
      await (0, _testHelpers.click)("#search-button");
      await (0, _testHelpers.triggerKeyEvent)(".search-menu", "keydown", "ArrowDown");
      const firstLink = (0, _qunitHelpers.query)(`${container} li:nth-child(1) a`).getAttribute("href");
      await (0, _testHelpers.triggerKeyEvent)(".search-menu", "keydown", "A");
      assert.strictEqual((0, _qunitHelpers.query)("#reply-control textarea").value, `${window.location.origin}${firstLink}`, "hitting A when focused on a search result copies link to composer");
      await (0, _testHelpers.click)("#search-button");
      await (0, _testHelpers.triggerKeyEvent)("#search-term", "keydown", "Enter");
      assert.ok((0, _qunitHelpers.exists)((0, _qunitHelpers.query)(`${container} .search-result-topic`)), "has topic results");
      await (0, _testHelpers.triggerKeyEvent)("#search-term", "keydown", "Enter");
      assert.ok((0, _qunitHelpers.exists)((0, _qunitHelpers.query)(`.search-container`)), "second Enter hit goes to full page search");
      assert.ok(!(0, _qunitHelpers.exists)((0, _qunitHelpers.query)(`.search-menu`)), "search dropdown is collapsed after second Enter hit"); // new search launched, Enter key should be reset

      await (0, _testHelpers.click)("#search-button");
      assert.ok((0, _qunitHelpers.exists)((0, _qunitHelpers.query)(`${container} ul li`)), "has a list of items");
      await (0, _testHelpers.triggerKeyEvent)("#search-term", "keydown", "Enter");
      assert.ok((0, _qunitHelpers.exists)((0, _qunitHelpers.query)(`.search-menu`)), "search dropdown is visible");
    });
    (0, _qunit.test)("Shows recent search results", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#search-button");
      assert.strictEqual((0, _qunitHelpers.query)(".search-menu .search-menu-recent li:nth-of-type(1) .search-link").textContent.trim(), "yellow", "shows first recent search");
      assert.strictEqual((0, _qunitHelpers.query)(".search-menu .search-menu-recent li:nth-of-type(2) .search-link").textContent.trim(), "blue", "shows second recent search");
    });
  });
  (0, _qunitHelpers.acceptance)("Search - with tagging enabled", function (needs) {
    needs.user();
    needs.settings({
      tagging_enabled: true
    });
    (0, _qunit.test)("displays tags", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#search-button");
      await (0, _testHelpers.fillIn)("#search-term", "dev");
      await (0, _testHelpers.triggerKeyEvent)("#search-term", "keydown", 13);
      assert.strictEqual((0, _qunitHelpers.query)(".search-menu .results ul li:nth-of-type(1) .discourse-tags").textContent.trim(), "dev slow", "tags displayed in search results");
    });
    (0, _qunit.test)("displays tag shortcuts", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#search-button");
      await (0, _testHelpers.fillIn)("#search-term", "dude #monk");
      await (0, _testHelpers.triggerKeyEvent)("#search-term", "keyup", 51);
      const firstItem = ".search-menu .results ul.search-menu-assistant .search-link";
      assert.ok((0, _qunitHelpers.exists)((0, _qunitHelpers.query)(firstItem)));
      const firstTag = (0, _qunitHelpers.query)(`${firstItem} .search-item-tag`).textContent.trim();
      assert.strictEqual(firstTag, "monkey");
    });
  });
  (0, _qunitHelpers.acceptance)("Search - assistant", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/search/query", request => {
        if (request.queryParams["search_context[type]"] === "private_messages") {
          // return only one result for PM search
          return helper.response({
            posts: [{
              id: 3833,
              name: "Bill Dudney",
              username: "bdudney",
              avatar_template: "/user_avatar/meta.discourse.org/bdudney/{size}/8343_1.png",
              uploaded_avatar_id: 8343,
              created_at: "2013-02-07T17:46:57.469Z",
              cooked: "<p>I've gotten vagrant up and running with a development environment but it's taking forever to load.</p>\n\n<p>For example <a href=\"http://192.168.10.200:3000/\" rel=\"nofollow\">http://192.168.10.200:3000/</a> takes tens of seconds to load.</p>\n\n<p>I'm running the whole stack on a new rMBP with OS X 10.8.2.</p>\n\n<p>Any ideas of what I've done wrong? Or is this just a function of being on the bleeding edge?</p>\n\n<p>Thanks,</p>\n\n<p>-bd</p>",
              post_number: 1,
              post_type: 1,
              updated_at: "2013-02-07T17:46:57.469Z",
              like_count: 0,
              reply_count: 1,
              reply_to_post_number: null,
              quote_count: 0,
              incoming_link_count: 4422,
              reads: 327,
              score: 21978.4,
              yours: false,
              topic_id: 2179,
              topic_slug: "development-mode-super-slow",
              display_username: "Bill Dudney",
              primary_group_name: null,
              version: 2,
              can_edit: false,
              can_delete: false,
              can_recover: false,
              user_title: null,
              actions_summary: [{
                id: 2,
                count: 0,
                hidden: false,
                can_act: false
              }, {
                id: 3,
                count: 0,
                hidden: false,
                can_act: false
              }, {
                id: 4,
                count: 0,
                hidden: false,
                can_act: false
              }, {
                id: 5,
                count: 0,
                hidden: true,
                can_act: false
              }, {
                id: 6,
                count: 0,
                hidden: false,
                can_act: false
              }, {
                id: 7,
                count: 0,
                hidden: false,
                can_act: false
              }, {
                id: 8,
                count: 0,
                hidden: false,
                can_act: false
              }],
              moderator: false,
              admin: false,
              staff: false,
              user_id: 1828,
              hidden: false,
              hidden_reason_id: null,
              trust_level: 1,
              deleted_at: null,
              user_deleted: false,
              edit_reason: null,
              can_view_edit_history: true,
              wiki: false,
              blurb: "I've gotten vagrant up and running with a development environment but it's taking forever to load. For example http://192.168.10.200:3000/ takes..."
            }],
            topics: [{
              id: 2179,
              title: "Development mode super slow",
              fancy_title: "Development mode super slow",
              slug: "development-mode-super-slow",
              posts_count: 72,
              reply_count: 53,
              highest_post_number: 73,
              image_url: null,
              created_at: "2013-02-07T17:46:57.262Z",
              last_posted_at: "2015-04-17T08:08:26.671Z",
              bumped: true,
              bumped_at: "2015-04-17T08:08:26.671Z",
              unseen: false,
              pinned: false,
              unpinned: null,
              visible: true,
              closed: false,
              archived: false,
              bookmarked: null,
              liked: null,
              views: 9538,
              like_count: 45,
              has_summary: true,
              archetype: "regular",
              last_poster_username: null,
              category_id: 7,
              pinned_globally: false,
              posters: [],
              tags: ["dev", "slow"],
              tags_descriptions: {
                dev: "dev description",
                slow: "slow description"
              }
            }],
            grouped_search_result: {
              term: "emoji",
              post_ids: [3833]
            }
          });
        }

        return helper.response(_searchFixtures.default["search/query"]);
      });
      server.get("/u/search/users", () => {
        return helper.response({
          users: [{
            username: "TeaMoe",
            name: "TeaMoe",
            avatar_template: "https://avatars.discourse.org/v3/letter/t/41988e/{size}.png"
          }, {
            username: "TeamOneJ",
            name: "J Cobb",
            avatar_template: "https://avatars.discourse.org/v3/letter/t/3d9bf3/{size}.png"
          }, {
            username: "kudos",
            name: "Team Blogeto.com",
            avatar_template: "/user_avatar/meta.discourse.org/kudos/{size}/62185_1.png"
          }]
        });
      });
    });
    (0, _qunit.test)("shows category shortcuts when typing #", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#search-button");
      await (0, _testHelpers.fillIn)("#search-term", "#");
      await (0, _testHelpers.triggerKeyEvent)("#search-term", "keyup", 51);
      const firstCategory = ".search-menu .results ul.search-menu-assistant .search-link";
      assert.ok((0, _qunitHelpers.exists)((0, _qunitHelpers.query)(firstCategory)));
      const firstResultSlug = (0, _qunitHelpers.query)(`${firstCategory} .category-name`).textContent.trim();
      await (0, _testHelpers.click)(firstCategory);
      assert.strictEqual((0, _qunitHelpers.query)("#search-term").value, `#${firstResultSlug}`);
      await (0, _testHelpers.fillIn)("#search-term", "sam #");
      await (0, _testHelpers.triggerKeyEvent)("#search-term", "keyup", 51);
      assert.ok((0, _qunitHelpers.exists)((0, _qunitHelpers.query)(firstCategory)));
      assert.strictEqual((0, _qunitHelpers.query)(".search-menu .results ul.search-menu-assistant .search-item-prefix").innerText, "sam ");
      await (0, _testHelpers.click)(firstCategory);
      assert.strictEqual((0, _qunitHelpers.query)("#search-term").value, `sam #${firstResultSlug}`);
    });
    (0, _qunit.test)("shows in: shortcuts", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#search-button");
      const firstTarget = ".search-menu .results ul.search-menu-assistant .search-link .search-item-slug";
      await (0, _testHelpers.fillIn)("#search-term", "in:");
      await (0, _testHelpers.triggerKeyEvent)("#search-term", "keyup", 51);
      assert.strictEqual((0, _qunitHelpers.query)(firstTarget).innerText, "in:title");
      await (0, _testHelpers.fillIn)("#search-term", "sam in:");
      await (0, _testHelpers.triggerKeyEvent)("#search-term", "keyup", 51);
      assert.strictEqual((0, _qunitHelpers.query)(firstTarget).innerText, "sam in:title");
      await (0, _testHelpers.fillIn)("#search-term", "in:mess");
      await (0, _testHelpers.triggerKeyEvent)("#search-term", "keyup", 51);
      assert.strictEqual((0, _qunitHelpers.query)(firstTarget).innerText, "in:messages");
    });
    (0, _qunit.test)("shows users when typing @", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("#search-button");
      await (0, _testHelpers.fillIn)("#search-term", "@");
      await (0, _testHelpers.triggerKeyEvent)("#search-term", "keyup", 51);
      const firstUser = ".search-menu .results ul.search-menu-assistant .search-item-user";
      const firstUsername = (0, _qunitHelpers.query)(firstUser).innerText.trim();
      assert.strictEqual(firstUsername, "TeaMoe");
      await (0, _testHelpers.click)((0, _qunitHelpers.query)(firstUser));
      assert.strictEqual((0, _qunitHelpers.query)("#search-term").value, `@${firstUsername}`);
    });
    (0, _qunit.test)("shows 'in messages' button when in an inbox", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie/messages");
      await (0, _testHelpers.click)("#search-button");
      assert.ok((0, _qunitHelpers.exists)(".btn.search-context"), "it shows the button");
      await (0, _testHelpers.fillIn)("#search-term", "");
      await (0, _qunitHelpers.query)("input#search-term").focus();
      await (0, _testHelpers.triggerKeyEvent)("input#search-term", "keydown", "Backspace");
      assert.notOk((0, _qunitHelpers.exists)(".btn.search-context"), "it removes the button");
      await (0, _testHelpers.click)(".d-header");
      await (0, _testHelpers.click)("#search-button");
      assert.ok((0, _qunitHelpers.exists)(".btn.search-context"), "it shows the button when reinvoking search");
      await (0, _testHelpers.fillIn)("#search-term", "emoji");
      await (0, _qunitHelpers.query)("input#search-term").focus();
      await (0, _testHelpers.triggerKeyEvent)("#search-term", "keydown", "Enter");
      assert.strictEqual((0, _qunitHelpers.count)(".search-menu .search-result-topic"), 1, "it passes the PM search context to the search query");
    });
  });
});
define("discourse/tests/acceptance/second-factor-auth-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/models/user", "qunit"], function (_qunitHelpers, _testHelpers, _user, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/models/user",0,"qunit"eaimeta@70e063a35619d71f

  const {
    TOTP,
    BACKUP_CODE,
    SECURITY_KEY
  } = _user.SECOND_FACTOR_METHODS;
  const RESPONSES = {
    failed: {
      status: 404,
      error: "could not find an active challenge in your session"
    },
    ok111111: {
      totp_enabled: true,
      backup_enabled: true,
      security_keys_enabled: true,
      allowed_methods: [TOTP, BACKUP_CODE, SECURITY_KEY]
    },
    ok111110: {
      totp_enabled: true,
      backup_enabled: true,
      security_keys_enabled: true,
      allowed_methods: [TOTP, BACKUP_CODE]
    },
    ok110111: {
      totp_enabled: true,
      backup_enabled: true,
      security_keys_enabled: false,
      allowed_methods: [TOTP, BACKUP_CODE, SECURITY_KEY]
    },
    ok100111: {
      totp_enabled: true,
      backup_enabled: false,
      security_keys_enabled: false,
      allowed_methods: [TOTP, BACKUP_CODE, SECURITY_KEY]
    },
    ok111010: {
      totp_enabled: true,
      backup_enabled: true,
      security_keys_enabled: true,
      allowed_methods: [BACKUP_CODE]
    }
  };
  Object.keys(RESPONSES).forEach(k => {
    if (k.startsWith("ok")) {
      const response = RESPONSES[k];

      if (!response.description) {
        response.description = "This is an additional description that can be customized per action";
      }
    }
  });
  const WRONG_TOTP = "124323";
  let callbackCount = 0;
  (0, _qunitHelpers.acceptance)("Second Factor Auth Page", function (needs) {
    needs.user();
    needs.pretender((server, _ref) => {
      let {
        parsePostData,
        response
      } = _ref;
      server.get("/session/2fa.json", request => {
        const responseBody = { ...RESPONSES[request.queryParams.nonce]
        };
        const status = responseBody.status || 200;
        delete responseBody.status;
        return response(status, responseBody);
      });
      server.post("/session/2fa", request => {
        const params = parsePostData(request.requestBody);

        if (params.second_factor_token === WRONG_TOTP) {
          return response(401, {
            error: "invalid token man",
            ok: false
          });
        } else {
          return response({
            ok: true,
            callback_method: "PUT",
            callback_path: "/callback-path",
            redirect_url: "/"
          });
        }
      });
      server.put("/callback-path", () => {
        callbackCount++;
        return response(200, {
          whatever: true
        });
      });
    });
    needs.hooks.beforeEach(() => callbackCount = 0);
    (0, _qunit.test)("when challenge data fails to load", async function (assert) {
      await (0, _testHelpers.visit)("/session/2fa?nonce=failed");
      assert.equal((0, _qunitHelpers.query)(".alert-error").textContent, "could not find an active challenge in your session", "load error message is shown");
    });
    (0, _qunit.test)("default 2FA method", async function (assert) {
      await (0, _testHelpers.visit)("/session/2fa?nonce=ok111111");
      assert.ok((0, _qunitHelpers.exists)("#security-key-authenticate-button"), "security key is the default method");
      assert.ok(!(0, _qunitHelpers.exists)("form.totp-token"), "totp is not shown by default when security key is allowed");
      assert.ok(!(0, _qunitHelpers.exists)("form.backup-code-token"), "backup code form is not shown by default when security key is allowed");
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.visit)("/session/2fa?nonce=ok111110");
      assert.ok(!(0, _qunitHelpers.exists)("#security-key-authenticate-button"), "security key method is not shown when it's not allowed");
      assert.ok((0, _qunitHelpers.exists)("form.totp-token"), "totp is the default method when security key is not allowed");
      assert.ok(!(0, _qunitHelpers.exists)("form.backup-code-token"), "backup code form is not shown by default when TOTP is allowed");
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.visit)("/session/2fa?nonce=ok110111");
      assert.ok(!(0, _qunitHelpers.exists)("#security-key-authenticate-button"), "security key method is not shown when it's not enabled");
      assert.ok((0, _qunitHelpers.exists)("form.totp-token"), "totp is the default method when security key is not enabled");
      assert.ok(!(0, _qunitHelpers.exists)("form.backup-code-token"), "backup code form is not shown by default when TOTP is enabled");
    });
    (0, _qunit.test)("alternative 2FA methods", async function (assert) {
      await (0, _testHelpers.visit)("/session/2fa?nonce=ok111111");
      assert.ok((0, _qunitHelpers.exists)(".toggle-second-factor-method.totp"), "TOTP is shown as an alternative method if it's enabled and allowed");
      assert.ok((0, _qunitHelpers.exists)(".toggle-second-factor-method.backup-code"), "backup code is shown as an alternative method if it's enabled and allowed");
      assert.ok(!(0, _qunitHelpers.exists)(".toggle-second-factor-method.security-key"), "security key is not shown as an alternative method when it's selected");
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.visit)("/session/2fa?nonce=ok100111");
      assert.ok(!(0, _qunitHelpers.exists)(".toggle-second-factor-method"), "no alternative methods are shown if only 1 method is enabled");
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.visit)("/session/2fa?nonce=ok111010");
      assert.ok(!(0, _qunitHelpers.exists)(".toggle-second-factor-method"), "no alternative methods are shown if only 1 method is allowed");
    });
    (0, _qunit.test)("switching 2FA methods", async function (assert) {
      await (0, _testHelpers.visit)("/session/2fa?nonce=ok111111");
      assert.ok((0, _qunitHelpers.exists)("#security-key-authenticate-button"), "security key form is shown because it's the default");
      assert.ok((0, _qunitHelpers.exists)(".toggle-second-factor-method.totp"), "TOTP is shown as an alternative method");
      assert.ok((0, _qunitHelpers.exists)(".toggle-second-factor-method.backup-code"), "backup code is shown as an alternative method");
      assert.ok(!(0, _qunitHelpers.exists)(".toggle-second-factor-method.security-key"), "security key is not shown as an alternative method because it's selected");
      await (0, _testHelpers.click)(".toggle-second-factor-method.totp");
      assert.ok((0, _qunitHelpers.exists)("form.totp-token"), "TOTP form is now shown");
      assert.ok((0, _qunitHelpers.exists)(".toggle-second-factor-method.security-key"), "security key is now shown as alternative method");
      assert.ok((0, _qunitHelpers.exists)(".toggle-second-factor-method.backup-code"), "backup code is still shown as an alternative method");
      assert.ok(!(0, _qunitHelpers.exists)(".toggle-second-factor-method.totp"), "TOTP is no longer shown as an alternative method");
      await (0, _testHelpers.click)(".toggle-second-factor-method.backup-code");
      assert.ok((0, _qunitHelpers.exists)("form.backup-code-token"), "backup code form is now shown");
      assert.ok((0, _qunitHelpers.exists)(".toggle-second-factor-method.security-key"), "security key is still shown as alternative method");
      assert.ok((0, _qunitHelpers.exists)(".toggle-second-factor-method.totp"), "TOTP is now shown as an alternative method");
      assert.ok(!(0, _qunitHelpers.exists)(".toggle-second-factor-method.backup-code"), "backup code is no longer shown as an alternative method");
      await (0, _testHelpers.click)(".toggle-second-factor-method.security-key");
      assert.ok((0, _qunitHelpers.exists)("#security-key-authenticate-button"), "security key form is back");
      assert.ok(!(0, _qunitHelpers.exists)(".toggle-second-factor-method.security-key"), "security key is no longer shown as alternative method");
      assert.ok((0, _qunitHelpers.exists)(".toggle-second-factor-method.totp"), "TOTP is now shown as an alternative method");
      assert.ok((0, _qunitHelpers.exists)(".toggle-second-factor-method.backup-code"), "backup code is now shown as an alternative method");
    });
    (0, _qunit.test)("2FA action description", async function (assert) {
      await (0, _testHelpers.visit)("/session/2fa?nonce=ok111111");
      assert.equal((0, _qunitHelpers.query)(".action-description").textContent.trim(), "This is an additional description that can be customized per action", "action description is rendered on the page");
    });
    (0, _qunit.test)("error when submitting 2FA form", async function (assert) {
      await (0, _testHelpers.visit)("/session/2fa?nonce=ok110111");
      await (0, _testHelpers.fillIn)("form.totp-token .second-factor-token-input", WRONG_TOTP);
      await (0, _testHelpers.click)('form.totp-token .btn-primary[type="submit"]');
      assert.equal((0, _qunitHelpers.query)(".alert-error").textContent.trim(), "invalid token man", "error message from the server is displayed");
    });
    (0, _qunit.test)("successful 2FA form submit", async function (assert) {
      await (0, _testHelpers.visit)("/session/2fa?nonce=ok110111");
      await (0, _testHelpers.fillIn)("form.totp-token .second-factor-token-input", "323421");
      await (0, _testHelpers.click)('form.totp-token .btn-primary[type="submit"]');
      assert.equal((0, _testHelpers.currentURL)(), "/", "user has been redirected to the redirect_url");
      assert.equal(callbackCount, 1, "callback request has been performed");
    });
  });
});
define("discourse/tests/acceptance/share-topic-test", ["discourse/tests/fixtures/category-fixtures", "I18n", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/select-kit-helper", "qunit"], function (_categoryFixtures, _I18n, _testHelpers, _qunitHelpers, _selectKitHelper, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/fixtures/category-fixtures",0,"I18n",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Share and Invite modal", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get(`/c/2481/visible_groups.json`, () => helper.response(200, {
        groups: ["group_name_1", "group_name_2"]
      }));
      server.get(`/c/2/visible_groups.json`, () => helper.response(200, {
        groups: []
      }));
    });
    (0, _qunit.test)("Topic footer button", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      assert.ok((0, _qunitHelpers.exists)("#topic-footer-button-share-and-invite"), "the button exists");
      await (0, _testHelpers.click)("#topic-footer-button-share-and-invite");
      assert.ok((0, _qunitHelpers.exists)(".share-topic-modal"), "it shows the modal");
      assert.notOk((0, _qunitHelpers.exists)("#modal-alert.alert-warning"), "it does not show the alert with restricted groups");
      assert.ok((0, _qunitHelpers.query)("input.invite-link").value.includes("/t/internationalization-localization/280?u=eviltrout"), "it shows the topic sharing url");
      assert.ok((0, _qunitHelpers.exists)(".link-share-actions .invite"), "it shows the invite button");
    });
    (0, _qunit.test)("Post date link", async function (assert) {
      await (0, _testHelpers.visit)("/t/short-topic-with-two-posts/54077");
      assert.ok((0, _qunitHelpers.query)("#post_2 .post-info.post-date a").href.endsWith("/t/short-topic-with-two-posts/54077/2?u=eviltrout"));
      await (0, _testHelpers.click)("#post_2 a.post-date");
      assert.ok((0, _qunitHelpers.exists)(".share-topic-modal"), "it shows the share modal");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/t/short-topic-with-two-posts/54077", "it does not route to post #2");
    });
    (0, _qunit.test)("Share topic in a restricted category", async function (assert) {
      await (0, _testHelpers.visit)("/t/topic-in-restricted-group/2481");
      assert.ok((0, _qunitHelpers.exists)("#topic-footer-button-share-and-invite"), "the button exists");
      await (0, _testHelpers.click)("#topic-footer-button-share-and-invite");
      assert.ok((0, _qunitHelpers.exists)(".share-topic-modal"), "it shows the modal");
      assert.ok((0, _qunitHelpers.exists)("#modal-alert.alert-warning"), "it shows restricted warning");
      assert.strictEqual((0, _qunitHelpers.query)("#modal-alert.alert-warning").innerText, _I18n.default.t("topic.share.restricted_groups", {
        count: 2,
        groupNames: "group_name_1, group_name_2"
      }), "it shows correct restricted group name");
    });
  });
  (0, _qunitHelpers.acceptance)("Share and Invite modal - mobile", function (needs) {
    needs.user();
    needs.mobileView();
    (0, _qunit.test)("Topic footer mobile button", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      assert.ok(!(0, _qunitHelpers.exists)("#topic-footer-button-share-and-invite"), "the button doesnt exist");
      const subject = (0, _selectKitHelper.default)(".topic-footer-mobile-dropdown");
      await subject.expand();
      await subject.selectRowByValue("share-and-invite");
      assert.ok((0, _qunitHelpers.exists)(".share-topic-modal"), "it shows the modal");
    });
  });
  (0, _qunitHelpers.acceptance)("Share url with badges disabled - desktop", function (needs) {
    needs.user();
    needs.settings({
      enable_badges: false
    });
    needs.pretender((server, helper) => {
      server.get("/c/feature/find_by_slug.json", () => helper.response(200, _categoryFixtures.default["/c/1/show.json"]));
    });
    (0, _qunit.test)("topic footer button - badges disabled - desktop", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-button-share-and-invite");
      assert.notOk((0, _qunitHelpers.query)("input.invite-link").value.includes("?u=eviltrout"), "it doesn't add the username param when badges are disabled");
    });
  });
});
define("discourse/tests/acceptance/shared-drafts-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/tests/helpers/select-kit-helper", "qunit"], function (_qunitHelpers, _testHelpers, _selectKitHelper, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Shared Drafts", function () {
    (0, _qunit.test)("Viewing and publishing", async function (assert) {
      await (0, _testHelpers.visit)("/t/some-topic/9");
      assert.strictEqual((0, _qunitHelpers.count)(".shared-draft-controls"), 1);
      let categoryChooser = (0, _selectKitHelper.default)(".shared-draft-controls .category-chooser");
      assert.strictEqual(categoryChooser.header().value(), "3");
      await (0, _testHelpers.click)(".publish-shared-draft");
      await (0, _testHelpers.click)(".bootbox .btn-primary");
      assert.ok(!(0, _qunitHelpers.exists)(".shared-draft-controls"));
    });
    (0, _qunit.test)("Updating category", async function (assert) {
      await (0, _testHelpers.visit)("/t/some-topic/9");
      assert.strictEqual((0, _qunitHelpers.count)(".shared-draft-controls"), 1);
      await (0, _testHelpers.click)(".edit-topic");
      let categoryChooser = (0, _selectKitHelper.default)(".edit-topic-title .category-chooser");
      await categoryChooser.expand();
      await categoryChooser.selectRowByValue(7);
      await (0, _testHelpers.click)(".edit-controls .btn-primary");
      categoryChooser = (0, _selectKitHelper.default)(".shared-draft-controls .category-chooser");
      assert.strictEqual(categoryChooser.header().value(), "7");
    });
  });
});
define("discourse/tests/acceptance/sidebar-anonymous-categories-section-test", ["qunit", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_qunit, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Sidebar - Anonymous Categories Section", function (needs) {
    needs.settings({
      enable_experimental_sidebar_hamburger: true,
      enable_sidebar: true,
      suppress_uncategorized_badge: false
    });
    (0, _qunit.test)("category section links", async function (assert) {
      await (0, _testHelpers.visit)("/");
      const categories = (0, _qunitHelpers.queryAll)(".sidebar-section-categories .sidebar-section-link-wrapper");
      assert.strictEqual(categories.length, 6);
      assert.strictEqual(categories[0].textContent.trim(), "support");
      assert.strictEqual(categories[1].textContent.trim(), "bug");
      assert.strictEqual(categories[2].textContent.trim(), "feature");
      assert.strictEqual(categories[3].textContent.trim(), "dev");
      assert.strictEqual(categories[4].textContent.trim(), "ux");
      assert.ok((0, _qunitHelpers.exists)("a.sidebar-section-link-more-categories"), "more link is visible");
    });
    (0, _qunit.test)("default sidebar categories", async function (assert) {
      this.siteSettings.default_sidebar_categories = "3|13|1";
      await (0, _testHelpers.visit)("/");
      const categories = (0, _qunitHelpers.queryAll)(".sidebar-section-categories .sidebar-section-link-wrapper");
      assert.strictEqual(categories.length, 4);
      assert.strictEqual(categories[0].textContent.trim(), "bug");
      assert.strictEqual(categories[1].textContent.trim(), "meta");
      assert.strictEqual(categories[2].textContent.trim(), "blog");
      assert.ok((0, _qunitHelpers.exists)("a.sidebar-section-link-more-categories"), "more link is visible");
    });
  });
});
define("discourse/tests/acceptance/sidebar-anonymous-community-section-test", ["I18n", "qunit", "discourse/tests/helpers/qunit-helpers", "@ember/test-helpers"], function (_I18n, _qunit, _qunitHelpers, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"I18n",0,"qunit",0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Sidebar - Anonymous user - Community Section", function (needs) {
    needs.settings({
      enable_experimental_sidebar_hamburger: true,
      enable_sidebar: true
    });
    (0, _qunit.test)("everything, users, about and FAQ section links are shown by default ", async function (assert) {
      await (0, _testHelpers.visit)("/");
      const sectionLinks = (0, _qunitHelpers.queryAll)(".sidebar-section-community .sidebar-section-link");
      assert.strictEqual(sectionLinks[0].textContent.trim(), _I18n.default.t("sidebar.sections.community.links.everything.content"), "displays the everything section link first");
      assert.strictEqual(sectionLinks[1].textContent.trim(), _I18n.default.t("sidebar.sections.community.links.users.content"), "displays the users section link second");
      assert.strictEqual(sectionLinks[2].textContent.trim(), _I18n.default.t("sidebar.sections.community.links.about.content"), "displays the about section link third");
      assert.strictEqual(sectionLinks[3].textContent.trim(), _I18n.default.t("sidebar.sections.community.links.faq.content"), "displays the FAQ section link last");
    });
    (0, _qunit.test)("groups  and badges section links are shown in more...", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-more-section-links-details-summary");
      const sectionLinks = (0, _qunitHelpers.queryAll)(".sidebar-more-section-links-details-content-main .sidebar-section-link");
      assert.strictEqual(sectionLinks[0].textContent.trim(), _I18n.default.t("sidebar.sections.community.links.groups.content"), "displays the groups section link first");
      assert.strictEqual(sectionLinks[1].textContent.trim(), _I18n.default.t("sidebar.sections.community.links.badges.content"), "displays the badges section link second");
    });
  });
});
define("discourse/tests/acceptance/sidebar-anonymous-tags-section-test", ["qunit", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_qunit, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Sidebar - Anonymous Tags Section", function (needs) {
    needs.settings({
      enable_experimental_sidebar_hamburger: true,
      enable_sidebar: true,
      suppress_uncategorized_badge: false,
      tagging_enabled: true
    });
    needs.site({
      top_tags: ["design", "development", "fun"]
    });
    (0, _qunit.test)("tag section links", async function (assert) {
      await (0, _testHelpers.visit)("/");
      const categories = (0, _qunitHelpers.queryAll)(".sidebar-section-tags .sidebar-section-link-wrapper");
      assert.strictEqual(categories.length, 4);
      assert.strictEqual(categories[0].textContent.trim(), "design");
      assert.strictEqual(categories[1].textContent.trim(), "development");
      assert.strictEqual(categories[2].textContent.trim(), "fun");
      assert.ok((0, _qunitHelpers.exists)("a.sidebar-section-link-more-tags"), "more link is visible");
    });
  });
  (0, _qunitHelpers.acceptance)("Sidebar - Anonymous Tags Section - default tags", function (needs) {
    needs.settings({
      enable_experimental_sidebar_hamburger: true,
      enable_sidebar: true,
      suppress_uncategorized_badge: false,
      tagging_enabled: true
    });
    needs.site({
      top_tags: ["design", "development", "fun"],
      anonymous_default_sidebar_tags: ["random", "meta"]
    });
    (0, _qunit.test)("tag section links", async function (assert) {
      await (0, _testHelpers.visit)("/");
      const categories = (0, _qunitHelpers.queryAll)(".sidebar-section-tags .sidebar-section-link-wrapper");
      assert.strictEqual(categories.length, 3);
      assert.strictEqual(categories[0].textContent.trim(), "random");
      assert.strictEqual(categories[1].textContent.trim(), "meta");
      assert.ok((0, _qunitHelpers.exists)("a.sidebar-section-link-more-tags"), "more link is visible");
    });
  });
  (0, _qunitHelpers.acceptance)("Sidebar - Anonymous Tags Section - Tagging disabled", function (needs) {
    needs.settings({
      enable_experimental_sidebar_hamburger: true,
      enable_sidebar: true,
      suppress_uncategorized_badge: false,
      tagging_enabled: false
    });
    needs.site({
      top_tags: ["design", "development", "fun"]
    });
    (0, _qunit.test)("tag section links", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.ok(!(0, _qunitHelpers.exists)(".sidebar-section-tags"), "section is not visible");
    });
  });
});
define("discourse/tests/acceptance/sidebar-anonymous-user-test", ["qunit", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_qunit, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Sidebar - Anonymous User", function (needs) {
    needs.settings({
      enable_experimental_sidebar_hamburger: true,
      enable_sidebar: true
    });
    (0, _qunit.test)("sidebar is displayed", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.ok(document.body.classList.contains("has-sidebar-page"), "adds sidebar utility class to body");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-container"), "sidebar exists for anonymous user");
      assert.ok((0, _qunitHelpers.exists)(".header-sidebar-toggle"), "toggle button for anonymous user");
    });
    (0, _qunit.test)("sidebar hamburger panel dropdown when sidebar has been disabled", async function (assert) {
      this.siteSettings.enable_sidebar = false;
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".hamburger-dropdown");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-hamburger-dropdown .sidebar-sections-anonymous"), "sidebar hamburger panel dropdown renders anonymous sidebar sections");
    });
  });
  (0, _qunitHelpers.acceptance)("Sidebar - Anonymous User - Login Required", function (needs) {
    needs.settings({
      enable_experimental_sidebar_hamburger: true,
      enable_sidebar: true,
      login_required: true
    });
    (0, _qunit.test)("sidebar and toggle button is hidden", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.ok(!(0, _qunitHelpers.exists)(".sidebar-container"), "sidebar is hidden for anonymous user");
      assert.ok(!(0, _qunitHelpers.exists)(".header-sidebar-toggle"), "toggle button is hidden for anonymous user");
    });
  });
});
define("discourse/tests/acceptance/sidebar-mobile-test", ["I18n", "qunit", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_I18n, _qunit, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"I18n",0,"qunit",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Sidebar - Mobile - User with sidebar enabled", function (needs) {
    needs.user();
    needs.settings({
      enable_experimental_sidebar_hamburger: true,
      enable_sidebar: true
    });
    needs.mobileView();
    (0, _qunit.test)("hidden by default", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.ok(!(0, _qunitHelpers.exists)(".sidebar-hamburger-dropdown"), "sidebar is not displayed");
    });
    (0, _qunit.test)("clicking outside sidebar collapses it", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".hamburger-dropdown");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-hamburger-dropdown"), "sidebar is displayed");
      await (0, _testHelpers.click)("#main-outlet");
      assert.ok(!(0, _qunitHelpers.exists)(".sidebar-hamburger-dropdown"), "sidebar is collapsed");
    });
    (0, _qunit.test)("clicking on a link or button in sidebar collapses it", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".hamburger-dropdown");
      await (0, _testHelpers.click)(".sidebar-section-link-tracked");
      assert.ok(!(0, _qunitHelpers.exists)(".sidebar-hamburger-dropdown"), "sidebar is collapsed when a button in sidebar is clicked");
      await (0, _testHelpers.click)(".hamburger-dropdown");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-section-link-everything");
      assert.ok(!(0, _qunitHelpers.exists)(".sidebar-hamburger-dropdown"), "sidebar is collapsed when a link in sidebar is clicked");
    });
    (0, _qunit.test)("button to toggle between mobile and desktop view", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".hamburger-dropdown");
      assert.ok((0, _qunitHelpers.exists)(`.sidebar-footer-actions-toggle-mobile-view[title="${_I18n.default.t("desktop_view")}"]`), "displays the right title for the button");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-footer-actions-toggle-mobile-view .d-icon-desktop"), "displays the desktop icon for the button");
    });
  });
});
define("discourse/tests/acceptance/sidebar-plugin-api-test", ["qunit", "I18n", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/lib/plugin-api", "discourse-common/utils/decorators"], function (_qunit, _I18n, _testHelpers, _qunitHelpers, _pluginApi, _decorators) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"I18n",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/lib/plugin-api",0,"discourse-common/utils/decorators"eaimeta@70e063a35619d71f

  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }

  (0, _qunitHelpers.acceptance)("Sidebar - Plugin API", function (needs) {
    needs.user();
    needs.settings({
      enable_experimental_sidebar_hamburger: true,
      enable_sidebar: true
    });
    needs.hooks.afterEach(() => {
      linkDestroy = undefined;
      sectionDestroy = undefined;
    });
    let linkDestroy, sectionDestroy;
    (0, _qunit.test)("Multiple header actions and links", async function (assert) {
      (0, _pluginApi.withPluginApi)("1.3.0", api => {
        api.addSidebarSection((BaseCustomSidebarSection, BaseCustomSidebarSectionLink) => {
          var _class;

          return _class = class extends BaseCustomSidebarSection {
            get name() {
              return "test-chat-channels";
            }

            get text() {
              return "chat channels text";
            }

            get actionsIcon() {
              return "cog";
            }

            get actions() {
              return [{
                id: "browseChannels",
                title: "Browse channels",
                action: () => {}
              }, {
                id: "settings",
                title: "Settings",
                action: () => {}
              }];
            }

            willDestroy() {
              sectionDestroy = "section test";
            }

            get links() {
              var _class2;

              return [new (_class2 = class extends BaseCustomSidebarSectionLink {
                get name() {
                  return "random-channel";
                }

                get route() {
                  return "topic";
                }

                get models() {
                  return ["some-slug", 1];
                }

                get title() {
                  return "random channel title";
                }

                get text() {
                  return "random channel text";
                }

                get prefixType() {
                  return "icon";
                }

                get prefixValue() {
                  return "hashtag";
                }

                get prefixColor() {
                  return "FF0000";
                }

                get prefixBadge() {
                  return "lock";
                }

                get suffixType() {
                  return "icon";
                }

                get suffixValue() {
                  return "circle";
                }

                get suffixCSSClass() {
                  return "unread";
                }

                willDestroy() {
                  linkDestroy = "link test";
                }

              }, (_applyDecoratedDescriptor(_class2.prototype, "willDestroy", [_decorators.bind], Object.getOwnPropertyDescriptor(_class2.prototype, "willDestroy"), _class2.prototype)), _class2)(), new class extends BaseCustomSidebarSectionLink {
                get name() {
                  return "dev-channel";
                }

                get route() {
                  return "discovery.latest";
                }

                get title() {
                  return "dev channel title";
                }

                get text() {
                  return "dev channel text";
                }

                get prefixColor() {
                  return "alert";
                }

                get prefixType() {
                  return "text";
                }

                get prefixValue() {
                  return "test text";
                }

              }(), new class extends BaseCustomSidebarSectionLink {
                get name() {
                  return "fun-channel";
                }

                get route() {
                  return "discovery.latest";
                }

                get title() {
                  return "fun channel title";
                }

                get text() {
                  return "fun channel text";
                }

                get prefixType() {
                  return "image";
                }

                get prefixValue() {
                  return "/test.png";
                }

                get hoverType() {
                  return "icon";
                }

                get hoverValue() {
                  return "times";
                }

                get hoverAction() {
                  return () => {};
                }

                get hoverTitle() {
                  return "hover button title attribute";
                }

              }()];
            }

          }, (_applyDecoratedDescriptor(_class.prototype, "willDestroy", [_decorators.bind], Object.getOwnPropertyDescriptor(_class.prototype, "willDestroy"), _class.prototype)), _class;
        });
      });
      await (0, _testHelpers.visit)("/");
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-test-chat-channels .sidebar-section-header-text").textContent.trim(), "chat channels text", "displays header with correct text");
      await (0, _testHelpers.click)(".sidebar-section-test-chat-channels .sidebar-section-header-dropdown summary");
      assert.strictEqual((0, _qunitHelpers.queryAll)(".sidebar-section-test-chat-channels .sidebar-section-header-dropdown .select-kit-collection li").length, 2, "displays two actions");
      const actions = (0, _qunitHelpers.queryAll)(".sidebar-section-test-chat-channels .sidebar-section-header-dropdown .select-kit-collection li");
      assert.strictEqual(actions[0].textContent.trim(), "Browse channels", "displays first header action with correct text");
      assert.strictEqual(actions[1].textContent.trim(), "Settings", "displays second header action with correct text");
      const links = (0, _qunitHelpers.queryAll)(".sidebar-section-test-chat-channels .sidebar-section-link");
      assert.strictEqual(links[0].textContent.trim(), "random channel text", "displays first link with correct text");
      assert.strictEqual(links[0].title, "random channel title", "displays first link with correct title attribute");
      assert.ok(links[0].href.endsWith("/some-slug/1"), "link has the correct href attribute");
      assert.strictEqual(links[0].children[0].style.color, "rgb(255, 0, 0)", "has correct prefix color");
      assert.strictEqual(links[0].children[0].children[0].classList.contains("d-icon-hashtag"), true, "displays prefix icon");
      assert.strictEqual(links[0].children[0].children[1].classList.contains("d-icon-lock"), true, "displays prefix icon badge");
      assert.strictEqual(links[0].children[2].children[0].classList.contains("d-icon-circle"), true, "displays suffix icon");
      assert.strictEqual(links[1].children[1].textContent.trim(), "dev channel text", "displays second link with correct text");
      assert.strictEqual(links[1].title, "dev channel title", "displays second link with correct title attribute");
      assert.strictEqual(links[1].children[0].style.color, "", "has no color style when value is invalid");
      assert.strictEqual(links[1].children[0].textContent.trim(), "test text", "displays prefix text");
      assert.strictEqual(links[2].children[1].textContent.trim(), "fun channel text", "displays third link with correct text");
      assert.strictEqual(links[2].title, "fun channel title", "displays third link with correct title attribute");
      assert.strictEqual(links[2].children[0].children[0].getAttribute("src"), "/test.png", "uses correct prefix image url");
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-link-hover button").title, "hover button title attribute", "displays hover button with correct title");
      await (0, _testHelpers.click)(".btn-sidebar-toggle");
      assert.strictEqual(linkDestroy, "link test", "calls link willDestroy function");
      assert.strictEqual(sectionDestroy, "section test", "calls section willDestroy function");
    });
    (0, _qunit.test)("Single header action and no links", async function (assert) {
      (0, _pluginApi.withPluginApi)("1.3.0", api => {
        api.addSidebarSection(BaseCustomSidebarSection => {
          return class extends BaseCustomSidebarSection {
            get name() {
              return "test-chat-channels";
            }

            get text() {
              return "chat channels text";
            }

            get actionsIcon() {
              return "cog";
            }

            get actions() {
              return [{
                id: "browseChannels",
                title: "Browse channels",
                action: () => {}
              }];
            }

            get links() {
              return [];
            }

          };
        });
      });
      await (0, _testHelpers.visit)("/");
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-test-chat-channels .sidebar-section-header-text").textContent.trim(), "chat channels text", "displays header with correct text");
      assert.ok((0, _qunitHelpers.exists)("button.sidebar-section-header-button"), "displays single header action button");
      assert.ok(!(0, _qunitHelpers.exists)(".sidebar-section-test-chat-channels .sidebar-section-content a"), "displays no links");
    });
    (0, _qunit.test)("API bridge for decorating hamburger-menu widget with footer links", async function (assert) {
      (0, _pluginApi.withPluginApi)("1.3.0", api => {
        api.decorateWidget("hamburger-menu:footerLinks", () => {
          return {
            route: "discovery.top",
            rawLabel: "my top",
            className: "my-custom-top"
          };
        });
      });
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-more-section-links-details-summary");
      const myCustomTopSectionLink = (0, _qunitHelpers.query)(".sidebar-section-community .sidebar-more-section-links-details-content-secondary .sidebar-section-link-my-custom-top");
      assert.ok(myCustomTopSectionLink, "adds my custom top section link to community section under the secondary section in the More... links drawer");
      assert.ok(myCustomTopSectionLink.href.endsWith("/top"), "sets the right href attribute for the my custom top section link");
      assert.strictEqual(myCustomTopSectionLink.textContent.trim(), "my top", "displays the right text for my custom top section link");
    });
    (0, _qunit.test)("API bridge for decorating hamburger-menu widget with general links", async function (assert) {
      (0, _pluginApi.withPluginApi)("1.3.0", api => {
        api.decorateWidget("hamburger-menu:generalLinks", () => {
          return {
            route: "discovery.latest",
            label: "filters.latest.title"
          };
        });
        api.decorateWidget("hamburger-menu:generalLinks", () => {
          return {
            route: "discovery.unread",
            rawLabel: "my unreads"
          };
        });
        api.decorateWidget("hamburger-menu:generalLinks", () => {
          return {
            route: "discovery.top",
            rawLabel: "my top",
            className: "my-custom-top"
          };
        });
        api.decorateWidget("hamburger-menu:generalLinks", () => {
          return {
            href: "/c/bug?status=open",
            rawLabel: "open bugs"
          };
        });
        api.decorateWidget("hamburger-menu:generalLinks", () => {
          return {
            href: "/t/internationalization-localization/280",
            rawLabel: "my favourite topic"
          };
        });
      });
      await (0, _testHelpers.visit)("/");
      const customLatestSectionLink = (0, _qunitHelpers.query)(".sidebar-section-community .sidebar-section-link-latest");
      assert.ok(customLatestSectionLink, "adds custom latest section link to community section");
      assert.ok(customLatestSectionLink.href.endsWith("/latest"), "sets the right href attribute for the custom latest section link");
      assert.strictEqual(customLatestSectionLink.textContent.trim(), _I18n.default.t("filters.latest.title"), "displays the right text for custom latest section link");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-more-section-links-details-summary");
      const customUnreadSectionLink = (0, _qunitHelpers.query)(".sidebar-section-community .sidebar-section-link-my-unreads");
      assert.ok(customUnreadSectionLink, "adds custom unread section link to community section");
      assert.ok(customUnreadSectionLink.href.endsWith("/unread"), "sets the right href attribute for the custom unread section link");
      assert.strictEqual(customUnreadSectionLink.textContent.trim(), "my unreads", "displays the right text for custom unread section link");
      const customTopSectionLInk = (0, _qunitHelpers.query)(".sidebar-section-community .sidebar-section-link-my-custom-top");
      assert.ok(customTopSectionLInk, "adds custom top section link to community section with right link class");
      const openBugsSectionLink = (0, _qunitHelpers.query)(".sidebar-section-community .sidebar-section-link-open-bugs");
      assert.ok(openBugsSectionLink, "adds custom open bugs section link to community section with right link class");
      assert.ok(openBugsSectionLink.href.endsWith("/c/bug?status=open"), "sets the right href attribute for the custom open bugs section link"); // close more links

      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-more-section-links-details-summary");
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-my-favourite-topic.active"), "displays my favourite topic custom section link when current route matches the link's route");
      await (0, _testHelpers.visit)("/t/short-topic-with-two-posts/54077");
      assert.notOk((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-my-favourite-topic.active"), "does not display my favourite topic custom section link when current route does not match the link's route");
    });
  });
});
define("discourse/tests/acceptance/sidebar-user-categories-section-test", ["I18n", "qunit", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/models/site", "discourse/tests/fixtures/discovery-fixtures", "discourse/tests/fixtures/category-fixtures", "discourse-common/lib/object"], function (_I18n, _qunit, _testHelpers, _qunitHelpers, _site, _discoveryFixtures, _categoryFixtures, _object) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"I18n",0,"qunit",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/models/site",0,"discourse/tests/fixtures/discovery-fixtures",0,"discourse/tests/fixtures/category-fixtures",0,"discourse-common/lib/object"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Sidebar - Logged on user - Categories Section - suppress_uncategorized_badge enabled", function (needs) {
    needs.settings({
      suppress_uncategorized_badge: true,
      enable_experimental_sidebar_hamburger: true,
      enable_sidebar: true
    });
    needs.user();
    (0, _qunit.test)("uncategorized category is not shown", async function (assert) {
      const categories = _site.default.current().categories;

      const category1 = categories[0];
      const uncategorizedCategory = categories.find(category => {
        return category.id === _site.default.current().uncategorized_category_id;
      });
      (0, _qunitHelpers.updateCurrentUser)({
        sidebar_category_ids: [category1.id, uncategorizedCategory.id]
      });
      await (0, _testHelpers.visit)("/");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-categories .sidebar-section-link:not(.sidebar-more-link)"), 1, "there should only be one section link under the section");
      assert.ok((0, _qunitHelpers.exists)(`.sidebar-section-link-${category1.slug}`), `only the ${category1.slug} section link is shown`);
    });
  });
  (0, _qunitHelpers.acceptance)("Sidebar - Logged on user - Categories Section", function (needs) {
    needs.user({
      sidebar_category_ids: [],
      sidebar_tags: []
    });
    needs.settings({
      enable_experimental_sidebar_hamburger: true,
      enable_sidebar: true,
      suppress_uncategorized_badge: false
    });
    needs.pretender((server, helper) => {
      ["latest", "top", "new", "unread"].forEach(type => {
        server.get(`/c/:categorySlug/:categoryId/l/${type}.json`, () => {
          return helper.response((0, _object.cloneJSON)(_discoveryFixtures.default["/c/bug/1/l/latest.json"]));
        });
      });
      server.get("/c/:categorySlug/:categoryId/find_by_slug.json", () => {
        return helper.response((0, _object.cloneJSON)(_categoryFixtures.default["/c/1/show.json"]));
      });
    });

    const setupUserSidebarCategories = function () {
      const categories = _site.default.current().categories;

      const category1 = categories[0];
      const category2 = categories[1];
      const category3 = categories[5];
      (0, _qunitHelpers.updateCurrentUser)({
        sidebar_category_ids: [category1.id, category2.id, category3.id]
      });
      return {
        category1,
        category2,
        category3
      };
    };

    (0, _qunit.test)("clicking on section header link", async function (assert) {
      await (0, _testHelpers.visit)("/t/280");
      await (0, _testHelpers.click)(".sidebar-section-categories .sidebar-section-header");
      assert.notOk((0, _qunitHelpers.exists)(".sidebar-section-categories .sidebar-section-content"), "hides the content of the section");
    });
    (0, _qunit.test)("clicking on section header button", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".sidebar-section-categories .sidebar-section-header-button");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/u/eviltrout/preferences/sidebar", "it should transition to user preferences sidebar page");
    });
    (0, _qunit.test)("category section links when user has not added any categories", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-message"), "the no categories message is displayed");
      await (0, _testHelpers.click)(".sidebar-section-message a");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/u/eviltrout/preferences/sidebar", "it should transition to user preferences sidebar page");
    });
    (0, _qunit.test)("uncategorized category is shown when added to sidebar", async function (assert) {
      const categories = _site.default.current().categories;

      const uncategorizedCategory = categories.find(category => {
        return category.isUncategorizedCategory;
      });
      (0, _qunitHelpers.updateCurrentUser)({
        sidebar_category_ids: [uncategorizedCategory.id]
      });
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)(`.sidebar-section-link-${uncategorizedCategory.slug}`), `displays the section link for ${uncategorizedCategory.slug} category`);
    });
    (0, _qunit.test)("category section links are sorted by category name alphabetically", async function (assert) {
      const {
        category1,
        category2,
        category3
      } = setupUserSidebarCategories();
      category3.set("name", "aBC");
      category2.set("name", "abc");
      category1.set("name", "efg");
      await (0, _testHelpers.visit)("/");
      const categorySectionLinks = (0, _qunitHelpers.queryAll)(".sidebar-section-categories .sidebar-section-link:not(.sidebar-more-link)");
      const categoryNames = [...categorySectionLinks].map(categorySectionLink => categorySectionLink.textContent.trim());
      assert.deepEqual(categoryNames, ["abc", "aBC", "efg"], "category section links are displayed in the right order");
    });
    (0, _qunit.test)("category section links", async function (assert) {
      const {
        category1,
        category2,
        category3
      } = setupUserSidebarCategories();
      await (0, _testHelpers.visit)("/");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-categories .sidebar-section-link:not(.sidebar-more-link)"), 3, "there should only be 3 section link under the section");
      assert.ok((0, _qunitHelpers.exists)(`.sidebar-section-link-${category1.slug} .prefix-icon.d-icon-square-full`), "category1 section link is rendered with right prefix icon");
      assert.ok((0, _qunitHelpers.exists)(`.sidebar-section-link-${category1.slug} .sidebar-section-link-prefix[style="color: #${category1.color}"]`), "category1 section link is rendered with right prefix icon color");
      assert.strictEqual((0, _qunitHelpers.query)(`.sidebar-section-link-${category1.slug}`).textContent.trim(), category1.name, "displays category1's name for the link text");
      await (0, _testHelpers.click)(`.sidebar-section-link-${category1.slug}`);
      assert.strictEqual((0, _testHelpers.currentURL)(), `/c/${category1.slug}/${category1.id}/l/latest`, "it should transition to the category1's discovery page");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-categories .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(`.sidebar-section-link-${category1.slug}.active`), "the category1 section link is marked as active");
      await (0, _testHelpers.click)(`.sidebar-section-link-${category2.slug}`);
      assert.strictEqual((0, _testHelpers.currentURL)(), `/c/${category2.slug}/${category2.id}/l/latest`, "it should transition to the category2's discovery page");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-categories .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(`.sidebar-section-link-${category2.slug}.active`), "the category2 section link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(`.sidebar-section-link-${category3.slug} .sidebar-section-link-prefix .prefix-badge.d-icon-lock`), "category3 section link is rendered with lock prefix badge icon as it is read restricted");
    });
    (0, _qunit.test)("visiting category discovery new route", async function (assert) {
      const {
        category1
      } = setupUserSidebarCategories();
      await (0, _testHelpers.visit)(`/c/${category1.slug}/${category1.id}/l/new`);
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-categories .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(`.sidebar-section-link-${category1.slug}.active`), "the category1 section link is marked as active for the new route");
    });
    (0, _qunit.test)("visiting category discovery unread route", async function (assert) {
      const {
        category1
      } = setupUserSidebarCategories();
      await (0, _testHelpers.visit)(`/c/${category1.slug}/${category1.id}/l/unread`);
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-categories .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(`.sidebar-section-link-${category1.slug}.active`), "the category1 section link is marked as active for the unread route");
    });
    (0, _qunit.test)("visiting category discovery top route", async function (assert) {
      const {
        category1
      } = setupUserSidebarCategories();
      await (0, _testHelpers.visit)(`/c/${category1.slug}/${category1.id}/l/top`);
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-categories .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(`.sidebar-section-link-${category1.slug}.active`), "the category1 section link is marked as active for the top route");
    });
    (0, _qunit.test)("new and unread count for categories link", async function (assert) {
      const {
        category1,
        category2
      } = setupUserSidebarCategories();
      this.container.lookup("service:topic-tracking-state").loadStates([{
        topic_id: 1,
        highest_post_number: 1,
        last_read_post_number: null,
        created_at: "2022-05-11T03:09:31.959Z",
        category_id: category1.id,
        notification_level: null,
        created_in_new_period: true,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }, {
        topic_id: 2,
        highest_post_number: 12,
        last_read_post_number: 11,
        created_at: "2020-02-09T09:40:02.672Z",
        category_id: category1.id,
        notification_level: 2,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }, {
        topic_id: 3,
        highest_post_number: 15,
        last_read_post_number: 14,
        created_at: "2021-06-14T12:41:02.477Z",
        category_id: category2.id,
        notification_level: 2,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }, {
        topic_id: 4,
        highest_post_number: 17,
        last_read_post_number: 16,
        created_at: "2020-10-31T03:41:42.257Z",
        category_id: category2.id,
        notification_level: 2,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }]);
      await (0, _testHelpers.visit)("/");
      assert.strictEqual((0, _qunitHelpers.query)(`.sidebar-section-link-${category1.slug} .sidebar-section-link-content-badge`).textContent.trim(), _I18n.default.t("sidebar.unread_count", {
        count: 1
      }), `displays 1 unread count for ${category1.slug} section link`);
      assert.strictEqual((0, _qunitHelpers.query)(`.sidebar-section-link-${category2.slug} .sidebar-section-link-content-badge`).textContent.trim(), _I18n.default.t("sidebar.unread_count", {
        count: 2
      }), `displays 2 unread count for ${category2.slug} section link`);
      await (0, _qunitHelpers.publishToMessageBus)("/unread", {
        topic_id: 2,
        message_type: "read",
        payload: {
          last_read_post_number: 12,
          highest_post_number: 12
        }
      });
      assert.strictEqual((0, _qunitHelpers.query)(`.sidebar-section-link-${category1.slug} .sidebar-section-link-content-badge`).textContent.trim(), _I18n.default.t("sidebar.new_count", {
        count: 1
      }), `displays 1 new count for ${category1.slug} section link`);
      await (0, _qunitHelpers.publishToMessageBus)("/unread", {
        topic_id: 1,
        message_type: "read",
        payload: {
          last_read_post_number: 1,
          highest_post_number: 1
        }
      });
      assert.ok(!(0, _qunitHelpers.exists)(`.sidebar-section-link-${category1.slug} .sidebar-section-link-content-badge`), `does not display any badge ${category1.slug} section link`);
      await (0, _qunitHelpers.publishToMessageBus)("/unread", {
        topic_id: 3,
        message_type: "read",
        payload: {
          last_read_post_number: 15,
          highest_post_number: 15
        }
      });
      assert.strictEqual((0, _qunitHelpers.query)(`.sidebar-section-link-${category2.slug} .sidebar-section-link-content-badge`).textContent.trim(), _I18n.default.t("sidebar.unread_count", {
        count: 1
      }), `displays 1 unread count for ${category2.slug} section link`);
    });
    (0, _qunit.test)("clean up topic tracking state state changed callbacks when Sidebar is collapsed", async function (assert) {
      setupUserSidebarCategories();
      await (0, _testHelpers.visit)("/");
      const topicTrackingState = this.container.lookup("service:topic-tracking-state");
      const initialCallbackCount = Object.keys(topicTrackingState.stateChangeCallbacks).length;
      await (0, _testHelpers.click)(".btn-sidebar-toggle");
      assert.ok(Object.keys(topicTrackingState.stateChangeCallbacks).length < initialCallbackCount);
    });
  });
});
define("discourse/tests/acceptance/sidebar-user-community-section-test", ["I18n", "qunit", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/tests/fixtures/discovery-fixtures", "discourse-common/lib/object", "discourse/lib/plugin-api", "discourse/models/site", "discourse/lib/notification-levels"], function (_I18n, _qunit, _testHelpers, _qunitHelpers, _discoveryFixtures, _object, _pluginApi, _site, _notificationLevels) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"I18n",0,"qunit",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/tests/fixtures/discovery-fixtures",0,"discourse-common/lib/object",0,"discourse/lib/plugin-api",0,"discourse/models/site",0,"discourse/lib/notification-levels"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Sidebar - Logged on user - Community Section", function (needs) {
    needs.user({
      tracked_tags: ["tag1"],
      watched_tags: ["tag2"],
      watching_first_post_tags: ["tag3"]
    });
    needs.settings({
      enable_experimental_sidebar_hamburger: true,
      enable_sidebar: true
    });
    needs.pretender((server, helper) => {
      server.get("/new.json", () => {
        return helper.response((0, _object.cloneJSON)(_discoveryFixtures.default["/latest.json"]));
      });
      server.get("/unread.json", () => {
        return helper.response((0, _object.cloneJSON)(_discoveryFixtures.default["/latest.json"]));
      });
      server.get("/top.json", () => {
        return helper.response((0, _object.cloneJSON)(_discoveryFixtures.default["/latest.json"]));
      });
    });
    (0, _qunit.test)("clicking on section header button", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-section-header-button");
      assert.ok((0, _qunitHelpers.exists)("#reply-control"), "it opens the composer");
    });
    (0, _qunit.test)("clicking on section header button while viewing a category", async function (assert) {
      await (0, _testHelpers.visit)("/c/bug");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-section-header-button");
      assert.ok((0, _qunitHelpers.exists)("#reply-control"), "it opens the composer");
      assert.strictEqual((0, _qunitHelpers.query)(".category-input .selected-name .category-name").textContent, "bug", "the current category is prefilled in the composer input");
    });
    (0, _qunit.test)("clicking on section header link", async function (assert) {
      await (0, _testHelpers.visit)("/t/280");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-content"), "shows content section");
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-community .sidebar-section-header").title, _I18n.default.t("sidebar.toggle_section"), "caret has the right title");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-section-header");
      assert.notOk((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-content"), "hides the content of the section");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-section-header");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-content"), "shows content section");
    }); // TODO(tgxworld): Flaky probably due to assertions running before event listener callbacks have completed.

    (0, _qunit.skip)("clicking on more... link", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-more-section-links-details-summary");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-more-section-links-details-content"), "additional section links are displayed");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-more-section-links-details-summary");
      assert.notOk((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-more-section-links-details-content"), "additional section links are hidden");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-more-section-links-details-summary");
      await (0, _testHelpers.click)("#main-outlet");
      assert.notOk((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-more-section-links-details-content"), "additional section links are hidden when clicking outside");
    });
    (0, _qunit.test)("clicking on everything link", async function (assert) {
      await (0, _testHelpers.visit)("/t/280");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-section-link-everything");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/latest", "it should transition to the latest page");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-community .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-everything.active"), "the everything link is marked as active");
    });
    (0, _qunit.test)("clicking on tracked link", async function (assert) {
      await (0, _testHelpers.visit)("/t/280");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-section-link-tracked");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/latest?f=tracked", "it should transition to the tracked url");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-community .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-tracked.active"), "the tracked link is marked as active");
    });
    (0, _qunit.test)("clicking on users link", async function (assert) {
      await (0, _testHelpers.visit)("/t/280");
      assert.notOk((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-users"), "users link is not displayed in sidebar when it is not the active route");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-more-section-links-details-summary");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-section-link-users");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/u?order=likes_received", "it should transition to the users url");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-community .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-users.active"), "the users link is marked as active");
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-community .sidebar-more-section-links-details-summary").textContent.trim(), _I18n.default.t("sidebar.more"), "displays the right count as users link is currently active");
      await (0, _testHelpers.visit)("/u");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-users.active"), "users link is displayed in sidebar when it is the active route");
    });
    (0, _qunit.test)("clicking on badges link", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-more-section-links-details-summary");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-section-link-badges");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/badges", "it should transition to the badges url");
    });
    (0, _qunit.test)("clicking on groups link", async function (assert) {
      await (0, _testHelpers.visit)("/t/280");
      assert.notOk((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-groups"), "groups link is not displayed in sidebar when it is not the active route");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-more-section-links-details-summary");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-section-link-groups");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/g", "it should transition to the groups url");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-community .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-groups.active"), "the groups link is marked as active");
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-community .sidebar-more-section-links-details-summary").textContent.trim(), _I18n.default.t("sidebar.more"), "displays the right count as groups link is currently active");
      await (0, _testHelpers.visit)("/g");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-groups.active"), "groups link is displayed in sidebar when it is the active route");
    });
    (0, _qunit.test)("navigating to about from sidebar", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-more-section-links-details-summary");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-section-link-about");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/about", "navigates to about route correctly");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-about.active"), "about section link link is displayed in the main section and marked as active");
    });
    (0, _qunit.test)("navigating to FAQ from sidebar", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-more-section-links-details-summary");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-section-link-faq");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/faq", "navigates to faq route correctly");
    });
    (0, _qunit.test)("navigating to custom FAQ URL from sidebar", async function (assert) {
      this.siteSettings.faq_url = "http://some.faq.url";
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-more-section-links-details-summary");
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-community .sidebar-section-link-faq").href, "http://some.faq.url/", "href attribute is set to custom FAQ URL on the section link");
    });
    (0, _qunit.test)("navigating to admin from sidebar", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-section-link-admin");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "admin.dashboard.general");
    });
    (0, _qunit.test)("admin section link is not shown to non-staff users", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        admin: false,
        moderator: false
      });
      await (0, _testHelpers.visit)("/");
      assert.notOk((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-admin"));
    });
    (0, _qunit.test)("clicking on my posts link", async function (assert) {
      await (0, _testHelpers.visit)("/t/280");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-section-link-my-posts");
      assert.strictEqual((0, _testHelpers.currentURL)(), `/u/${(0, _qunitHelpers.loggedInUser)().username}/activity`, "it should transition to the user's activity url");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-community .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-my-posts.active"), "the my posts link is marked as active");
      await (0, _testHelpers.visit)(`/u/${(0, _qunitHelpers.loggedInUser)().username}/activity/drafts`);
      assert.notOk((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-my-posts.active"), "the my posts link is not marked as active when user has no drafts and visiting the user activity drafts URL");
    });
    (0, _qunit.test)("clicking on my posts link when user has a draft", async function (assert) {
      await (0, _testHelpers.visit)("/t/280");
      await (0, _qunitHelpers.publishToMessageBus)(`/user-drafts/${(0, _qunitHelpers.loggedInUser)().id}`, {
        draft_count: 1
      });
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-section-link-my-posts");
      assert.strictEqual((0, _testHelpers.currentURL)(), `/u/${(0, _qunitHelpers.loggedInUser)().username}/activity/drafts`, "it transitions to the user's activity drafts url");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-community .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-my-posts.active"), "the my posts link is marked as active");
      await (0, _testHelpers.visit)(`/u/${(0, _qunitHelpers.loggedInUser)().username}/activity`);
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-my-posts.active"), "the my posts link is marked as active");
    });
    (0, _qunit.test)("visiting top route", async function (assert) {
      await (0, _testHelpers.visit)("/top");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-community .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-everything.active"), "the everything link is marked as active");
    });
    (0, _qunit.test)("visiting unread route", async function (assert) {
      await (0, _testHelpers.visit)("/unread");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-community .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-everything.active"), "the everything link is marked as active");
    });
    (0, _qunit.test)("visiting new route", async function (assert) {
      await (0, _testHelpers.visit)("/new");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-community .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-everything.active"), "the everything link is marked as active");
    });
    (0, _qunit.test)("new and unread count for everything link", async function (assert) {
      this.container.lookup("service:topic-tracking-state").loadStates([{
        topic_id: 1,
        highest_post_number: 1,
        last_read_post_number: null,
        created_at: "2022-05-11T03:09:31.959Z",
        category_id: 1,
        notification_level: null,
        created_in_new_period: true,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }, {
        topic_id: 2,
        highest_post_number: 12,
        last_read_post_number: 11,
        created_at: "2020-02-09T09:40:02.672Z",
        category_id: 2,
        notification_level: 2,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }, {
        topic_id: 3,
        highest_post_number: 15,
        last_read_post_number: 14,
        created_at: "2021-06-14T12:41:02.477Z",
        category_id: 3,
        notification_level: 2,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }, {
        topic_id: 4,
        highest_post_number: 17,
        last_read_post_number: 16,
        created_at: "2020-10-31T03:41:42.257Z",
        category_id: 4,
        notification_level: 2,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }]);
      await (0, _testHelpers.visit)("/");
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-link-everything .sidebar-section-link-content-badge").textContent.trim(), "3 unread", "it displays the right unread count");
      assert.ok((0, _qunitHelpers.query)(".sidebar-section-link-everything").href.endsWith("/unread"), "it links to unread filter"); // simulate reading topic 2

      await (0, _qunitHelpers.publishToMessageBus)("/unread", {
        topic_id: 2,
        message_type: "read",
        payload: {
          last_read_post_number: 12,
          highest_post_number: 12,
          notification_level: 2
        }
      });
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-link-everything .sidebar-section-link-content-badge").textContent.trim(), "2 unread", "it updates the unread count"); // simulate reading topic 3

      await (0, _qunitHelpers.publishToMessageBus)("/unread", {
        topic_id: 3,
        message_type: "read",
        payload: {
          last_read_post_number: 15,
          highest_post_number: 15,
          notification_level: 2
        }
      }); // simulate reading topic 4

      await (0, _qunitHelpers.publishToMessageBus)("/unread", {
        topic_id: 4,
        message_type: "read",
        payload: {
          last_read_post_number: 17,
          highest_post_number: 17,
          notification_level: 2
        }
      });
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-link-everything .sidebar-section-link-content-badge").textContent.trim(), "1 new", "it displays the new count once there are no unread topics");
      assert.ok((0, _qunitHelpers.query)(".sidebar-section-link-everything").href.endsWith("/new"), "it links to new filter");
      await (0, _qunitHelpers.publishToMessageBus)("/unread", {
        topic_id: 1,
        message_type: "read",
        payload: {
          last_read_post_number: 1,
          highest_post_number: 1,
          notification_level: 2
        }
      });
      assert.ok(!(0, _qunitHelpers.exists)(".sidebar-section-link-everything .sidebar-section-link-content-badge"), "it removes new count once there are no new topics");
      assert.ok((0, _qunitHelpers.query)(".sidebar-section-link-everything").href.endsWith("/latest"), "it links to latest filter");
    });
    (0, _qunit.test)("visiting top route with tracked filter", async function (assert) {
      await (0, _testHelpers.visit)("/top?f=tracked");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-community .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-tracked.active"), "the tracked link is marked as active");
    });
    (0, _qunit.test)("visiting unread route with tracked filter", async function (assert) {
      await (0, _testHelpers.visit)("/unread?f=tracked");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-community .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-tracked.active"), "the tracked link is marked as active");
    });
    (0, _qunit.test)("visiting new route with tracked filter", async function (assert) {
      await (0, _testHelpers.visit)("/new?f=tracked");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-community .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-community .sidebar-section-link-tracked.active"), "the tracked link is marked as active");
    });
    (0, _qunit.test)("new and unread count for tracked link", async function (assert) {
      const categories = _site.default.current().categories; // Category id 1001 has two subcategories


      const category = categories.find(c => c.id === 1001);
      category.set("notification_level", _notificationLevels.NotificationLevels.TRACKING);
      this.container.lookup("service:topic-tracking-state").loadStates([{
        topic_id: 1,
        highest_post_number: 1,
        last_read_post_number: null,
        created_at: "2022-05-11T03:09:31.959Z",
        category_id: category.id,
        notification_level: _notificationLevels.NotificationLevels.TRACKING,
        created_in_new_period: true,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }, {
        topic_id: 2,
        highest_post_number: 12,
        last_read_post_number: 11,
        created_at: "2020-02-09T09:40:02.672Z",
        category_id: category.subcategories[0].id,
        notification_level: _notificationLevels.NotificationLevels.TRACKING,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }, {
        topic_id: 3,
        highest_post_number: 12,
        last_read_post_number: 11,
        created_at: "2020-02-09T09:40:02.672Z",
        category_id: category.subcategories[0].subcategories[0].id,
        notification_level: _notificationLevels.NotificationLevels.TRACKING,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }, {
        topic_id: 4,
        highest_post_number: 15,
        last_read_post_number: 14,
        created_at: "2021-06-14T12:41:02.477Z",
        category_id: 3,
        notification_level: _notificationLevels.NotificationLevels.TRACKING,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }, {
        topic_id: 5,
        highest_post_number: 1,
        last_read_post_number: null,
        created_at: "2021-06-14T12:41:02.477Z",
        category_id: 3,
        notification_level: null,
        created_in_new_period: true,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }, {
        topic_id: 6,
        highest_post_number: 17,
        last_read_post_number: 16,
        created_at: "2020-10-31T03:41:42.257Z",
        category_id: 1234,
        notification_level: _notificationLevels.NotificationLevels.TRACKING,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z",
        tags: ["tag3"]
      }]);
      await (0, _testHelpers.visit)("/");
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-link-tracked .sidebar-section-link-content-badge").textContent.trim(), "3 unread", "it displays the right unread count");
      assert.ok((0, _qunitHelpers.query)(".sidebar-section-link-tracked").href.endsWith("/unread?f=tracked"), "it links to unread url with tracked filter"); // simulate reading topic id 2

      await (0, _qunitHelpers.publishToMessageBus)("/unread", {
        topic_id: 2,
        message_type: "read",
        payload: {
          last_read_post_number: 12,
          highest_post_number: 12
        }
      });
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-link-tracked .sidebar-section-link-content-badge").textContent.trim(), "2 unread", "it updates the unread count"); // simulate reading topic id 3

      await (0, _qunitHelpers.publishToMessageBus)("/unread", {
        topic_id: 3,
        message_type: "read",
        payload: {
          last_read_post_number: 17,
          highest_post_number: 17
        }
      }); // simulate reading topic id 6

      await (0, _qunitHelpers.publishToMessageBus)("/unread", {
        topic_id: 6,
        message_type: "read",
        payload: {
          last_read_post_number: 17,
          highest_post_number: 17
        }
      });
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-link-tracked .sidebar-section-link-content-badge").textContent.trim(), "1 new", "it displays the new count once there are no tracked unread topics");
      assert.ok((0, _qunitHelpers.query)(".sidebar-section-link-tracked").href.endsWith("/new?f=tracked"), "it links to new url with tracked filter"); // simulate reading topic id 1

      await (0, _qunitHelpers.publishToMessageBus)("/unread", {
        topic_id: 1,
        message_type: "read",
        payload: {
          last_read_post_number: 1,
          highest_post_number: 1
        }
      });
      assert.ok(!(0, _qunitHelpers.exists)(".sidebar-section-link-tracked .sidebar-section-link-content-badge"), "it removes new count once there are no tracked new topics");
      assert.ok((0, _qunitHelpers.query)(".sidebar-section-link-tracked").href.endsWith("/latest?f=tracked"), "it links to latest url with tracked filter");
    });
    (0, _qunit.test)("adding section link via plugin API with Object", async function (assert) {
      (0, _pluginApi.withPluginApi)("1.2.0", api => {
        api.addCommunitySectionLink({
          name: "unread",
          route: "discovery.unread",
          text: "unread topics",
          title: "List of unread topics"
        });
      });
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-more-section-links-details-summary");
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-link-unread").textContent.trim(), "unread topics", "displays the right text for the link");
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-link-unread").title, "List of unread topics", "displays the right title for the link");
      await (0, _testHelpers.click)(".sidebar-section-link-unread");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/unread", "links to the right URL");
    });
    (0, _qunit.test)("adding section link via plugin API with callback function", async function (assert) {
      (0, _pluginApi.withPluginApi)("1.2.0", api => {
        api.addCommunitySectionLink(baseSectionLink => {
          return class CustomSectionLink extends baseSectionLink {
            get name() {
              return "user-summary";
            }

            get route() {
              return "user.summary";
            }

            get model() {
              return this.currentUser;
            }

            get title() {
              return `${this.currentUser.username} summary`;
            }

            get text() {
              return "my summary";
            }

          };
        });
      });
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".sidebar-section-community .sidebar-more-section-links-details-summary");
      await (0, _testHelpers.click)(".sidebar-section-link-user-summary");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/u/eviltrout/summary", "links to the right URL");
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-link-user-summary").textContent.trim(), "my summary", "displays the right text for the link");
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-link-user-summary").title, "eviltrout summary", "displays the right title for the link");
    });
    (0, _qunit.test)("clean up topic tracking state state changed callbacks when section is destroyed", async function (assert) {
      await (0, _testHelpers.visit)("/");
      const topicTrackingState = this.container.lookup("service:topic-tracking-state");
      const initialCallbackCount = Object.keys(topicTrackingState.stateChangeCallbacks).length;
      await (0, _testHelpers.click)(".btn-sidebar-toggle");
      assert.ok(Object.keys(topicTrackingState.stateChangeCallbacks).length < initialCallbackCount);
    });
  });
});
define("discourse/tests/acceptance/sidebar-user-messages-section-test", ["qunit", "I18n", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/lib/notification-levels"], function (_qunit, _I18n, _testHelpers, _qunitHelpers, _notificationLevels) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"I18n",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/lib/notification-levels"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Sidebar - Logged on user - Messages Section - enable_personal_messages disabled", function (needs) {
    needs.user();
    needs.settings({
      enable_experimental_sidebar_hamburger: true,
      enable_sidebar: true,
      enable_personal_messages: false
    });
    (0, _qunit.test)("clicking on section header button", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.ok(!(0, _qunitHelpers.exists)(".sidebar-section-messages"), "does not display messages section in sidebar");
    });
  });
  (0, _qunitHelpers.acceptance)("Sidebar - Logged on user - Messages Section - enable_personal_messages enabled", function (needs) {
    needs.user();
    needs.settings({
      enable_experimental_sidebar_hamburger: true,
      enable_sidebar: true
    });
    needs.pretender((server, helper) => {
      ["/topics/private-messages-new/:username.json", "/topics/private-messages-unread/:username.json", "/topics/private-messages-archive/:username.json", "/topics/private-messages-sent/:username.json", "/topics/private-messages-group/:username/:group_name/new.json", "/topics/private-messages-group/:username/:group_name.json", "/topics/private-messages-group/:username/:group_name/unread.json", "/topics/private-messages-group/:username/:group_name/archive.json"].forEach(url => {
        server.get(url, () => {
          const topics = [{
            id: 1,
            posters: []
          }, {
            id: 2,
            posters: []
          }, {
            id: 3,
            posters: []
          }];
          return helper.response({
            topic_list: {
              topics
            }
          });
        });
      });
    });
    (0, _qunit.test)("clicking on section header button", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".sidebar-section-messages .sidebar-section-header-button");
      assert.ok((0, _qunitHelpers.exists)("#reply-control.private-message"), "it opens the composer");
    });
    (0, _qunit.test)("clicking on section header link", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".sidebar-section-messages .sidebar-section-header");
      assert.notOk((0, _qunitHelpers.exists)(".sidebar-section-messages .sidebar-section-content"), "hides the content of the section");
    });
    (0, _qunit.test)("personal messages section links", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-messages .sidebar-section-link-personal-messages-inbox"), "displays the personal message inbox link");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-messages .sidebar-section-link"), 1, "only displays the personal message inbox link");
      await (0, _testHelpers.click)(".sidebar-section-messages .sidebar-section-link-personal-messages-inbox");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-messages .sidebar-section-link-personal-messages-inbox.active"), "personal message inbox link is marked as active");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-messages .sidebar-section-link"), 5, "expands and displays the links for personal messages");
    });
    ["new", "archive", "sent", "unread"].forEach(type => {
      (0, _qunit.test)(`${type} personal messages section link`, async function (assert) {
        await (0, _testHelpers.visit)("/");
        await (0, _testHelpers.click)(".sidebar-section-messages .sidebar-section-link-personal-messages-inbox");
        await (0, _testHelpers.click)(`.sidebar-section-messages .sidebar-section-link-personal-messages-${type}`);
        assert.strictEqual((0, _testHelpers.currentURL)(), `/u/eviltrout/messages/${type}`, `it should transition to user's ${type} personal messages`);
        assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-messages .sidebar-section-link.active"), 2, "only two links are marked as active in the sidebar");
        assert.ok((0, _qunitHelpers.exists)(".sidebar-section-messages .sidebar-section-link-personal-messages-inbox.active"), "personal message inbox link is marked as active");
        assert.ok((0, _qunitHelpers.exists)(`.sidebar-section-messages .sidebar-section-link-personal-messages-${type}.active`), `personal message ${type} link is marked as active`);
      });
    });
    (0, _qunit.test)("group messages section links", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        groups: [{
          name: "group1",
          has_messages: true
        }, {
          name: "group2",
          has_messages: false
        }, {
          name: "group3",
          has_messages: true
        }]
      });
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-messages .sidebar-section-link-group-messages-inbox.group1"), "displays group1 inbox link");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-messages .sidebar-section-link-group-messages-inbox.group3"), "displays group3 inbox link");
      await (0, _testHelpers.visit)("/u/eviltrout/messages/group/GrOuP1");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-messages .sidebar-section-link"), 6, "expands and displays the links for group1 group messages");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-messages .sidebar-section-link.group1"), 4, "expands the links for group1 group messages");
      await (0, _testHelpers.click)(".sidebar-section-messages .sidebar-section-link-group-messages-inbox.group3");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-messages .sidebar-section-link.group1"), 1, "collapses the links for group1 group messages");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-messages .sidebar-section-link.group3"), 4, "expands the links for group3 group messages");
    });
    ["new", "archive", "unread"].forEach(type => {
      (0, _qunit.test)(`${type} group messages section link`, async function (assert) {
        (0, _qunitHelpers.updateCurrentUser)({
          groups: [{
            name: "group1",
            has_messages: true
          }, {
            name: "group2",
            has_messages: false
          }, {
            name: "group3",
            has_messages: true
          }]
        });
        await (0, _testHelpers.visit)("/");
        await (0, _testHelpers.click)(`.sidebar-section-messages .sidebar-section-link-group-messages-inbox.group1`);
        await (0, _testHelpers.click)(`.sidebar-section-messages .sidebar-section-link-group-messages-${type}.group1`);
        assert.strictEqual((0, _testHelpers.currentURL)(), `/u/eviltrout/messages/group/group1/${type}`, `it should transition to user's ${type} personal messages`);
        assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-messages .sidebar-section-link.active"), 2, "only two links are marked as active in the sidebar");
        assert.ok((0, _qunitHelpers.exists)(".sidebar-section-messages .sidebar-section-link-group-messages-inbox.group1.active"), "group1 group message inbox link is marked as active");
        assert.ok((0, _qunitHelpers.exists)(`.sidebar-section-messages .sidebar-section-link-group-messages-${type}.group1.active`), `group1 group message ${type} link is marked as active`);
      });
    });
    (0, _qunit.test)("viewing personal message topic with a group the user is a part of", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        groups: [{
          name: "foo_group",
          // based on fixtures
          has_messages: true
        }]
      });
      await (0, _testHelpers.visit)("/t/130");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-messages .sidebar-section-link"), 5, "5 section links are displayed");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-messages .sidebar-section-link.personal-messages"), 1, "personal messages inbox filter links are not shown");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-messages .sidebar-section-link.foo_group"), 4, "foo_group messages inbox filter links are shown");
    });
    (0, _qunit.test)("viewing personal message topic", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        groups: [{
          name: "foo_group",
          // based on fixtures
          has_messages: true
        }]
      });
      await (0, _testHelpers.visit)("/t/34");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-messages .sidebar-section-link"), 6, "6 section links are displayed");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-messages .sidebar-section-link.personal-messages"), 5, "personal messages inbox filter links are shown");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-messages .sidebar-section-link.foo_group"), 1, "foo_group messages inbox filter links are not shown");
    });
    (0, _qunit.test)("new and unread counts for group messages", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        groups: [{
          id: 1,
          name: "group1",
          has_messages: true
        }]
      });
      await (0, _testHelpers.visit)("/");
      const pmTopicTrackingState = this.container.lookup("service:pm-topic-tracking-state");
      await (0, _qunitHelpers.publishToMessageBus)(pmTopicTrackingState.groupChannel(1), {
        topic_id: 1,
        message_type: "unread",
        payload: {
          last_read_post_number: 1,
          highest_post_number: 2,
          notification_level: _notificationLevels.NotificationLevels.TRACKING,
          group_ids: [1]
        }
      });
      await (0, _qunitHelpers.publishToMessageBus)(pmTopicTrackingState.groupChannel(1), {
        topic_id: 2,
        message_type: "new_topic",
        payload: {
          last_read_post_number: null,
          highest_post_number: 1,
          notification_level: _notificationLevels.NotificationLevels.TRACKING,
          group_ids: [1]
        }
      });
      await (0, _testHelpers.click)(".sidebar-section-messages .sidebar-section-link-group-messages-inbox.group1");
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-messages .sidebar-section-link-group-messages-unread.group1").textContent.trim(), _I18n.default.t("sidebar.sections.messages.links.unread_with_count", {
        count: 1
      }), "displays 1 count for group1 unread inbox filter link");
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-messages .sidebar-section-link-group-messages-new.group1").textContent.trim(), _I18n.default.t("sidebar.sections.messages.links.new_with_count", {
        count: 1
      }), "displays 1 count for group1 new inbox filter link");
      await (0, _qunitHelpers.publishToMessageBus)(pmTopicTrackingState.groupChannel(1), {
        topic_id: 2,
        message_type: "read",
        payload: {
          last_read_post_number: 1,
          highest_post_number: 1,
          notification_level: _notificationLevels.NotificationLevels.TRACKING,
          group_ids: [1]
        }
      });
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-messages .sidebar-section-link-group-messages-new.group1").textContent.trim(), _I18n.default.t("sidebar.sections.messages.links.new"), "removes count for group1 new inbox filter link");
    });
    (0, _qunit.test)("new and unread counts for personal messages", async function (assert) {
      await (0, _testHelpers.visit)("/");
      const pmTopicTrackingState = this.container.lookup("service:pm-topic-tracking-state");
      await (0, _qunitHelpers.publishToMessageBus)(pmTopicTrackingState.userChannel(), {
        topic_id: 1,
        message_type: "unread",
        payload: {
          last_read_post_number: 1,
          highest_post_number: 2,
          notification_level: _notificationLevels.NotificationLevels.TRACKING,
          group_ids: []
        }
      });
      await (0, _testHelpers.click)(".sidebar-section-messages .sidebar-section-link-personal-messages-inbox");
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-messages .sidebar-section-link-personal-messages-unread").textContent.trim(), _I18n.default.t("sidebar.sections.messages.links.unread_with_count", {
        count: 1
      }), "displays 1 count for the unread inbox filter link");
      await (0, _qunitHelpers.publishToMessageBus)(pmTopicTrackingState.userChannel(), {
        topic_id: 2,
        message_type: "unread",
        payload: {
          last_read_post_number: 1,
          highest_post_number: 2,
          notification_level: _notificationLevels.NotificationLevels.TRACKING,
          group_ids: []
        }
      });
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-messages .sidebar-section-link-personal-messages-unread").textContent.trim(), _I18n.default.t("sidebar.sections.messages.links.unread_with_count", {
        count: 2
      }), "displays 2 count for the unread inbox filter link");
      await (0, _qunitHelpers.publishToMessageBus)(pmTopicTrackingState.userChannel(), {
        topic_id: 3,
        message_type: "new_topic",
        payload: {
          last_read_post_number: null,
          highest_post_number: 1,
          notification_level: _notificationLevels.NotificationLevels.TRACKING,
          group_ids: []
        }
      });
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-messages .sidebar-section-link-personal-messages-new").textContent.trim(), _I18n.default.t("sidebar.sections.messages.links.new_with_count", {
        count: 1
      }), "displays 1 count for the new inbox filter link");
      await (0, _qunitHelpers.publishToMessageBus)(pmTopicTrackingState.userChannel(), {
        topic_id: 3,
        message_type: "read",
        payload: {
          last_read_post_number: 1,
          highest_post_number: 1,
          notification_level: _notificationLevels.NotificationLevels.TRACKING,
          group_ids: []
        }
      });
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-messages .sidebar-section-link-personal-messages-new").textContent.trim(), _I18n.default.t("sidebar.sections.messages.links.new"), "removes the count from the new inbox filter link");
    });
  });
});
define("discourse/tests/acceptance/sidebar-user-tags-section-test", ["I18n", "qunit", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/tests/fixtures/discovery-fixtures", "discourse-common/lib/object"], function (_I18n, _qunit, _testHelpers, _qunitHelpers, _discoveryFixtures, _object) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"I18n",0,"qunit",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/tests/fixtures/discovery-fixtures",0,"discourse-common/lib/object"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Sidebar - Logged on user - Tags section - tagging disabled", function (needs) {
    needs.settings({
      tagging_enabled: false,
      enable_experimental_sidebar_hamburger: true,
      enable_sidebar: true
    });
    needs.user();
    (0, _qunit.test)("tags section is not shown", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.ok(!(0, _qunitHelpers.exists)(".sidebar-section-tags"), "does not display the tags section");
    });
  });
  (0, _qunitHelpers.acceptance)("Sidebar - Logged on user - Tags section", function (needs) {
    needs.settings({
      tagging_enabled: true,
      enable_experimental_sidebar_hamburger: true,
      enable_sidebar: true
    });
    needs.user({
      tracked_tags: ["tag1"],
      watched_tags: ["tag2", "tag3"],
      watching_first_post_tags: [],
      sidebar_tags: [{
        name: "tag2",
        pm_only: false
      }, {
        name: "tag1",
        pm_only: false
      }, {
        name: "tag4",
        pm_only: true
      }, {
        name: "tag3",
        pm_only: false
      }]
    });
    needs.pretender((server, helper) => {
      server.get("/tag/:tagId/notifications", request => {
        return helper.response({
          tag_notification: {
            id: request.params.tagId
          }
        });
      });
      server.get("/topics/private-messages-tags/:username/:tagId", () => {
        const topics = [{
          id: 1,
          posters: []
        }, {
          id: 2,
          posters: []
        }, {
          id: 3,
          posters: []
        }];
        return helper.response({
          topic_list: {
            topics
          }
        });
      });
      ["latest", "top", "new", "unread"].forEach(type => {
        server.get(`/tag/:tagId/l/${type}.json`, () => {
          return helper.response((0, _object.cloneJSON)(_discoveryFixtures.default["/tag/important/l/latest.json"]));
        });
      });
    });
    (0, _qunit.test)("clicking on section header button", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".sidebar-section-tags .sidebar-section-header-button");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/u/eviltrout/preferences/sidebar", "it should transition to user preferences sidebar page");
    });
    (0, _qunit.test)("section content when user has not added any tags", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        sidebar_tags: []
      });
      await (0, _testHelpers.visit)("/");
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-tags .sidebar-section-message").textContent.trim(), `${_I18n.default.t("sidebar.sections.tags.none")} ${_I18n.default.t("sidebar.sections.tags.click_to_get_started")}`, "the no tags message is displayed");
    });
    (0, _qunit.test)("tag section links are sorted alphabetically by tag's name", async function (assert) {
      await (0, _testHelpers.visit)("/");
      const tagSectionLinks = (0, _qunitHelpers.queryAll)(".sidebar-section-tags .sidebar-section-link:not(.sidebar-more-link)");
      const tagNames = [...tagSectionLinks].map(tagSectionLink => tagSectionLink.textContent.trim());
      assert.deepEqual(tagNames, ["tag1", "tag2", "tag3", "tag4"], "tag section links are displayed in the right order");
    });
    (0, _qunit.test)("tag section links for user", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-tags .sidebar-section-link:not(.sidebar-more-link)"), 4, "4 section links under the section");
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-link-tag1").textContent.trim(), "tag1", "displays the tag1 name for the link text");
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-link-tag2").textContent.trim(), "tag2", "displays the tag2 name for the link text");
      assert.strictEqual((0, _qunitHelpers.query)(".sidebar-section-link-tag3").textContent.trim(), "tag3", "displays the tag3 name for the link text");
      await (0, _testHelpers.click)(".sidebar-section-link-tag1");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/tag/tag1", "it should transition to tag1's topics discovery page");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-tags .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(`.sidebar-section-link-tag1.active`), "the tag1 section link is marked as active");
      await (0, _testHelpers.click)(".sidebar-section-link-tag2");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/tag/tag2", "it should transition to tag2's topics discovery page");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-tags .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(`.sidebar-section-link-tag2.active`), "the tag2 section link is marked as active");
    });
    (0, _qunit.test)("private message tag section links for user", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".sidebar-section-link-tag4");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/u/eviltrout/messages/tags/tag4", "it should transition to user's private message tag4 tag page");
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-tags .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(`.sidebar-section-link-tag4.active`), "the tag4 section link is marked as active");
    });
    (0, _qunit.test)("visiting tag discovery top route", async function (assert) {
      await (0, _testHelpers.visit)(`/tag/tag1/l/top`);
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-tags .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-link-tag1.active"), "the tag1 section link is marked as active for the top route");
    });
    (0, _qunit.test)("visiting tag discovery new ", async function (assert) {
      await (0, _testHelpers.visit)(`/tag/tag1/l/new`);
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-tags .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-link-tag1.active"), "the tag1 section link is marked as active for the new route");
    });
    (0, _qunit.test)("visiting tag discovery unread route", async function (assert) {
      await (0, _testHelpers.visit)(`/tag/tag1/l/unread`);
      assert.strictEqual((0, _qunitHelpers.count)(".sidebar-section-tags .sidebar-section-link.active"), 1, "only one link is marked as active");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-link-tag1.active"), "the tag1 section link is marked as active for the unread route");
    });
    (0, _qunit.test)("new and unread count for tag section links", async function (assert) {
      this.container.lookup("service:topic-tracking-state").loadStates([{
        topic_id: 1,
        highest_post_number: 1,
        last_read_post_number: null,
        created_at: "2022-05-11T03:09:31.959Z",
        category_id: 1,
        notification_level: null,
        created_in_new_period: true,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z",
        tags: ["tag1"]
      }, {
        topic_id: 2,
        highest_post_number: 12,
        last_read_post_number: 11,
        created_at: "2020-02-09T09:40:02.672Z",
        category_id: 2,
        notification_level: 2,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z",
        tags: ["tag1"]
      }, {
        topic_id: 3,
        highest_post_number: 15,
        last_read_post_number: 14,
        created_at: "2021-06-14T12:41:02.477Z",
        category_id: 3,
        notification_level: 2,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z",
        tags: ["tag2"]
      }, {
        topic_id: 4,
        highest_post_number: 17,
        last_read_post_number: 16,
        created_at: "2020-10-31T03:41:42.257Z",
        category_id: 4,
        notification_level: 2,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z",
        tags: ["tag4"]
      }]);
      await (0, _testHelpers.visit)("/");
      assert.strictEqual((0, _qunitHelpers.query)(`.sidebar-section-link-tag1 .sidebar-section-link-content-badge`).textContent.trim(), _I18n.default.t("sidebar.unread_count", {
        count: 1
      }), `displays 1 unread count for tag1 section link`);
      assert.strictEqual((0, _qunitHelpers.query)(`.sidebar-section-link-tag2 .sidebar-section-link-content-badge`).textContent.trim(), _I18n.default.t("sidebar.unread_count", {
        count: 1
      }), `displays 1 unread count for tag2 section link`);
      assert.ok(!(0, _qunitHelpers.exists)(`.sidebar-section-link-tag3 .sidebar-section-link-content-badge`), "does not display any badge for tag3 section link");
      await (0, _qunitHelpers.publishToMessageBus)("/unread", {
        topic_id: 2,
        message_type: "read",
        payload: {
          last_read_post_number: 12,
          highest_post_number: 12
        }
      });
      assert.strictEqual((0, _qunitHelpers.query)(`.sidebar-section-link-tag1 .sidebar-section-link-content-badge`).textContent.trim(), _I18n.default.t("sidebar.new_count", {
        count: 1
      }), `displays 1 new count for tag1 section link`);
      await (0, _qunitHelpers.publishToMessageBus)("/unread", {
        topic_id: 1,
        message_type: "read",
        payload: {
          last_read_post_number: 1,
          highest_post_number: 1
        }
      });
      assert.ok(!(0, _qunitHelpers.exists)(`.sidebar-section-link-tag1 .sidebar-section-link-content-badge`), `does not display any badge tag1 section link`);
    });
    (0, _qunit.test)("cleans up topic tracking state state changed callbacks when section is destroyed", async function (assert) {
      await (0, _testHelpers.visit)("/");
      const topicTrackingState = this.container.lookup("service:topic-tracking-state");
      const initialCallbackCount = Object.keys(topicTrackingState.stateChangeCallbacks).length;
      await (0, _testHelpers.click)(".btn-sidebar-toggle");
      assert.ok(Object.keys(topicTrackingState.stateChangeCallbacks).length < initialCallbackCount);
    });
  });
});
define("discourse/tests/acceptance/sidebar-user-test", ["I18n", "qunit", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_I18n, _qunit, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"I18n",0,"qunit",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Sidebar - Logged on user - Experimental sidebar and hamburger setting disabled", function (needs) {
    needs.user();
    needs.settings({
      enable_experimental_sidebar_hamburger: false
    });
    (0, _qunit.test)("clicking header hamburger icon displays old hamburger dropdown", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".hamburger-dropdown");
      assert.ok((0, _qunitHelpers.exists)(".menu-container-general-links"));
    });
  });
  (0, _qunitHelpers.acceptance)("Sidebar - Logged on user - Experimental sidebar and hamburger setting enabled - Sidebar disabled", function (needs) {
    needs.user();
    needs.settings({
      enable_experimental_sidebar_hamburger: true,
      enable_sidebar: false
    });
    (0, _qunit.test)("showing and hiding sidebar", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".hamburger-dropdown");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-hamburger-dropdown"), "displays the sidebar dropdown");
      await (0, _testHelpers.click)(".hamburger-dropdown");
      assert.notOk((0, _qunitHelpers.exists)(".sidebar-hamburger-dropdown"), "hides the sidebar dropdown");
    });
    (0, _qunit.test)("'enable_sidebar' query param override to enable sidebar", async function (assert) {
      await (0, _testHelpers.visit)("/?enable_sidebar=1");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-container"), "sidebar is displayed");
      await (0, _testHelpers.click)(".btn-sidebar-toggle");
      assert.notOk((0, _qunitHelpers.exists)(".sidebar-hamburger-dropdown"), "does not display the sidebar dropdown");
      assert.notOk((0, _qunitHelpers.exists)(".sidebar-container"), "sidebar is hidden");
      await (0, _testHelpers.click)(".btn-sidebar-toggle");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-container"), "sidebar is displayed");
    });
  });
  (0, _qunitHelpers.acceptance)("Sidebar - Experimental sidebar and hamburger setting enabled - Sidebar enabled", function (needs) {
    needs.user();
    needs.settings({
      enable_experimental_sidebar_hamburger: true,
      enable_sidebar: true
    });
    (0, _qunit.test)("viewing keyboard shortcuts using sidebar", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(`.sidebar-footer-actions-keyboard-shortcuts[title="${_I18n.default.t("keyboard_shortcuts_help.title")}"]`);
      assert.ok((0, _qunitHelpers.exists)("#keyboard-shortcuts-help"), "keyboard shortcuts help is displayed");
    });
    (0, _qunit.test)("sidebar is disabled on wizard route", async function (assert) {
      await (0, _testHelpers.visit)("/wizard");
      assert.notOk((0, _qunitHelpers.exists)(".sidebar-container"), "does not display the sidebar on wizard route");
    });
    (0, _qunit.test)("showing and hiding sidebar", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.ok(document.body.classList.contains("has-sidebar-page"), "adds sidebar utility class to body");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-container"), "displays the sidebar by default");
      await (0, _testHelpers.click)(".btn-sidebar-toggle");
      assert.ok(!document.body.classList.contains("has-sidebar-page"), "removes sidebar utility class from body");
      assert.ok(!(0, _qunitHelpers.exists)(".sidebar-container"), "hides the sidebar");
      await (0, _testHelpers.click)(".btn-sidebar-toggle");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-container"), "displays the sidebar");
    });
    (0, _qunit.test)("'enable_sidebar' query param override to disable sidebar", async function (assert) {
      await (0, _testHelpers.visit)("/?enable_sidebar=0");
      assert.notOk((0, _qunitHelpers.exists)(".sidebar-container"), "sidebar is not displayed");
      await (0, _testHelpers.click)(".hamburger-dropdown");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-hamburger-dropdown"), "displays the sidebar dropdown");
      await (0, _testHelpers.click)(".hamburger-dropdown");
      assert.notOk((0, _qunitHelpers.exists)(".sidebar-hamburger-dropdown"), "hides the sidebar dropdown");
    });
    (0, _qunit.test)("button to toggle between mobile and desktop view on touch devices ", async function (assert) {
      const capabilities = this.container.lookup("capabilities:main");
      capabilities.touch = true;
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)(`.sidebar-footer-actions-toggle-mobile-view[title="${_I18n.default.t("mobile_view")}"]`), "displays the right title for the button");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-footer-actions-toggle-mobile-view .d-icon-mobile-alt"), "displays the mobile icon for the button");
    });
  });
});
define("discourse/tests/acceptance/sign-in-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Signing In", function () {
    (0, _qunit.test)("sign in", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("header .login-button");
      assert.ok((0, _qunitHelpers.exists)(".login-modal"), "it shows the login modal"); // Test invalid password first

      await (0, _testHelpers.fillIn)("#login-account-name", "eviltrout");
      await (0, _testHelpers.fillIn)("#login-account-password", "incorrect");
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
      assert.ok((0, _qunitHelpers.exists)("#modal-alert:visible"), "it displays the login error");
      assert.notOk((0, _qunitHelpers.exists)(".modal-footer .btn-primary:disabled"), "enables the login button"); // Use the correct password

      await (0, _testHelpers.fillIn)("#login-account-password", "correct");
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
      assert.ok((0, _qunitHelpers.exists)(".modal-footer .btn-primary:disabled"), "disables the login button");
    });
    (0, _qunit.test)("sign in - not activated", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("header .login-button");
      assert.ok((0, _qunitHelpers.exists)(".login-modal"), "it shows the login modal");
      await (0, _testHelpers.fillIn)("#login-account-name", "eviltrout");
      await (0, _testHelpers.fillIn)("#login-account-password", "not-activated");
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-body b").innerText, "<small>eviltrout@example.com</small>");
      assert.ok(!(0, _qunitHelpers.exists)(".modal-body small"), "it escapes the email address");
      await (0, _testHelpers.click)(".modal-footer button.resend");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-body b").innerText, "<small>current@example.com</small>");
      assert.ok(!(0, _qunitHelpers.exists)(".modal-body small"), "it escapes the email address");
    });
    (0, _qunit.test)("sign in - not activated - edit email", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("header .login-button");
      assert.ok((0, _qunitHelpers.exists)(".login-modal"), "it shows the login modal");
      await (0, _testHelpers.fillIn)("#login-account-name", "eviltrout");
      await (0, _testHelpers.fillIn)("#login-account-password", "not-activated-edit");
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
      await (0, _testHelpers.click)(".modal-footer button.edit-email");
      assert.strictEqual((0, _qunitHelpers.query)(".activate-new-email").value, "current@example.com");
      assert.strictEqual((0, _qunitHelpers.count)(".modal-footer .btn-primary:disabled"), 1, "must change email");
      await (0, _testHelpers.fillIn)(".activate-new-email", "different@example.com");
      assert.ok(!(0, _qunitHelpers.exists)(".modal-footer .btn-primary:disabled"));
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
      assert.strictEqual((0, _qunitHelpers.query)(".modal-body b").innerText, "different@example.com");
    });
    (0, _qunit.test)("second factor", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("header .login-button");
      assert.ok((0, _qunitHelpers.exists)(".login-modal"), "it shows the login modal");
      await (0, _testHelpers.fillIn)("#login-account-name", "eviltrout");
      await (0, _testHelpers.fillIn)("#login-account-password", "need-second-factor");
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
      assert.notOk((0, _qunitHelpers.exists)("#credentials:visible"), "it hides the username and password prompt");
      assert.ok((0, _qunitHelpers.exists)("#second-factor:visible"), "it displays the second factor prompt");
      assert.notOk((0, _qunitHelpers.exists)(".modal-footer .btn-primary:disabled"), "enables the login button");
      await (0, _testHelpers.fillIn)("#login-second-factor", "123456");
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
      assert.ok((0, _qunitHelpers.exists)(".modal-footer .btn-primary:disabled"), "disables the login button");
    });
    (0, _qunit.test)("security key", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("header .login-button");
      assert.ok((0, _qunitHelpers.exists)(".login-modal"), "it shows the login modal");
      await (0, _testHelpers.fillIn)("#login-account-name", "eviltrout");
      await (0, _testHelpers.fillIn)("#login-account-password", "need-security-key");
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
      assert.notOk((0, _qunitHelpers.exists)("#credentials:visible"), "it hides the username and password prompt");
      assert.notOk((0, _qunitHelpers.exists)("#login-second-factor:visible"), "it does not display the second factor prompt");
      assert.ok((0, _qunitHelpers.exists)("#security-key:visible"), "it shows the security key prompt");
      assert.notOk((0, _qunitHelpers.exists)("#login-button:visible"), "hides the login button");
    });
    (0, _qunit.test)("create account", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("header .sign-up-button");
      assert.ok((0, _qunitHelpers.exists)(".create-account"), "it shows the create account modal");
      await (0, _testHelpers.fillIn)("#new-account-name", "Dr. Good Tuna");
      await (0, _testHelpers.fillIn)("#new-account-password", "cool password bro"); // without this double fill, field will sometimes being empty
      // got consistent repro by having browser search bar focused when starting test

      await (0, _testHelpers.fillIn)("#new-account-email", "good.tuna@test.com");
      await (0, _testHelpers.fillIn)("#new-account-email", "good.tuna@test.com"); // Check username

      await (0, _testHelpers.fillIn)("#new-account-username", "taken");
      assert.ok((0, _qunitHelpers.exists)("#username-validation.bad"), "the username validation is bad");
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
      await (0, _testHelpers.fillIn)("#new-account-username", "good-tuna");
      assert.ok((0, _qunitHelpers.exists)("#username-validation.good"), "the username validation is good");
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
      assert.ok((0, _qunitHelpers.exists)(".modal-footer .btn-primary:disabled"), "create account is disabled");
    });
    (0, _qunit.test)("second factor backup - valid token", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("header .login-button");
      await (0, _testHelpers.fillIn)("#login-account-name", "eviltrout");
      await (0, _testHelpers.fillIn)("#login-account-password", "need-second-factor");
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
      await (0, _testHelpers.click)(".login-modal .toggle-second-factor-method");
      await (0, _testHelpers.fillIn)("#login-second-factor", "123456");
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
      assert.ok((0, _qunitHelpers.exists)(".modal-footer .btn-primary:disabled"), "it closes the modal when the code is valid");
    });
    (0, _qunit.test)("second factor backup - invalid token", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)("header .login-button");
      await (0, _testHelpers.fillIn)("#login-account-name", "eviltrout");
      await (0, _testHelpers.fillIn)("#login-account-password", "need-second-factor");
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
      await (0, _testHelpers.click)(".login-modal .toggle-second-factor-method");
      await (0, _testHelpers.fillIn)("#login-second-factor", "something");
      await (0, _testHelpers.click)(".modal-footer .btn-primary");
      assert.ok((0, _qunitHelpers.exists)("#modal-alert:visible"), "it shows an error when the code is invalid");
    });
  });
});
define("discourse/tests/acceptance/static-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Static", function () {
    (0, _qunit.test)("Static Pages", async function (assert) {
      await (0, _testHelpers.visit)("/faq");
      assert.ok(document.body.classList.contains("static-faq"), "has the body class");
      assert.ok((0, _qunitHelpers.exists)(".body-page"), "The content is present");
      await (0, _testHelpers.visit)("/guidelines");
      assert.ok(document.body.classList.contains("static-guidelines"), "has the body class");
      assert.ok((0, _qunitHelpers.exists)(".body-page"), "The content is present");
      await (0, _testHelpers.visit)("/tos");
      assert.ok(document.body.classList.contains("static-tos"), "has the body class");
      assert.ok((0, _qunitHelpers.exists)(".body-page"), "The content is present");
      await (0, _testHelpers.visit)("/privacy");
      assert.ok(document.body.classList.contains("static-privacy"), "has the body class");
      assert.ok((0, _qunitHelpers.exists)(".body-page"), "The content is present");
      await (0, _testHelpers.visit)("/login");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "discovery.latest", "it redirects them to latest unless `login_required`");
    });
  });
});
define("discourse/tests/acceptance/tag-groups-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/tests/helpers/select-kit-helper", "qunit"], function (_qunitHelpers, _testHelpers, _selectKitHelper, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Tag Groups", function (needs) {
    needs.user();
    needs.settings({
      tagging_enabled: true
    });
    needs.pretender((server, helper) => {
      server.post("/tag_groups", () => {
        return helper.response({
          tag_group: {
            id: 42,
            name: "test tag group",
            tag_names: ["monkey"],
            parent_tag_name: [],
            one_per_topic: false,
            permissions: {
              everyone: 1
            }
          }
        });
      });
      server.get("/groups/search.json", () => {
        return helper.response([{
          id: 88,
          name: "tl1"
        }, {
          id: 89,
          name: "tl2"
        }]);
      });
    });
    (0, _qunit.test)("tag groups can be saved and deleted", async function (assert) {
      const tags = (0, _selectKitHelper.default)(".group-tags-list .tag-chooser");
      await (0, _testHelpers.visit)("/tag_groups");
      await (0, _testHelpers.click)(".tag-group-content .btn.btn-primary");
      await (0, _testHelpers.fillIn)(".tag-group-content .group-name input", "test tag group");
      await tags.expand();
      await tags.selectRowByValue("monkey");
      await (0, _testHelpers.click)(".tag-group-content .btn.btn-primary");
      await (0, _testHelpers.click)(".tag-groups-sidebar li:first-child a");
      await tags.expand();
      await tags.deselectItemByValue("monkey");
      assert.ok(!(0, _qunitHelpers.query)(".tag-group-content .btn.btn-danger").disabled);
    });
    (0, _qunit.test)("tag groups can have multiple groups added to them", async function (assert) {
      const tags = (0, _selectKitHelper.default)(".tag-chooser");
      const groups = (0, _selectKitHelper.default)(".group-chooser");
      await (0, _testHelpers.visit)("/tag_groups");
      await (0, _testHelpers.click)(".tag-group-content .btn.btn-primary");
      await (0, _testHelpers.fillIn)(".tag-group-content .group-name input", "test tag group");
      await tags.expand();
      await tags.selectRowByValue("monkey");
      await (0, _testHelpers.click)("#visible-permission");
      await groups.expand();
      await groups.selectRowByIndex(1);
      await groups.selectRowByIndex(0);
      assert.ok(!(0, _qunitHelpers.query)(".tag-group-content .btn.btn-primary").disabled);
      await (0, _testHelpers.click)(".tag-group-content .btn.btn-primary");
      await (0, _testHelpers.click)(".tag-groups-sidebar li:first-child a");
      assert.ok((0, _qunitHelpers.exists)("#visible-permission:checked"), "selected permission does not change after saving");
    });
  });
});
define("discourse/tests/acceptance/tags-intersection-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Tags intersection", function (needs) {
    needs.user();
    needs.site({
      can_tag_topics: true
    });
    needs.settings({
      tagging_enabled: true
    });
    needs.pretender((server, helper) => {
      server.get("/tag/first/notifications", () => {
        return helper.response({
          tag_notification: {
            id: "first",
            notification_level: 1
          }
        });
      });
      server.get("/tags/intersection/first/second.json", () => {
        return helper.response({
          users: [],
          primary_groups: [],
          topic_list: {
            can_create_topic: true,
            draft_key: "new_topic",
            topics: [{
              id: 16,
              posters: []
            }],
            tags: [{
              id: 1,
              name: "second",
              topic_count: 1
            }, {
              id: 2,
              name: "first",
              topic_count: 1
            }]
          }
        });
      });
    });
    (0, _qunit.test)("Populate tags when creating new topic", async function (assert) {
      await (0, _testHelpers.visit)("/tags/intersection/first/second");
      await (0, _testHelpers.click)("#create-topic");
      assert.ok((0, _qunitHelpers.exists)(".mini-tag-chooser"), "The tag selector appears");
      assert.strictEqual((0, _qunitHelpers.query)(".composer-fields .mini-tag-chooser").innerText.trim(), "first, second", "populates the tags when clicking 'New topic'");
    });
  });
});
define("discourse/tests/acceptance/tags-test", ["discourse/tests/helpers/select-kit-helper", "discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_selectKitHelper, _qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/select-kit-helper",0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Tags", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/tag/test/notifications", () => helper.response({
        tag_notification: {
          id: "test",
          notification_level: 2
        }
      }));
      server.get("/tag/test/l/unread.json", () => helper.response({
        users: [{
          id: 42,
          username: "foo",
          name: "Foo",
          avatar_template: "/user_avatar/localhost/foo/{size}/10265_2.png"
        }],
        primary_groups: [],
        topic_list: {
          can_create_topic: true,
          draft: null,
          draft_key: "new_topic",
          per_page: 30,
          top_tags: [],
          tags: [{
            id: 42,
            name: "test",
            topic_count: 1,
            staff: false
          }],
          topics: [{
            id: 42,
            title: "Hello world",
            fancy_title: "Hello world",
            slug: "hello-world",
            posts_count: 1,
            reply_count: 1,
            highest_post_number: 1,
            created_at: "2020-01-01T00:00:00.000Z",
            last_posted_at: "2020-01-01T00:00:00.000Z",
            bumped: true,
            bumped_at: "2020-01-01T00:00:00.000Z",
            archetype: "regular",
            unseen: false,
            last_read_post_number: 1,
            unread_posts: 1,
            pinned: false,
            unpinned: null,
            visible: true,
            closed: true,
            archived: false,
            notification_level: 3,
            bookmarked: false,
            liked: true,
            tags: ["test"],
            tags_descriptions: {
              test: "test description"
            },
            views: 42,
            like_count: 42,
            has_summary: false,
            last_poster_username: "foo",
            pinned_globally: false,
            featured_link: null,
            posters: []
          }]
        }
      }));
      server.put("/topics/bulk", () => helper.response({}));
      server.get("/tags/c/faq/4/test/l/latest.json", () => {
        return helper.response({
          users: [],
          primary_groups: [],
          topic_list: {
            can_create_topic: true,
            draft: null,
            draft_key: "new_topic",
            draft_sequence: 1,
            per_page: 30,
            tags: [{
              id: 1,
              name: "planters",
              topic_count: 1
            }],
            topics: []
          }
        });
      });
    });
    (0, _qunit.test)("list the tags", async function (assert) {
      await (0, _testHelpers.visit)("/tags");
      assert.ok(document.body.classList.contains("tags-page"), "has the body class");
      assert.ok((0, _qunitHelpers.exists)(`[data-tag-name="eviltrout"]`), "shows the eviltrout tag");
    });
    (0, _qunit.test)("dismiss notifications", async function (assert) {
      await (0, _testHelpers.visit)("/tag/test/l/unread");
      await (0, _testHelpers.click)("button.dismiss-read");
      await (0, _testHelpers.click)(".dismiss-read-modal button.btn-primary");
      assert.ok((0, _qunitHelpers.invisible)(".dismiss-read-modal"));
    });
    (0, _qunit.test)("hide tag notifications menu", async function (assert) {
      await (0, _testHelpers.visit)("/tags/c/faq/4/test");
      assert.ok((0, _qunitHelpers.invisible)(".tag-notifications-button"));
    });
  });
  (0, _qunitHelpers.acceptance)("Tags listed by group", function (needs) {
    needs.user();
    needs.settings({
      tags_listed_by_group: true
    });
    needs.pretender((server, helper) => {
      server.get("/tag/regular-tag/notifications", () => helper.response({
        tag_notification: {
          id: "regular-tag",
          notification_level: 1
        }
      }));
      server.get("/tag/regular-tag/l/latest.json", () => helper.response({
        users: [],
        primary_groups: [],
        topic_list: {
          can_create_topic: true,
          draft: null,
          draft_key: "new_topic",
          draft_sequence: 1,
          per_page: 30,
          tags: [{
            id: 1,
            name: "regular-tag",
            topic_count: 1
          }],
          topics: []
        }
      }));
      server.get("/tag/staff-only-tag/notifications", () => helper.response({
        tag_notification: {
          id: "staff-only-tag",
          notification_level: 1
        }
      }));
      server.get("/tag/staff-only-tag/l/latest.json", () => helper.response({
        users: [],
        primary_groups: [],
        topic_list: {
          can_create_topic: true,
          draft: null,
          draft_key: "new_topic",
          draft_sequence: 1,
          per_page: 30,
          tags: [{
            id: 1,
            name: "staff-only-tag",
            topic_count: 1,
            staff: true
          }],
          topics: []
        }
      }));
    });
    (0, _qunit.test)("list the tags in groups", async function (assert) {
      await (0, _testHelpers.visit)("/tags");
      assert.strictEqual((0, _qunitHelpers.count)(".tag-list"), 4, "shows separate lists for the 3 groups and the ungrouped tags");
      assert.deepEqual([...(0, _qunitHelpers.queryAll)(".tag-list h3")].map(el => el.innerText), ["Ford Cars", "Honda Cars", "Makes", "Other Tags"], "shown in given order and with tags that are not in a group");
      assert.deepEqual([...(0, _qunitHelpers.queryAll)(".tag-list:nth-of-type(1) .discourse-tag")].map(el => el.innerText), ["focus", "Escort"], "shows the tags in default sort (by count)");
      assert.deepEqual([...(0, _qunitHelpers.queryAll)(".tag-list:nth-of-type(1) .discourse-tag")].map(el => el.getAttribute("href")), ["/tag/focus", "/tag/escort"], "always uses lowercase URLs for mixed case tags");
      assert.strictEqual((0, _qunitHelpers.query)(`a[data-tag-name="private"]`).getAttribute("href"), "/u/eviltrout/messages/tags/private", "links to private messages");
    });
    (0, _qunit.test)("new topic button is not available for staff-only tags", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: false
      });
      await (0, _testHelpers.visit)("/tag/regular-tag");
      assert.ok(!(0, _qunitHelpers.exists)("#create-topic:disabled"));
      await (0, _testHelpers.visit)("/tag/staff-only-tag");
      assert.strictEqual((0, _qunitHelpers.count)("#create-topic:disabled"), 1);
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true
      });
      await (0, _testHelpers.visit)("/tag/regular-tag");
      assert.ok(!(0, _qunitHelpers.exists)("#create-topic:disabled"));
      await (0, _testHelpers.visit)("/tag/staff-only-tag");
      assert.ok(!(0, _qunitHelpers.exists)("#create-topic:disabled"));
    });
  });
  (0, _qunitHelpers.acceptance)("Tag info", function (needs) {
    needs.user();
    needs.settings({
      tags_listed_by_group: true
    });
    needs.pretender((server, helper) => {
      server.get("/tag/:tag_name/notifications", request => {
        return helper.response({
          tag_notification: {
            id: request.params.tag_name,
            notification_level: 1
          }
        });
      });
      server.get("/tag/:tag_name/l/latest.json", request => {
        return helper.response({
          users: [],
          primary_groups: [],
          topic_list: {
            can_create_topic: true,
            draft: null,
            draft_key: "new_topic",
            draft_sequence: 1,
            per_page: 30,
            tags: [{
              id: 1,
              name: request.params.tag_name,
              topic_count: 1
            }],
            topics: []
          }
        });
      });
      ["/tags/c/faq/4/planters/l/latest.json", "/tags/c/feature/2/planters/l/latest.json", "/tags/c/feature/2/planters/l/top.json", "/tags/c/feature/2/none/planters/l/latest.json"].forEach(url => {
        server.get(url, () => {
          return helper.response({
            users: [],
            primary_groups: [],
            topic_list: {
              can_create_topic: true,
              draft: null,
              draft_key: "new_topic",
              draft_sequence: 1,
              per_page: 30,
              tags: [{
                id: 1,
                name: "planters",
                topic_count: 1
              }],
              topics: []
            }
          });
        });
      });
      server.get("/tag/planters/info", () => {
        return helper.response({
          __rest_serializer: "1",
          tag_info: {
            id: 12,
            name: "planters",
            topic_count: 1,
            staff: false,
            synonyms: [{
              id: "containers",
              text: "containers"
            }, {
              id: "planter",
              text: "planter"
            }],
            tag_group_names: ["Gardening"],
            category_ids: [7]
          },
          categories: [{
            id: 7,
            name: "Outdoors",
            color: "000",
            text_color: "FFFFFF",
            slug: "outdoors",
            topic_count: 701,
            post_count: 5320,
            description: "Talk about the outdoors.",
            description_text: "Talk about the outdoors.",
            topic_url: "/t/category-definition-for-outdoors/1026",
            read_restricted: false,
            permission: null,
            notification_level: null
          }]
        });
      });
      server.put("/tag/happy-monkey", request => {
        const data = helper.parsePostData(request.requestBody);
        return helper.response({
          tag: {
            id: data.tag.id
          }
        });
      });
      server.get("/tag/happy-monkey/info", () => {
        return helper.response({
          __rest_serializer: "1",
          tag_info: {
            id: 13,
            name: "happy-monkey",
            description: "happy monkey description",
            topic_count: 1,
            staff: false,
            synonyms: [],
            tag_group_names: [],
            category_ids: []
          },
          categories: []
        });
      });
      server.delete("/tag/planters/synonyms/containers", () => helper.response({
        success: true
      }));
      server.get("/tags/filter/search", () => helper.response({
        results: [{
          id: "monkey",
          name: "monkey",
          count: 1
        }, {
          id: "not-monkey",
          name: "not-monkey",
          count: 1
        }, {
          id: "happy-monkey",
          name: "happy-monkey",
          count: 1
        }]
      }));
    });
    (0, _qunit.test)("tag info can show synonyms", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: false
      });
      await (0, _testHelpers.visit)("/tag/planters");
      assert.strictEqual((0, _qunitHelpers.count)("#show-tag-info"), 1);
      await (0, _testHelpers.click)("#show-tag-info");
      assert.ok((0, _qunitHelpers.exists)(".tag-info .tag-name"), "show tag");
      assert.ok((0, _qunitHelpers.query)(".tag-info .tag-associations").innerText.includes("Gardening"), "show tag group names");
      assert.strictEqual((0, _qunitHelpers.count)(".tag-info .synonyms-list .tag-box"), 2, "shows the synonyms");
      assert.strictEqual((0, _qunitHelpers.count)(".tag-info .badge-category"), 1, "show the category");
      assert.ok(!(0, _qunitHelpers.exists)("#rename-tag"), "can't rename tag");
      assert.ok(!(0, _qunitHelpers.exists)("#edit-synonyms"), "can't edit synonyms");
      assert.ok(!(0, _qunitHelpers.exists)("#delete-tag"), "can't delete tag");
    });
    (0, _qunit.test)("tag info hides only current tag in synonyms dropdown", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: true
      });
      await (0, _testHelpers.visit)("/tag/happy-monkey");
      assert.strictEqual((0, _qunitHelpers.count)("#show-tag-info"), 1);
      await (0, _testHelpers.click)("#show-tag-info");
      assert.ok((0, _qunitHelpers.exists)(".tag-info .tag-name"), "show tag");
      await (0, _testHelpers.click)("#edit-synonyms");
      const addSynonymsDropdown = (0, _selectKitHelper.default)("#add-synonyms");
      await addSynonymsDropdown.expand();
      assert.deepEqual(Array.from(addSynonymsDropdown.rows()).map(r => {
        return r.dataset.value;
      }), ["monkey", "not-monkey"]);
    });
    (0, _qunit.test)("edit tag is showing input for name and description", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: true
      });
      await (0, _testHelpers.visit)("/tag/happy-monkey");
      assert.strictEqual((0, _qunitHelpers.count)("#show-tag-info"), 1);
      await (0, _testHelpers.click)("#show-tag-info");
      assert.ok((0, _qunitHelpers.exists)(".tag-info .tag-name"), "show tag");
      await (0, _testHelpers.click)(".edit-tag");
      assert.strictEqual((0, _qunitHelpers.query)("#edit-name").value, "happy-monkey", "it displays original tag name");
      assert.strictEqual((0, _qunitHelpers.query)("#edit-description").value, "happy monkey description", "it displays original tag description");
      await (0, _testHelpers.fillIn)("#edit-description", "new description");
      await (0, _testHelpers.click)(".submit-edit");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/tag/happy-monkey", "it doesn't change URL");
      await (0, _testHelpers.click)(".edit-tag");
      await (0, _testHelpers.fillIn)("#edit-name", "happy-monkey2");
      await (0, _testHelpers.click)(".submit-edit");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/tag/happy-monkey2", "it changes URL to new tag path");
    });
    (0, _qunit.test)("can filter tags page by category", async function (assert) {
      await (0, _testHelpers.visit)("/tag/planters");
      await (0, _testHelpers.click)(".category-breadcrumb .category-drop-header");
      await (0, _testHelpers.click)(`.category-breadcrumb .category-row[data-name="faq"]`);
      assert.strictEqual((0, _testHelpers.currentURL)(), "/tags/c/faq/4/planters");
    });
    (0, _qunit.test)("can switch between all/none subcategories", async function (assert) {
      await (0, _testHelpers.visit)("/tag/planters");
      await (0, _testHelpers.click)(".category-breadcrumb .category-drop-header");
      await (0, _testHelpers.click)(`.category-breadcrumb .category-row[data-name="feature"]`);
      assert.strictEqual((0, _testHelpers.currentURL)(), "/tags/c/feature/2/planters");
      await (0, _testHelpers.click)(".category-breadcrumb li:nth-of-type(2) .category-drop-header");
      await (0, _testHelpers.click)(`.category-breadcrumb li:nth-of-type(2) .category-row[data-value="no-categories"]`);
      assert.strictEqual((0, _testHelpers.currentURL)(), "/tags/c/feature/2/none/planters");
    });
    (0, _qunit.test)("can visit show-category-latest routes", async function (assert) {
      await (0, _testHelpers.visit)("/tags/c/feature/2/planters");
      await (0, _testHelpers.click)(".nav-item_latest a[href]");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/tags/c/feature/2/planters/l/latest");
      await (0, _testHelpers.click)(".nav-item_top a[href]");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/tags/c/feature/2/planters/l/top");
    });
    (0, _qunit.test)("admin can manage tags", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: true
      });
      await (0, _testHelpers.visit)("/tag/planters");
      assert.strictEqual((0, _qunitHelpers.count)("#show-tag-info"), 1);
      await (0, _testHelpers.click)("#show-tag-info");
      assert.ok((0, _qunitHelpers.exists)(".edit-tag"), "can rename tag");
      assert.ok((0, _qunitHelpers.exists)("#edit-synonyms"), "can edit synonyms");
      assert.ok((0, _qunitHelpers.exists)("#delete-tag"), "can delete tag");
      await (0, _testHelpers.click)("#edit-synonyms");
      assert.strictEqual((0, _qunitHelpers.count)(".unlink-synonym:visible"), 2, "unlink UI is visible");
      assert.strictEqual((0, _qunitHelpers.count)(".delete-synonym:visible"), 2, "delete UI is visible");
      await (0, _testHelpers.click)(".unlink-synonym:nth-of-type(1)");
      assert.strictEqual((0, _qunitHelpers.count)(".tag-info .synonyms-list .tag-box"), 1, "removed a synonym");
    });
    (0, _qunit.test)("composer will not set tags if user cannot create them", async function (assert) {
      await (0, _testHelpers.visit)("/tag/planters");
      await (0, _testHelpers.click)("#create-topic");
      let composer = this.owner.lookup("controller:composer");
      assert.strictEqual(composer.get("model").tags, undefined);
    });
  });
  (0, _qunitHelpers.acceptance)("Tag show - topic list with `more_topics_url` present", function (needs) {
    needs.pretender((server, helper) => {
      server.get("/tag/:tagName/l/latest.json", () => helper.response({
        users: [],
        primary_groups: [],
        topic_list: {
          topics: [],
          more_topics_url: "..."
        }
      }));
      server.put("/topics/bulk", () => helper.response({}));
    });
    (0, _qunit.test)("load more footer message is present", async function (assert) {
      await (0, _testHelpers.visit)("/tag/planters");
      assert.notOk((0, _qunitHelpers.exists)(".topic-list-bottom .footer-message"));
    });
  });
  (0, _qunitHelpers.acceptance)("Tag show - create topic", function (needs) {
    needs.user();
    needs.site({
      can_tag_topics: true
    });
    needs.settings({
      tagging_enabled: true,
      tags_listed_by_group: true
    });
    needs.pretender((server, helper) => {
      server.get("/tag/:tag_name/notifications", request => {
        return helper.response({
          tag_notification: {
            id: request.params.tag_name,
            notification_level: 1
          }
        });
      });
      server.get("/tag/:tag_name/l/latest.json", request => {
        return helper.response({
          users: [],
          primary_groups: [],
          topic_list: {
            can_create_topic: true,
            draft: null,
            draft_key: "new_topic",
            draft_sequence: 1,
            per_page: 30,
            tags: [{
              id: 1,
              name: request.params.tag_name,
              topic_count: 1
            }],
            topics: []
          }
        });
      });
    });
    (0, _qunit.test)("composer will not set tags with all/none tags when creating topic", async function (assert) {
      const composer = this.owner.lookup("controller:composer");
      await (0, _testHelpers.visit)("/tag/none");
      await (0, _testHelpers.click)("#create-topic");
      assert.deepEqual(composer.model.tags, []);
      await (0, _testHelpers.visit)("/tag/all");
      await (0, _testHelpers.click)("#create-topic");
      assert.deepEqual(composer.model.tags, []);
    });
    (0, _qunit.test)("composer will set tags from selected tag", async function (assert) {
      const composer = this.owner.lookup("controller:composer");
      await (0, _testHelpers.visit)("/tag/planters");
      await (0, _testHelpers.click)("#create-topic");
      assert.deepEqual(composer.model.tags, ["planters"]);
    });
  });
  (0, _qunitHelpers.acceptance)("Tag show - topic list without `more_topics_url`", function (needs) {
    needs.pretender((server, helper) => {
      server.get("/tag/:tagName/l/latest.json", () => helper.response({
        users: [],
        primary_groups: [],
        topic_list: {
          topics: []
        }
      }));
      server.put("/topics/bulk", () => helper.response({}));
    });
    (0, _qunit.test)("load more footer message is not present", async function (assert) {
      await (0, _testHelpers.visit)("/tag/planters");
      assert.ok((0, _qunitHelpers.exists)(".topic-list-bottom .footer-message"));
    });
  });
});
define("discourse/tests/acceptance/themes-test", ["@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "I18n", "qunit"], function (_testHelpers, _qunitHelpers, _I18n, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"I18n",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Theme", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/admin/themes", () => {
        return helper.response(200, {
          themes: [{
            id: 42,
            name: "discourse-incomplete-theme",
            created_at: "2022-01-01T12:00:00.000Z",
            updated_at: "2022-01-01T12:00:00.000Z",
            component: false,
            color_scheme: null,
            color_scheme_id: null,
            user_selectable: false,
            auto_update: true,
            remote_theme_id: 42,
            settings: [],
            supported: true,
            description: null,
            enabled: true,
            user: {
              id: 1,
              username: "foo",
              name: null,
              avatar_template: "/letter_avatar_proxy/v4/letter/f/3be4f8/{size}.png",
              title: "Tester"
            },
            theme_fields: [],
            child_themes: [],
            parent_themes: [],
            remote_theme: {
              id: 42,
              remote_url: "git@github.com:discourse/discourse-incomplete-theme.git",
              remote_version: null,
              local_version: null,
              commits_behind: null,
              branch: null,
              remote_updated_at: null,
              updated_at: "2022-01-01T12:00:00.000Z",
              last_error_text: null,
              is_git: true,
              license_url: null,
              about_url: null,
              authors: null,
              theme_version: null,
              minimum_discourse_version: null,
              maximum_discourse_version: null
            },
            translations: []
          }]
        });
      });
      server.post("/admin/themes/import", request => {
        const data = helper.parsePostData(request.requestBody);

        if (!data.force) {
          return helper.response(422, {
            errors: ["Error cloning git repository, access is denied or repository is not found"]
          });
        }

        return helper.response(201, {
          theme: {
            id: 42,
            name: "discourse-inexistent-theme",
            created_at: "2022-01-01T12:00:00.000Z",
            updated_at: "2022-01-01T12:00:00.000Z",
            component: false,
            color_scheme: null,
            color_scheme_id: null,
            user_selectable: false,
            auto_update: true,
            remote_theme_id: 42,
            settings: [],
            supported: true,
            description: null,
            enabled: true,
            user: {
              id: 1,
              username: "foo",
              name: null,
              avatar_template: "/letter_avatar_proxy/v4/letter/f/3be4f8/{size}.png"
            },
            theme_fields: [],
            child_themes: [],
            parent_themes: [],
            remote_theme: {
              id: 42,
              remote_url: "git@github.com:discourse/discourse-inexistent-theme.git",
              remote_version: null,
              local_version: null,
              commits_behind: null,
              branch: null,
              remote_updated_at: null,
              updated_at: "2022-01-01T12:00:00.000Z",
              last_error_text: null,
              is_git: true,
              license_url: null,
              about_url: null,
              authors: null,
              theme_version: null,
              minimum_discourse_version: null,
              maximum_discourse_version: null
            },
            translations: []
          }
        });
      });
      server.put("/admin/themes/42", () => {
        return helper.response(200, {
          theme: {
            id: 42,
            name: "discourse-complete-theme",
            created_at: "2022-01-01T12:00:00.000Z",
            updated_at: "2022-01-01T12:00:00.000Z",
            component: false,
            color_scheme: null,
            color_scheme_id: null,
            user_selectable: false,
            auto_update: true,
            remote_theme_id: 42,
            settings: [],
            supported: true,
            description: null,
            enabled: true,
            user: {
              id: 1,
              username: "foo",
              name: null,
              avatar_template: "/letter_avatar_proxy/v4/letter/f/3be4f8/{size}.png"
            },
            theme_fields: [],
            child_themes: [],
            parent_themes: [],
            remote_theme: {
              id: 42,
              remote_url: "git@github.com:discourse-org/discourse-incomplete-theme.git",
              remote_version: "0000000000000000000000000000000000000000",
              local_version: "0000000000000000000000000000000000000000",
              commits_behind: 0,
              branch: null,
              remote_updated_at: "2022-01-01T12:00:30.000Z",
              updated_at: "2022-01-01T12:00:30.000Z",
              last_error_text: null,
              is_git: true,
              license_url: "URL",
              about_url: "URL",
              authors: null,
              theme_version: null,
              minimum_discourse_version: null,
              maximum_discourse_version: null
            },
            translations: []
          }
        });
      });
    });
    (0, _qunit.test)("can force install themes", async function (assert) {
      await (0, _testHelpers.visit)("/admin/customize/themes");
      await (0, _testHelpers.click)(".themes-list .create-actions button");
      await (0, _testHelpers.click)(".install-theme-items #remote");
      await (0, _testHelpers.fillIn)(".install-theme-content .repo input", "git@github.com:discourse/discourse-inexistent-theme.git");
      await (0, _testHelpers.click)(".install-theme-content button.advanced-repo");
      await (0, _testHelpers.click)(".install-theme-content .check-private input");
      assert.notOk((0, _qunitHelpers.exists)(".admin-install-theme-modal .modal-footer .install-theme-warning"), "no Git warning is displayed");
      await (0, _testHelpers.click)(".admin-install-theme-modal .modal-footer .btn-primary");
      assert.ok((0, _qunitHelpers.exists)(".admin-install-theme-modal .modal-footer .install-theme-warning"), "Git warning is displayed");
      await (0, _testHelpers.click)(".admin-install-theme-modal .modal-footer .btn-danger");
      assert.notOk((0, _qunitHelpers.exists)(".admin-install-theme-modal:visible"), "modal is closed");
    });
    (0, _qunit.test)("can continue installation", async function (assert) {
      await (0, _testHelpers.visit)("/admin/customize/themes");
      await (0, _testHelpers.click)(".themes-list-container .themes-list-item");
      assert.ok((0, _qunitHelpers.query)(".control-unit .status-message").innerText.includes(_I18n.default.t("admin.customize.theme.last_attempt")), "it says that theme is not completely installed");
      await (0, _testHelpers.click)(".control-unit .btn-primary.finish-install");
      assert.equal((0, _qunitHelpers.query)(".show-current-style .title span").innerText, "discourse-complete-theme", "it updates theme title");
      assert.notOk((0, _qunitHelpers.query)(".metadata.control-unit").innerText.includes(_I18n.default.t("admin.customize.theme.last_attempt")), "it does not say that theme is not completely installed");
      assert.notOk((0, _qunitHelpers.query)(".control-unit .btn-primary.finish-install"), "it does not show finish install button");
    });
  });
});
define("discourse/tests/acceptance/topic-admin-menu-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic - Admin Menu Anonymous Users", function () {
    (0, _qunit.test)("Enter as a regular user", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      assert.ok((0, _qunitHelpers.exists)("#topic"), "The topic was rendered");
      assert.ok(!(0, _qunitHelpers.exists)(".toggle-admin-menu"), "The admin menu button was not rendered");
    });
  });
  (0, _qunitHelpers.acceptance)("Topic - Admin Menu", function (needs) {
    needs.user();
    (0, _qunit.test)("Enter as a user with group moderator permissions", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: false,
        trust_level: 1
      });
      await (0, _testHelpers.visit)("/t/topic-for-group-moderators/2480");
      assert.ok((0, _qunitHelpers.exists)("#topic"), "The topic was rendered");
      assert.ok((0, _qunitHelpers.exists)(".toggle-admin-menu"), "The admin menu button was rendered");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      assert.ok((0, _qunitHelpers.exists)(".topic-admin-delete"), "The delete item was rendered");
    });
    (0, _qunit.test)("Enter as a user with moderator and admin permissions", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true,
        admin: true,
        trust_level: 4
      });
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      assert.ok((0, _qunitHelpers.exists)("#topic"), "The topic was rendered");
      assert.ok((0, _qunitHelpers.exists)(".toggle-admin-menu"), "The admin menu button was rendered");
    });
    (0, _qunit.test)("Toggle the menu as admin focuses the first item", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        admin: true
      });
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      assert.ok((0, _qunitHelpers.exists)("#topic"), "The topic was rendered");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      assert.strictEqual(document.activeElement, document.querySelector(".topic-admin-multi-select > button"));
    });
  });
});
define("discourse/tests/acceptance/topic-anonymous-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic - Anonymous", function () {
    (0, _qunit.test)("Enter a Topic", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280/1");
      assert.ok((0, _qunitHelpers.exists)("#topic"), "The topic was rendered");
      assert.ok((0, _qunitHelpers.exists)("#topic .cooked"), "The topic has cooked posts");
      assert.ok(!(0, _qunitHelpers.exists)(".shared-draft-notice"), "no shared draft unless there's a dest category id");
    });
    (0, _qunit.test)("Enter without an id", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization");
      assert.ok((0, _qunitHelpers.exists)("#topic"), "The topic was rendered");
    });
    (0, _qunit.test)("Enter a 404 topic", async function (assert) {
      await (0, _testHelpers.visit)("/t/not-found/404");
      assert.ok(!(0, _qunitHelpers.exists)("#topic"), "The topic was not rendered");
      assert.ok((0, _qunitHelpers.exists)(".topic-error"), "An error message is displayed");
    });
    (0, _qunit.test)("Enter without access", async function (assert) {
      await (0, _testHelpers.visit)("/t/i-dont-have-access/403");
      assert.ok(!(0, _qunitHelpers.exists)("#topic"), "The topic was not rendered");
      assert.ok((0, _qunitHelpers.exists)(".topic-error"), "An error message is displayed");
    });
    (0, _qunit.test)("Enter with 500 errors", async function (assert) {
      await (0, _testHelpers.visit)("/t/throws-error/500");
      assert.ok(!(0, _qunitHelpers.exists)("#topic"), "The topic was not rendered");
      assert.ok((0, _qunitHelpers.exists)(".topic-error"), "An error message is displayed");
    });
  });
});
define("discourse/tests/acceptance/topic-bulk-actions-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "I18n"], function (_qunitHelpers, _testHelpers, _qunit, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic - Bulk Actions", function (needs) {
    needs.user();
    needs.settings({
      tagging_enabled: true
    });
    needs.pretender((server, helper) => {
      server.put("/topics/bulk", () => {
        return helper.response({
          topic_ids: []
        });
      });
    });
    (0, _qunit.test)("bulk select - modal", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true,
        enable_defer: true
      });
      await (0, _testHelpers.visit)("/latest");
      await (0, _testHelpers.click)("button.bulk-select");
      await (0, _testHelpers.click)((0, _qunitHelpers.queryAll)("input.bulk-select")[0]);
      await (0, _testHelpers.click)((0, _qunitHelpers.queryAll)("input.bulk-select")[1]);
      await (0, _testHelpers.click)(".bulk-select-actions");
      assert.ok((0, _qunitHelpers.query)("#discourse-modal-title").innerHTML.includes(_I18n.default.t("topics.bulk.actions")), "it opens bulk-select modal");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.change_category")), "it shows an option to change category");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.close_topics")), "it shows an option to close topics");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.archive_topics")), "it shows an option to archive topics");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.notification_level")), "it shows an option to update notification level");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.defer")), "it shows an option to reset read");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.unlist_topics")), "it shows an option to unlist topics");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.reset_bump_dates")), "it shows an option to reset bump dates");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.change_tags")), "it shows an option to replace tags");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.append_tags")), "it shows an option to append tags");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.remove_tags")), "it shows an option to remove all tags");
      assert.ok((0, _qunitHelpers.query)(".bulk-buttons").innerHTML.includes(_I18n.default.t("topics.bulk.delete")), "it shows an option to delete topics");
    });
    (0, _qunit.test)("bulk select - delete topics", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true
      });
      await (0, _testHelpers.visit)("/latest");
      await (0, _testHelpers.click)("button.bulk-select");
      await (0, _testHelpers.click)((0, _qunitHelpers.queryAll)("input.bulk-select")[0]);
      await (0, _testHelpers.click)((0, _qunitHelpers.queryAll)("input.bulk-select")[1]);
      await (0, _testHelpers.click)(".bulk-select-actions");
      await (0, _testHelpers.click)(".modal-body .delete-topics");
      assert.ok((0, _qunitHelpers.invisible)(".topic-bulk-actions-modal"), "it closes the bulk select modal");
    });
    (0, _qunit.test)("bulk select - Shift click selection", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true
      });
      await (0, _testHelpers.visit)("/latest");
      await (0, _testHelpers.click)("button.bulk-select");
      await (0, _testHelpers.click)((0, _qunitHelpers.queryAll)("input.bulk-select")[0]);
      await (0, _testHelpers.triggerEvent)((0, _qunitHelpers.queryAll)("input.bulk-select")[3], "click", {
        shiftKey: true
      });
      assert.strictEqual((0, _qunitHelpers.count)("input.bulk-select:checked"), 4, "Shift click selects a range");
      await (0, _testHelpers.click)("button.bulk-clear-all");
      await (0, _testHelpers.click)((0, _qunitHelpers.queryAll)("input.bulk-select")[5]);
      await (0, _testHelpers.triggerEvent)((0, _qunitHelpers.queryAll)("input.bulk-select")[1], "click", {
        shiftKey: true
      });
      assert.strictEqual((0, _qunitHelpers.count)("input.bulk-select:checked"), 5, "Bottom-up Shift click range selection works");
    });
  });
});
define("discourse/tests/acceptance/topic-discovery-test", ["discourse/tests/helpers/qunit-helpers", "discourse/lib/url", "discourse/tests/helpers/select-kit-helper", "sinon", "qunit", "@ember/test-helpers", "discourse-common/lib/object", "discourse/tests/fixtures/discovery-fixtures", "discourse/mixins/scrolling", "discourse/lib/eyeline"], function (_qunitHelpers, _url, _selectKitHelper, _sinon, _qunit, _testHelpers, _object, _discoveryFixtures, _scrolling, _eyeline) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"discourse/lib/url",0,"discourse/tests/helpers/select-kit-helper",0,"sinon",0,"qunit",0,"@ember/test-helpers",0,"discourse-common/lib/object",0,"discourse/tests/fixtures/discovery-fixtures",0,"discourse/mixins/scrolling",0,"discourse/lib/eyeline"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic Discovery", function (needs) {
    needs.settings({
      show_pinned_excerpt_desktop: true
    });
    (0, _qunit.test)("Visit Discovery Pages", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.ok(document.body.classList.contains("navigation-topics"), "has the default navigation");
      assert.ok((0, _qunitHelpers.exists)(".topic-list"), "The list of topics was rendered");
      assert.ok((0, _qunitHelpers.exists)(".topic-list .topic-list-item"), "has topics");
      assert.strictEqual((0, _qunitHelpers.query)("a[data-user-card=eviltrout] img.avatar").getAttribute("title"), "Evil Trout - Most Posts", "it shows user's full name in avatar title");
      assert.strictEqual((0, _qunitHelpers.query)("a[data-user-card=eviltrout] img.avatar").getAttribute("loading"), "lazy", "it adds loading=`lazy` to topic list avatars");
      await (0, _testHelpers.visit)("/c/bug");
      assert.ok((0, _qunitHelpers.exists)(".topic-list"), "The list of topics was rendered");
      assert.ok((0, _qunitHelpers.exists)(".topic-list .topic-list-item"), "has topics");
      assert.ok(!(0, _qunitHelpers.exists)(".category-list"), "doesn't render subcategories");
      assert.ok(document.body.classList.contains("category-bug"), "has a custom css class for the category id on the body");
      await (0, _testHelpers.visit)("/categories");
      assert.ok(document.body.classList.contains("navigation-categories"), "has the body class");
      assert.ok(!document.body.classList.contains("category-bug"), "removes the custom category class");
      assert.ok((0, _qunitHelpers.exists)(".category"), "has a list of categories");
      assert.ok(document.body.classList.contains("categories-list"), "has a custom class to indicate categories");
      await (0, _testHelpers.visit)("/top");
      assert.ok(!document.body.classList.contains("categories-list"), "removes the `categories-list` class");
      assert.ok((0, _qunitHelpers.exists)(".topic-list .topic-list-item"), "has topics");
      await (0, _testHelpers.visit)("/c/feature");
      assert.ok((0, _qunitHelpers.exists)(".topic-list"), "The list of topics was rendered");
      assert.ok((0, _qunitHelpers.exists)(".category-boxes"), "The list of subcategories were rendered with box style");
      await (0, _testHelpers.visit)("/c/dev");
      assert.ok((0, _qunitHelpers.exists)(".topic-list"), "The list of topics was rendered");
      assert.ok((0, _qunitHelpers.exists)(".category-boxes-with-topics"), "The list of subcategories were rendered with box-with-featured-topics style");
      assert.ok((0, _qunitHelpers.exists)(".category-boxes-with-topics .featured-topics"), "The featured topics are there too");
    });
    (0, _qunit.test)("Clearing state after leaving a category", async function (assert) {
      await (0, _testHelpers.visit)("/c/dev");
      assert.ok((0, _qunitHelpers.exists)('.topic-list-item[data-topic-id="11994"] .topic-excerpt'), "it expands pinned topics in a subcategory");
      await (0, _testHelpers.visit)("/");
      assert.ok(!(0, _qunitHelpers.exists)('.topic-list-item[data-topic-id="11557"] .topic-excerpt'), "it doesn't expand all pinned in the latest category");
    });
    (0, _qunit.test)("Live update unread state", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)(".topic-list-item:not(.visited) a[data-topic-id='11995']"), "shows the topic unread");
      await (0, _qunitHelpers.publishToMessageBus)("/latest", {
        message_type: "read",
        topic_id: 11995,
        payload: {
          highest_post_number: 1,
          last_read_post_number: 2,
          notification_level: 1,
          topic_id: 11995
        }
      });
      assert.ok((0, _qunitHelpers.exists)(".topic-list-item.visited a[data-topic-id='11995']"), "shows the topic read");
    });
    (0, _qunit.test)("Using period chooser when query params are present", async function (assert) {
      await (0, _testHelpers.visit)("/top?f=foo&d=bar");

      _sinon.default.stub(_url.default, "routeTo");

      const periodChooser = (0, _selectKitHelper.default)(".period-chooser");
      await periodChooser.expand();
      await periodChooser.selectRowByValue("yearly");
      assert.ok(_url.default.routeTo.calledWith("/top?f=foo&d=bar&period=yearly"), "it keeps the query params");
    });
    (0, _qunit.test)("switching between tabs", async function (assert) {
      await (0, _testHelpers.visit)("/latest");
      assert.strictEqual((0, _qunitHelpers.query)(".topic-list-body .topic-list-item:first-of-type").dataset.topicId, "11557", "shows the correct latest topics");
      await (0, _testHelpers.click)(".navigation-container a[href='/top']");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/top", "switches to top");
      assert.deepEqual((0, _qunitHelpers.query)(".topic-list-body .topic-list-item:first-of-type").dataset.topicId, "13088", "shows the correct top topics");
      await (0, _testHelpers.click)(".navigation-container a[href='/categories']");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/categories", "switches to categories");
    });
    (0, _qunit.test)("refreshing tabs", async function (assert) {
      const assertShowingLatest = () => {
        assert.strictEqual((0, _testHelpers.currentURL)(), "/latest", "stays on latest");
        const el = (0, _qunitHelpers.query)(".topic-list-body .topic-list-item:first-of-type");
        assert.strictEqual(el.closest(".hidden"), null, "topic list is visible");
        assert.strictEqual(el.dataset.topicId, "11557", "shows the correct topic");
      };

      await (0, _testHelpers.visit)("/latest");
      assertShowingLatest();
      await (0, _testHelpers.click)(".navigation-container a[href='/latest']");
      assertShowingLatest();
      await (0, _testHelpers.click)("#site-logo");
      assertShowingLatest();
    });
  });
  (0, _qunitHelpers.acceptance)("Topic Discovery | Footer", function (needs) {
    needs.hooks.beforeEach(function () {
      _scrolling.ScrollingDOMMethods.bindOnScroll.restore();

      (0, _eyeline.configureEyeline)({
        skipUpdate: false,
        rootElement: "#ember-testing"
      });
    });
    needs.hooks.afterEach(function () {
      (0, _eyeline.configureEyeline)();
    });
    needs.pretender((server, helper) => {
      server.get("/c/dev/7/l/latest.json", () => {
        const json = (0, _object.cloneJSON)(_discoveryFixtures.default["/c/dev/7/l/latest.json"]);
        json.topic_list.more_topics_url = "/c/dev/7/l/latest.json?page=2";
        return helper.response(json);
      });
      server.get("/c/dev/7/l/latest.json?page=2", () => {
        const json = (0, _object.cloneJSON)(_discoveryFixtures.default["/c/dev/7/l/latest.json"]);
        json.topic_list.more_topics_url = null;
        return helper.response(json);
      });
    }); // TODO: Needs scroll support in tests

    (0, _qunit.skip)("No footer, then shows footer when all loaded", async function (assert) {
      await (0, _testHelpers.visit)("/c/dev");
      assert.ok(!(0, _qunitHelpers.exists)(".custom-footer-content"));
      document.querySelector("#ember-testing-container").scrollTop = 100000; // scroll to bottom

      await (0, _testHelpers.settled)();
      assert.ok((0, _qunitHelpers.exists)(".custom-footer-content"));
    });
  });
});
define("discourse/tests/acceptance/topic-discovery-tracked-test", ["@ember/test-helpers", "I18n", "qunit", "discourse/tests/helpers/qunit-helpers", "discourse/models/site", "discourse/lib/notification-levels", "discourse/tests/fixtures/discovery-fixtures", "discourse-common/lib/object"], function (_testHelpers, _I18n, _qunit, _qunitHelpers, _site, _notificationLevels, _discoveryFixtures, _object) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"@ember/test-helpers",0,"I18n",0,"qunit",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/models/site",0,"discourse/lib/notification-levels",0,"discourse/tests/fixtures/discovery-fixtures",0,"discourse-common/lib/object"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic Discovery Tracked", function (needs) {
    needs.user({
      tracked_tags: ["tag1"],
      watched_tags: ["tag2"],
      watching_first_post_tags: ["tag3"]
    });
    needs.pretender((server, helper) => {
      server.get("/c/:category-slug/:category-id/l/latest.json", () => {
        return helper.response((0, _object.cloneJSON)(_discoveryFixtures.default["/latest.json"]));
      });
      server.get("/tag/:tag_name/notifications", () => {
        return helper.response({
          tag_notification: {
            id: "test",
            notification_level: _notificationLevels.NotificationLevels.TRACKING
          }
        });
      });
      server.get("/tag/:tag_name/l/latest.json", () => {
        return helper.response((0, _object.cloneJSON)(_discoveryFixtures.default["/latest.json"]));
      });
    });
    (0, _qunit.test)("navigation items with tracked filter", async function (assert) {
      this.container.lookup("service:topic-tracking-state").loadStates([{
        topic_id: 1,
        highest_post_number: 1,
        last_read_post_number: null,
        created_at: "2022-05-11T03:09:31.959Z",
        category_id: 1,
        notification_level: null,
        created_in_new_period: true,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }, {
        topic_id: 2,
        highest_post_number: 12,
        last_read_post_number: 11,
        created_at: "2020-02-09T09:40:02.672Z",
        category_id: 2,
        notification_level: _notificationLevels.NotificationLevels.TRACKING,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }]);
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)("#navigation-bar li.categories"), "the categories nav item is displayed when tracked filter is not present");
      await (0, _testHelpers.visit)("/categories");
      assert.ok((0, _qunitHelpers.exists)("#navigation-bar li.categories"), "the categories nav item is displayed on categories route when tracked filter is not present");
      await (0, _testHelpers.visit)("/?f=tracked");
      assert.ok(!(0, _qunitHelpers.exists)("#navigation-bar li.categories"), "the categories nav item is not displayed when tracked filter is present");
      assert.ok((0, _qunitHelpers.query)("#navigation-bar li.unread a").href.endsWith("/unread?f=tracked"), "unread link has tracked filter");
      assert.ok((0, _qunitHelpers.query)("#navigation-bar li.new a").href.endsWith("/new?f=tracked"), "new link has tracked filter");
      assert.ok((0, _qunitHelpers.query)("#navigation-bar li.top a").href.endsWith("/top?f=tracked"), "top link has tracked filter");
      assert.ok((0, _qunitHelpers.query)("#navigation-bar li.latest a").href.endsWith("/latest?f=tracked"), "latest link has tracked filter");
    });
    (0, _qunit.test)("visit discovery pages with tracked filter", async function (assert) {
      const categories = _site.default.current().categories; // Category id 1001 has two subcategories


      const category = categories.find(c => c.id === 1001);
      category.set("notification_level", _notificationLevels.NotificationLevels.TRACKING);
      this.container.lookup("service:topic-tracking-state").loadStates([{
        topic_id: 1,
        highest_post_number: 1,
        last_read_post_number: null,
        created_at: "2022-05-11T03:09:31.959Z",
        category_id: category.id,
        notification_level: _notificationLevels.NotificationLevels.TRACKING,
        created_in_new_period: true,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }, {
        topic_id: 2,
        highest_post_number: 12,
        last_read_post_number: 11,
        created_at: "2020-02-09T09:40:02.672Z",
        category_id: category.subcategories[0].id,
        notification_level: _notificationLevels.NotificationLevels.TRACKING,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }, {
        topic_id: 3,
        highest_post_number: 12,
        last_read_post_number: 11,
        created_at: "2020-02-09T09:40:02.672Z",
        category_id: category.subcategories[0].subcategories[0].id,
        notification_level: _notificationLevels.NotificationLevels.TRACKING,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }, {
        topic_id: 4,
        highest_post_number: 15,
        last_read_post_number: 14,
        created_at: "2021-06-14T12:41:02.477Z",
        category_id: 3,
        notification_level: _notificationLevels.NotificationLevels.TRACKING,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }, {
        topic_id: 5,
        highest_post_number: 1,
        last_read_post_number: null,
        created_at: "2021-06-14T12:41:02.477Z",
        category_id: 3,
        notification_level: null,
        created_in_new_period: true,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }, {
        topic_id: 6,
        highest_post_number: 17,
        last_read_post_number: 16,
        created_at: "2020-10-31T03:41:42.257Z",
        category_id: 1234,
        notification_level: _notificationLevels.NotificationLevels.TRACKING,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z",
        tags: ["tag3"]
      }]);
      await (0, _testHelpers.visit)("/");
      assert.strictEqual((0, _qunitHelpers.query)("#navigation-bar li.unread").textContent.trim(), _I18n.default.t("filters.unread.title_with_count", {
        count: 4
      }), "displays the right content on unread link");
      assert.strictEqual((0, _qunitHelpers.query)("#navigation-bar li.new").textContent.trim(), _I18n.default.t("filters.new.title_with_count", {
        count: 2
      }), "displays the right content on new link");
      await (0, _testHelpers.visit)("/?f=tracked");
      assert.strictEqual((0, _qunitHelpers.query)("#navigation-bar li.unread").textContent.trim(), _I18n.default.t("filters.unread.title_with_count", {
        count: 3
      }), "displays the right content on unread link");
      assert.strictEqual((0, _qunitHelpers.query)("#navigation-bar li.new").textContent.trim(), _I18n.default.t("filters.new.title_with_count", {
        count: 1
      }), "displays the right content on new link"); // simulate reading topic id 1

      await (0, _qunitHelpers.publishToMessageBus)("/unread", {
        topic_id: 1,
        message_type: "read",
        payload: {
          last_read_post_number: 1,
          highest_post_number: 1
        }
      }); // simulate reading topic id 3

      await (0, _qunitHelpers.publishToMessageBus)("/unread", {
        topic_id: 3,
        message_type: "read",
        payload: {
          last_read_post_number: 12,
          highest_post_number: 12
        }
      });
      assert.strictEqual((0, _qunitHelpers.query)("#navigation-bar li.unread").textContent.trim(), _I18n.default.t("filters.unread.title_with_count", {
        count: 2
      }), "displays the right content on unread link");
      assert.strictEqual((0, _qunitHelpers.query)("#navigation-bar li.new").textContent.trim(), _I18n.default.t("filters.new.title"), "displays the right content on new link");
    });
    (0, _qunit.test)("visit discovery page filtered by tag with tracked filter", async function (assert) {
      this.container.lookup("service:topic-tracking-state").loadStates([{
        topic_id: 1,
        highest_post_number: 1,
        last_read_post_number: null,
        created_at: "2022-05-11T03:09:31.959Z",
        category_id: 1,
        notification_level: null,
        created_in_new_period: true,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z",
        tags: ["some-other-tag"]
      }]);
      await (0, _testHelpers.visit)("/tag/some-other-tag");
      assert.strictEqual((0, _qunitHelpers.query)("#navigation-bar li.unread").textContent.trim(), _I18n.default.t("filters.unread.title"), "displays the right content on unread link");
      assert.strictEqual((0, _qunitHelpers.query)("#navigation-bar li.new").textContent.trim(), _I18n.default.t("filters.new.title_with_count", {
        count: 1
      }), "displays the right content on new link");
      await (0, _testHelpers.visit)("/tag/some-other-tag?f=tracked");
      assert.strictEqual((0, _qunitHelpers.query)("#navigation-bar li.unread").textContent.trim(), _I18n.default.t("filters.unread.title"), "displays the right content on unread link");
      assert.strictEqual((0, _qunitHelpers.query)("#navigation-bar li.new").textContent.trim(), _I18n.default.t("filters.new.title"), "displays the right content on new link");
    });
    (0, _qunit.test)("visit discovery page filtered by category with tracked filter", async function (assert) {
      const categories = _site.default.current().categories;

      const category = categories.at(-1);
      category.set("notification_level", _notificationLevels.NotificationLevels.TRACKING);
      this.container.lookup("service:topic-tracking-state").loadStates([{
        topic_id: 1,
        highest_post_number: 1,
        last_read_post_number: null,
        created_at: "2022-05-11T03:09:31.959Z",
        category_id: category.id,
        notification_level: null,
        created_in_new_period: true,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }, {
        topic_id: 2,
        highest_post_number: 12,
        last_read_post_number: 11,
        created_at: "2020-02-09T09:40:02.672Z",
        category_id: category.id,
        notification_level: _notificationLevels.NotificationLevels.TRACKING,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }, {
        topic_id: 3,
        highest_post_number: 15,
        last_read_post_number: 14,
        created_at: "2021-06-14T12:41:02.477Z",
        category_id: 3,
        notification_level: _notificationLevels.NotificationLevels.TRACKING,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z"
      }, {
        topic_id: 4,
        highest_post_number: 17,
        last_read_post_number: 16,
        created_at: "2020-10-31T03:41:42.257Z",
        category_id: 1234,
        notification_level: _notificationLevels.NotificationLevels.TRACKING,
        created_in_new_period: false,
        treat_as_new_topic_start_date: "2022-05-09T03:17:34.286Z",
        tags: ["tag3"]
      }]);
      await (0, _testHelpers.visit)(`/c/3`);
      assert.strictEqual((0, _qunitHelpers.query)("#navigation-bar li.unread").textContent.trim(), _I18n.default.t("filters.unread.title_with_count", {
        count: 1
      }), "displays the right content on unread link");
      assert.strictEqual((0, _qunitHelpers.query)("#navigation-bar li.new").textContent.trim(), _I18n.default.t("filters.new.title"), "displays the right content on new link");
      await (0, _testHelpers.visit)(`/c/3?f=tracked`);
      assert.strictEqual((0, _qunitHelpers.query)("#navigation-bar li.unread").textContent.trim(), _I18n.default.t("filters.unread.title"), "displays the right content on unread link");
      assert.strictEqual((0, _qunitHelpers.query)("#navigation-bar li.new").textContent.trim(), _I18n.default.t("filters.new.title"), "displays the right content on new link");
    });
  });
});
define("discourse/tests/acceptance/topic-edit-timer-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "discourse/tests/helpers/select-kit-helper", "I18n"], function (_qunitHelpers, _testHelpers, _qunit, _selectKitHelper, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"discourse/tests/helpers/select-kit-helper",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic - Edit timer", function (needs) {
    let clock = null;
    needs.user();
    needs.pretender((server, helper) => {
      server.post("/t/280/timer", () => helper.response({
        success: "OK",
        execute_at: new Date(new Date().getTime() + 1 * 60 * 60 * 1000).toISOString(),
        duration_minutes: 1440,
        based_on_last_post: false,
        closed: false,
        category_id: null
      }));
    });
    needs.hooks.beforeEach(() => {
      const timezone = (0, _qunitHelpers.loggedInUser)().timezone;
      const tuesday = "2100-06-15T08:00:00";
      clock = (0, _qunitHelpers.fakeTime)(tuesday, timezone, true);
    });
    needs.hooks.afterEach(() => {
      clock.restore();
    });
    (0, _qunit.test)("autoclose - specific time", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true
      });
      await (0, _testHelpers.visit)("/t/internationalization-localization");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".admin-topic-timer-update button");
      await (0, _testHelpers.click)("#tap_tile_start_of_next_business_week");
      const regex = /will automatically close in/g;
      const html = (0, _qunitHelpers.query)(".edit-topic-timer-modal .topic-timer-info").innerHTML.trim();
      assert.ok(regex.test(html));
    });
    (0, _qunit.test)("autoclose", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true
      });
      await (0, _testHelpers.visit)("/t/internationalization-localization");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".admin-topic-timer-update button");
      await (0, _testHelpers.click)("#tap_tile_start_of_next_business_week");
      const regex1 = /will automatically close in/g;
      const html1 = (0, _qunitHelpers.query)(".edit-topic-timer-modal .topic-timer-info").innerHTML.trim();
      assert.ok(regex1.test(html1));
      await (0, _testHelpers.click)("#tap_tile_custom");
      await (0, _testHelpers.fillIn)(".tap-tile-date-input .date-picker", "2100-11-24");
      const regex2 = /will automatically close in/g;
      const html2 = (0, _qunitHelpers.query)(".edit-topic-timer-modal .topic-timer-info").innerHTML.trim();
      assert.ok(regex2.test(html2));
      const timerType = (0, _selectKitHelper.default)(".select-kit.timer-type");
      await timerType.expand();
      await timerType.selectRowByValue("close_after_last_post");
      const interval = (0, _selectKitHelper.default)(".select-kit.relative-time-intervals");
      await interval.expand();
      await interval.selectRowByValue("hours");
      await (0, _testHelpers.fillIn)(".relative-time-duration", "2");
      const regex3 = /last post in the topic is already/g;
      const html3 = (0, _qunitHelpers.query)(".edit-topic-timer-modal .warning").innerHTML.trim();
      assert.ok(regex3.test(html3));
    });
    (0, _qunit.test)("close temporarily", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true
      });
      const timerType = (0, _selectKitHelper.default)(".select-kit.timer-type");
      await (0, _testHelpers.visit)("/t/internationalization-localization");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".admin-topic-timer-update button");
      await timerType.expand();
      await timerType.selectRowByValue("open");
      await (0, _testHelpers.click)("#tap_tile_start_of_next_business_week");
      const regex1 = /will automatically open in/g;
      const html1 = (0, _qunitHelpers.query)(".edit-topic-timer-modal .topic-timer-info").innerHTML.trim();
      assert.ok(regex1.test(html1));
      await (0, _testHelpers.click)("#tap_tile_custom");
      await (0, _testHelpers.fillIn)(".tap-tile-date-input .date-picker", "2100-11-24");
      const regex2 = /will automatically open in/g;
      const html2 = (0, _qunitHelpers.query)(".edit-topic-timer-modal .topic-timer-info").innerHTML.trim();
      assert.ok(regex2.test(html2));
    });
    (0, _qunit.test)("schedule publish to category - visible for a PM", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true
      });
      const timerType = (0, _selectKitHelper.default)(".select-kit.timer-type");
      const categoryChooser = (0, _selectKitHelper.default)(".modal-body .category-chooser");
      await (0, _testHelpers.visit)("/t/pm-for-testing/12");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".admin-topic-timer-update button");
      await timerType.expand();
      await timerType.selectRowByValue("publish_to_category");
      assert.strictEqual(categoryChooser.header().label(), "uncategorized");
      assert.strictEqual(categoryChooser.header().value(), null);
      await categoryChooser.expand();
      await categoryChooser.selectRowByValue("7");
      await (0, _testHelpers.click)("#tap_tile_start_of_next_business_week");
      const text = (0, _qunitHelpers.query)(".edit-topic-timer-modal .topic-timer-info").innerText.trim(); // this needs to be done because there is no simple way to get the
      // plain text version of a translation with HTML

      let el = document.createElement("p");
      el.innerHTML = _I18n.default.t("topic.status_update_notice.auto_publish_to_category", {
        categoryUrl: "/c/dev/7",
        categoryName: "dev",
        timeLeft: "in 6 days"
      });
      assert.strictEqual(text, el.innerText);
    });
    (0, _qunit.test)("schedule publish to category - visible for a private category", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true
      });
      const timerType = (0, _selectKitHelper.default)(".select-kit.timer-type");
      const categoryChooser = (0, _selectKitHelper.default)(".modal-body .category-chooser"); // has private category id 24 (shared drafts)

      await (0, _testHelpers.visit)("/t/some-topic/9");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".admin-topic-timer-update button");
      await timerType.expand();
      await timerType.selectRowByValue("publish_to_category");
      assert.strictEqual(categoryChooser.header().label(), "uncategorized");
      assert.strictEqual(categoryChooser.header().value(), null);
      await categoryChooser.expand();
      await categoryChooser.selectRowByValue("7");
      await (0, _testHelpers.click)("#tap_tile_start_of_next_business_week");
      const text = (0, _qunitHelpers.query)(".edit-topic-timer-modal .topic-timer-info").innerText.trim(); // this needs to be done because there is no simple way to get the
      // plain text version of a translation with HTML

      let el = document.createElement("p");
      el.innerHTML = _I18n.default.t("topic.status_update_notice.auto_publish_to_category", {
        categoryUrl: "/c/dev/7",
        categoryName: "dev",
        timeLeft: "in 6 days"
      });
      assert.strictEqual(text, el.innerText);
    });
    (0, _qunit.test)("schedule publish to category - visible for an unlisted public topic", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true
      });
      const timerType = (0, _selectKitHelper.default)(".select-kit.timer-type");
      const categoryChooser = (0, _selectKitHelper.default)(".modal-body .category-chooser");
      await (0, _testHelpers.visit)("/t/internationalization-localization/280"); // make topic not visible

      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".topic-admin-visible .btn");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".admin-topic-timer-update button");
      await timerType.expand();
      await timerType.selectRowByValue("publish_to_category");
      assert.strictEqual(categoryChooser.header().label(), "uncategorized");
      assert.strictEqual(categoryChooser.header().value(), null);
      await categoryChooser.expand();
      await categoryChooser.selectRowByValue("7");
      await (0, _testHelpers.click)("#tap_tile_start_of_next_business_week");
      const text = (0, _qunitHelpers.query)(".edit-topic-timer-modal .topic-timer-info").innerText.trim(); // this needs to be done because there is no simple way to get the
      // plain text version of a translation with HTML

      let el = document.createElement("p");
      el.innerHTML = _I18n.default.t("topic.status_update_notice.auto_publish_to_category", {
        categoryUrl: "/c/dev/7",
        categoryName: "dev",
        timeLeft: "in 6 days"
      });
      assert.strictEqual(text, el.innerText);
    });
    (0, _qunit.test)("schedule publish to category - last custom date and time", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true
      });
      await (0, _testHelpers.visit)("/t/internationalization-localization");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".admin-topic-timer-update button");
      assert.notOk((0, _qunitHelpers.exists)("#tap_tile_last_custom"), "it does not show last custom if the custom date and time was not filled before");
      await (0, _testHelpers.click)(".modal-close");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".admin-topic-timer-update button");
      await (0, _testHelpers.click)("#tap_tile_custom");
      await (0, _testHelpers.fillIn)(".tap-tile-date-input .date-picker", "2100-11-24");
      await (0, _testHelpers.fillIn)("#custom-time", "10:30");
      await (0, _testHelpers.click)(".edit-topic-timer-buttons button.btn-primary");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".admin-topic-timer-update button");
      assert.ok((0, _qunitHelpers.exists)("#tap_tile_last_custom"), "it show last custom because the custom date and time was valid");
      const text = (0, _qunitHelpers.query)("#tap_tile_last_custom").innerText.trim();
      const regex = /Nov 24, 10:30 am/g;
      assert.ok(regex.test(text));
    });
    (0, _qunit.test)("schedule publish to category - does not show for a public topic", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true
      });
      const timerType = (0, _selectKitHelper.default)(".select-kit.timer-type");
      await (0, _testHelpers.visit)("/t/internationalization-localization");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".admin-topic-timer-update button");
      await timerType.expand();
      assert.notOk(timerType.rowByValue("publish_to_category").exists(), "publish to category is not shown for a public topic");
    });
    (0, _qunit.test)("TL4 can't auto-delete", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: false,
        trust_level: 4
      });
      await (0, _testHelpers.visit)("/t/internationalization-localization");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".admin-topic-timer-update button");
      const timerType = (0, _selectKitHelper.default)(".select-kit.timer-type");
      await timerType.expand();
      assert.ok(!timerType.rowByValue("delete").exists());
    });
    (0, _qunit.test)("auto delete", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true
      });
      const timerType = (0, _selectKitHelper.default)(".select-kit.timer-type");
      await (0, _testHelpers.visit)("/t/internationalization-localization");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".admin-topic-timer-update button");
      await timerType.expand();
      await timerType.selectRowByValue("delete");
      await (0, _testHelpers.click)("#tap_tile_two_weeks");
      const regex = /will be automatically deleted/g;
      const html = (0, _qunitHelpers.query)(".edit-topic-timer-modal .topic-timer-info").innerHTML.trim();
      assert.ok(regex.test(html));
    });
    (0, _qunit.test)("Inline delete timer", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true
      });
      await (0, _testHelpers.visit)("/t/internationalization-localization");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".admin-topic-timer-update button");
      await (0, _testHelpers.click)("#tap_tile_start_of_next_business_week");
      await (0, _testHelpers.click)(".edit-topic-timer-buttons button.btn-primary");
      const removeTimerButton = (0, _qunitHelpers.query)(".topic-timer-info .topic-timer-remove");
      assert.strictEqual(removeTimerButton.getAttribute("title"), "remove timer");
      await (0, _testHelpers.click)(".topic-timer-info .topic-timer-remove");
      assert.ok(!(0, _qunitHelpers.exists)(".topic-timer-info .topic-timer-remove"));
    });
    (0, _qunit.test)("Shows correct time frame options", async function (assert) {
      this.siteSettings.suggest_weekends_in_date_pickers = true;
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true
      });
      await (0, _testHelpers.visit)("/t/internationalization-localization");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".admin-topic-timer-update button");
      assert.deepEqual([...(0, _qunitHelpers.queryAll)("div.tap-tile-grid div.tap-tile-title")].map(el => el.innerText.trim()), [_I18n.default.t("time_shortcut.tomorrow"), _I18n.default.t("time_shortcut.this_weekend"), _I18n.default.t("time_shortcut.start_of_next_business_week"), _I18n.default.t("time_shortcut.two_weeks"), _I18n.default.t("time_shortcut.next_month"), _I18n.default.t("time_shortcut.six_months"), _I18n.default.t("time_shortcut.custom")]);
    });
    (0, _qunit.test)("Does not show timer notice unless timer set", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true
      });
      await (0, _testHelpers.visit)("/t/internationalization-localization");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".admin-topic-timer-update button");
      const timerType = (0, _selectKitHelper.default)(".select-kit.timer-type");
      await timerType.expand();
      await timerType.selectRowByValue("close_after_last_post");
      assert.notOk((0, _qunitHelpers.exists)(".topic-timer-heading"));
    });
  });
});
define("discourse/tests/acceptance/topic-entrance-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic Entrance Modal", function () {
    (0, _qunit.test)("can be closed with the esc key", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".topic-list-item button.posts-map");
      const topicEntrance = (0, _qunitHelpers.query)("#topic-entrance");
      assert.ok(!topicEntrance.classList.contains("hidden"), "topic entrance modal appears");
      assert.equal(document.activeElement, topicEntrance.querySelector(".jump-top"), "the jump top button has focus when the modal is shown");
      await (0, _testHelpers.triggerKeyEvent)(topicEntrance, "keydown", "Escape");
      assert.ok(topicEntrance.classList.contains("hidden"), "topic entrance modal disappears after pressing esc");
    });
  });
});
define("discourse/tests/acceptance/topic-footer-button-api-mobile-test", ["discourse/tests/helpers/select-kit-helper", "discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers", "discourse/lib/plugin-api"], function (_selectKitHelper, _qunitHelpers, _qunit, _testHelpers, _pluginApi) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/select-kit-helper",0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers",0,"discourse/lib/plugin-api"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic - Plugin API - registerTopicFooterButton (mobile)", function (needs) {
    needs.user();
    needs.mobileView();
    (0, _qunit.test)("adds topic footer button as a dropdown through API", async function (assert) {
      const done = assert.async();
      (0, _pluginApi.withPluginApi)("0.13.1", api => {
        api.registerTopicFooterButton({
          id: "foo",
          icon: "cog",

          action() {
            assert.step(`action called`);
            done();
          },

          dropdown: true
        });
      });
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      const subject = (0, _selectKitHelper.default)(".topic-footer-mobile-dropdown");
      await subject.expand();
      await subject.selectRowByValue("foo");
      assert.verifySteps(["action called"]);
    });
  });
});
define("discourse/tests/acceptance/topic-footer-button-api-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "discourse/lib/plugin-api"], function (_qunitHelpers, _testHelpers, _qunit, _pluginApi) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"discourse/lib/plugin-api"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic - Plugin API - registerTopicFooterButton", function (needs) {
    needs.user();
    (0, _qunit.test)("adds topic footer button through API", async function (assert) {
      const done = assert.async();
      (0, _pluginApi.withPluginApi)("0.13.1", api => {
        api.registerTopicFooterButton({
          id: "my-button",
          icon: "cog",

          action() {
            assert.step("action called");
            done();
          }

        });
      });
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-footer-button-my-button");
      assert.verifySteps(["action called"]);
    });
  });
});
define("discourse/tests/acceptance/topic-footer-dropdown-api-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "discourse/lib/plugin-api", "discourse/tests/helpers/select-kit-helper"], function (_qunitHelpers, _testHelpers, _qunit, _pluginApi, _selectKitHelper) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"discourse/lib/plugin-api",0,"discourse/tests/helpers/select-kit-helper"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic - Plugin API - registerTopicFooterDropdown", function (needs) {
    needs.user();
    (0, _qunit.test)("adds topic footer dropdown through API", async function (assert) {
      const done = assert.async();
      (0, _pluginApi.withPluginApi)("0.13.1", api => {
        api.registerTopicFooterDropdown({
          id: "my-button",

          content() {
            return [{
              id: 1,
              name: "foo"
            }];
          },

          action(itemId) {
            assert.step(`action ${itemId} called`);
            done();
          }

        });
      });
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      const subject = (0, _selectKitHelper.default)("#topic-footer-dropdown-my-button");
      await subject.expand();
      await subject.selectRowByValue(1);
      assert.verifySteps(["action 1 called"]);
    });
  });
});
define("discourse/tests/acceptance/topic-list-plugin-api-test", ["discourse/tests/helpers/qunit-helpers", "discourse/models/topic", "qunit", "@ember/test-helpers", "discourse/lib/plugin-api"], function (_qunitHelpers, _topic, _qunit, _testHelpers, _pluginApi) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"discourse/models/topic",0,"qunit",0,"@ember/test-helpers",0,"discourse/lib/plugin-api"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic list plugin API", function () {
    function customLastUnreadUrl(context) {
      return `${context.urlForPostNumber(1)}?overridden`;
    }

    (0, _qunit.test)("Overrides lastUnreadUrl", async function (assert) {
      try {
        (0, _pluginApi.withPluginApi)("1.2.0", api => {
          api.registerCustomLastUnreadUrlCallback(customLastUnreadUrl);
        });
        await (0, _testHelpers.visit)("/");
        assert.strictEqual((0, _qunitHelpers.query)(".topic-list .topic-list-item:first-child a.raw-topic-link").getAttribute("href"), "/t/error-after-upgrade-to-0-9-7-9/11557/1?overridden");
      } finally {
        (0, _topic.clearCustomLastUnreadUrlCallbacks)();
      }
    });
  });
});
define("discourse/tests/acceptance/topic-list-tracker-test", ["discourse/lib/topic-list-tracker", "discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers", "discourse/tests/fixtures/topic", "discourse/tests/fixtures/discovery-fixtures", "discourse-common/lib/object", "discourse/lib/notification-levels"], function (_topicListTracker, _qunitHelpers, _qunit, _testHelpers, _topic, _discoveryFixtures, _object, _notificationLevels) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/lib/topic-list-tracker",0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers",0,"discourse/tests/fixtures/topic",0,"discourse/tests/fixtures/discovery-fixtures",0,"discourse-common/lib/object",0,"discourse/lib/notification-levels"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic list tracking", function (needs) {
    let notificationLevel;
    needs.hooks.afterEach(() => {
      notificationLevel = null;
    });
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/latest.json", () => {
        const fixture = (0, _object.cloneJSON)(_discoveryFixtures.default["/latest.json"]);

        if (notificationLevel) {
          fixture["topic_list"]["topics"].find(t => {
            if (t.id === 11557) {
              t.notification_level = notificationLevel;
            }
          });
        }

        return helper.response((0, _object.cloneJSON)(fixture));
      });
      server.get("/t/11557.json", () => {
        const topicFixture = (0, _object.cloneJSON)(_topic.default["/t/130.json"]);
        topicFixture.id = 11557;
        return helper.response(topicFixture);
      });
    });
    (0, _qunit.test)("Navigation", async function (assert) {
      await (0, _testHelpers.visit)("/");
      let url = await (0, _topicListTracker.nextTopicUrl)();
      assert.strictEqual(url, "/t/error-after-upgrade-to-0-9-7-9/11557");
      (0, _topicListTracker.setTopicId)(11557);
      url = await (0, _topicListTracker.nextTopicUrl)();
      assert.strictEqual(url, "/t/welcome-to-meta-discourse-org/1");
      url = await (0, _topicListTracker.previousTopicUrl)();
      assert.strictEqual(url, "/t/error-after-upgrade-to-0-9-7-9/11557");
    });
    (0, _qunit.test)("unread count is set on topic that user is tracking", async function (assert) {
      notificationLevel = _notificationLevels.NotificationLevels.TRACKING;
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".raw-topic-link[data-topic-id='11557']");
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)("tr[data-topic-id='11557'] .unread-posts"), "unread count for topic is shown");
    });
    (0, _qunit.test)("unread count is not set on topic that user is not tracking", async function (assert) {
      notificationLevel = _notificationLevels.NotificationLevels.REGULAR;
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".raw-topic-link[data-topic-id='11557']");
      await (0, _testHelpers.visit)("/");
      assert.notOk((0, _qunitHelpers.exists)("tr[data-topic-id='11557'] .unread-posts"), "unread count for topic is not shown");
    });
  });
});
define("discourse/tests/acceptance/topic-move-posts-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "I18n", "qunit"], function (_qunitHelpers, _testHelpers, _I18n, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"I18n",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic move posts", function (needs) {
    needs.user();
    (0, _qunit.test)("default", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".topic-admin-multi-select .btn");
      await (0, _testHelpers.click)("#post_11 .select-below");
      assert.strictEqual((0, _qunitHelpers.query)(".selected-posts .move-to-topic").innerText.trim(), _I18n.default.t("topic.move_to.action"), "it should show the move to button");
      await (0, _testHelpers.click)(".selected-posts .move-to-topic");
      assert.ok((0, _qunitHelpers.query)(".choose-topic-modal .title").innerHTML.includes(_I18n.default.t("topic.move_to.title")), "it opens move to modal");
      assert.ok((0, _qunitHelpers.query)(".choose-topic-modal .radios").innerHTML.includes(_I18n.default.t("topic.split_topic.radio_label")), "it shows an option to move to new topic");
      assert.ok((0, _qunitHelpers.query)(".choose-topic-modal .radios").innerHTML.includes(_I18n.default.t("topic.merge_topic.radio_label")), "it shows an option to move to existing topic");
      assert.ok((0, _qunitHelpers.query)(".choose-topic-modal .radios").innerHTML.includes(_I18n.default.t("topic.move_to_new_message.radio_label")), "it shows an option to move to new message");
    });
    (0, _qunit.test)("moving all posts", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".topic-admin-multi-select .btn");
      await (0, _testHelpers.click)(".select-all");
      await (0, _testHelpers.click)(".selected-posts .move-to-topic");
      assert.ok((0, _qunitHelpers.query)(".choose-topic-modal .title").innerHTML.includes(_I18n.default.t("topic.move_to.title")), "it opens move to modal");
      assert.notOk((0, _qunitHelpers.query)(".choose-topic-modal .radios").innerHTML.includes(_I18n.default.t("topic.split_topic.radio_label")), "it does not show an option to move to new topic");
      assert.ok((0, _qunitHelpers.query)(".choose-topic-modal .radios").innerHTML.includes(_I18n.default.t("topic.merge_topic.radio_label")), "it shows an option to move to existing topic");
      assert.notOk((0, _qunitHelpers.query)(".choose-topic-modal .radios").innerHTML.includes(_I18n.default.t("topic.move_to_new_message.radio_label")), "it does not show an option to move to new message");
    });
    (0, _qunit.test)("moving posts from personal message", async function (assert) {
      await (0, _testHelpers.visit)("/t/pm-for-testing/12");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".topic-admin-multi-select .btn");
      await (0, _testHelpers.click)("#post_1 .select-post");
      assert.strictEqual((0, _qunitHelpers.query)(".selected-posts .move-to-topic").innerText.trim(), _I18n.default.t("topic.move_to.action"), "it should show the move to button");
      await (0, _testHelpers.click)(".selected-posts .move-to-topic");
      assert.ok((0, _qunitHelpers.query)(".choose-topic-modal .title").innerHTML.includes(_I18n.default.t("topic.move_to.title")), "it opens move to modal");
      assert.ok((0, _qunitHelpers.query)(".choose-topic-modal .radios").innerHTML.includes(_I18n.default.t("topic.move_to_new_message.radio_label")), "it shows an option to move to new message");
      assert.ok((0, _qunitHelpers.query)(".choose-topic-modal .radios").innerHTML.includes(_I18n.default.t("topic.move_to_existing_message.radio_label")), "it shows an option to move to existing message");
    });
    (0, _qunit.test)("group moderator moving posts", async function (assert) {
      await (0, _testHelpers.visit)("/t/topic-for-group-moderators/2480");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".topic-admin-multi-select .btn");
      await (0, _testHelpers.click)("#post_2 .select-below");
      assert.strictEqual((0, _qunitHelpers.query)(".selected-posts .move-to-topic").innerText.trim(), _I18n.default.t("topic.move_to.action"), "it should show the move to button");
      await (0, _testHelpers.click)(".selected-posts .move-to-topic");
      assert.ok((0, _qunitHelpers.query)(".choose-topic-modal .title").innerHTML.includes(_I18n.default.t("topic.move_to.title")), "it opens move to modal");
    });
  });
});
define("discourse/tests/acceptance/topic-notifications-button-test", ["discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/select-kit-helper", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _selectKitHelper, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic Notifications button", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.post("/t/280/notifications", () => {
        return helper.response({});
      });
    });
    (0, _qunit.test)("Updating topic notification level", async function (assert) {
      const notificationOptions = (0, _selectKitHelper.default)("#topic-footer-buttons .topic-notifications-options");
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      assert.ok(notificationOptions.exists(), "it should display the notification options button in the topic's footer");
      await notificationOptions.expand();
      await notificationOptions.selectRowByValue("3");
      assert.strictEqual(notificationOptions.header().label(), "Watching", "it should display the right notification level");
      const timelineNotificationOptions = (0, _selectKitHelper.default)(".topic-timeline .widget-component-connector .topic-notifications-options");
      assert.strictEqual(timelineNotificationOptions.header().value(), "3", "it should display the right notification level");
      await timelineNotificationOptions.expand();
      await timelineNotificationOptions.selectRowByValue("0");
      assert.strictEqual(timelineNotificationOptions.header().value(), "0", "it should display the right notification level");
      assert.strictEqual(notificationOptions.header().label(), "Muted", "it should display the right notification level");
    });
  });
});
define("discourse/tests/acceptance/topic-quote-button-test", ["discourse/tests/helpers/qunit-helpers", "I18n", "@ember/test-helpers", "discourse-common/lib/object", "discourse/tests/fixtures/topic", "qunit"], function (_qunitHelpers, _I18n, _testHelpers, _object, _topic, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"I18n",0,"@ember/test-helpers",0,"discourse-common/lib/object",0,"discourse/tests/fixtures/topic",0,"qunit"eaimeta@70e063a35619d71f

  // This tests are flaky on Firefox. Fails with `calling set on destroyed object`
  (0, _qunitHelpers.acceptance)("Topic - Quote button - logged in", function (needs) {
    needs.user();
    needs.settings({
      share_quote_visibility: "anonymous",
      share_quote_buttons: "twitter|email"
    });
    (0, _qunitHelpers.chromeTest)("Does not show the quote share buttons by default", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _qunitHelpers.selectText)("#post_5 blockquote");
      assert.ok((0, _qunitHelpers.exists)(".insert-quote"), "it shows the quote button");
      assert.ok(!(0, _qunitHelpers.exists)(".quote-sharing"), "it does not show quote sharing");
    });
    (0, _qunitHelpers.chromeTest)("Shows quote share buttons with the right site settings", async function (assert) {
      this.siteSettings.share_quote_visibility = "all";
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _qunitHelpers.selectText)("#post_5 blockquote");
      assert.ok((0, _qunitHelpers.exists)(".quote-sharing"), "it shows the quote sharing options");
      assert.ok((0, _qunitHelpers.exists)(`.quote-sharing .btn[title='${_I18n.default.t("share.twitter")}']`), "it includes the twitter share button");
      assert.ok((0, _qunitHelpers.exists)(`.quote-sharing .btn[title='${_I18n.default.t("share.email")}']`), "it includes the email share button");
    });
    (0, _qunitHelpers.chromeTest)("Quoting a Onebox should not copy the formatting of the rendered Onebox", async function (assert) {
      await (0, _testHelpers.visit)("/t/topic-for-group-moderators/2480");
      await (0, _qunitHelpers.selectText)("#post_3 aside.onebox p");
      await (0, _testHelpers.click)(".insert-quote");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value.trim(), '[quote="group_moderator, post:3, topic:2480"]\nhttps://example.com/57350945\n[/quote]', "quote only contains a link");
    });
  });
  (0, _qunitHelpers.acceptance)("Closed Topic - Quote button - logged in", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      const topicResponse = (0, _object.cloneJSON)(_topic.default["/t/280/1.json"]);
      topicResponse.closed = true;
      topicResponse.details.can_create_post = false;
      server.get("/t/280.json", () => helper.response(topicResponse));
    });
    (0, _qunitHelpers.chromeTest)("Shows quote button in closed topics", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _qunitHelpers.selectText)("#post_1 .cooked p:first-child");
      assert.ok((0, _qunitHelpers.exists)(".insert-quote"), "it shows the quote button");
      await (0, _testHelpers.click)(".insert-quote");
      assert.ok((0, _qunitHelpers.query)(".d-editor-input").value.trim().startsWith("Continuing the discussion from"), "quote action defaults to reply as new topic (since topic is closed)");
    });
  });
  (0, _qunitHelpers.acceptance)("Topic - Quote button - anonymous", function (needs) {
    needs.settings({
      share_quote_visibility: "anonymous",
      share_quote_buttons: "twitter|email"
    });
    (0, _qunitHelpers.chromeTest)("Shows quote share buttons with the right site settings", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _qunitHelpers.selectText)("#post_5 blockquote");
      assert.ok((0, _qunitHelpers.queryAll)(".quote-sharing"), "it shows the quote sharing options");
      assert.ok((0, _qunitHelpers.exists)(`.quote-sharing .btn[title='${_I18n.default.t("share.twitter")}']`), "it includes the twitter share button");
      assert.ok((0, _qunitHelpers.exists)(`.quote-sharing .btn[title='${_I18n.default.t("share.email")}']`), "it includes the email share button");
      assert.ok(!(0, _qunitHelpers.exists)(".insert-quote"), "it does not show the quote button");
    });
    (0, _qunitHelpers.chromeTest)("Shows single share button when site setting only has one item", async function (assert) {
      this.siteSettings.share_quote_buttons = "twitter";
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _qunitHelpers.selectText)("#post_5 blockquote");
      assert.ok((0, _qunitHelpers.exists)(".quote-sharing"), "it shows the quote sharing options");
      assert.ok((0, _qunitHelpers.exists)(`.quote-sharing .btn[title='${_I18n.default.t("share.twitter")}']`), "it includes the twitter share button");
      assert.ok(!(0, _qunitHelpers.exists)(".quote-share-label"), "it does not show the Share label");
    });
    (0, _qunitHelpers.chromeTest)("Shows nothing when visibility is disabled", async function (assert) {
      this.siteSettings.share_quote_visibility = "none";
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _qunitHelpers.selectText)("#post_5 blockquote");
      assert.ok(!(0, _qunitHelpers.exists)(".quote-sharing"), "it does not show quote sharing");
      assert.ok(!(0, _qunitHelpers.exists)(".insert-quote"), "it does not show the quote button");
    });
  });
  (0, _qunitHelpers.acceptance)("Topic - Quote button - keyboard shortcut", function (needs) {
    needs.user();
    (0, _qunit.test)("Can use keyboard shortcut to quote selected text", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _qunitHelpers.selectText)("#post_1 .cooked");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "Q");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-input"), "the editor is open");
      assert.ok((0, _qunitHelpers.query)(".d-editor-input").value.includes("Any plans to support"), "editor includes selected text");
    });
  });
});
define("discourse/tests/acceptance/topic-set-slow-mode-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "I18n"], function (_qunitHelpers, _testHelpers, _qunit, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic - Set Slow Mode", function (needs) {
    let clock = null;
    needs.user();
    needs.pretender((server, helper) => {
      server.post("/t/280/timer", () => helper.response({
        success: "OK",
        execute_at: new Date(new Date().getTime() + 1 * 60 * 60 * 1000).toISOString(),
        duration_minutes: 1440,
        based_on_last_post: false,
        closed: false,
        category_id: null
      }));
    });
    needs.hooks.beforeEach(() => {
      const timezone = (0, _qunitHelpers.loggedInUser)().timezone;
      clock = (0, _qunitHelpers.fakeTime)("2100-05-03T08:00:00", timezone, true); // Monday morning
    });
    needs.hooks.afterEach(() => {
      clock.restore();
    });
    (0, _qunit.test)("shows correct timeframe options", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true
      });
      await (0, _testHelpers.visit)("/t/internationalization-localization");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".topic-admin-slow-mode button");
      await (0, _testHelpers.click)(".future-date-input-selector-header");
      const options = Array.from((0, _qunitHelpers.queryAll)(`ul.select-kit-collection li span.name`).map((_, x) => x.innerText.trim()));
      const expected = [_I18n.default.t("time_shortcut.later_today"), _I18n.default.t("time_shortcut.tomorrow"), _I18n.default.t("time_shortcut.two_days"), _I18n.default.t("time_shortcut.next_week"), _I18n.default.t("time_shortcut.two_weeks"), _I18n.default.t("time_shortcut.next_month"), _I18n.default.t("time_shortcut.two_months"), _I18n.default.t("time_shortcut.custom")];
      assert.deepEqual(options, expected, "options are correct");
    });
  });
});
define("discourse/tests/acceptance/topic-slow-mode-test", ["discourse/tests/helpers/select-kit-helper", "discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "I18n", "discourse-common/lib/object", "discourse/tests/fixtures/topic"], function (_selectKitHelper, _qunitHelpers, _testHelpers, _qunit, _I18n, _object, _topic) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/select-kit-helper",0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"I18n",0,"discourse-common/lib/object",0,"discourse/tests/fixtures/topic"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic - Slow Mode - enabled", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/t/1.json", () => {
        const json = (0, _object.cloneJSON)(_topic.default["/t/130.json"]);
        json.slow_mode_seconds = 600;
        json.slow_mode_enabled_until = "2040-01-01T04:00:00.000Z";
        return helper.response(json);
      });
      server.get("/t/2.json", () => {
        const json = (0, _object.cloneJSON)(_topic.default["/t/130.json"]);
        json.slow_mode_seconds = 0;
        json.slow_mode_enabled_until = null;
        return helper.response(json);
      });
    });
    needs.hooks.beforeEach(() => {
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true
      });
    });
    (0, _qunit.test)("the slow mode dialog loads settings of currently enabled slow mode ", async function (assert) {
      await (0, _testHelpers.visit)("/t/a-topic-with-enabled-slow-mode/1");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".topic-admin-slow-mode button");
      const slowModeType = (0, _selectKitHelper.default)(".slow-mode-type");
      assert.strictEqual(slowModeType.header().name(), _I18n.default.t("topic.slow_mode_update.durations.10_minutes"), "slow mode interval is rendered"); // unfortunately we can't check exact date and time
      // but at least we can make sure that components for choosing date and time are rendered
      // (in case of inactive slow mode it would be only a combo box with text "Select a timeframe",
      // and date picker and time picker wouldn't be rendered)

      assert.strictEqual((0, _qunitHelpers.query)("div.enabled-until span.name").innerText, _I18n.default.t("time_shortcut.custom"), "enabled until combobox is switched to the option Pick Date and Time");
      assert.ok((0, _qunitHelpers.exists)("input.date-picker"), "date picker is rendered");
      assert.ok((0, _qunitHelpers.exists)("input.time-input"), "time picker is rendered");
    });
    (0, _qunit.test)("'Enable' button changes to 'Update' button when slow mode is enabled", async function (assert) {
      await (0, _testHelpers.visit)("/t/a-topic-with-disabled-slow-mode/2");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".topic-admin-slow-mode button");
      await (0, _testHelpers.click)(".future-date-input-selector-header");
      assert.strictEqual((0, _qunitHelpers.query)("div.modal-footer button.btn-primary span").innerText, _I18n.default.t("topic.slow_mode_update.enable"), "shows 'Enable' button when slow mode is disabled");
      await (0, _testHelpers.visit)("/t/a-topic-with-enabled-slow-mode/1");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".topic-admin-slow-mode button");
      await (0, _testHelpers.click)(".future-date-input-selector-header");
      assert.strictEqual((0, _qunitHelpers.query)("div.modal-footer button.btn-primary span").innerText, _I18n.default.t("topic.slow_mode_update.update"), "shows 'Update' button when slow mode is enabled");
    });
  });
});
define("discourse/tests/acceptance/topic-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "I18n", "discourse/tests/helpers/select-kit-helper", "qunit", "discourse/lib/plugin-api", "discourse/tests/fixtures/topic", "discourse-common/lib/object", "discourse/tests/fixtures/category-fixtures"], function (_qunitHelpers, _testHelpers, _I18n, _selectKitHelper, _qunit, _pluginApi, _topic, _object, _categoryFixtures) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"I18n",0,"discourse/tests/helpers/select-kit-helper",0,"qunit",0,"discourse/lib/plugin-api",0,"discourse/tests/fixtures/topic",0,"discourse-common/lib/object",0,"discourse/tests/fixtures/category-fixtures"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/c/2/visible_groups.json", () => helper.response(200, {
        groups: []
      }));
      server.get("/c/feature/find_by_slug.json", () => {
        return helper.response(200, _categoryFixtures.default["/c/1/show.json"]);
      });
      server.put("/posts/398/wiki", () => {
        return helper.response({});
      });
    });
    (0, _qunit.test)("Reply as new topic", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("button.share:nth-of-type(1)");
      await (0, _testHelpers.click)("button.new-topic");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-input"), "the composer input is visible");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value.trim(), `Continuing the discussion from [Internationalization / localization](${window.location.origin}/t/internationalization-localization/280):`, "it fills composer with the ring string");
      assert.strictEqual((0, _selectKitHelper.default)(".category-chooser").header().value(), "2", "it fills category selector with the right category");
    });
    (0, _qunit.test)("Reply as new message", async function (assert) {
      await (0, _testHelpers.visit)("/t/pm-for-testing/12");
      await (0, _testHelpers.click)("button.share:nth-of-type(1)");
      await (0, _testHelpers.click)("button.new-topic");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-input"), "the composer input is visible");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value.trim(), `Continuing the discussion from [PM for testing](${window.location.origin}/t/pm-for-testing/12):`, "it fills composer with the ring string");
      const privateMessageUsers = (0, _selectKitHelper.default)("#private-message-users");
      assert.strictEqual(privateMessageUsers.header().value(), "someguy,test,Group", "it fills up the composer correctly");
    });
    (0, _qunit.test)("Share Modal", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)(".topic-post:first-child button.share");
      assert.ok((0, _qunitHelpers.exists)(".share-topic-modal"), "it shows the share modal");
    });
    (0, _qunit.test)("Showing and hiding the edit controls", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-title .d-icon-pencil-alt");
      assert.ok((0, _qunitHelpers.exists)("#edit-title"), "it shows the editing controls");
      assert.ok(!(0, _qunitHelpers.exists)(".title-wrapper .remove-featured-link"), "link to remove featured link is not shown");
      await (0, _testHelpers.fillIn)("#edit-title", "this is the new title");
      await (0, _testHelpers.click)("#topic-title .cancel-edit");
      assert.ok(!(0, _qunitHelpers.exists)("#edit-title"), "it hides the editing controls");
    });
    (0, _qunit.test)("Updating the topic title and category", async function (assert) {
      const categoryChooser = (0, _selectKitHelper.default)(".title-wrapper .category-chooser");
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-title .d-icon-pencil-alt");
      await (0, _testHelpers.fillIn)("#edit-title", "this is the new title");
      await categoryChooser.expand();
      await categoryChooser.selectRowByValue(4);
      await (0, _testHelpers.click)("#topic-title .submit-edit");
      assert.strictEqual((0, _qunitHelpers.query)("#topic-title .badge-category").innerText, "faq", "it displays the new category");
      assert.strictEqual((0, _qunitHelpers.query)(".fancy-title").innerText.trim(), "this is the new title", "it displays the new title");
    });
    (0, _qunit.test)("Marking a topic as wiki", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      assert.ok(!(0, _qunitHelpers.exists)("a.wiki"), "it does not show the wiki icon");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.show-more-actions");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.show-post-admin-menu");
      await (0, _testHelpers.click)(".btn.wiki");
      assert.strictEqual((0, _qunitHelpers.count)("button.wiki"), 1, "it shows the wiki icon");
    });
    (0, _qunit.test)("Visit topic routes", async function (assert) {
      await (0, _testHelpers.visit)("/t/12");
      assert.strictEqual((0, _qunitHelpers.query)(".fancy-title").innerText.trim(), "PM for testing", "it routes to the right topic");
      await (0, _testHelpers.visit)("/t/280/20");
      assert.strictEqual((0, _qunitHelpers.query)(".fancy-title").innerText.trim(), "Internationalization / localization", "it routes to the right topic");
    });
    (0, _qunit.test)("Updating the topic title with emojis", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-title .d-icon-pencil-alt");
      await (0, _testHelpers.fillIn)("#edit-title", "emojis title :bike: :blonde_woman:t6:");
      await (0, _testHelpers.click)("#topic-title .submit-edit");
      assert.ok((0, _qunitHelpers.query)(".fancy-title").innerHTML.trim().includes("bike.png"), "it displays the new title with emojis");
    });
    (0, _qunit.test)("Updating the topic title with unicode emojis", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-title .d-icon-pencil-alt");
      await (0, _testHelpers.fillIn)("#edit-title", "emojis title ");
      await (0, _testHelpers.click)("#topic-title .submit-edit");
      assert.ok((0, _qunitHelpers.query)(".fancy-title").innerHTML.trim().includes("man_farmer.png"), "it displays the new title with emojis");
    });
    (0, _qunit.test)("Updating the topic title with unicode emojis without whitespace", async function (assert) {
      this.siteSettings.enable_inline_emoji_translation = true;
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)("#topic-title .d-icon-pencil-alt");
      await (0, _testHelpers.fillIn)("#edit-title", "TestTitle");
      await (0, _testHelpers.click)("#topic-title .submit-edit");
      assert.ok((0, _qunitHelpers.query)(".fancy-title").innerHTML.trim().includes("slightly_smiling_face.png"), "it displays the new title with emojis");
    });
    (0, _qunit.test)("Suggested topics", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      assert.strictEqual((0, _qunitHelpers.query)("#suggested-topics .suggested-topics-title").innerText.trim(), _I18n.default.t("suggested_topics.title"));
    });
    (0, _qunit.test)("Deleting a topic", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.show-more-actions");
      await (0, _testHelpers.click)(".widget-button.delete");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      assert.ok((0, _qunitHelpers.exists)(".topic-admin-recover"), "it shows the recover button");
    });
    (0, _qunit.test)("Deleting a popular topic displays confirmation modal", async function (assert) {
      this.siteSettings.min_topic_views_for_delete_confirm = 10;
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)(".topic-post:nth-of-type(1) button.show-more-actions");
      await (0, _testHelpers.click)(".widget-button.delete");
      assert.ok((0, _qunitHelpers.visible)(".delete-topic-confirm-modal"), "it shows the delete confirmation modal");
      await (0, _testHelpers.click)(".delete-topic-confirm-modal .btn-primary");
      assert.ok(!(0, _qunitHelpers.visible)(".delete-topic-confirm-modal"), "it hides the delete confirmation modal");
      await (0, _testHelpers.click)(".widget-button.delete");
      await (0, _testHelpers.click)(".delete-topic-confirm-modal .btn-danger");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      assert.ok((0, _qunitHelpers.exists)(".topic-admin-recover"), "it shows the recover button");
    });
    (0, _qunit.test)("Group category moderator posts", async function (assert) {
      await (0, _testHelpers.visit)("/t/topic-for-group-moderators/2480");
      assert.ok((0, _qunitHelpers.exists)(".category-moderator"), "it has a class applied");
      assert.ok((0, _qunitHelpers.exists)(".d-icon-shield-alt"), "it shows an icon");
    });
    (0, _qunit.test)("Suspended user posts", async function (assert) {
      await (0, _testHelpers.visit)("/t/topic-from-suspended-user/54077");
      assert.ok((0, _qunitHelpers.exists)(".topic-post.user-suspended > #post_1"), "it has a class applied");
    });
  });
  (0, _qunitHelpers.acceptance)("Topic featured links", function (needs) {
    needs.user();
    needs.settings({
      topic_featured_link_enabled: true,
      max_topic_title_length: 80,
      exclude_rel_nofollow_domains: "example.com",
      display_name_on_posts: false,
      prioritize_username_in_ux: true
    });
    (0, _qunit.test)("remove nofollow attribute", async function (assert) {
      await (0, _testHelpers.visit)("/t/-/299/1");
      const link = (0, _qunitHelpers.query)(".title-wrapper .topic-featured-link");
      assert.strictEqual(link.innerText, " example.com");
      assert.strictEqual(link.getAttribute("rel"), "ugc");
    });
    (0, _qunit.test)("remove featured link", async function (assert) {
      await (0, _testHelpers.visit)("/t/-/299/1");
      assert.ok((0, _qunitHelpers.exists)(".title-wrapper .topic-featured-link"), "link is shown with topic title");
      await (0, _testHelpers.click)(".title-wrapper .edit-topic");
      assert.ok((0, _qunitHelpers.exists)(".title-wrapper .remove-featured-link"), "link to remove featured link"); // TODO: decide if we want to test this, test is flaky so it
      // was commented out.
      // If not fixed by May 2021, delete this code block
      //
      //await click(".title-wrapper .remove-featured-link");
      //await click(".title-wrapper .submit-edit");
      //assert.ok(!exists(".title-wrapper .topic-featured-link"), "link is gone");
    });
    (0, _qunit.test)("Converting to a public topic", async function (assert) {
      await (0, _testHelpers.visit)("/t/test-pm/34");
      assert.ok((0, _qunitHelpers.exists)(".private_message"));
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".topic-admin-convert button");
      let categoryChooser = (0, _selectKitHelper.default)(".convert-to-public-topic .category-chooser");
      await categoryChooser.expand();
      await categoryChooser.selectRowByValue(21);
      await (0, _testHelpers.click)(".convert-to-public-topic .btn-primary");
      assert.ok(!(0, _qunitHelpers.exists)(".private_message"));
    });
    (0, _qunit.test)("Unpinning unlisted topic", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".topic-admin-pin .btn");
      await (0, _testHelpers.click)(".make-banner");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".topic-admin-visible .btn");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      assert.ok((0, _qunitHelpers.exists)(".topic-admin-pin"), "it should show the multi select menu");
    });
    (0, _qunit.test)("selecting posts", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".topic-admin-multi-select .btn");
      assert.ok((0, _qunitHelpers.exists)(".selected-posts:not(.hidden)"), "it should show the multi select menu");
      assert.ok((0, _qunitHelpers.exists)(".select-all"), "it should allow users to select all the posts");
    });
    (0, _qunit.test)("select below", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".topic-admin-multi-select .btn");
      await (0, _testHelpers.click)("#post_3 .select-below");
      assert.ok((0, _qunitHelpers.query)(".selected-posts").innerHTML.includes(_I18n.default.t("topic.multi_select.description", {
        count: 18
      })), "it should select the right number of posts");
      await (0, _testHelpers.click)("#post_2 .select-below");
      assert.ok((0, _qunitHelpers.query)(".selected-posts").innerHTML.includes(_I18n.default.t("topic.multi_select.description", {
        count: 19
      })), "it should select the right number of posts");
    });
    (0, _qunit.test)("View Hidden Replies", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)(".gap");
      assert.ok(!(0, _qunitHelpers.exists)(".gap"), "it hides gap");
    });
    (0, _qunitHelpers.chromeTest)("Quoting a quote keeps the original poster name", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _qunitHelpers.selectText)("#post_5 blockquote");
      await (0, _testHelpers.click)(".quote-button .insert-quote");
      assert.ok((0, _qunitHelpers.query)(".d-editor-input").value.includes('quote="codinghorror said, post:3, topic:280"'));
    });
    (0, _qunitHelpers.chromeTest)("Quoting a quote of a different topic keeps the original topic title", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _qunitHelpers.selectText)("#post_9 blockquote");
      await (0, _testHelpers.click)(".quote-button .insert-quote");
      assert.ok((0, _qunitHelpers.query)(".d-editor-input").value.includes('quote="A new topic with a link to another topic, post:3, topic:62"'));
    });
    (0, _qunitHelpers.chromeTest)("Quoting a quote with the Reply button keeps the original poster name", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _qunitHelpers.selectText)("#post_5 blockquote");
      await (0, _testHelpers.click)(".reply");
      assert.ok((0, _qunitHelpers.query)(".d-editor-input").value.includes('quote="codinghorror said, post:3, topic:280"'));
    }); // Using J/K on Firefox clean the text selection, so this won't work there

    (0, _qunitHelpers.chromeTest)("Quoting a quote with replyAsNewTopic keeps the original poster name", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _qunitHelpers.selectText)("#post_5 blockquote");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "J");
      await (0, _testHelpers.triggerKeyEvent)(document, "keypress", "T");
      assert.ok((0, _qunitHelpers.query)(".d-editor-input").value.includes('quote="codinghorror said, post:3, topic:280"'));
    });
    (0, _qunit.test)("Quoting by selecting text can mark the quote as full", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _qunitHelpers.selectText)("#post_5 .cooked");
      await (0, _testHelpers.click)(".quote-button .insert-quote");
      assert.ok((0, _qunitHelpers.query)(".d-editor-input").value.includes('quote="pekka, post:5, topic:280, full:true"'));
    });
  });
  (0, _qunitHelpers.acceptance)("Topic featured links", function (needs) {
    needs.user();
    needs.settings({
      topic_featured_link_enabled: true,
      max_topic_title_length: 80
    });
    (0, _qunit.test)("remove featured link", async function (assert) {
      await (0, _testHelpers.visit)("/t/-/299/1");
      assert.ok((0, _qunitHelpers.exists)(".title-wrapper .topic-featured-link"), "link is shown with topic title");
      await (0, _testHelpers.click)(".title-wrapper .edit-topic");
      assert.ok((0, _qunitHelpers.exists)(".title-wrapper .remove-featured-link"), "link to remove featured link");
    });
  });
  (0, _qunitHelpers.acceptance)("Topic with title decorated", function (needs) {
    needs.user();
    needs.hooks.beforeEach(() => {
      (0, _pluginApi.withPluginApi)("0.8.40", api => {
        api.decorateTopicTitle((topic, node, topicTitleType) => {
          node.innerText = `${node.innerText}-${topic.id}-${topicTitleType}`;
        });
      });
    });
    (0, _qunit.test)("Decorate topic title", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      assert.ok((0, _qunitHelpers.query)(".fancy-title").innerText.endsWith("-280-topic-title"), "it decorates topic title");
      assert.ok((0, _qunitHelpers.query)(".raw-topic-link:nth-child(1)").innerText.endsWith("-27331-topic-list-item-title"), "it decorates topic list item title");
    });
  });
  (0, _qunitHelpers.acceptance)("Topic pinning/unpinning as an admin", function (needs) {
    needs.user({
      admin: true
    });
    (0, _qunit.test)("Admin pinning topic", async function (assert) {
      await (0, _testHelpers.visit)("/t/topic-for-group-moderators/2480");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".topic-admin-pin .btn");
      assert.ok((0, _qunitHelpers.exists)(".feature-topic .btn-primary"), "it should show the 'Pin Topic' button");
      assert.ok((0, _qunitHelpers.exists)(".make-banner"), "it should show the 'Banner Topic' button");
    });
  });
  (0, _qunitHelpers.acceptance)("Topic pinning/unpinning as a staff member", function (needs) {
    needs.user({
      moderator: true,
      admin: false,
      trust_level: 2
    });
    (0, _qunit.test)("Staff pinning topic", async function (assert) {
      await (0, _testHelpers.visit)("/t/topic-for-group-moderators/2480");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".topic-admin-pin .btn");
      assert.ok((0, _qunitHelpers.exists)(".feature-topic .btn-primary"), "it should show the 'Pin Topic' button");
      assert.ok((0, _qunitHelpers.exists)(".make-banner"), "it should show the 'Banner Topic' button");
    });
  });
  (0, _qunitHelpers.acceptance)("Topic pinning/unpinning as a group moderator", function (needs) {
    needs.user({
      moderator: false,
      admin: false,
      trust_level: 1
    });
    (0, _qunit.test)("Group category moderator pinning topic", async function (assert) {
      await (0, _testHelpers.visit)("/t/topic-for-group-moderators/2480");
      await (0, _testHelpers.click)(".toggle-admin-menu");
      await (0, _testHelpers.click)(".topic-admin-pin .btn");
      assert.ok((0, _qunitHelpers.exists)(".feature-topic .btn-primary"), "it should show the 'Pin Topic' button");
      assert.ok(!(0, _qunitHelpers.exists)(".make-banner"), "it should not show the 'Banner Topic' button");
    });
  });
  (0, _qunitHelpers.acceptance)("Topic last visit line", function (needs) {
    needs.user({
      moderator: false,
      admin: false,
      trust_level: 1
    });
    (0, _qunit.test)("visit topic", async function (assert) {
      await (0, _testHelpers.visit)("/t/-/280");
      assert.ok((0, _qunitHelpers.exists)(".topic-post-visited-line.post-10"), "shows the last visited line on the right post");
      await (0, _testHelpers.visit)("/t/-/9");
      assert.ok(!(0, _qunitHelpers.exists)(".topic-post-visited-line"), "does not show last visited line if post is the last post");
    });
  });
  (0, _qunitHelpers.acceptance)("Topic filter replies to post number", function (needs) {
    needs.settings({
      enable_filtered_replies_view: true
    });
    (0, _qunit.test)("visit topic", async function (assert) {
      await (0, _testHelpers.visit)("/t/-/280");
      assert.equal((0, _qunitHelpers.query)("#post_3 .show-replies").title, _I18n.default.t("post.filtered_replies_hint", {
        count: 3
      }), "it displays the right title for filtering by replies");
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.visit)("/t/-/280?replies_to_post_number=3");
      assert.equal((0, _qunitHelpers.query)("#post_3 .show-replies").title, _I18n.default.t("post.view_all_posts"), "it displays the right title when filtered by replies");
    });
  });
  (0, _qunitHelpers.acceptance)("Navigating between topics", function (needs) {
    needs.pretender((server, helper) => {
      const topicResponse = (0, _object.cloneJSON)(_topic.default["/t/280/1.json"]);
      const firstPost = topicResponse.post_stream.posts[0];
      firstPost.cooked += `\n<a class='same-topic-slugless' href='/t/280'>Link 1</a>`;
      firstPost.cooked += `\n<a class='same-topic-slugless-post' href='/t/280/3'>Link 2</a>`;
      firstPost.cooked += `\n<a class='diff-topic-slugless' href='/t/28830'>Link 3</a>`;
      firstPost.cooked += `\n<a class='diff-topic-slugless-post' href='/t/28830/1'>Link 4</a>`;
      firstPost.cooked += `\n<a class='by-post-id' href='/p/${firstPost.id}'>Link to Post</a>`;
      server.get("/t/280.json", () => helper.response(topicResponse));
      server.get("/t/280/:post_number.json", () => helper.response(topicResponse));
    });
    (0, _qunit.test)("clicking slug-less URLs within the same topic", async function (assert) {
      await (0, _testHelpers.visit)("/t/-/280");
      await (0, _testHelpers.click)("a.same-topic-slugless");
      assert.ok((0, _testHelpers.currentURL)().includes("/280"));
      await (0, _testHelpers.click)("a.same-topic-slugless-post");
      assert.ok((0, _testHelpers.currentURL)().includes("/280"));
    });
    (0, _qunit.test)("clicking slug-less URLs to a different topic", async function (assert) {
      await (0, _testHelpers.visit)("/t/-/280");
      await (0, _testHelpers.click)("a.diff-topic-slugless");
      assert.ok((0, _testHelpers.currentURL)().includes("/28830"));
      await (0, _testHelpers.visit)("/t/-/280");
      await (0, _testHelpers.click)("a.diff-topic-slugless-post");
      assert.ok((0, _testHelpers.currentURL)().includes("/28830"));
    });
    (0, _qunit.test)("clicking post URLs", async function (assert) {
      await (0, _testHelpers.visit)("/t/-/280");
      await (0, _testHelpers.click)("a.by-post-id");
      assert.ok((0, _testHelpers.currentURL)().includes("/280"));
    });
  });
  (0, _qunitHelpers.acceptance)("Topic stats update automatically", function () {
    (0, _qunit.test)("Likes count updates automatically", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      const likesDisplay = (0, _qunitHelpers.query)("#post_1 .topic-map .likes .number");
      const oldLikes = likesDisplay.textContent;
      const likesChangedFixture = {
        id: 280,
        type: "stats",
        like_count: 999
      }; // simulate the topic like_count being changed

      await (0, _qunitHelpers.publishToMessageBus)("/topic/280", likesChangedFixture);
      const newLikes = likesDisplay.textContent;
      assert.notEqual(oldLikes, newLikes, "it updates the like count on the topic stats");
      assert.equal(newLikes, likesChangedFixture.like_count, "it updates the like count with the expected value");
    });
    const postsChangedFixture = {
      id: 280,
      type: "stats",
      posts_count: 999,
      last_posted_at: "2022-06-20T21:01:45.844Z",
      last_poster: {
        id: 1,
        username: "test",
        name: "Mr. Tester",
        avatar_template: "/images/d-logo-sketch-small.png"
      }
    };
    (0, _qunit.test)("Replies count updates automatically", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      const repliesDisplay = (0, _qunitHelpers.query)("#post_1 .topic-map .replies .number");
      const oldReplies = repliesDisplay.textContent; // simulate the topic posts_count being changed

      await (0, _qunitHelpers.publishToMessageBus)("/topic/280", postsChangedFixture);
      const newLikes = repliesDisplay.textContent;
      assert.notEqual(oldReplies, newLikes, "it updates the replies count on the topic stats");
      assert.equal(newLikes, postsChangedFixture.posts_count - 1, // replies = posts_count - 1
      "it updates the replies count with the expected value");
    });
    (0, _qunit.test)("Last replier avatar updates automatically", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      const avatarImg = (0, _qunitHelpers.query)("#post_1 .topic-map .last-reply .avatar");
      const oldAvatarTitle = avatarImg.title;
      const oldAvatarSrc = avatarImg.src; // simulate the topic posts_count being changed

      await (0, _qunitHelpers.publishToMessageBus)("/topic/280", postsChangedFixture);
      const newAvatarTitle = avatarImg.title;
      const newAvatarSrc = avatarImg.src;
      assert.notEqual(oldAvatarTitle, newAvatarTitle, "it updates the last poster avatar title on the topic stats");
      assert.equal(newAvatarTitle, postsChangedFixture.last_poster.name, "it updates the last poster avatar title with the expected value");
      assert.notEqual(oldAvatarSrc, newAvatarSrc, "it updates the last poster avatar src on the topic stats");
      assert.equal(newAvatarSrc, `${document.location.origin}${postsChangedFixture.last_poster.avatar_template}`, "it updates the last poster avatar src with the expected value");
    });
    (0, _qunit.test)("Last replied at updates automatically", async function (assert) {
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      const lastRepliedAtDisplay = (0, _qunitHelpers.query)("#post_1 .topic-map .last-reply .relative-date");
      const oldTime = lastRepliedAtDisplay.dataset.time; // simulate the topic posts_count being changed

      await (0, _qunitHelpers.publishToMessageBus)("/topic/280", postsChangedFixture);
      const newTime = lastRepliedAtDisplay.dataset.time;
      assert.notEqual(oldTime, newTime, "it updates the last posted time on the topic stats");
      assert.equal(newTime, new Date(postsChangedFixture.last_posted_at).getTime(), "it updates the last posted time with the expected value");
    });
  });
});
define("discourse/tests/acceptance/topic-timeline-test", ["@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "qunit"], function (_testHelpers, _qunitHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic Timeline", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/t/129.json", () => {
        return helper.response({
          post_stream: {
            posts: [{
              id: 132,
              name: null,
              username: "foo",
              avatar_template: "/letter_avatar_proxy/v4/letter/f/b19c9b/{size}.png",
              created_at: "2020-07-08T15:03:53.166Z",
              cooked: "<p>Deleted post</p>",
              post_number: 1,
              post_type: 1,
              updated_at: "2020-07-08T15:04:33.425Z",
              reply_count: 0,
              reply_to_post_number: null,
              quote_count: 0,
              incoming_link_count: 0,
              reads: 1,
              readers_count: 0,
              score: 0,
              yours: true,
              topic_id: 129,
              topic_slug: "deleted-topic-with-whisper-post",
              display_username: null,
              primary_group_name: null,
              flair_name: null,
              flair_url: null,
              flair_bg_color: null,
              flair_color: null,
              version: 1,
              can_edit: true,
              can_delete: false,
              can_recover: true,
              can_wiki: true,
              read: true,
              user_title: null,
              bookmarked: false,
              bookmarks: [],
              actions_summary: [{
                id: 3,
                can_act: true
              }, {
                id: 4,
                can_act: true
              }, {
                id: 8,
                can_act: true
              }, {
                id: 7,
                can_act: true
              }],
              moderator: false,
              admin: true,
              staff: true,
              user_id: 7,
              hidden: false,
              trust_level: 4,
              deleted_at: "2020-07-08T15:04:37.544Z",
              deleted_by: {
                id: 7,
                username: "foo",
                name: null,
                avatar_template: "/letter_avatar_proxy/v4/letter/f/b19c9b/{size}.png"
              },
              user_deleted: false,
              edit_reason: null,
              can_view_edit_history: true,
              wiki: false,
              reviewable_id: 0,
              reviewable_score_count: 0,
              reviewable_score_pending_count: 0
            }, {
              id: 133,
              name: null,
              username: "foo",
              avatar_template: "/letter_avatar_proxy/v4/letter/f/b19c9b/{size}.png",
              created_at: "2020-07-08T15:04:23.190Z",
              cooked: "<p>Whisper post</p>",
              post_number: 2,
              post_type: 4,
              updated_at: "2020-07-08T15:04:23.190Z",
              reply_count: 0,
              reply_to_post_number: null,
              quote_count: 0,
              incoming_link_count: 0,
              reads: 1,
              readers_count: 0,
              score: 0,
              yours: true,
              topic_id: 129,
              topic_slug: "deleted-topic-with-whisper-post",
              display_username: null,
              primary_group_name: null,
              flair_name: null,
              flair_url: null,
              flair_bg_color: null,
              flair_color: null,
              version: 1,
              can_edit: true,
              can_delete: true,
              can_recover: false,
              can_wiki: true,
              read: true,
              user_title: null,
              bookmarked: false,
              bookmarks: [],
              actions_summary: [{
                id: 3,
                can_act: true
              }, {
                id: 4,
                can_act: true
              }, {
                id: 8,
                can_act: true
              }, {
                id: 7,
                can_act: true
              }],
              moderator: false,
              admin: true,
              staff: true,
              user_id: 7,
              hidden: false,
              trust_level: 4,
              deleted_at: null,
              user_deleted: false,
              edit_reason: null,
              can_view_edit_history: true,
              wiki: false,
              reviewable_id: 0,
              reviewable_score_count: 0,
              reviewable_score_pending_count: 0
            }],
            stream: [132, 133]
          },
          timeline_lookup: [[1, 0]],
          suggested_topics: [{
            id: 7,
            title: "Welcome to Discourse",
            fancy_title: "Welcome to Discourse",
            slug: "welcome-to-discourse",
            posts_count: 1,
            reply_count: 0,
            highest_post_number: 1,
            image_url: null,
            created_at: "2020-07-08T14:56:57.424Z",
            last_posted_at: "2020-07-08T14:56:57.488Z",
            bumped: true,
            bumped_at: "2020-07-08T14:56:57.488Z",
            archetype: "regular",
            unseen: false,
            pinned: true,
            unpinned: null,
            excerpt: "The first paragraph of this pinned topic will be visible as a welcome message to all new visitors on your homepage. Its important! \nEdit this into a brief description of your community: \n\nWho is it for?\nWhat can they fi&hellip;",
            visible: true,
            closed: false,
            archived: false,
            bookmarked: null,
            liked: null,
            tags: [],
            like_count: 0,
            views: 0,
            category_id: 1,
            featured_link: null,
            posters: [{
              extras: "latest single",
              description: "Original Poster, Most Recent Poster",
              user: {
                id: -1,
                username: "system",
                name: "system",
                avatar_template: "/images/discourse-logo-sketch-small.png"
              }
            }]
          }],
          tags: [],
          id: 129,
          title: "Deleted topic with whisper post",
          fancy_title: "Deleted topic with whisper post",
          posts_count: 0,
          created_at: "2020-07-08T15:03:53.045Z",
          views: 1,
          reply_count: 0,
          like_count: 0,
          last_posted_at: null,
          visible: true,
          closed: false,
          archived: false,
          has_summary: false,
          archetype: "regular",
          slug: "deleted-topic-with-whisper-post",
          category_id: 1,
          word_count: 8,
          deleted_at: "2020-07-08T15:04:37.580Z",
          user_id: 7,
          featured_link: null,
          pinned_globally: false,
          pinned_at: null,
          pinned_until: null,
          image_url: null,
          slow_mode_seconds: 0,
          draft: null,
          draft_key: "topic_129",
          draft_sequence: 5,
          posted: true,
          unpinned: null,
          pinned: false,
          current_post_number: 1,
          highest_post_number: 2,
          last_read_post_number: 0,
          bookmarks: [],
          last_read_post_id: null,
          deleted_by: {
            id: 7,
            username: "foo",
            name: null,
            avatar_template: "/letter_avatar_proxy/v4/letter/f/b19c9b/{size}.png"
          },
          has_deleted: false,
          actions_summary: [{
            id: 4,
            count: 0,
            hidden: false,
            can_act: true
          }, {
            id: 8,
            count: 0,
            hidden: false,
            can_act: true
          }, {
            id: 7,
            count: 0,
            hidden: false,
            can_act: true
          }],
          chunk_size: 20,
          bookmarked: false,
          bookmarks: [],
          topic_timer: null,
          message_bus_last_id: 5,
          participant_count: 1,
          show_read_indicator: false,
          thumbnails: null,
          slow_mode_enabled_until: null,
          details: {
            can_edit: true,
            notification_level: 3,
            notifications_reason_id: 1,
            can_move_posts: true,
            can_recover: true,
            can_remove_allowed_users: true,
            can_invite_to: true,
            can_invite_via_email: true,
            can_reply_as_new_topic: true,
            can_flag_topic: true,
            can_review_topic: true,
            can_close_topic: true,
            can_archive_topic: true,
            can_split_merge_topic: true,
            can_edit_staff_notes: true,
            can_toggle_topic_visibility: true,
            can_pin_unpin_topic: true,
            can_moderate_category: true,
            can_remove_self_id: 7,
            participants: [{
              id: 7,
              username: "foo",
              name: null,
              avatar_template: "/letter_avatar_proxy/v4/letter/f/b19c9b/{size}.png",
              post_count: 1,
              primary_group_name: null,
              flair_name: null,
              flair_url: null,
              flair_color: null,
              flair_bg_color: null,
              admin: true,
              trust_level: 4
            }],
            created_by: {
              id: 7,
              username: "foo",
              name: null,
              avatar_template: "/letter_avatar_proxy/v4/letter/f/b19c9b/{size}.png"
            },
            last_poster: {
              id: 7,
              username: "foo",
              name: null,
              avatar_template: "/letter_avatar_proxy/v4/letter/f/b19c9b/{size}.png"
            }
          }
        });
      });
    });
    (0, _qunit.test)("Shows dates of first and last posts", async function (assert) {
      await (0, _testHelpers.visit)("/t/deleted-topic-with-whisper-post/129");
      assert.strictEqual((0, _qunitHelpers.query)(".now-date").innerText, "Jul 2020");
    });
  });
});
define("discourse/tests/acceptance/topic-user-status-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "discourse/tests/fixtures/topic", "discourse-common/lib/object"], function (_qunitHelpers, _testHelpers, _qunit, _topic, _object) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"discourse/tests/fixtures/topic",0,"discourse-common/lib/object"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Topic - User Status", function (needs) {
    const status = {
      emoji: "tooth",
      description: "off to dentist"
    };
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/t/299/1.json", () => {
        const response = (0, _object.cloneJSON)(_topic.default["/t/299/1.json"]);
        response.post_stream.posts.forEach(post => {
          post.user_status = status;
        });
        return helper.response(200, response);
      });
    });
    (0, _qunit.test)("shows user status next to avatar on posts", async function (assert) {
      this.siteSettings.enable_user_status = true;
      await (0, _testHelpers.visit)("/t/-/299/1");
      assert.equal((0, _qunitHelpers.queryAll)(".topic-post .user-status-message").length, 3, "all posts has user status");
    });
  });
  (0, _qunitHelpers.acceptance)("Topic - User Status - live updates", function (needs) {
    const userId = 1;
    const status = {
      emoji: "tooth",
      description: "off to dentist"
    };
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/t/299/1.json", () => {
        const response = (0, _object.cloneJSON)(_topic.default["/t/299/1.json"]);
        response.post_stream.posts.forEach(post => {
          post.user_id = userId;
          post.user_status = {
            emoji: "tooth",
            description: "off to dentist"
          };
        });
        return helper.response(200, response);
      });
    });
    (0, _qunit.test)("updating status", async function (assert) {
      this.siteSettings.enable_user_status = true;
      await (0, _testHelpers.visit)("/t/-/299/1");
      assert.equal((0, _qunitHelpers.queryAll)(".topic-post .user-status-message").length, 3, "all posts has user status");
      assert.ok((0, _qunitHelpers.query)(".topic-post .user-status-message .emoji").src.includes(status.emoji), "status emoji is correct");
      const newStatus = {
        emoji: "surfing_man",
        description: "surfing"
      };
      await (0, _qunitHelpers.publishToMessageBus)(`/user-status`, {
        [userId]: newStatus
      });
      assert.equal((0, _qunitHelpers.queryAll)(".topic-post .user-status-message").length, 3, "all posts has user status");
      assert.ok((0, _qunitHelpers.query)(".topic-post .user-status-message .emoji").src.includes(newStatus.emoji), "status emoji is correct");
    });
    (0, _qunit.test)("removing status and setting again", async function (assert) {
      this.siteSettings.enable_user_status = true;
      await (0, _testHelpers.visit)("/t/-/299/1");
      assert.equal((0, _qunitHelpers.queryAll)(".topic-post .user-status-message").length, 3, "all posts has user status");
      assert.ok((0, _qunitHelpers.query)(".topic-post .user-status-message .emoji").src.includes(status.emoji), "status emoji is correct");
      await (0, _qunitHelpers.publishToMessageBus)(`/user-status`, {
        [userId]: null
      });
      assert.notOk((0, _qunitHelpers.exists)(".topic-post .user-status-message"), "status on all posts has disappeared");
      const newStatus = {
        emoji: "surfing_man",
        description: "surfing"
      };
      await (0, _qunitHelpers.publishToMessageBus)(`/user-status`, {
        [userId]: newStatus
      });
      assert.equal((0, _qunitHelpers.queryAll)(".topic-post .user-status-message").length, 3, "all posts have user status");
      assert.ok((0, _qunitHelpers.query)(".topic-post .user-status-message .emoji").src.includes(newStatus.emoji), "status emoji is correct");
    });
  });
});
define("discourse/tests/acceptance/unknown-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "sinon"], function (_qunitHelpers, _testHelpers, _qunit, _sinon) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"sinon"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Category 404", function (needs) {
    needs.pretender((server, helper) => {
      server.get("/c/category-does-not-exist/find_by_slug.json", () => {
        return helper.response(404, {
          errors: ["The requested URL or resource could not be found."],
          error_type: "not_found",
          extras: {
            html: "<div class='page-not-found'>not found</div>"
          }
        });
      });
    });
    (0, _qunit.test)("Navigating to a bad category link does not break the router", async function (assert) {
      // Don't log the XHR error
      const stub = _sinon.default.stub(console, "error").withArgs(_sinon.default.match({
        status: 404
      }));

      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)('[data-for-test="category-404"]');
      assert.strictEqual((0, _testHelpers.currentURL)(), "/404");

      _sinon.default.assert.calledOnce(stub); // See that we can navigate away


      await (0, _testHelpers.click)("#site-logo");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/");
    });
  });
  (0, _qunitHelpers.acceptance)("Unknown", function (needs) {
    const urls = {
      "/viewtopic.php?f=8&t=280": "/t/internationalization-localization/280",
      "/another-url-for-faq": "/faq"
    };
    needs.pretender((server, helper) => {
      server.get("/permalink-check.json", request => {
        let url = urls[request.queryParams.path];

        if (url) {
          return helper.response({
            found: true,
            internal: true,
            target_url: url
          });
        } else {
          return helper.response({
            found: false,
            html: "<div class='page-not-found'>not found</div>"
          });
        }
      });
    });
    (0, _qunit.test)("Permalink Unknown URL", async function (assert) {
      await (0, _testHelpers.visit)("/url-that-doesn't-exist");
      assert.ok((0, _qunitHelpers.exists)(".page-not-found"), "The not found content is present");
    });
    (0, _qunit.test)("Permalink URL to a Topic", async function (assert) {
      await (0, _testHelpers.visit)("/viewtopic.php?f=8&t=280");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/t/internationalization-localization/280");
    });
    (0, _qunit.test)("Permalink URL to a static page", async function (assert) {
      await (0, _testHelpers.visit)("/another-url-for-faq");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/faq");
    });
  });
});
define("discourse/tests/acceptance/user-activity-all-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers", "I18n"], function (_qunitHelpers, _qunit, _testHelpers, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User Activity / All - empty state", function (needs) {
    const currentUser = "eviltrout";
    const anotherUser = "charlie";
    needs.user();
    needs.pretender((server, helper) => {
      const emptyResponse = {
        user_actions: []
      };
      server.get("/user_actions.json", () => {
        return helper.response(emptyResponse);
      });
    });
    (0, _qunit.test)("When looking at own activity page", async function (assert) {
      await (0, _testHelpers.visit)(`/u/${currentUser}/activity`);
      assert.equal((0, _qunitHelpers.query)("div.empty-state span.empty-state-title").innerText, _I18n.default.t("user_activity.no_activity_title"));
    });
    (0, _qunit.test)("When looking at another user's activity page", async function (assert) {
      await (0, _testHelpers.visit)(`/u/${anotherUser}/activity`);
      assert.equal((0, _qunitHelpers.query)("div.empty-state span.empty-state-title").innerText, _I18n.default.t("user_activity.no_activity_title")); // the same title as when looking at own page
    });
  });
});
define("discourse/tests/acceptance/user-activity-drafts-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User Activity / Drafts - empty state", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      const emptyResponse = {
        drafts: []
      };
      server.get("/drafts.json", () => {
        return helper.response(emptyResponse);
      });
    });
    (0, _qunit.test)("It renders the empty state panel", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/activity/drafts");
      assert.ok((0, _qunitHelpers.exists)("div.empty-state"));
    });
  });
});
define("discourse/tests/acceptance/user-activity-likes-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers", "I18n"], function (_qunitHelpers, _qunit, _testHelpers, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User Activity / Likes - empty state", function (needs) {
    const currentUser = "eviltrout";
    const anotherUser = "charlie";
    needs.user();
    needs.pretender((server, helper) => {
      const emptyResponse = {
        user_actions: []
      };
      server.get("/user_actions.json", () => {
        return helper.response(emptyResponse);
      });
    });
    (0, _qunit.test)("When looking at own likes page", async function (assert) {
      await (0, _testHelpers.visit)(`/u/${currentUser}/activity/likes-given`);
      assert.equal((0, _qunitHelpers.query)("div.empty-state span.empty-state-title").innerText, _I18n.default.t("user_activity.no_likes_title"));
    });
    (0, _qunit.test)("When looking at another user's likes page", async function (assert) {
      await (0, _testHelpers.visit)(`/u/${anotherUser}/activity/likes-given`);
      assert.equal((0, _qunitHelpers.query)("div.empty-state span.empty-state-title").innerText, _I18n.default.t("user_activity.no_likes_title_others", {
        username: anotherUser
      }));
    });
  });
});
define("discourse/tests/acceptance/user-activity-read-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers", "discourse/tests/fixtures/user-fixtures"], function (_qunitHelpers, _qunit, _testHelpers, _userFixtures) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers",0,"discourse/tests/fixtures/user-fixtures"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User Activity / Read - bulk actions", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/read.json", () => {
        return helper.response(_userFixtures.default["/topics/created-by/eviltrout.json"]);
      });
      server.put("/topics/bulk", () => {
        return helper.response({
          topic_ids: [7764, 9318]
        });
      });
    });
    (0, _qunit.test)("bulk topic closing works", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie/activity/read");
      await (0, _testHelpers.click)("button.bulk-select");
      await (0, _testHelpers.click)((0, _qunitHelpers.queryAll)("input.bulk-select")[0]);
      await (0, _testHelpers.click)((0, _qunitHelpers.queryAll)("input.bulk-select")[1]);
      await (0, _testHelpers.click)("button.bulk-select-actions");
      await (0, _testHelpers.click)("div.bulk-buttons button:nth-child(2)"); // the Close Topics button

      assert.notOk((0, _qunitHelpers.exists)("div.bulk-buttons"), "The bulk actions modal was closed");
    });
  });
  (0, _qunitHelpers.acceptance)("User Activity / Read - empty state", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      const emptyResponse = {
        topic_list: {
          topics: []
        }
      };
      server.get("/read.json", () => {
        return helper.response(emptyResponse);
      });
    });
    (0, _qunit.test)("It renders the empty state panel", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie/activity/read");
      assert.ok((0, _qunitHelpers.exists)("div.empty-state"));
    });
  });
});
define("discourse/tests/acceptance/user-activity-replies-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers", "I18n"], function (_qunitHelpers, _qunit, _testHelpers, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User Activity / Replies - empty state", function (needs) {
    const currentUser = "eviltrout";
    const anotherUser = "charlie";
    needs.user();
    needs.pretender((server, helper) => {
      const emptyResponse = {
        user_actions: []
      };
      server.get("/user_actions.json", () => {
        return helper.response(emptyResponse);
      });
    });
    (0, _qunit.test)("When looking at own replies page", async function (assert) {
      await (0, _testHelpers.visit)(`/u/${currentUser}/activity/replies`);
      assert.equal((0, _qunitHelpers.query)("div.empty-state span.empty-state-title").innerText, _I18n.default.t("user_activity.no_replies_title"));
    });
    (0, _qunit.test)("When looking at another user's replies page", async function (assert) {
      await (0, _testHelpers.visit)(`/u/${anotherUser}/activity/replies`);
      assert.equal((0, _qunitHelpers.query)("div.empty-state span.empty-state-title").innerText, _I18n.default.t("user_activity.no_replies_title_others", {
        username: anotherUser
      }));
    });
  });
  (0, _qunitHelpers.acceptance)("User Activity / Replies - Download All", function (needs) {
    const currentUser = "eviltrout";
    const anotherUser = "charlie";
    needs.user();
    needs.pretender((server, helper) => {
      server.post("/export_csv/export_entity.json", () => {
        return helper.response({});
      });
    });
    (0, _qunit.test)("Can see and trigger download for own data replies", async function (assert) {
      await (0, _testHelpers.visit)(`/u/${currentUser}/activity`);
      assert.ok((0, _qunitHelpers.query)(".user-additional-controls .btn"), "button exists");
      await (0, _testHelpers.click)(".user-additional-controls .btn");
      await (0, _testHelpers.click)("#dialog-holder .btn-primary");
      assert.equal((0, _qunitHelpers.query)(".dialog-body").innerText.trim(), _I18n.default.t("user.download_archive.success"));
      await (0, _testHelpers.click)("#dialog-holder .btn-primary");
    });
    (0, _qunit.test)("Cannot see 'Download All' button for another user", async function (assert) {
      await (0, _testHelpers.visit)(`/u/${anotherUser}/activity`);
      assert.notOk((0, _qunitHelpers.query)(".user-additional-controls .btn"), "download button is not present");
    });
  });
});
define("discourse/tests/acceptance/user-activity-topic-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers", "discourse/tests/fixtures/user-fixtures", "I18n"], function (_qunitHelpers, _qunit, _testHelpers, _userFixtures, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers",0,"discourse/tests/fixtures/user-fixtures",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User Activity / Topics - bulk actions", function (needs) {
    const currentUser = "eviltrout";
    needs.user();
    needs.pretender((server, helper) => {
      server.get(`/topics/created-by/${currentUser}.json`, () => {
        return helper.response(_userFixtures.default[`/topics/created-by/${currentUser}.json`]);
      });
      server.put("/topics/bulk", () => {
        return helper.response({
          topic_ids: [7764, 9318]
        });
      });
    });
    (0, _qunit.test)("bulk topic closing works", async function (assert) {
      await (0, _testHelpers.visit)(`/u/${currentUser}/activity/topics`);
      await (0, _testHelpers.click)("button.bulk-select");
      await (0, _testHelpers.click)((0, _qunitHelpers.queryAll)("input.bulk-select")[0]);
      await (0, _testHelpers.click)((0, _qunitHelpers.queryAll)("input.bulk-select")[1]);
      await (0, _testHelpers.click)("button.bulk-select-actions");
      await (0, _testHelpers.click)("div.bulk-buttons button:nth-child(2)"); // the Close Topics button

      assert.notOk((0, _qunitHelpers.exists)("div.bulk-buttons"), "The bulk actions modal was closed");
    });
  });
  (0, _qunitHelpers.acceptance)("User Activity / Topics - empty state", function (needs) {
    const currentUser = "eviltrout";
    const anotherUser = "charlie";
    needs.user();
    needs.pretender((server, helper) => {
      const emptyResponse = {
        topic_list: {
          topics: []
        }
      };
      server.get(`/topics/created-by/${currentUser}.json`, () => {
        return helper.response(emptyResponse);
      });
      server.get(`/topics/created-by/${anotherUser}.json`, () => {
        return helper.response(emptyResponse);
      });
    });
    (0, _qunit.test)("When looking at the own activity page", async function (assert) {
      await (0, _testHelpers.visit)(`/u/${currentUser}/activity/topics`);
      assert.equal((0, _qunitHelpers.query)("div.empty-state span.empty-state-title").innerText, _I18n.default.t("user_activity.no_topics_title"));
    });
    (0, _qunit.test)("When looking at another user's activity page", async function (assert) {
      await (0, _testHelpers.visit)(`/u/${anotherUser}/activity/topics`);
      assert.equal((0, _qunitHelpers.query)("div.empty-state span.empty-state-title").innerText, _I18n.default.t("user_activity.no_topics_title_others", {
        username: anotherUser
      }));
    });
  });
});
define("discourse/tests/acceptance/user-anonymous-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User Anonymous", function () {
    (0, _qunit.test)("Root URL", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout");
      assert.ok(document.body.classList.contains("user-summary-page"), "has the body class");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "user.summary", "it defaults to summary");
    });
    (0, _qunit.test)("Filters", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/activity");
      assert.ok(document.body.classList.contains("user-activity-page"), "has the body class");
      assert.ok((0, _qunitHelpers.exists)(".user-main .about"), "it has the about section");
      assert.ok((0, _qunitHelpers.exists)(".user-stream .item"), "it has stream items");
      await (0, _testHelpers.visit)("/u/eviltrout/activity/topics");
      assert.ok(!(0, _qunitHelpers.exists)(".user-stream .item"), "has no stream displayed");
      assert.ok((0, _qunitHelpers.exists)(".topic-list tr"), "it has a topic list");
      await (0, _testHelpers.visit)("/u/eviltrout/activity/replies");
      assert.ok((0, _qunitHelpers.exists)(".user-main .about"), "it has the about section");
      assert.ok((0, _qunitHelpers.exists)(".user-stream .item"), "it has stream items");
      assert.ok((0, _qunitHelpers.exists)(".user-stream.filter-5"), "stream has filter class");
    });
    (0, _qunit.test)("Badges", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/badges");
      assert.ok(document.body.classList.contains("user-badges-page"), "has the body class");
      assert.ok((0, _qunitHelpers.exists)(".badge-group-list .badge-card"), "shows a badge");
    });
    (0, _qunit.test)("Restricted Routes", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/u/eviltrout/activity", "it redirects from preferences");
    });
  });
});
define("discourse/tests/acceptance/user-bookmarks-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse-common/lib/object", "discourse/tests/helpers/select-kit-helper", "qunit", "discourse/tests/fixtures/user-fixtures"], function (_qunitHelpers, _testHelpers, _object, _selectKitHelper, _qunit, _userFixtures) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse-common/lib/object",0,"discourse/tests/helpers/select-kit-helper",0,"qunit",0,"discourse/tests/fixtures/user-fixtures"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User's bookmarks", function (needs) {
    needs.user();
    (0, _qunit.test)("removing a bookmark with no reminder does not show a confirmation", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/activity/bookmarks");
      assert.ok((0, _qunitHelpers.exists)(".bookmark-list-item"));
      const dropdown = (0, _selectKitHelper.default)(".bookmark-actions-dropdown:nth-of-type(1)");
      await dropdown.expand();
      await dropdown.selectRowByValue("remove");
      assert.notOk((0, _qunitHelpers.exists)(".bootbox.modal"), "it should not show the modal");
    });
    (0, _qunit.test)("it renders search controls if there are bookmarks", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/activity/bookmarks");
      assert.ok((0, _qunitHelpers.exists)("div.bookmark-search-form"));
    });
  });
  (0, _qunitHelpers.acceptance)("User's bookmarks - reminder", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/u/eviltrout/bookmarks.json", () => {
        let json = (0, _object.cloneJSON)(_userFixtures.default["/u/eviltrout/bookmarks.json"]);
        json.user_bookmark_list.bookmarks[0].reminder_at = "2028-01-01T08:00";
        return helper.response(json);
      });
      server.put("/bookmarks/:id", () => {
        return helper.response({});
      });
    });
    (0, _qunit.test)("removing a bookmark with a reminder shows a confirmation", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/activity/bookmarks");
      const dropdown = (0, _selectKitHelper.default)(".bookmark-actions-dropdown");
      await dropdown.expand();
      await dropdown.selectRowByValue("remove");
      assert.ok((0, _qunitHelpers.exists)(".bootbox.modal"), "it asks for delete confirmation");
      await (0, _testHelpers.click)(".bootbox.modal a.btn-primary");
      assert.notOk((0, _qunitHelpers.exists)(".bootbox.modal"));
    });
    (0, _qunit.test)("bookmarks with reminders have a clear reminder option", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/activity/bookmarks");
      assert.strictEqual((0, _qunitHelpers.count)(".bookmark-reminder"), 2);
      const dropdown = (0, _selectKitHelper.default)(".bookmark-actions-dropdown");
      await dropdown.expand();
      await dropdown.selectRowByValue("clear_reminder");
      assert.strictEqual((0, _qunitHelpers.count)(".bookmark-reminder"), 1);
    });
  });
  (0, _qunitHelpers.acceptance)("User's bookmarks - no bookmarks", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/u/eviltrout/bookmarks.json", () => helper.response({
        bookmarks: []
      }));
    });
    (0, _qunit.test)("listing users bookmarks - no bookmarks", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/activity/bookmarks");
      assert.notOk((0, _qunitHelpers.exists)("div.bookmark-search-form"), "does not render search controls");
      assert.ok((0, _qunitHelpers.exists)("div.empty-state", "renders the empty-state message"));
    });
  });
});
define("discourse/tests/acceptance/user-card-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/models/user", "qunit", "discourse/tests/fixtures/user-fixtures", "discourse-common/lib/object"], function (_qunitHelpers, _testHelpers, _user, _qunit, _userFixtures, _object) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/models/user",0,"qunit",0,"discourse/tests/fixtures/user-fixtures",0,"discourse-common/lib/object"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User Card - Show Local Time", function (needs) {
    needs.user();
    needs.settings({
      display_local_time_in_user_card: true
    });
    needs.pretender((server, helper) => {
      const cardResponse = (0, _object.cloneJSON)(_userFixtures.default["/u/charlie/card.json"]);
      delete cardResponse.user.timezone;
      server.get("/u/charlie/card.json", () => helper.response(cardResponse));
    });
    (0, _qunit.test)("user card local time - does not update timezone for another user", async function (assert) {
      _user.default.current().timezone = "Australia/Brisbane";
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)('a[data-user-card="charlie"]');
      assert.notOk((0, _qunitHelpers.exists)(".user-card .local-time"), "it does not show the local time if the user card returns a null/undefined timezone for another user");
    });
  });
  (0, _qunitHelpers.acceptance)("User Card - when 'prioritize username in ux' is enabled", function (needs) {
    needs.user();
    needs.settings({
      prioritize_username_in_ux: true
    });
    needs.pretender((server, helper) => {
      const cardResponse = (0, _object.cloneJSON)(_userFixtures.default["/u/eviltrout/card.json"]);
      server.get("/u/eviltrout/card.json", () => helper.response(cardResponse));
    });
    (0, _qunit.test)("it displays the person's username followed by ther fullname", async function (assert) {
      await (0, _testHelpers.visit)("/t/this-is-a-test-topic/9");
      await (0, _testHelpers.click)('a[data-user-card="eviltrout"]');
      assert.equal((0, _qunitHelpers.query)(".user-card h1.username .name-username-wrapper").innerText, "eviltrout");
      assert.equal((0, _qunitHelpers.query)(".user-card h2.full-name").innerText, "Robin Ward");
    });
  });
  (0, _qunitHelpers.acceptance)("User Card - when 'prioritize username in ux' is disabled", function (needs) {
    needs.user();
    needs.settings({
      prioritize_username_in_ux: false
    });
    needs.pretender((server, helper) => {
      const cardResponse = (0, _object.cloneJSON)(_userFixtures.default["/u/eviltrout/card.json"]);
      server.get("/u/eviltrout/card.json", () => helper.response(cardResponse));
    });
    (0, _qunit.test)("it displays the person's fullname followed by their username", async function (assert) {
      await (0, _testHelpers.visit)("/t/this-is-a-test-topic/9");
      await (0, _testHelpers.click)('a[data-user-card="eviltrout"]');
      assert.equal((0, _qunitHelpers.query)(".user-card h1.full-name .name-username-wrapper").innerText, "Robin Ward");
      assert.equal((0, _qunitHelpers.query)(".user-card h2.username").innerText, "eviltrout");
    });
  });
  (0, _qunitHelpers.acceptance)("User Card - User Status", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      const response = (0, _object.cloneJSON)(_userFixtures.default["/u/charlie/card.json"]);
      response.user.status = {
        description: "off to dentist"
      };
      server.get("/u/charlie/card.json", () => helper.response(response));
    });
    (0, _qunit.test)("shows user status if enabled", async function (assert) {
      this.siteSettings.enable_user_status = true;
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)('a[data-user-card="charlie"]');
      assert.ok((0, _qunitHelpers.exists)(".user-card h3.user-status"));
    });
    (0, _qunit.test)("doesn't show user status if disabled", async function (assert) {
      this.siteSettings.enable_user_status = false;
      await (0, _testHelpers.visit)("/t/internationalization-localization/280");
      await (0, _testHelpers.click)('a[data-user-card="charlie"]');
      assert.notOk((0, _qunitHelpers.exists)(".user-card h3.user-status"));
    });
  });
});
define("discourse/tests/acceptance/user-drafts-stream-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "pretty-text/emoji/version"], function (_qunitHelpers, _testHelpers, _qunit, _version) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"pretty-text/emoji/version"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User Drafts", function (needs) {
    needs.user();
    (0, _qunit.test)("Stream", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/activity/drafts");
      assert.strictEqual((0, _qunitHelpers.count)(".user-stream-item"), 3, "has drafts");
      await (0, _testHelpers.click)(".user-stream-item:first-child .remove-draft");
      assert.ok((0, _qunitHelpers.visible)(".bootbox"));
      await (0, _testHelpers.click)(".bootbox .btn-primary");
      assert.strictEqual((0, _qunitHelpers.count)(".user-stream-item"), 2, "draft removed, list length diminished by one");
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.visible)("#create-topic"));
      assert.ok(!(0, _qunitHelpers.exists)("#create-topic.open-draft"), "Open Draft button is not present");
    });
    (0, _qunit.test)("Stream - resume draft", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/activity/drafts");
      assert.ok((0, _qunitHelpers.exists)(".user-stream-item"), "has drafts");
      await (0, _testHelpers.click)(".user-stream-item .resume-draft");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-input").value.trim(), "A fun new topic for testing drafts.");
    });
    (0, _qunit.test)("Stream - has excerpt", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/activity/drafts");
      assert.ok((0, _qunitHelpers.exists)(".user-stream-item"), "has drafts");
      assert.strictEqual((0, _qunitHelpers.query)(".user-stream-item:nth-child(3) .category").textContent, "meta");
      assert.strictEqual((0, _qunitHelpers.normalizeHtml)((0, _qunitHelpers.query)(".user-stream-item:nth-child(3) .excerpt").innerHTML.trim()), (0, _qunitHelpers.normalizeHtml)(`here goes a reply to a PM <img src="/images/emoji/google_classic/slight_smile.png?v=${_version.IMAGE_VERSION}" title=":slight_smile:" class="emoji" alt=":slight_smile:" loading="lazy" width="20" height="20" style="aspect-ratio: 20 / 20;">`), "shows the excerpt");
    });
  });
});
define("discourse/tests/acceptance/user-menu-test", ["@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "qunit", "discourse-common/lib/object", "discourse/lib/plugin-api", "discourse/tests/fixtures/concerns/notification-types", "discourse/tests/fixtures/user-menu", "discourse/tests/fixtures/topic", "rsvp", "@ember/runloop", "I18n"], function (_testHelpers, _qunitHelpers, _qunit, _object, _pluginApi, _notificationTypes, _userMenu, _topic, _rsvp, _runloop, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"discourse-common/lib/object",0,"discourse/lib/plugin-api",0,"discourse/tests/fixtures/concerns/notification-types",0,"discourse/tests/fixtures/user-menu",0,"discourse/tests/fixtures/topic",0,"rsvp",0,"@ember/runloop",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User menu", function (needs) {
    needs.user({
      redesigned_user_menu_enabled: true,
      unread_high_priority_notifications: 73,
      trust_level: 3,
      grouped_unread_notifications: {
        [_notificationTypes.NOTIFICATION_TYPES.replied]: 2
      }
    });
    needs.settings({
      allow_anonymous_posting: true,
      anonymous_posting_min_trust_level: 3
    });
    let requestHeaders = {};
    needs.pretender((server, helper) => {
      server.get("/t/1234.json", request => {
        const json = (0, _object.cloneJSON)(_topic.default["/t/130.json"]);
        json.id = 1234;
        json.post_stream.posts.forEach(post => {
          post.topic_id = 1234;
        });
        requestHeaders = request.requestHeaders;
        return helper.response(json);
      });
    });
    needs.hooks.afterEach(() => {
      requestHeaders = {};
    });
    (0, _qunit.test)("clicking on an unread notification", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".d-header-icons .current-user");
      let repliesBadgeNotification = (0, _qunitHelpers.query)("#user-menu-button-replies .badge-notification");
      assert.strictEqual(repliesBadgeNotification.textContent.trim(), "2", "badge shows the right count");
      await (0, _testHelpers.click)(".user-menu ul li.replied a");
      assert.strictEqual(requestHeaders["Discourse-Clear-Notifications"], 123, // id is from the fixtures in fixtures/notification-fixtures.js
      "the Discourse-Clear-Notifications request header is set to the notification id in the next ajax request");
      await (0, _testHelpers.click)(".d-header-icons .current-user");
      repliesBadgeNotification = (0, _qunitHelpers.query)("#user-menu-button-replies .badge-notification");
      assert.strictEqual(repliesBadgeNotification.textContent.trim(), "1", "badge shows count reduced by one");
    });
    (0, _qunit.test)("tabs added via the plugin API", async function (assert) {
      (0, _pluginApi.withPluginApi)("0.1", api => {
        api.registerUserMenuTab(UserMenuTab => {
          return class extends UserMenuTab {
            get id() {
              return "custom-tab-1";
            }

            get count() {
              return this.currentUser.get("unread_high_priority_notifications");
            }

            get icon() {
              return "wrench";
            }

            get panelComponent() {
              return "d-button";
            }

          };
        });
        api.registerUserMenuTab(UserMenuTab => {
          return class extends UserMenuTab {
            get id() {
              return "custom-tab-2";
            }

            get count() {
              return 29;
            }

            get icon() {
              return "plus";
            }

            get panelComponent() {
              return "d-button";
            }

          };
        });
      });
      const expectedTabOrder = {
        "user-menu-button-all-notifications": "0",
        "user-menu-button-replies": "1",
        "user-menu-button-mentions": "2",
        "user-menu-button-likes": "3",
        "user-menu-button-messages": "4",
        "user-menu-button-bookmarks": "5",
        "user-menu-button-custom-tab-1": "6",
        "user-menu-button-custom-tab-2": "7",
        "user-menu-button-review-queue": "8",
        "user-menu-button-other": "9"
      };
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".d-header-icons .current-user");
      assert.ok((0, _qunitHelpers.exists)("#user-menu-button-custom-tab-1"), "first custom tab is rendered");
      assert.ok((0, _qunitHelpers.exists)("#user-menu-button-custom-tab-2"), "second custom tab is rendered");
      const tabs = [...(0, _qunitHelpers.queryAll)(".tabs-list.top-tabs .btn")];
      assert.deepEqual(tabs.reduce((acc, tab) => {
        acc[tab.id] = tab.dataset.tabNumber;
        return acc;
      }, {}), expectedTabOrder, "data-tab-number of the tabs has no gaps when custom tabs are added and the tabs are in the right order");
      assert.strictEqual((0, _qunitHelpers.query)(".tabs-list.bottom-tabs .btn").dataset.tabNumber, "10", "bottom tab has the correct data-tab-number");
      let customTab1Bubble = (0, _qunitHelpers.query)("#user-menu-button-custom-tab-1 .badge-notification");
      assert.strictEqual(customTab1Bubble.textContent.trim(), "73", "bubble shows the right count");
      const customTab2Bubble = (0, _qunitHelpers.query)("#user-menu-button-custom-tab-2 .badge-notification");
      assert.strictEqual(customTab2Bubble.textContent.trim(), "29", "bubble shows the right count");
      await (0, _qunitHelpers.publishToMessageBus)(`/notification/${(0, _qunitHelpers.loggedInUser)().id}`, {
        unread_high_priority_notifications: 18
      });
      customTab1Bubble = (0, _qunitHelpers.query)("#user-menu-button-custom-tab-1 .badge-notification");
      assert.strictEqual(customTab1Bubble.textContent.trim(), "18", "displayed bubble count updates when the value is changed");
      await (0, _testHelpers.click)("#user-menu-button-custom-tab-1");
      assert.ok((0, _qunitHelpers.exists)("#user-menu-button-custom-tab-1.active"), "custom tabs can be clicked on and become active");
      assert.ok((0, _qunitHelpers.exists)("#quick-access-custom-tab-1 button.btn"), "the tab's content is now displayed in the panel");
    });
    (0, _qunit.test)("notifications tab applies model transformations registered by plugins", async function (assert) {
      (0, _pluginApi.withPluginApi)("0.1", api => {
        api.registerModelTransformer("notification", notifications => {
          notifications.forEach((notification, index) => {
            if (notification.fancy_title) {
              notification.fancy_title = `pluginNotificationTransformer ${index} ${notification.fancy_title}`;
            }
          });
        });
      });
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".d-header-icons .current-user");
      const notifications = (0, _qunitHelpers.queryAll)("#quick-access-all-notifications ul li.notification");
      assert.strictEqual(notifications[0].textContent.replace(/\s+/g, " ").trim(), "velesin pluginNotificationTransformer 0 edited topic 443");
      assert.strictEqual(notifications[1].textContent.replace(/\s+/g, " ").trim(), "velesin pluginNotificationTransformer 1 some title");
    });
    (0, _qunit.test)("bookmarks tab applies model transformations registered by plugins", async function (assert) {
      (0, _pluginApi.withPluginApi)("0.1", api => {
        api.registerModelTransformer("bookmark", bookmarks => {
          bookmarks.forEach(bookmark => {
            if (bookmark.title) {
              bookmark.title = `pluginBookmarkTransformer ${bookmark.title}`;
            }
          });
        });
      });
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".d-header-icons .current-user");
      await (0, _testHelpers.click)("#user-menu-button-bookmarks");
      const bookmarks = (0, _qunitHelpers.queryAll)("#quick-access-bookmarks ul li.bookmark");
      assert.strictEqual(bookmarks[0].textContent.replace(/\s+/g, " ").trim(), "osama pluginBookmarkTransformer Test poll topic hello world");
    });
    (0, _qunit.test)("messages tab applies model transformations registered by plugins", async function (assert) {
      (0, _pluginApi.withPluginApi)("0.1", api => {
        api.registerModelTransformer("topic", topics => {
          topics.forEach(topic => {
            topic.fancy_title = `pluginTransformer#1 ${topic.fancy_title}`;
          });
        });
        api.registerModelTransformer("topic", async topics => {
          // sleep 1 ms
          await new _rsvp.Promise(resolve => (0, _runloop.later)(resolve, 1));
          topics.forEach(topic => {
            topic.fancy_title = `pluginTransformer#2 ${topic.fancy_title}`;
          });
        });
      });
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".d-header-icons .current-user");
      await (0, _testHelpers.click)("#user-menu-button-messages");
      const messages = (0, _qunitHelpers.queryAll)("#quick-access-messages ul li.message");
      assert.strictEqual(messages[0].textContent.replace(/\s+/g, " ").trim(), "mixtape pluginTransformer#2 pluginTransformer#1 BUG: Can not render emoji properly");
    });
    (0, _qunit.test)("the profile tab", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        draft_count: 13
      });
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".d-header-icons .current-user");
      await (0, _testHelpers.click)("#user-menu-button-profile");
      const summaryLink = (0, _qunitHelpers.query)("#quick-access-profile ul li.summary a");
      assert.ok(summaryLink.href.endsWith("/u/eviltrout/summary"), "has a link to the summary page of the user");
      assert.strictEqual(summaryLink.textContent.trim(), _I18n.default.t("user.summary.title"), "summary link has the right label");
      assert.ok(summaryLink.querySelector(".d-icon-user"), "summary link has the right icon");
      const activityLink = (0, _qunitHelpers.query)("#quick-access-profile ul li.activity a");
      assert.ok(activityLink.href.endsWith("/u/eviltrout/activity"), "has a link to the activity page of the user");
      assert.strictEqual(activityLink.textContent.trim(), _I18n.default.t("user.activity_stream"), "activity link has the right label");
      assert.ok(activityLink.querySelector(".d-icon-stream"), "activity link has the right icon");
      const invitesLink = (0, _qunitHelpers.query)("#quick-access-profile ul li.invites a");
      assert.ok(invitesLink.href.endsWith("/u/eviltrout/invited"), "has a link to the invites page of the user");
      assert.strictEqual(invitesLink.textContent.trim(), _I18n.default.t("user.invited.title"), "invites link has the right label");
      assert.ok(invitesLink.querySelector(".d-icon-user-plus"), "invites link has the right icon");
      await (0, _testHelpers.click)("header.d-header"); // close the menu

      (0, _qunitHelpers.updateCurrentUser)({
        can_invite_to_forum: false
      });
      await (0, _testHelpers.click)(".d-header-icons .current-user");
      await (0, _testHelpers.click)("#user-menu-button-profile");
      assert.notOk((0, _qunitHelpers.exists)("#quick-access-profile ul li.invites"), "invites link not shown when the user can't invite");
      const dratsLink = (0, _qunitHelpers.query)("#quick-access-profile ul li.drafts a");
      assert.ok(dratsLink.href.endsWith("/u/eviltrout/activity/drafts"), "has a link to the drafts page of the user");
      assert.strictEqual(dratsLink.textContent.trim(), _I18n.default.t("drafts.label_with_count", {
        count: 13
      }), "drafts link has the right label with count of the user's drafts");
      assert.ok(dratsLink.querySelector(".d-icon-pencil-alt"), "drafts link has the right icon");
      const preferencesLink = (0, _qunitHelpers.query)("#quick-access-profile ul li.preferences a");
      assert.ok(preferencesLink.href.endsWith("/u/eviltrout/preferences"), "has a link to the preferences page of the user");
      assert.strictEqual(preferencesLink.textContent.trim(), _I18n.default.t("user.preferences"), "preferences link has the right label");
      assert.ok(preferencesLink.querySelector(".d-icon-cog"), "preferences link has the right icon");
      let doNotDisturbButton = (0, _qunitHelpers.query)("#quick-access-profile ul li.do-not-disturb .btn");
      assert.strictEqual(doNotDisturbButton.textContent.replaceAll(/\s+/g, " ").replaceAll(/\u200B/g, "").trim(), _I18n.default.t("do_not_disturb.label"), "Do Not Disturb button has the right label");
      assert.ok(doNotDisturbButton.querySelector(".d-icon-toggle-off"), "Do Not Disturb button has the right icon");
      await (0, _testHelpers.click)("header.d-header"); // close the menu

      const date = new Date();
      date.setHours(date.getHours() + 2);
      (0, _qunitHelpers.updateCurrentUser)({
        do_not_disturb_until: date.toISOString()
      });
      await (0, _testHelpers.click)(".d-header-icons .current-user");
      await (0, _testHelpers.click)("#user-menu-button-profile");
      doNotDisturbButton = (0, _qunitHelpers.query)("#quick-access-profile ul li.do-not-disturb .btn");
      assert.strictEqual(doNotDisturbButton.textContent.replaceAll(/\s+/g, " ").replaceAll(/\u200B/g, "").trim(), `${_I18n.default.t("do_not_disturb.label")} 2h`, "Do Not Disturb button has the right label when Do Not Disturb is enabled");
      assert.ok(doNotDisturbButton.querySelector(".d-icon-toggle-on"), "Do Not Disturb button has the right icon when Do Not Disturb is enabled");
      let toggleAnonButton = (0, _qunitHelpers.query)("#quick-access-profile ul li.enable-anonymous .btn");
      assert.strictEqual(toggleAnonButton.textContent.replaceAll(/\s+/g, " ").replaceAll(/\u200B/g, "").trim(), _I18n.default.t("switch_to_anon"), "toggle anonymous button has the right label when the user isn't anonymous");
      assert.ok(toggleAnonButton.querySelector(".d-icon-user-secret"), "toggle anonymous button has the right icon when the user isn't anonymous");
      await (0, _testHelpers.click)("header.d-header"); // close the menu

      (0, _qunitHelpers.updateCurrentUser)({
        is_anonymous: true
      });
      await (0, _testHelpers.click)(".d-header-icons .current-user");
      await (0, _testHelpers.click)("#user-menu-button-profile");
      toggleAnonButton = (0, _qunitHelpers.query)("#quick-access-profile ul li.disable-anonymous .btn");
      assert.strictEqual(toggleAnonButton.textContent.replaceAll(/\s+/g, " ").replaceAll(/\u200B/g, "").trim(), _I18n.default.t("switch_from_anon"), "toggle anonymous button has the right label when the user is anonymous");
      assert.ok(toggleAnonButton.querySelector(".d-icon-ban"), "toggle anonymous button has the right icon when the user is anonymous");
      await (0, _testHelpers.click)("header.d-header"); // close the menu

      (0, _qunitHelpers.updateCurrentUser)({
        is_anonymous: false,
        trust_level: 2
      });
      await (0, _testHelpers.click)(".d-header-icons .current-user");
      await (0, _testHelpers.click)("#user-menu-button-profile");
      assert.notOk((0, _qunitHelpers.exists)("#quick-access-profile ul li.enable-anonymous"), "toggle anon button isn't shown when the user can't use it");
      assert.notOk((0, _qunitHelpers.exists)("#quick-access-profile ul li.disable-anonymous"), "toggle anon button isn't shown when the user can't use it");
      await (0, _testHelpers.click)("header.d-header"); // close the menu

      (0, _qunitHelpers.updateCurrentUser)({
        is_anonymous: true,
        trust_level: 2
      });
      this.siteSettings.allow_anonymous_posting = false;
      this.siteSettings.anonymous_posting_min_trust_level = 3;
      await (0, _testHelpers.click)(".d-header-icons .current-user");
      await (0, _testHelpers.click)("#user-menu-button-profile");
      assert.ok((0, _qunitHelpers.exists)("#quick-access-profile ul li.disable-anonymous"), "toggle anon button is always shown if the user is anonymous");
      await (0, _testHelpers.click)("header.d-header"); // close the menu

      (0, _qunitHelpers.updateCurrentUser)({
        is_anonymous: false,
        trust_level: 4
      });
      this.siteSettings.allow_anonymous_posting = false;
      this.siteSettings.anonymous_posting_min_trust_level = 3;
      await (0, _testHelpers.click)(".d-header-icons .current-user");
      await (0, _testHelpers.click)("#user-menu-button-profile");
      assert.notOk((0, _qunitHelpers.exists)("#quick-access-profile ul li.enable-anonymous"), "toggle anon button is not shown if the allow_anonymous_posting setting is false");
      await (0, _testHelpers.click)("header.d-header"); // close the menu

      (0, _qunitHelpers.updateCurrentUser)({
        is_anonymous: false,
        trust_level: 2
      });
      this.siteSettings.allow_anonymous_posting = true;
      this.siteSettings.anonymous_posting_min_trust_level = 3;
      await (0, _testHelpers.click)(".d-header-icons .current-user");
      await (0, _testHelpers.click)("#user-menu-button-profile");
      assert.notOk((0, _qunitHelpers.exists)("#quick-access-profile ul li.enable-anonymous"), "toggle anon button is not shown if the user doesn't have a high enough trust level");
      const logoutButton = (0, _qunitHelpers.query)("#quick-access-profile ul li.logout .btn");
      assert.strictEqual(logoutButton.textContent.replaceAll(/\s+/g, " ").replaceAll(/\u200B/g, "").trim(), _I18n.default.t("user.log_out"), "logout button has the right label");
      assert.ok(logoutButton.querySelector(".d-icon-sign-out-alt"), "logout button has the right icon");
    });
  });
  (0, _qunitHelpers.acceptance)("User menu - Dismiss button", function (needs) {
    needs.user({
      redesigned_user_menu_enabled: true,
      unread_high_priority_notifications: 10,
      grouped_unread_notifications: {
        [_notificationTypes.NOTIFICATION_TYPES.bookmark_reminder]: 103,
        [_notificationTypes.NOTIFICATION_TYPES.private_message]: 89,
        [_notificationTypes.NOTIFICATION_TYPES.votes_released]: 1,
        [_notificationTypes.NOTIFICATION_TYPES.code_review_commit_approved]: 3
      }
    });
    let markRead = false;
    let markReadRequestBody;
    needs.pretender((server, helper) => {
      server.put("/notifications/mark-read", request => {
        markReadRequestBody = request.requestBody;
        markRead = true;
        return helper.response({
          success: true
        });
      });
      server.get("/u/eviltrout/user-menu-bookmarks", () => {
        if (markRead) {
          const copy = (0, _object.cloneJSON)(_userMenu.default["/u/:username/user-menu-bookmarks"]);
          copy.notifications = [];
          return helper.response(copy);
        } else {
          return helper.response(_userMenu.default["/u/:username/user-menu-bookmarks"]);
        }
      });
      server.get("/u/eviltrout/user-menu-private-messages", () => {
        if (markRead) {
          const copy = (0, _object.cloneJSON)(_userMenu.default["/u/:username/user-menu-private-messages"]);
          copy.notifications = [];
          return helper.response(copy);
        } else {
          return helper.response(_userMenu.default["/u/:username/user-menu-private-messages"]);
        }
      });
    });
    needs.hooks.afterEach(() => {
      markRead = false;
      markReadRequestBody = null;
    });
    (0, _qunit.test)("shows confirmation modal for the all-notifications list", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".d-header-icons .current-user");
      await (0, _testHelpers.click)(".user-menu .notifications-dismiss");
      assert.strictEqual((0, _qunitHelpers.query)(".dismiss-notification-confirmation").textContent.trim(), _I18n.default.t("notifications.dismiss_confirmation.body.default", {
        count: 10
      }), "confirmation modal is shown when there are unread high pri notifications");
      await (0, _testHelpers.click)(".modal-footer .btn-default"); // click cancel on the dismiss modal

      assert.notOk(markRead, "mark-read request isn't sent");
      await (0, _testHelpers.click)(".user-menu .notifications-dismiss");
      await (0, _testHelpers.click)(".modal-footer .btn-primary"); // click confirm on the dismiss modal

      assert.ok(markRead, "mark-read request is sent");
    });
    (0, _qunit.test)("shows confirmation modal for the bookmarks list", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".d-header-icons .current-user");
      assert.strictEqual((0, _qunitHelpers.query)("#user-menu-button-bookmarks .badge-notification").textContent, "103", "bookmarks tab has bubble with count");
      await (0, _testHelpers.click)("#user-menu-button-bookmarks");
      assert.ok((0, _qunitHelpers.exists)("#quick-access-bookmarks ul li.notification"), "bookmark reminder notifications are visible");
      assert.ok((0, _qunitHelpers.exists)("#quick-access-bookmarks ul li.bookmark"), "bookmarks are visible");
      await (0, _testHelpers.click)(".user-menu .notifications-dismiss");
      assert.strictEqual((0, _qunitHelpers.query)(".dismiss-notification-confirmation").textContent.trim(), _I18n.default.t("notifications.dismiss_confirmation.body.bookmarks", {
        count: 103
      }), "confirmation modal is shown when there are unread bookmark reminder notifications");
      assert.notOk(markRead, "mark-read request isn't sent");
      await (0, _testHelpers.click)(".modal-footer .btn-primary"); // confirm dismiss on the dismiss modal

      assert.notOk((0, _qunitHelpers.exists)("#quick-access-bookmarks ul li.notification"), "bookmark reminder notifications are gone");
      assert.ok((0, _qunitHelpers.exists)("#quick-access-bookmarks ul li.bookmark"), "bookmarks are still visible");
      assert.notOk((0, _qunitHelpers.exists)("#user-menu-button-bookmarks .badge-notification"), "bookmarks tab no longer has bubble");
      assert.ok(markRead, "mark-read request is sent");
      assert.strictEqual(markReadRequestBody, "dismiss_types=bookmark_reminder", "mark-read request specifies bookmark_reminder types");
      assert.notOk((0, _qunitHelpers.exists)(".user-menu .notifications-dismiss"));
    });
    (0, _qunit.test)("shows confirmation modal for the messages list", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".d-header-icons .current-user");
      assert.strictEqual((0, _qunitHelpers.query)("#user-menu-button-messages .badge-notification").textContent, "89", "messages tab has bubble with count");
      await (0, _testHelpers.click)("#user-menu-button-messages");
      assert.ok((0, _qunitHelpers.exists)("#quick-access-messages ul li.notification"), "messages notifications are visible");
      assert.ok((0, _qunitHelpers.exists)("#quick-access-messages ul li.message"), "messages are visible");
      await (0, _testHelpers.click)(".user-menu .notifications-dismiss");
      assert.strictEqual((0, _qunitHelpers.query)(".dismiss-notification-confirmation").textContent.trim(), _I18n.default.t("notifications.dismiss_confirmation.body.messages", {
        count: 89
      }), "confirmation modal is shown when there are unread messages notifications");
      assert.notOk(markRead, "mark-read request isn't sent");
      await (0, _testHelpers.click)(".modal-footer .btn-primary"); // confirm dismiss on the dismiss modal

      assert.notOk((0, _qunitHelpers.exists)("#quick-access-messages ul li.notification"), "messages notifications are gone");
      assert.ok((0, _qunitHelpers.exists)("#quick-access-messages ul li.message"), "messages are still visible");
      assert.notOk((0, _qunitHelpers.exists)("#user-menu-button-messages .badge-notification"), "messages tab no longer has bubble");
      assert.ok(markRead, "mark-read request is sent");
      assert.strictEqual(markReadRequestBody, "dismiss_types=private_message", "mark-read request specifies private_message types");
      assert.notOk((0, _qunitHelpers.exists)(".user-menu .notifications-dismiss"));
    });
    (0, _qunit.test)("doesn't show confirmation modal for the likes notifications list", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".d-header-icons .current-user");
      await (0, _testHelpers.click)("#user-menu-button-likes");
      await (0, _testHelpers.click)(".user-menu .notifications-dismiss");
      assert.ok(markRead, "mark-read request is sent without a confirmation modal");
    });
    (0, _qunit.test)("doesn't show confirmation modal for the other notifications list", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".d-header-icons .current-user");
      await (0, _testHelpers.click)("#user-menu-button-other");
      let repliesBadgeNotification = (0, _qunitHelpers.query)("#user-menu-button-other .badge-notification");
      assert.strictEqual(repliesBadgeNotification.textContent.trim(), "4", "badge shows the right count");
      await (0, _testHelpers.click)(".user-menu .notifications-dismiss");
      assert.ok(!(0, _qunitHelpers.exists)("#user-menu-button-other .badge-notification"));
      assert.ok(markRead, "mark-read request is sent without a confirmation modal");
    });
  });
});
define("discourse/tests/acceptance/user-preferences-account-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "discourse/lib/url", "I18n", "sinon"], function (_qunitHelpers, _testHelpers, _qunit, _url, _I18n, _sinon) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"discourse/lib/url",0,"I18n",0,"sinon"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User Profile - Account - Self Delete", function (needs) {
    needs.user({
      username: "charlie"
    });
    needs.pretender((server, helper) => {
      server.delete("/u/charlie.json", () => helper.response({
        success: true
      }));
    });
    (0, _qunit.test)("Delete dialog", async function (assert) {
      _sinon.default.stub(_url.default, "redirectAbsolute");

      await (0, _testHelpers.visit)("/u/charlie/preferences/account");
      await (0, _testHelpers.click)(".delete-account .btn-danger");
      await (0, _testHelpers.click)(".dialog-footer .btn-danger");
      assert.strictEqual((0, _qunitHelpers.query)(".dialog-body").textContent.trim(), _I18n.default.t("user.deleted_yourself"), "confirmation dialog is shown");
      await (0, _testHelpers.click)(".dialog-footer .btn-primary");
      assert.ok(_url.default.redirectAbsolute.calledWith("/"), "redirects to home after deleting");
    });
  });
});
define("discourse/tests/acceptance/user-preferences-interface-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/lib/cookie", "I18n", "discourse/models/session", "discourse/models/site", "discourse/tests/helpers/select-kit-helper", "qunit", "discourse/tests/fixtures/user-fixtures"], function (_qunitHelpers, _testHelpers, _cookie, _I18n, _session, _site, _selectKitHelper, _qunit, _userFixtures) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/lib/cookie",0,"I18n",0,"discourse/models/session",0,"discourse/models/site",0,"discourse/tests/helpers/select-kit-helper",0,"qunit",0,"discourse/tests/fixtures/user-fixtures"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User Preferences - Interface", function (needs) {
    needs.user();
    (0, _qunit.test)("font size change", async function (assert) {
      (0, _cookie.removeCookie)("text_size");

      const savePreferences = async () => {
        assert.ok(!(0, _qunitHelpers.exists)(".saved"), "it hasn't been saved yet");
        await (0, _testHelpers.click)(".save-changes");
        assert.ok((0, _qunitHelpers.exists)(".saved"), "it displays the saved message");
        (0, _qunitHelpers.query)(".saved").remove();
      };

      await (0, _testHelpers.visit)("/u/eviltrout/preferences/interface"); // Live changes without reload

      const textSize = (0, _selectKitHelper.default)(".text-size .combo-box");
      await textSize.expand();
      await textSize.selectRowByValue("larger");
      assert.ok(document.documentElement.classList.contains("text-size-larger"));
      await textSize.expand();
      await textSize.selectRowByValue("largest");
      assert.ok(document.documentElement.classList.contains("text-size-largest"));
      assert.strictEqual((0, _cookie.default)("text_size"), undefined, "cookie is not set"); // Click save (by default this sets for all browsers, no cookie)

      await savePreferences();
      assert.strictEqual((0, _cookie.default)("text_size"), undefined, "cookie is not set");
      await textSize.expand();
      await textSize.selectRowByValue("larger");
      await (0, _testHelpers.click)(".text-size input[type=checkbox]");
      await savePreferences();
      assert.strictEqual((0, _cookie.default)("text_size"), "larger|1", "cookie is set");
      await (0, _testHelpers.click)(".text-size input[type=checkbox]");
      await textSize.expand();
      await textSize.selectRowByValue("largest");
      await savePreferences();
      assert.strictEqual((0, _cookie.default)("text_size"), undefined, "cookie is removed");
      (0, _cookie.removeCookie)("text_size");
    });
    (0, _qunit.test)("does not show option to disable dark mode by default", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/interface");
      assert.ok(!(0, _qunitHelpers.exists)(".control-group.dark-mode"), "option not visible");
    });
    (0, _qunit.test)("shows light/dark color scheme pickers", async function (assert) {
      let site = _site.default.current();

      site.set("user_color_schemes", [{
        id: 2,
        name: "Cool Breeze"
      }, {
        id: 3,
        name: "Dark Night",
        is_dark: true
      }]);
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/interface");
      assert.ok((0, _qunitHelpers.exists)(".light-color-scheme"), "has regular dropdown");
      assert.ok((0, _qunitHelpers.exists)(".dark-color-scheme"), "has dark color scheme dropdown");
    });
    (0, _qunit.test)("shows light color scheme default option when theme's color scheme is not user selectable", async function (assert) {
      let site = _site.default.current();

      site.set("user_themes", [{
        theme_id: 1,
        name: "Cool Theme",
        color_scheme_id: null
      }]);
      site.set("user_color_schemes", [{
        id: 2,
        name: "Cool Breeze"
      }]);
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/interface");
      assert.ok((0, _qunitHelpers.exists)(".light-color-scheme"), "has regular dropdown");
      assert.strictEqual((0, _selectKitHelper.default)(".light-color-scheme .select-kit").header().value(), null);
      assert.strictEqual((0, _selectKitHelper.default)(".light-color-scheme .select-kit").header().label(), _I18n.default.t("user.color_schemes.default_description"));
    });
    (0, _qunit.test)("shows no default option for light scheme when theme's color scheme is user selectable", async function (assert) {
      let meta = document.createElement("meta");
      meta.name = "discourse_theme_id";
      meta.content = "2";
      document.getElementsByTagName("head")[0].appendChild(meta);

      let site = _site.default.current();

      site.set("user_themes", [{
        theme_id: 1,
        name: "Cool Theme",
        color_scheme_id: 2,
        default: true
      }, {
        theme_id: 2,
        name: "Some Other Theme",
        color_scheme_id: 3,
        default: false
      }]);
      site.set("user_color_schemes", [{
        id: 2,
        name: "Cool Breeze"
      }, {
        id: 3,
        name: "Dark Night"
      }]);
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/interface");
      assert.ok((0, _qunitHelpers.exists)(".light-color-scheme"), "has regular dropdown");
      assert.strictEqual((0, _selectKitHelper.default)(".theme .select-kit").header().value(), "2");
      await (0, _selectKitHelper.default)(".light-color-scheme .select-kit").expand();
      assert.strictEqual((0, _qunitHelpers.count)(".light-color-scheme .select-kit .select-kit-row"), 2);
      document.querySelector("meta[name='discourse_theme_id']").remove();
    });
  });
  (0, _qunitHelpers.acceptance)("User Preferences Color Schemes (with default dark scheme)", function (needs) {
    needs.user();
    needs.settings({
      default_dark_mode_color_scheme_id: 1
    });
    needs.pretender((server, helper) => {
      server.get("/color-scheme-stylesheet/2.json", () => {
        return helper.response({
          success: "OK"
        });
      });
      server.get("/color-scheme-stylesheet/3.json", () => {
        return helper.response({
          new_href: "3.css"
        });
      });
      server.get("/u/charlie.json", () => {
        return helper.response(_userFixtures.default["/u/charlie.json"]);
      });
    });
    (0, _qunit.test)("show option to disable dark mode", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/interface");
      assert.ok((0, _qunitHelpers.exists)(".control-group.dark-mode"), "it has the option to disable dark mode");
    });
    (0, _qunit.test)("no color scheme picker by default", async function (assert) {
      let site = _site.default.current();

      site.set("user_color_schemes", []);
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/interface");
      assert.ok(!(0, _qunitHelpers.exists)(".control-group.color-scheme"));
    });
    (0, _qunit.test)("light color scheme picker", async function (assert) {
      let site = _site.default.current();

      site.set("user_color_schemes", [{
        id: 2,
        name: "Cool Breeze"
      }]);
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/interface");
      assert.ok((0, _qunitHelpers.exists)(".light-color-scheme"), "has regular picker dropdown");
      assert.ok(!(0, _qunitHelpers.exists)(".dark-color-scheme"), "does not have a dark color scheme picker");
    });
    (0, _qunit.test)("light color scheme defaults to custom scheme selected by user", async function (assert) {
      let site = _site.default.current();

      let session = _session.default.current();

      session.userColorSchemeId = 2;
      site.set("user_color_schemes", [{
        id: 2,
        name: "Cool Breeze"
      }]);
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/interface");
      assert.ok((0, _qunitHelpers.exists)(".light-color-scheme"), "has light scheme dropdown");
      assert.strictEqual((0, _qunitHelpers.query)(".light-color-scheme .selected-name").dataset.value, session.userColorSchemeId.toString(), "user's selected color scheme is selected value in light scheme dropdown");
    });
    (0, _qunit.test)("display 'Theme default' when default color scheme is not marked as selectable", async function (assert) {
      let meta = document.createElement("meta");
      meta.name = "discourse_theme_id";
      meta.content = "1";
      document.getElementsByTagName("head")[0].appendChild(meta);

      let site = _site.default.current();

      site.set("user_themes", [{
        theme_id: 1,
        name: "A Theme",
        color_scheme_id: 2,
        default: true
      }]);
      site.set("user_color_schemes", [{
        id: 3,
        name: "A Color Scheme"
      }]);
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/interface");
      assert.ok((0, _qunitHelpers.exists)(".light-color-scheme"), "has regular dropdown");
      const dropdownObject = (0, _selectKitHelper.default)(".light-color-scheme .select-kit");
      assert.strictEqual(dropdownObject.header().value(), null);
      assert.strictEqual(dropdownObject.header().label(), _I18n.default.t("user.color_schemes.default_description"));
      await dropdownObject.expand();
      assert.strictEqual(dropdownObject.rows().length, 1);
      document.querySelector("meta[name='discourse_theme_id']").remove();
    });
    (0, _qunit.test)("light and dark color scheme pickers", async function (assert) {
      let site = _site.default.current();

      let session = _session.default.current();

      session.userDarkSchemeId = 1; // same as default set in site settings

      site.set("default_dark_color_scheme", {
        id: 1,
        name: "Dark"
      });
      site.set("user_color_schemes", [{
        id: 2,
        name: "Cool Breeze"
      }, {
        id: 3,
        name: "Dark Night",
        is_dark: true
      }]);

      const savePreferences = async () => {
        assert.ok(!(0, _qunitHelpers.exists)(".saved"), "it hasn't been saved yet");
        await (0, _testHelpers.click)(".save-changes");
        assert.ok((0, _qunitHelpers.exists)(".saved"), "it displays the saved message");
        (0, _qunitHelpers.query)(".saved").remove();
      };

      await (0, _testHelpers.visit)("/u/eviltrout/preferences/interface");
      assert.ok((0, _qunitHelpers.exists)(".light-color-scheme"), "has regular dropdown");
      assert.ok((0, _qunitHelpers.exists)(".dark-color-scheme"), "has dark color scheme dropdown");
      assert.strictEqual((0, _qunitHelpers.query)(".dark-color-scheme .selected-name").dataset.value, session.userDarkSchemeId.toString(), "sets site default as selected dark scheme");
      assert.ok(!(0, _qunitHelpers.exists)(".control-group.dark-mode"), "it does not show disable dark mode checkbox");
      (0, _cookie.removeCookie)("color_scheme_id");
      (0, _cookie.removeCookie)("dark_scheme_id");
      await (0, _selectKitHelper.default)(".light-color-scheme .combobox").expand();
      await (0, _selectKitHelper.default)(".light-color-scheme .combobox").selectRowByValue(2);
      assert.strictEqual((0, _cookie.default)("color_scheme_id"), undefined, "cookie is not set");
      assert.ok((0, _qunitHelpers.exists)(".color-scheme-checkbox input:checked"), "defaults to storing values in user options");
      await savePreferences();
      assert.strictEqual((0, _cookie.default)("color_scheme_id"), undefined, "cookie is unchanged"); // Switch to saving changes in cookies

      await (0, _testHelpers.click)(".color-scheme-checkbox input[type=checkbox]");
      await savePreferences();
      assert.strictEqual((0, _cookie.default)("color_scheme_id"), "2", "cookie is set"); // dark scheme

      await (0, _selectKitHelper.default)(".dark-color-scheme .combobox").expand();
      assert.ok((0, _selectKitHelper.default)(".dark-color-scheme .combobox").rowByValue(1).exists(), "default dark scheme is included");
      await (0, _selectKitHelper.default)(".dark-color-scheme .combobox").selectRowByValue(-1);
      assert.strictEqual((0, _cookie.default)("dark_scheme_id"), undefined, "cookie is not set before saving");
      await savePreferences();
      assert.strictEqual((0, _cookie.default)("dark_scheme_id"), "-1", "cookie is set");
      await (0, _testHelpers.click)("button.undo-preview");
      assert.strictEqual((0, _selectKitHelper.default)(".light-color-scheme .combobox").header().value(), null, "resets light scheme dropdown");
      assert.strictEqual((0, _selectKitHelper.default)(".dark-color-scheme .combobox").header().value(), session.userDarkSchemeId.toString(), "resets dark scheme dropdown");
    });
    (0, _qunit.test)("preview the color scheme only in current user's profile", async function (assert) {
      let site = _site.default.current();

      site.set("default_dark_color_scheme", {
        id: 1,
        name: "Dark"
      });
      site.set("user_color_schemes", [{
        id: 2,
        name: "Cool Breeze"
      }, {
        id: 3,
        name: "Dark Night",
        is_dark: true
      }]);
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/interface");
      await (0, _selectKitHelper.default)(".light-color-scheme .combobox").expand();
      await (0, _selectKitHelper.default)(".light-color-scheme .combobox").selectRowByValue(3);
      assert.ok(document.querySelector("link#cs-preview-light").href.endsWith("/3.css"), "correct stylesheet loaded");
      document.querySelector("link#cs-preview-light").remove();
      await (0, _testHelpers.visit)("/u/charlie/preferences/interface");
      await (0, _selectKitHelper.default)(".light-color-scheme .combobox").expand();
      await (0, _selectKitHelper.default)(".light-color-scheme .combobox").selectRowByValue(3);
      assert.notOk(document.querySelector("link#cs-preview-light"), "stylesheet not loaded");
    });
  });
});
define("discourse/tests/acceptance/user-preferences-notifications-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/tests/helpers/select-kit-helper", "qunit", "I18n"], function (_qunitHelpers, _testHelpers, _selectKitHelper, _qunit, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"qunit",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User notification schedule", function (needs) {
    needs.user();
    (0, _qunit.test)("the schedule interface is hidden until enabled", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/notifications");
      assert.ok(!(0, _qunitHelpers.exists)(".notification-schedule-table"), "notification schedule is hidden");
      await (0, _testHelpers.click)(".control-group.notification-schedule input");
      assert.ok((0, _qunitHelpers.exists)(".notification-schedule-table"), "notification schedule is visible");
    });
    (0, _qunit.test)("By default every day is selected 8:00am - 5:00pm", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/notifications");
      await (0, _testHelpers.click)(".control-group.notification-schedule input");
      ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"].forEach(day => {
        assert.strictEqual((0, _selectKitHelper.default)(`.day.${day} .starts-at .combobox`).header().label(), "8:00 AM", "8am is selected");
        assert.strictEqual((0, _selectKitHelper.default)(`.day.${day} .starts-at .combobox`).header().value(), "480", "8am is 480");
        assert.strictEqual((0, _selectKitHelper.default)(`.day.${day} .ends-at .combobox`).header().label(), "5:00 PM", "5am is selected");
        assert.strictEqual((0, _selectKitHelper.default)(`.day.${day} .ends-at .combobox`).header().value(), "1020", "5pm is 1020");
      });
    });
    (0, _qunit.test)("If 'none' is selected for the start time, end time dropdown is removed", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/notifications");
      await (0, _testHelpers.click)(".control-group.notification-schedule input");
      await (0, _selectKitHelper.default)(".day.Monday .combobox").expand();
      await (0, _selectKitHelper.default)(".day.Monday .combobox").selectRowByValue(-1);
      assert.strictEqual((0, _selectKitHelper.default)(".day.Monday .starts-at .combobox").header().value(), "-1", "set monday input to none");
      assert.strictEqual((0, _selectKitHelper.default)(".day.Monday .starts-at .combobox").header().label(), "None", "set monday label to none");
      assert.strictEqual((0, _qunitHelpers.count)(".day.Monday .select-kit.single-select"), 1, "The end time input is hidden");
    });
    (0, _qunit.test)("If start time is after end time, end time gets bumped 30 minutes past start time", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/notifications");
      await (0, _testHelpers.click)(".control-group.notification-schedule input");
      await (0, _selectKitHelper.default)(".day.Tuesday .starts-at .combobox").expand();
      await (0, _selectKitHelper.default)(".day.Tuesday .starts-at .combobox").selectRowByValue("1350");
      assert.strictEqual((0, _selectKitHelper.default)(".day.Tuesday .ends-at .combobox").header().value(), "1380", "End time is 30 past start time");
      await (0, _selectKitHelper.default)(".day.Tuesday .ends-at .combobox").expand();
      assert.ok(!(0, _selectKitHelper.default)(".day.Tuesday .ends-at .combobox").rowByValue(1350).exists(), "End time options are limited to + 30 past start time");
    });
  });
  (0, _qunitHelpers.acceptance)("User Notifications - Users - Ignore User", function (needs) {
    let clock = null;
    needs.user();
    needs.hooks.beforeEach(() => {
      const timezone = (0, _qunitHelpers.loggedInUser)().timezone;
      clock = (0, _qunitHelpers.fakeTime)("2100-05-03T08:00:00", timezone, true); // Monday morning
    });
    needs.hooks.afterEach(() => {
      clock.restore();
    });
    (0, _qunit.test)("Shows correct timeframe options", async function (assert) {
      this.siteSettings.suggest_weekends_in_date_pickers = true;
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/users");
      await (0, _testHelpers.click)("div.user-notifications div div button");
      await (0, _testHelpers.click)(".future-date-input-selector-header");
      const options = Array.from((0, _qunitHelpers.queryAll)(`ul.select-kit-collection li span.name`).map((_, x) => x.innerText.trim()));
      const expected = [_I18n.default.t("time_shortcut.later_today"), _I18n.default.t("time_shortcut.tomorrow"), _I18n.default.t("time_shortcut.later_this_week"), _I18n.default.t("time_shortcut.this_weekend"), _I18n.default.t("time_shortcut.start_of_next_business_week_alt"), _I18n.default.t("time_shortcut.two_weeks"), _I18n.default.t("time_shortcut.next_month"), _I18n.default.t("time_shortcut.two_months"), _I18n.default.t("time_shortcut.three_months"), _I18n.default.t("time_shortcut.four_months"), _I18n.default.t("time_shortcut.six_months"), _I18n.default.t("time_shortcut.one_year"), _I18n.default.t("time_shortcut.forever")];
      assert.deepEqual(options, expected, "options are correct");
    });
  });
});
define("discourse/tests/acceptance/user-preferences-profile-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User - Preferences - Profile - Featured topic", function (needs) {
    needs.user();
    needs.settings({
      allow_featured_topic_on_user_profiles: true
    });
    needs.pretender((server, helper) => {
      server.put("/u/eviltrout/feature-topic", () => helper.response({
        success: true
      }));
    });
    (0, _qunit.test)("setting featured topic on profile", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/profile");
      assert.ok(!(0, _qunitHelpers.exists)(".featured-topic-link"), "no featured topic link to present");
      assert.ok(!(0, _qunitHelpers.exists)(".clear-feature-topic-on-profile-btn"), "clear button not present");
      await (0, _testHelpers.click)(".feature-topic-on-profile-btn");
      assert.ok((0, _qunitHelpers.exists)(".feature-topic-on-profile"), "topic picker modal is open");
      await (0, _testHelpers.click)((0, _qunitHelpers.query)('input[name="choose_topic_id"]'));
      await (0, _testHelpers.click)(".save-featured-topic-on-profile");
      assert.ok((0, _qunitHelpers.exists)(".featured-topic-link"), "link to featured topic is present");
      assert.ok((0, _qunitHelpers.exists)(".clear-feature-topic-on-profile-btn"), "clear button is present");
    });
    (0, _qunit.test)("focused item after closing feature topic modal", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/profile");
      await (0, _testHelpers.click)(".feature-topic-on-profile-btn");
      await (0, _testHelpers.click)(".modal-close");
      assert.equal(document.activeElement, (0, _qunitHelpers.query)(".feature-topic-on-profile-btn"), "it keeps focus on the feature topic button");
    });
  });
  (0, _qunitHelpers.acceptance)("User - Preferences - Profile - No default calendar set", function (needs) {
    needs.user({
      default_calendar: "none_selected"
    });
    (0, _qunit.test)("default calendar option is not visible", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/profile");
      assert.ok(!(0, _qunitHelpers.exists)("#user-default-calendar"), "option to change default calendar is hidden");
    });
  });
  (0, _qunitHelpers.acceptance)("User - Preferences - Profile - Default calendar set", function (needs) {
    needs.user({
      default_calendar: "google"
    });
    (0, _qunit.test)("default calendar can be changed", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/profile");
      assert.ok((0, _qunitHelpers.exists)("#user-default-calendar"), "option to change default calendar");
    });
  });
});
define("discourse/tests/acceptance/user-preferences-sidebar-test", ["qunit", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/select-kit-helper"], function (_qunit, _testHelpers, _qunitHelpers, _selectKitHelper) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/tests/helpers/select-kit-helper"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User Preferences - Sidebar", function (needs) {
    needs.user({
      sidebar_category_ids: [],
      sidebar_tags: []
    });
    needs.settings({
      enable_experimental_sidebar_hamburger: true,
      enable_sidebar: true,
      tagging_enabled: true
    });
    let updateUserRequestBody = null;
    needs.hooks.afterEach(() => {
      updateUserRequestBody = null;
    });
    needs.pretender((server, helper) => {
      server.put("/u/eviltrout.json", request => {
        updateUserRequestBody = helper.parsePostData(request.requestBody); // if only the howto category is updated, intentionally cause an error

        if (updateUserRequestBody["sidebar_category_ids[]"]?.[0] === "10" || updateUserRequestBody["sidebar_tag_names[]"]?.[0] === "gazelle") {
          // This request format will cause an error
          return helper.response(400, {});
        } else {
          return helper.response({
            user: {
              sidebar_tags: [{
                name: "monkey",
                pm_only: false
              }, {
                name: "gazelle",
                pm_only: false
              }]
            }
          });
        }
      });
    });
    (0, _qunit.test)("user should not see tag chooser when tagging is disabled", async function (assert) {
      this.siteSettings.tagging_enabled = false;
      await (0, _testHelpers.visit)("/u/eviltrout/preferences/sidebar");
      assert.ok(!(0, _qunitHelpers.exists)(".tag-chooser"), "tag chooser is not displayed");
    });
    (0, _qunit.test)("user encountering error when adding categories to sidebar", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        sidebar_category_ids: [6]
      });
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-categories .sidebar-section-link-support"), "support category is present in sidebar");
      await (0, _testHelpers.click)(".sidebar-section-categories .sidebar-section-header-button");
      const categorySelector = (0, _selectKitHelper.default)(".category-selector");
      await categorySelector.expand();
      await categorySelector.selectKitSelectRowByName("howto");
      await categorySelector.deselectItemByName("support");
      await (0, _testHelpers.click)(".save-changes");
      assert.deepEqual(updateUserRequestBody["sidebar_category_ids[]"], ["10"], "contains the right request body to update user's sidebar category links");
      assert.ok((0, _qunitHelpers.exists)(".modal-body"), "error message is displayed");
      await (0, _testHelpers.click)(".modal .d-button-label");
      assert.ok(!(0, _qunitHelpers.exists)(".sidebar-section-categories .sidebar-section-link-howto"), "howto category is not displayed in sidebar");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-categories .sidebar-section-link-support"), "support category is displayed in sidebar");
    });
    (0, _qunit.test)("user adding categories to sidebar", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".sidebar-section-categories .sidebar-section-header-button");
      const categorySelector = (0, _selectKitHelper.default)(".category-selector");
      await categorySelector.expand();
      await categorySelector.selectKitSelectRowByName("support");
      await categorySelector.selectKitSelectRowByName("bug");
      await (0, _testHelpers.click)(".save-changes");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-categories .sidebar-section-link-support"), "support category has been added to sidebar");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-categories .sidebar-section-link-bug"), "bug category has been added to sidebar");
      assert.deepEqual(updateUserRequestBody["sidebar_category_ids[]"], ["6", "1"], "contains the right request body to update user's sidebar category links");
    });
    (0, _qunit.test)("user encountering error when adding tags to sidebar", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        sidebar_tags: [{
          name: "monkey",
          pm_only: false
        }]
      });
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-tags .sidebar-section-link-monkey"), "monkey tag is displayed in sidebar");
      await (0, _testHelpers.click)(".sidebar-section-tags .sidebar-section-header-button");
      const tagChooser = (0, _selectKitHelper.default)(".tag-chooser");
      await tagChooser.expand();
      await tagChooser.selectKitSelectRowByName("gazelle");
      await tagChooser.deselectItemByName("monkey");
      await (0, _testHelpers.click)(".save-changes");
      assert.deepEqual(updateUserRequestBody["sidebar_tag_names[]"], ["gazelle"], "contains the right request body to update user's sidebar tag links");
      assert.ok((0, _qunitHelpers.exists)(".modal-body"), "error message is displayed");
      await (0, _testHelpers.click)(".modal .d-button-label");
      assert.ok(!(0, _qunitHelpers.exists)(".sidebar-section-tags .sidebar-section-link-gazelle"), "gazelle tag is not displayed in sidebar");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-tags .sidebar-section-link-monkey"), "monkey tag is displayed in sidebar");
    });
    (0, _qunit.test)("user adding tags to sidebar", async function (assert) {
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".sidebar-section-tags .sidebar-section-header-button");
      const tagChooser = (0, _selectKitHelper.default)(".tag-chooser");
      await tagChooser.expand();
      await tagChooser.selectKitSelectRowByName("monkey");
      await tagChooser.selectKitSelectRowByName("gazelle");
      await (0, _testHelpers.click)(".save-changes");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-tags .sidebar-section-link-monkey"), "monkey tag has been added to sidebar");
      assert.ok((0, _qunitHelpers.exists)(".sidebar-section-tags .sidebar-section-link-gazelle"), "gazelle tag has been added to sidebar");
      assert.deepEqual(updateUserRequestBody["sidebar_tag_names[]"], ["monkey", "gazelle"], "contains the right request body to update user's sidebar tag links");
    });
  });
});
define("discourse/tests/acceptance/user-private-messages-test", ["@ember/test-helpers", "qunit", "I18n", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/create-pretender", "discourse/tests/helpers/select-kit-helper", "discourse-common/lib/object"], function (_testHelpers, _qunit, _I18n, _qunitHelpers, _createPretender, _selectKitHelper, _object) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"@ember/test-helpers",0,"qunit",0,"I18n",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/tests/helpers/create-pretender",0,"discourse/tests/helpers/select-kit-helper",0,"discourse-common/lib/object"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User Private Messages - user with no group messages", function (needs) {
    needs.user();
    needs.site({
      can_tag_pms: true
    });
    (0, _qunit.test)("viewing messages", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/messages");
      assert.strictEqual((0, _qunitHelpers.count)(".topic-list-item"), 1, "displays the topic list");
      assert.ok(!(0, _qunitHelpers.exists)(".group-notifications-button"), "displays the group notifications button");
    });
    (0, _qunit.test)("viewing messages of another user", async function (assert) {
      (0, _qunitHelpers.updateCurrentUser)({
        id: 5,
        username: "charlie"
      });
      await (0, _testHelpers.visit)("/u/eviltrout/messages");
      assert.ok(!(0, _qunitHelpers.exists)(".messages-nav li a.new"), "it does not display new filter");
      assert.ok(!(0, _qunitHelpers.exists)(".messages-nav li a.unread"), "it does not display unread filter");
    });
  });
  (0, _qunitHelpers.acceptance)("User Private Messages - user with group messages", function (needs) {
    let fetchedNew;
    let fetchUserNew;
    let fetchedGroupNew;
    needs.user({
      id: 5,
      username: "charlie",
      groups: [{
        id: 14,
        name: "awesome_group",
        has_messages: true
      }]
    });
    needs.site({
      can_tag_pms: true
    });
    needs.hooks.afterEach(() => {
      fetchedNew = false;
      fetchedGroupNew = false;
      fetchUserNew = false;
    });
    needs.pretender((server, helper) => {
      server.get("/tags/personal_messages/:username.json", () => {
        return helper.response({
          tags: []
        });
      });
      server.get("/t/13.json", () => {
        const response = (0, _object.cloneJSON)(_createPretender.fixturesByUrl["/t/12/1.json"]);
        response.suggested_group_name = "awesome_group";
        return helper.response(response);
      });
      server.get("/topics/private-messages/:username.json", () => {
        return helper.response({
          topic_list: {
            topics: [{
              id: 1,
              posters: []
            }, {
              id: 2,
              posters: []
            }, {
              id: 3,
              posters: []
            }]
          }
        });
      });
      ["/topics/private-messages-new/:username.json", "/topics/private-messages-unread/:username.json", "/topics/private-messages-archive/:username.json", "/topics/private-messages-group/:username/:group_name/new.json", "/topics/private-messages-group/:username/:group_name/unread.json", "/topics/private-messages-group/:username/:group_name/archive.json"].forEach(url => {
        server.get(url, () => {
          let topics;

          if (fetchedNew || fetchedGroupNew || fetchUserNew) {
            topics = [];
          } else {
            topics = [{
              id: 1,
              posters: []
            }, {
              id: 2,
              posters: []
            }, {
              id: 3,
              posters: []
            }];
          }

          return helper.response({
            topic_list: {
              topics
            }
          });
        });
      });
      server.get("/topics/private-messages-group/:username/:group_name.json", () => {
        return helper.response({
          topic_list: {
            topics: [{
              id: 1,
              posters: []
            }, {
              id: 2,
              posters: []
            }]
          }
        });
      });
      server.put("/topics/pm-reset-new", request => {
        const requestBody = request.requestBody; // No easy way to do this https://github.com/pretenderjs/pretender/issues/159

        if (requestBody === "inbox=group&group_name=awesome_group") {
          fetchedGroupNew = true;
        }

        if (requestBody === "inbox=user") {
          fetchUserNew = true;
        }

        if (requestBody === "inbox=all") {
          fetchedNew = true;
        }

        return helper.response({
          topic_ids: [1, 2, 3]
        });
      });
      server.put("/topics/bulk", request => {
        const requestBody = request.requestBody;

        if (requestBody.includes("private_message_inbox=all")) {
          fetchedNew = true;
        }

        if (requestBody.includes("private_message_inbox=group&group_name=awesome_group")) {
          fetchedGroupNew = true;
        }

        if (requestBody.includes("private_message_inbox=user")) {
          fetchUserNew = true;
        }

        return helper.response({
          topic_ids: [1, 2, 3]
        });
      });
    });

    const publishReadToMessageBus = function () {
      let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      return (0, _qunitHelpers.publishToMessageBus)(`/private-message-topic-tracking-state/user/${opts.userId || 5}`, {
        topic_id: opts.topicId,
        message_type: "read",
        payload: {
          last_read_post_number: 2,
          highest_post_number: 2,
          notification_level: 2
        }
      });
    };

    const publishUnreadToMessageBus = function () {
      let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      return (0, _qunitHelpers.publishToMessageBus)(`/private-message-topic-tracking-state/user/${opts.userId || 5}`, {
        topic_id: opts.topicId,
        message_type: "unread",
        payload: {
          last_read_post_number: 1,
          highest_post_number: 2,
          notification_level: 2,
          group_ids: opts.groupIds || []
        }
      });
    };

    const publishNewToMessageBus = function () {
      let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      return (0, _qunitHelpers.publishToMessageBus)(`/private-message-topic-tracking-state/user/${opts.userId || 5}`, {
        topic_id: opts.topicId,
        message_type: "new_topic",
        payload: {
          last_read_post_number: null,
          highest_post_number: 1,
          group_ids: opts.groupIds || []
        }
      });
    };

    const publishGroupArchiveToMessageBus = function (opts) {
      return (0, _qunitHelpers.publishToMessageBus)(`/private-message-topic-tracking-state/group/${opts.groupIds[0]}`, {
        topic_id: opts.topicId,
        message_type: "group_archive",
        payload: {
          group_ids: opts.groupIds,
          acting_user_id: opts.actingUserId
        }
      });
    };

    const publishGroupUnreadToMessageBus = function (opts) {
      return (0, _qunitHelpers.publishToMessageBus)(`/private-message-topic-tracking-state/group/${opts.groupIds[0]}`, {
        topic_id: opts.topicId,
        message_type: "unread",
        payload: {
          last_read_post_number: 1,
          highest_post_number: 2,
          notification_level: 2,
          group_ids: opts.groupIds || []
        }
      });
    };

    const publishGroupNewToMessageBus = function (opts) {
      return (0, _qunitHelpers.publishToMessageBus)(`/private-message-topic-tracking-state/group/${opts.groupIds[0]}`, {
        topic_id: opts.topicId,
        message_type: "new_topic",
        payload: {
          last_read_post_number: null,
          highest_post_number: 1,
          group_ids: opts.groupIds || []
        }
      });
    };

    (0, _qunit.test)("viewing messages filtered by tags", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie/messages/tags");
      assert.strictEqual((0, _qunitHelpers.count)(".action-list li"), 3, "it does not expand personal or group inbox");
    });
    (0, _qunit.test)("incoming group archive message acted by current user", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie/messages");
      await publishGroupArchiveToMessageBus({
        groupIds: [14],
        topicId: 1,
        actingUserId: 5
      });
      assert.ok(!(0, _qunitHelpers.exists)(".show-mores"), `does not display the topic incoming info`);
    });
    (0, _qunit.test)("incoming group archive message on inbox and archive filter", async function (assert) {
      for (const url of ["/u/charlie/messages/group/awesome_group", "/u/charlie/messages/group/awesome_group/archive"]) {
        await (0, _testHelpers.visit)(url);
        await publishGroupArchiveToMessageBus({
          groupIds: [14],
          topicId: 1
        });
        assert.ok((0, _qunitHelpers.exists)(".show-mores"), `${url} displays the topic incoming info`);
      }

      for (const url of ["/u/charlie/messages", "/u/charlie/messages/archive"]) {
        await (0, _testHelpers.visit)(url);
        await publishGroupArchiveToMessageBus({
          groupIds: [14],
          topicId: 1
        });
        assert.ok(!(0, _qunitHelpers.exists)(".show-mores"), `${url} does not display the topic incoming info`);
      }
    });
    (0, _qunit.test)("incoming unread and new messages on all filter", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie/messages");
      await publishUnreadToMessageBus({
        topicId: 1
      });
      await publishNewToMessageBus({
        topicId: 2
      });
      assert.strictEqual((0, _qunitHelpers.query)(".messages-nav li a.new").innerText.trim(), _I18n.default.t("user.messages.new_with_count", {
        count: 1
      }), "displays the right count");
      assert.strictEqual((0, _qunitHelpers.query)(".messages-nav li a.unread").innerText.trim(), _I18n.default.t("user.messages.unread_with_count", {
        count: 1
      }), "displays the right count");
    });
    (0, _qunit.test)("incoming new messages while viewing new", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie/messages/new");
      await publishNewToMessageBus({
        topicId: 1
      });
      assert.strictEqual((0, _qunitHelpers.query)(".messages-nav li a.new").innerText.trim(), _I18n.default.t("user.messages.new_with_count", {
        count: 1
      }), "displays the right count");
      assert.ok((0, _qunitHelpers.exists)(".show-mores"), "displays the topic incoming info");
    });
    (0, _qunit.test)("incoming unread messages while viewing unread", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie/messages/unread");
      await publishUnreadToMessageBus();
      assert.strictEqual((0, _qunitHelpers.query)(".messages-nav li a.unread").innerText.trim(), _I18n.default.t("user.messages.unread_with_count", {
        count: 1
      }), "displays the right count");
      assert.ok((0, _qunitHelpers.exists)(".show-mores"), "displays the topic incoming info");
    });
    (0, _qunit.test)("incoming unread and new messages while viewing group unread", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie/messages/group/awesome_group/unread");
      await publishUnreadToMessageBus({
        groupIds: [14],
        topicId: 1
      });
      await publishNewToMessageBus({
        groupIds: [14],
        topicId: 2
      });
      assert.strictEqual((0, _qunitHelpers.query)(".messages-nav li a.unread").innerText.trim(), _I18n.default.t("user.messages.unread_with_count", {
        count: 1
      }), "displays the right count");
      assert.strictEqual((0, _qunitHelpers.query)(".messages-nav li a.new").innerText.trim(), _I18n.default.t("user.messages.new_with_count", {
        count: 1
      }), "displays the right count");
      assert.ok((0, _qunitHelpers.exists)(".show-mores"), "displays the topic incoming info");
      await (0, _testHelpers.visit)("/u/charlie/messages/unread");
      assert.strictEqual((0, _qunitHelpers.query)(".messages-nav li a.unread").innerText.trim(), _I18n.default.t("user.messages.unread"), "displays the right count");
      assert.strictEqual((0, _qunitHelpers.query)(".messages-nav li a.new").innerText.trim(), _I18n.default.t("user.messages.new"), "displays the right count");
    });
    (0, _qunit.test)("incoming messages is not tracked on non user messages route", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie/messages");
      await (0, _testHelpers.visit)("/t/13");
      await publishNewToMessageBus({
        topicId: 1,
        userId: 5
      });
      await (0, _testHelpers.visit)("/u/charlie/messages");
      assert.ok(!(0, _qunitHelpers.exists)(".show-mores"), "does not display the topic incoming info");
    });
    (0, _qunit.test)("dismissing all unread messages", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie/messages/unread");
      await publishUnreadToMessageBus({
        topicId: 1,
        userId: 5
      });
      await publishUnreadToMessageBus({
        topicId: 2,
        userId: 5
      });
      await publishUnreadToMessageBus({
        topicId: 3,
        userId: 5
      });
      assert.strictEqual((0, _qunitHelpers.count)(".topic-list-item"), 3, "displays the right topic list");
      await (0, _testHelpers.click)(".btn.dismiss-read");
      await (0, _testHelpers.click)("#dismiss-read-confirm");
      assert.strictEqual((0, _qunitHelpers.query)(".messages-nav li a.unread").innerText.trim(), _I18n.default.t("user.messages.unread"), "displays the right count");
      assert.strictEqual((0, _qunitHelpers.count)(".topic-list-item"), 0, "displays the right topic list");
    });
    (0, _qunit.test)("dismissing personal unread messages", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie/messages/unread");
      assert.strictEqual((0, _qunitHelpers.count)(".topic-list-item"), 3, "displays the right topic list");
      await (0, _testHelpers.click)(".btn.dismiss-read");
      await (0, _testHelpers.click)("#dismiss-read-confirm");
      assert.strictEqual((0, _qunitHelpers.count)(".topic-list-item"), 0, "displays the right topic list");
    });
    (0, _qunit.test)("dismissing group unread messages", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie/messages/group/awesome_group/unread");
      assert.strictEqual((0, _qunitHelpers.count)(".topic-list-item"), 3, "displays the right topic list");
      await (0, _testHelpers.click)(".btn.dismiss-read");
      await (0, _testHelpers.click)("#dismiss-read-confirm");
      assert.strictEqual((0, _qunitHelpers.count)(".topic-list-item"), 0, "displays the right topic list");
    });
    (0, _qunit.test)("dismissing new messages", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie/messages/new");
      await publishNewToMessageBus({
        topicId: 1,
        userId: 5
      });
      await publishNewToMessageBus({
        topicId: 2,
        userId: 5
      });
      await publishNewToMessageBus({
        topicId: 3,
        userId: 5
      });
      assert.strictEqual((0, _qunitHelpers.count)(".topic-list-item"), 3, "displays the right topic list");
      await (0, _testHelpers.click)(".btn.dismiss-read");
      assert.strictEqual((0, _qunitHelpers.query)(".messages-nav li a.new").innerText.trim(), _I18n.default.t("user.messages.new"), "displays the right count");
      assert.strictEqual((0, _qunitHelpers.count)(".topic-list-item"), 0, "displays the right topic list");
    });
    (0, _qunit.test)("dismissing personal new messages", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie/messages/new");
      assert.strictEqual((0, _qunitHelpers.count)(".topic-list-item"), 3, "displays the right topic list");
      await (0, _testHelpers.click)(".btn.dismiss-read");
      assert.strictEqual((0, _qunitHelpers.count)(".topic-list-item"), 0, "displays the right topic list");
    });
    (0, _qunit.test)("dismissing new group messages", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie/messages/group/awesome_group/new");
      assert.strictEqual((0, _qunitHelpers.count)(".topic-list-item"), 3, "displays the right topic list");
      await (0, _testHelpers.click)(".btn.dismiss-read");
      assert.strictEqual((0, _qunitHelpers.count)(".topic-list-item"), 0, "displays the right topic list");
    });
    (0, _qunit.test)("viewing messages", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie/messages");
      assert.strictEqual((0, _qunitHelpers.count)(".topic-list-item"), 3, "displays the right topic list");
      await (0, _testHelpers.visit)("/u/charlie/messages/group/awesome_group");
      assert.strictEqual((0, _qunitHelpers.count)(".topic-list-item"), 2, "displays the right topic list");
      assert.ok((0, _qunitHelpers.exists)(".group-notifications-button"), "displays the group notifications button");
    });
    (0, _qunit.test)("suggested messages without new or unread", async function (assert) {
      await (0, _testHelpers.visit)("/t/12");
      assert.strictEqual((0, _qunitHelpers.query)(".suggested-topics-message").innerText.trim(), "Want to read more? Browse other messages in personal messages.", "displays the right browse more message");
    });
    (0, _qunit.test)("suggested messages with new and unread", async function (assert) {
      await (0, _testHelpers.visit)("/t/12");
      await publishNewToMessageBus({
        userId: 5,
        topicId: 1
      });
      assert.strictEqual((0, _qunitHelpers.query)(".suggested-topics-message").innerText.trim(), "There is 1 new message remaining, or browse other personal messages", "displays the right browse more message");
      await publishUnreadToMessageBus({
        userId: 5,
        topicId: 2
      });
      assert.strictEqual((0, _qunitHelpers.query)(".suggested-topics-message").innerText.trim(), "There is 1 unread and 1 new message remaining, or browse other personal messages", "displays the right browse more message");
      await publishReadToMessageBus({
        userId: 5,
        topicId: 2
      });
      assert.strictEqual((0, _qunitHelpers.query)(".suggested-topics-message").innerText.trim(), "There is 1 new message remaining, or browse other personal messages", "displays the right browse more message");
    });
    (0, _qunit.test)("suggested messages for group messages without new or unread", async function (assert) {
      await (0, _testHelpers.visit)("/t/13");
      assert.ok((0, _qunitHelpers.query)(".suggested-topics-message").innerText.trim().match(/Want to read more\? Browse other messages in\s+awesome_group\./), "displays the right browse more message");
    });
    (0, _qunit.test)("suggested messages for group messages with new and unread", async function (assert) {
      await (0, _testHelpers.visit)("/t/13");
      await publishGroupNewToMessageBus({
        groupIds: [14],
        topicId: 1
      });
      assert.ok((0, _qunitHelpers.query)(".suggested-topics-message").innerText.trim().match(/There is 1 new message remaining, or browse other messages in\s+awesome_group/), "displays the right browse more message");
      await publishGroupUnreadToMessageBus({
        groupIds: [14],
        topicId: 2
      });
      assert.ok((0, _qunitHelpers.query)(".suggested-topics-message").innerText.trim().match(/There is 1 unread and 1 new message remaining, or browse other messages in\s+awesome_group/), "displays the right browse more message");
    });
  });
  (0, _qunitHelpers.acceptance)("User Private Messages - user with no messages", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      const emptyResponse = {
        topic_list: {
          topics: []
        }
      };
      const apiUrls = ["/topics/private-messages/:username.json", "/topics/private-messages-sent/:username.json", "/topics/private-messages-new/:username.json", "/topics/private-messages-unread/:username.json", "/topics/private-messages-archive/:username.json"];
      apiUrls.forEach(url => {
        server.get(url, () => {
          return helper.response(emptyResponse);
        });
      });
    });
    (0, _qunit.test)("It renders the empty state panel", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie/messages");
      assert.ok((0, _qunitHelpers.exists)("div.empty-state"));
      await (0, _testHelpers.visit)("/u/charlie/messages/sent");
      assert.ok((0, _qunitHelpers.exists)("div.empty-state"));
      await (0, _testHelpers.visit)("/u/charlie/messages/new");
      assert.ok((0, _qunitHelpers.exists)("div.empty-state"));
      await (0, _testHelpers.visit)("/u/charlie/messages/unread");
      assert.ok((0, _qunitHelpers.exists)("div.empty-state"));
      await (0, _testHelpers.visit)("/u/charlie/messages/archive");
      assert.ok((0, _qunitHelpers.exists)("div.empty-state"));
    });
  });
  (0, _qunitHelpers.acceptance)("User Private Messages - composer with tags - Desktop", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.post("/posts", () => {
        return helper.response({
          action: "create_post",
          post: {
            id: 323,
            name: "Robin Ward",
            username: "eviltrout",
            avatar_template: "/letter_avatar_proxy/v4/letter/j/b77776/{size}.png",
            created_at: "2021-10-26T11:47:54.253Z",
            cooked: "<p>Testing private messages with tags</p>",
            post_number: 1,
            post_type: 1,
            updated_at: "2021-10-26T11:47:54.253Z",
            yours: true,
            topic_id: 161,
            topic_slug: "testing-private-messages-with-tags",
            raw: "This is a test for private messages with tags",
            user_id: 29
          },
          success: true
        });
      });
      server.get("/t/161.json", () => {
        return helper.response(200, {});
      });
      server.get("/u/search/users", () => {
        return helper.response({
          users: [{
            username: "eviltrout",
            name: "Robin Ward",
            avatar_template: "https://avatars.discourse.org/v3/letter/t/41988e/{size}.png"
          }, {
            username: "r_ocelot",
            name: "Revolver Ocelot",
            avatar_template: "https://avatars.discourse.org/v3/letter/t/41988e/{size}.png"
          }]
        });
      });
    });
    needs.site({
      can_tag_pms: true,
      can_tag_topics: true
    });
    (0, _qunit.test)("tags are present on private messages - Desktop mode", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/messages");
      await (0, _testHelpers.click)(".new-private-message");
      assert.ok((0, _qunitHelpers.exists)("#reply-control .mini-tag-chooser"));
      await (0, _testHelpers.fillIn)("#reply-title", "Sending a message with tags");
      await (0, _testHelpers.fillIn)("#reply-control .d-editor-input", "This is a message to test tags");
      const users = (0, _selectKitHelper.default)("#reply-control .user-chooser");
      await users.expand();
      await (0, _testHelpers.fillIn)("#private-message-users-body input.filter-input", "eviltrout");
      await users.selectRowByValue("eviltrout");
      await (0, _testHelpers.fillIn)("#private-message-users-body input.filter-input", "r_ocelot");
      await users.selectRowByValue("r_ocelot");
      const tags = (0, _selectKitHelper.default)("#reply-control .mini-tag-chooser");
      await tags.expand();
      await tags.selectRowByValue("monkey");
      await tags.selectRowByValue("gazelle");
      await (0, _testHelpers.click)("#reply-control .save-or-cancel button");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/t/testing-private-messages-with-tags/161", "it creates the private message");
    });
  });
  (0, _qunitHelpers.acceptance)("User Private Messages - composer with tags - Mobile", function (needs) {
    needs.mobileView();
    needs.user();
    needs.site({
      can_tag_pms: true,
      can_tag_topics: true
    });
    (0, _qunit.test)("tags are not present on private messages - Mobile mode", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/messages");
      await (0, _testHelpers.click)(".new-private-message");
      assert.ok(!(0, _qunitHelpers.exists)("#reply-control .mini-tag-chooser"));
    });
  });
});
define("discourse/tests/acceptance/user-profile-summary-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit", "I18n", "discourse/tests/fixtures/user-fixtures", "discourse-common/lib/object"], function (_qunitHelpers, _testHelpers, _qunit, _I18n, _userFixtures, _object) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit",0,"I18n",0,"discourse/tests/fixtures/user-fixtures",0,"discourse-common/lib/object"eaimeta@70e063a35619d71f

  let deleteAndBlock = null;
  (0, _qunitHelpers.acceptance)("User Profile - Summary", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/u/eviltrout.json", () => {
        const response = (0, _object.cloneJSON)(_userFixtures.default["/u/eviltrout.json"]);
        return helper.response(response);
      });
    });
    (0, _qunit.test)("Viewing Summary", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/summary");
      assert.ok((0, _qunitHelpers.exists)(".replies-section li a"), "replies");
      assert.ok((0, _qunitHelpers.exists)(".topics-section li a"), "topics");
      assert.ok((0, _qunitHelpers.exists)(".links-section li a"), "links");
      assert.ok((0, _qunitHelpers.exists)(".replied-section .user-info"), "liked by");
      assert.ok((0, _qunitHelpers.exists)(".liked-by-section .user-info"), "liked by");
      assert.ok((0, _qunitHelpers.exists)(".liked-section .user-info"), "liked");
      assert.ok((0, _qunitHelpers.exists)(".badges-section .badge-card"), "badges");
      assert.ok((0, _qunitHelpers.exists)(".top-categories-section .category-link"), "top categories");
    });
  });
  (0, _qunitHelpers.acceptance)("User Profile - Summary - User Status", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/u/eviltrout.json", () => {
        const response = (0, _object.cloneJSON)(_userFixtures.default["/u/eviltrout.json"]);
        response.user.status = {
          description: "off to dentist",
          emoji: "tooth"
        };
        return helper.response(response);
      });
    });
    (0, _qunit.test)("Shows User Status", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/summary");
      assert.ok((0, _qunitHelpers.exists)(".user-status-message .emoji[alt='tooth']"));
    });
  });
  (0, _qunitHelpers.acceptance)("User Profile - Summary - Stats", function (needs) {
    needs.pretender((server, helper) => {
      server.get("/u/eviltrout/summary.json", () => {
        return helper.response(200, {
          user_summary: {
            likes_given: 1,
            likes_received: 2,
            topics_entered: 3,
            posts_read_count: 4,
            days_visited: 5,
            topic_count: 6,
            post_count: 7,
            time_read: 100000,
            recent_time_read: 1000,
            bookmark_count: 0,
            can_see_summary_stats: true,
            topic_ids: [1234],
            replies: [{
              topic_id: 1234
            }],
            links: [{
              topic_id: 1234,
              url: "https://eviltrout.com"
            }],
            most_replied_to_users: [{
              id: 333
            }],
            most_liked_by_users: [{
              id: 333
            }],
            most_liked_users: [{
              id: 333
            }],
            badges: [{
              badge_id: 444
            }],
            top_categories: [{
              id: 1,
              name: "bug",
              color: "e9dd00",
              text_color: "000000",
              slug: "bug",
              read_restricted: false,
              parent_category_id: null,
              topic_count: 1,
              post_count: 1
            }]
          },
          badges: [{
            id: 444,
            count: 1
          }],
          topics: [{
            id: 1234,
            title: "cool title",
            slug: "cool-title"
          }]
        });
      });
    });
    (0, _qunit.test)("Summary Read Times", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/summary");
      assert.equal((0, _qunitHelpers.query)(".stats-time-read span").textContent.trim(), "1d");
      assert.equal((0, _qunitHelpers.query)(".stats-time-read span").title, _I18n.default.t("user.summary.time_read_title", {
        duration: "1 day"
      }));
      assert.equal((0, _qunitHelpers.query)(".stats-recent-read span").textContent.trim(), "17m");
      assert.equal((0, _qunitHelpers.query)(".stats-recent-read span").title, _I18n.default.t("user.summary.recent_time_read_title", {
        duration: "17 mins"
      }));
    });
  });
  (0, _qunitHelpers.acceptance)("User Profile - Summary - Admin", function (needs) {
    needs.user({
      username: "eviltrout"
    });
    needs.pretender((server, helper) => {
      server.get("/admin/users/5.json", () => {
        return helper.response({
          id: 5,
          username: "charlie",
          name: null,
          avatar_template: "/letter_avatar_proxy/v4/letter/b/f0a364/{size}.png",
          active: true
        });
      });
      server.delete("/admin/users/5.json", request => {
        const data = helper.parsePostData(request.requestBody);

        if (data.block_email || data.block_ip || data.block_urls) {
          deleteAndBlock = true;
        } else {
          deleteAndBlock = false;
        }

        return helper.response({});
      });
    });
    needs.hooks.beforeEach(() => {
      deleteAndBlock = null;
    });
    (0, _qunit.test)("Delete only action", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie/summary");
      await (0, _testHelpers.click)(".btn-delete-user");
      await (0, _testHelpers.click)(".dialog-footer .btn-primary");
      assert.notOk(deleteAndBlock, "first button does not block user");
    });
    (0, _qunit.test)("Delete and block", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie/summary");
      await (0, _testHelpers.click)(".btn-delete-user");
      assert.equal((0, _qunitHelpers.query)("#dialog-title").textContent, _I18n.default.t("admin.user.delete_confirm_title"), "dialog has a title");
      await (0, _testHelpers.click)(".dialog-footer .btn-danger");
      assert.ok(deleteAndBlock, "second button also block user");
    });
  });
});
define("discourse/tests/acceptance/user-status-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  async function openUserStatusModal() {
    await (0, _testHelpers.click)(".header-dropdown-toggle.current-user");
    await (0, _testHelpers.click)(".menu-links-row .user-preferences-link");
    await (0, _testHelpers.click)(".user-status button");
  }

  async function pickEmoji(emoji) {
    await (0, _testHelpers.click)(".btn-emoji");
    await (0, _testHelpers.fillIn)(".emoji-picker-content .filter", emoji);
    await (0, _testHelpers.click)(".results .emoji");
  }

  (0, _qunitHelpers.acceptance)("User Status", function (needs) {
    const userStatus = "off to dentist";
    const userStatusEmoji = "tooth";
    const userId = 1;
    const userTimezone = "UTC";
    needs.user({
      id: userId,
      timezone: userTimezone
    });
    needs.pretender((server, helper) => {
      server.put("/user-status.json", () => {
        (0, _qunitHelpers.publishToMessageBus)(`/user-status/${userId}`, {
          description: userStatus,
          emoji: userStatusEmoji
        });
        return helper.response({
          success: true
        });
      });
      server.delete("/user-status.json", () => {
        (0, _qunitHelpers.publishToMessageBus)(`/user-status/${userId}`, null);
        return helper.response({
          success: true
        });
      });
    });
    (0, _qunit.test)("doesn't show the user status button on the menu by default", async function (assert) {
      this.siteSettings.enable_user_status = false;
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".header-dropdown-toggle.current-user");
      await (0, _testHelpers.click)(".menu-links-row .user-preferences-link");
      assert.notOk((0, _qunitHelpers.exists)("div.quick-access-panel li.user-status"));
    });
    (0, _qunit.test)("shows the user status button on the menu when enabled in settings", async function (assert) {
      this.siteSettings.enable_user_status = true;
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".header-dropdown-toggle.current-user");
      await (0, _testHelpers.click)(".menu-links-row .user-preferences-link");
      assert.ok((0, _qunitHelpers.exists)("div.quick-access-panel li.user-status"), "shows the button");
      assert.ok((0, _qunitHelpers.exists)("div.quick-access-panel li.user-status svg.d-icon-plus-circle"), "shows the icon on the button");
    });
    (0, _qunit.test)("shows user status on loaded page", async function (assert) {
      this.siteSettings.enable_user_status = true;
      (0, _qunitHelpers.updateCurrentUser)({
        status: {
          description: userStatus,
          emoji: userStatusEmoji
        }
      });
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".header-dropdown-toggle.current-user");
      await (0, _testHelpers.click)(".menu-links-row .user-preferences-link");
      assert.equal((0, _qunitHelpers.query)("div.quick-access-panel li.user-status span.d-button-label").textContent.trim(), userStatus, "shows user status description on the menu");
      assert.equal((0, _qunitHelpers.query)("div.quick-access-panel li.user-status img.emoji").alt, `:${userStatusEmoji}:`, "shows user status emoji on the menu");
      assert.equal((0, _qunitHelpers.query)(".header-dropdown-toggle .user-status-background img.emoji").alt, `:${userStatusEmoji}:`, "shows user status emoji on the user avatar in the header");
    });
    (0, _qunit.test)("shows user status on the user status modal", async function (assert) {
      this.siteSettings.enable_user_status = true;
      (0, _qunitHelpers.updateCurrentUser)({
        status: {
          description: userStatus,
          emoji: userStatusEmoji,
          ends_at: "2100-02-01T09:35:00.000Z"
        }
      });
      await (0, _testHelpers.visit)("/");
      await openUserStatusModal();
      assert.equal((0, _qunitHelpers.query)(`.btn-emoji img.emoji`).title, userStatusEmoji, "status emoji is shown");
      assert.equal((0, _qunitHelpers.query)(".user-status-description").value, userStatus, "status description is shown");
      assert.equal((0, _qunitHelpers.query)(".date-picker").value, "2100-02-01", "date of auto removing of status is shown");
      assert.equal((0, _qunitHelpers.query)(".time-input").value, "09:35", "time of auto removing of status is shown");
    });
    (0, _qunit.test)("emoji picking", async function (assert) {
      this.siteSettings.enable_user_status = true;
      await (0, _testHelpers.visit)("/");
      await openUserStatusModal();
      assert.ok((0, _qunitHelpers.exists)(`.d-icon-discourse-emojis`), "empty status icon is shown");
      await (0, _testHelpers.click)(".btn-emoji");
      assert.ok((0, _qunitHelpers.exists)(".emoji-picker.opened"), "emoji picker is opened");
      await (0, _testHelpers.fillIn)(".emoji-picker-content .filter", userStatusEmoji);
      await (0, _testHelpers.click)(".results .emoji");
      assert.ok((0, _qunitHelpers.exists)(`.btn-emoji img.emoji[title=${userStatusEmoji}]`), "chosen status emoji is shown");
    });
    (0, _qunit.test)("setting user status", async function (assert) {
      this.siteSettings.enable_user_status = true;
      await (0, _testHelpers.visit)("/");
      await openUserStatusModal();
      await (0, _testHelpers.fillIn)(".user-status-description", userStatus);
      await pickEmoji(userStatusEmoji);
      assert.ok((0, _qunitHelpers.exists)(`.btn-emoji img.emoji[title=${userStatusEmoji}]`), "chosen status emoji is shown");
      await (0, _testHelpers.click)(".btn-primary"); // save

      assert.equal((0, _qunitHelpers.query)(".header-dropdown-toggle .user-status-background img.emoji").alt, `:${userStatusEmoji}:`, "shows user status emoji on the user avatar in the header");
      await (0, _testHelpers.click)(".header-dropdown-toggle.current-user");
      await (0, _testHelpers.click)(".menu-links-row .user-preferences-link");
      assert.equal((0, _qunitHelpers.query)("div.quick-access-panel li.user-status span.d-button-label").textContent.trim(), userStatus, "shows user status description on the menu");
      assert.equal((0, _qunitHelpers.query)("div.quick-access-panel li.user-status img.emoji").alt, `:${userStatusEmoji}:`, "shows user status emoji on the menu");
    });
    (0, _qunit.test)("updating user status", async function (assert) {
      this.siteSettings.enable_user_status = true;
      (0, _qunitHelpers.updateCurrentUser)({
        status: {
          description: userStatus
        }
      });
      const updatedStatus = "off to dentist the second time";
      await (0, _testHelpers.visit)("/");
      await openUserStatusModal();
      await (0, _testHelpers.fillIn)(".user-status-description", updatedStatus);
      await pickEmoji(userStatusEmoji);
      await (0, _testHelpers.click)(".btn-primary"); // save

      await (0, _testHelpers.click)(".header-dropdown-toggle.current-user");
      await (0, _testHelpers.click)(".menu-links-row .user-preferences-link");
      assert.equal((0, _qunitHelpers.query)("div.quick-access-panel li.user-status span.d-button-label").textContent.trim(), updatedStatus, "shows user status description on the menu");
      assert.equal((0, _qunitHelpers.query)("div.quick-access-panel li.user-status img.emoji").alt, `:${userStatusEmoji}:`, "shows user status emoji on the menu");
    });
    (0, _qunit.test)("clearing user status", async function (assert) {
      this.siteSettings.enable_user_status = true;
      (0, _qunitHelpers.updateCurrentUser)({
        status: {
          description: userStatus
        }
      });
      await (0, _testHelpers.visit)("/");
      await openUserStatusModal();
      await (0, _testHelpers.click)(".btn.delete-status");
      assert.notOk((0, _qunitHelpers.exists)(".header-dropdown-toggle .user-status-background"));
    });
    (0, _qunit.test)("setting user status with auto removing timer", async function (assert) {
      this.siteSettings.enable_user_status = true;
      await (0, _testHelpers.visit)("/");
      await openUserStatusModal();
      await (0, _testHelpers.fillIn)(".user-status-description", userStatus);
      await pickEmoji(userStatusEmoji);
      await (0, _testHelpers.click)("#tap_tile_one_hour");
      await (0, _testHelpers.click)(".btn-primary"); // save

      await (0, _testHelpers.click)(".header-dropdown-toggle.current-user");
      await (0, _testHelpers.click)(".menu-links-row .user-preferences-link");
      assert.equal((0, _qunitHelpers.query)("div.quick-access-panel li.user-status span.relative-date").textContent.trim(), "1h", "shows user status timer on the menu");
    });
    (0, _qunit.test)("it's impossible to set status without description", async function (assert) {
      this.siteSettings.enable_user_status = true;
      await (0, _testHelpers.visit)("/");
      await openUserStatusModal();
      await pickEmoji(userStatusEmoji);
      assert.ok((0, _qunitHelpers.exists)(`.btn-primary[disabled]`), "the save button is disabled");
    });
    (0, _qunit.test)("sets default status emoji automatically after user started inputting  status description", async function (assert) {
      this.siteSettings.enable_user_status = true;
      const defaultStatusEmoji = "speech_balloon";
      await (0, _testHelpers.visit)("/");
      await openUserStatusModal();
      await (0, _testHelpers.fillIn)(".user-status-description", "some status");
      assert.ok((0, _qunitHelpers.exists)(`.btn-emoji img.emoji[title=${defaultStatusEmoji}]`), "default status emoji is shown");
    });
    (0, _qunit.test)("shows actual status on the modal after canceling the modal and opening it again", async function (assert) {
      this.siteSettings.enable_user_status = true;
      (0, _qunitHelpers.updateCurrentUser)({
        status: {
          description: userStatus,
          emoji: userStatusEmoji
        }
      });
      await (0, _testHelpers.visit)("/");
      await openUserStatusModal();
      await (0, _testHelpers.fillIn)(".user-status-description", "another status");
      await pickEmoji("cold_face"); // another emoji

      await (0, _testHelpers.click)(".d-modal-cancel");
      await openUserStatusModal();
      assert.equal((0, _qunitHelpers.query)(`.btn-emoji img.emoji`).title, userStatusEmoji, "the actual status emoji is shown");
      assert.equal((0, _qunitHelpers.query)(".user-status-description").value, userStatus, "the actual status description is shown");
    });
    (0, _qunit.test)("shows the trash button when editing status that was set before", async function (assert) {
      this.siteSettings.enable_user_status = true;
      (0, _qunitHelpers.updateCurrentUser)({
        status: {
          description: userStatus
        }
      });
      await (0, _testHelpers.visit)("/");
      await openUserStatusModal();
      assert.ok((0, _qunitHelpers.exists)(".btn.delete-status"));
    });
    (0, _qunit.test)("doesn't show the trash button when status wasn't set before", async function (assert) {
      this.siteSettings.enable_user_status = true;
      (0, _qunitHelpers.updateCurrentUser)({
        status: null
      });
      await (0, _testHelpers.visit)("/");
      await openUserStatusModal();
      assert.notOk((0, _qunitHelpers.exists)(".btn.delete-status"));
    });
    (0, _qunit.test)("shows empty modal after deleting the status", async function (assert) {
      this.siteSettings.enable_user_status = true;
      (0, _qunitHelpers.updateCurrentUser)({
        status: {
          description: userStatus,
          emoji: userStatusEmoji
        }
      });
      await (0, _testHelpers.visit)("/");
      await openUserStatusModal();
      await (0, _testHelpers.click)(".btn.delete-status");
      await openUserStatusModal();
      assert.ok((0, _qunitHelpers.exists)(`.d-icon-discourse-emojis`), "empty status icon is shown");
      assert.equal((0, _qunitHelpers.query)(".user-status-description").value, "", "no status description is shown");
    });
  });
  (0, _qunitHelpers.acceptance)("User Status - new user menu", function (needs) {
    const userStatus = "off to dentist";
    const userStatusEmoji = "tooth";
    const userId = 1;
    const userTimezone = "UTC";
    needs.user({
      id: userId,
      timezone: userTimezone,
      redesigned_user_menu_enabled: true
    });
    needs.pretender((server, helper) => {
      server.put("/user-status.json", () => {
        (0, _qunitHelpers.publishToMessageBus)(`/user-status/${userId}`, {
          description: userStatus,
          emoji: userStatusEmoji
        });
        return helper.response({
          success: true
        });
      });
      server.delete("/user-status.json", () => {
        (0, _qunitHelpers.publishToMessageBus)(`/user-status/${userId}`, null);
        return helper.response({
          success: true
        });
      });
    });
    (0, _qunit.test)("doesn't show the user status button on the menu by default", async function (assert) {
      this.siteSettings.enable_user_status = false;
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".header-dropdown-toggle.current-user");
      await (0, _testHelpers.click)("#user-menu-button-profile");
      assert.notOk((0, _qunitHelpers.exists)("li.set-user-status"));
    });
    (0, _qunit.test)("shows the user status button on the menu when enabled in settings", async function (assert) {
      this.siteSettings.enable_user_status = true;
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".header-dropdown-toggle.current-user");
      await (0, _testHelpers.click)("#user-menu-button-profile");
      assert.ok((0, _qunitHelpers.exists)("li.set-user-status .btn"), "shows the button");
      assert.ok((0, _qunitHelpers.exists)("li.set-user-status svg.d-icon-plus-circle"), "shows the icon on the button");
    });
    (0, _qunit.test)("shows user status on the button", async function (assert) {
      this.siteSettings.enable_user_status = true;
      (0, _qunitHelpers.updateCurrentUser)({
        status: {
          description: userStatus,
          emoji: userStatusEmoji
        }
      });
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".header-dropdown-toggle.current-user");
      await (0, _testHelpers.click)("#user-menu-button-profile");
      assert.equal((0, _qunitHelpers.query)("li.set-user-status .item-label").textContent.trim(), userStatus, "shows user status description on the menu");
      assert.equal((0, _qunitHelpers.query)("li.set-user-status .emoji").alt, `${userStatusEmoji}`, "shows user status emoji on the menu");
      assert.equal((0, _qunitHelpers.query)(".header-dropdown-toggle .user-status-background img.emoji").alt, `:${userStatusEmoji}:`, "shows user status emoji on the user avatar in the header");
    });
    (0, _qunit.test)("user menu gets closed when the user status modal is opened", async function (assert) {
      this.siteSettings.enable_user_status = true;
      await (0, _testHelpers.visit)("/");
      await (0, _testHelpers.click)(".header-dropdown-toggle.current-user");
      await (0, _testHelpers.click)("#user-menu-button-profile");
      await (0, _testHelpers.click)(".set-user-status button");
      assert.notOk((0, _qunitHelpers.exists)(".user-menu"));
    });
  });
});
define("discourse/tests/acceptance/user-test", ["@ember/object", "discourse/models/user", "discourse/tests/helpers/select-kit-helper", "sinon", "discourse/tests/fixtures/user-fixtures", "discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse-common/lib/object", "qunit"], function (_object, _user, _selectKitHelper, _sinon, _userFixtures, _qunitHelpers, _testHelpers, _object2, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"@ember/object",0,"discourse/models/user",0,"discourse/tests/helpers/select-kit-helper",0,"sinon",0,"discourse/tests/fixtures/user-fixtures",0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse-common/lib/object",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User Routes", function (needs) {
    needs.user();
    needs.pretender((server, helper) => {
      server.get("/u/eviltrout%2F..%2F..%2F.json", () => helper.response(400, {}));
    });
    (0, _qunit.test)("Invalid usernames", async function (assert) {
      try {
        await (0, _testHelpers.visit)("/u/eviltrout%2F..%2F..%2F/summary");
      } catch (e) {
        if (e.message !== "TransitionAborted") {
          throw e;
        }
      }

      assert.strictEqual((0, _testHelpers.currentRouteName)(), "exception-unknown");
    });
    (0, _qunit.test)("Unicode usernames", async function (assert) {
      await (0, _testHelpers.visit)("/u/%E3%83%A9%E3%82%A4%E3%82%AA%E3%83%B3/summary");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "user.summary");
    });
    (0, _qunit.test)("Invites", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/invited/pending");
      assert.ok(document.body.classList.contains("user-invites-page"), "has the body class");
    });
    (0, _qunit.test)("Notifications", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/notifications");
      assert.ok(document.body.classList.contains("user-notifications-page"), "has the body class");
      const $links = (0, _qunitHelpers.queryAll)(".item.notification a");
      assert.ok($links[2].href.includes("/u/eviltrout/notifications/likes-received?acting_username=aquaman"));
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: true,
        admin: false
      });
      await (0, _testHelpers.visit)("/u/charlie/summary");
      assert.notOk((0, _qunitHelpers.exists)(".user-nav > .user-notifications"), "does not have the notifications tab");
      (0, _qunitHelpers.updateCurrentUser)({
        moderator: false,
        admin: true
      });
      await (0, _testHelpers.visit)("/u/charlie/summary");
      assert.ok((0, _qunitHelpers.exists)(".user-nav > .user-notifications"), "has the notifications tab");
    });
    (0, _qunit.test)("Root URL - Viewing Self", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout");
      assert.ok(document.body.classList.contains("user-activity-page"), "has the body class");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "userActivity.index", "it defaults to activity");
      assert.ok((0, _qunitHelpers.exists)(".container.viewing-self"), "has the viewing-self class");
    });
    (0, _qunit.test)("Viewing Drafts", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/activity/drafts");
      assert.ok((0, _qunitHelpers.exists)(".user-stream"), "has drafts stream");
      assert.ok((0, _qunitHelpers.exists)(".user-stream .user-stream-item-draft-actions"), "has draft action buttons");
      await (0, _testHelpers.click)(".user-stream button.resume-draft:nth-of-type(1)");
      assert.ok((0, _qunitHelpers.exists)(".d-editor-input"), "composer is visible after resuming a draft");
    });
  });
  (0, _qunitHelpers.acceptance)("User Routes - Periods in current user's username", function (needs) {
    needs.user({
      username: "e.il.rout"
    });
    (0, _qunit.test)("Periods in current user's username don't act like wildcards", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout");
      assert.strictEqual((0, _qunitHelpers.query)(".user-profile-names .username").textContent.trim(), "eviltrout", "eviltrout profile is shown");
      await (0, _testHelpers.visit)("/u/e.il.rout");
      assert.strictEqual((0, _qunitHelpers.query)(".user-profile-names .username").textContent.trim(), "e.il.rout", "e.il.rout profile is shown");
    });
  });
  (0, _qunitHelpers.acceptance)("User Routes - Moderator viewing warnings", function (needs) {
    needs.user({
      username: "notEviltrout",
      moderator: true,
      staff: true,
      admin: false
    });
    (0, _qunit.test)("Messages - Warnings", async function (assert) {
      await (0, _testHelpers.visit)("/u/eviltrout/messages/warnings");
      assert.ok(document.body.classList.contains("user-messages-page"), "has the body class");
      assert.ok((0, _qunitHelpers.exists)("div.alert-info"), "has the permissions alert");
    });
  });
  (0, _qunitHelpers.acceptance)("User - Saving user options", function (needs) {
    needs.user({
      admin: false,
      moderator: false,
      username: "eviltrout",
      id: 1,
      user_option: _object.default.create({})
    });
    needs.settings({
      disable_mailing_list_mode: false
    });
    needs.pretender((server, helper) => {
      server.put("/u/eviltrout.json", () => {
        return helper.response(200, {
          user: {}
        });
      });
    });
    (0, _qunit.test)("saving user options", async function (assert) {
      const spy = _sinon.default.spy(_user.default.current(), "_saveUserData");

      await (0, _testHelpers.visit)("/u/eviltrout/preferences/emails");
      await (0, _testHelpers.click)(".pref-mailing-list-mode input[type='checkbox']");
      await (0, _testHelpers.click)(".save-changes");
      assert.ok(spy.calledWithMatch({
        mailing_list_mode: true
      }), "sends a PUT request to update the specified user option");
      await (0, _selectKitHelper.default)("#user-email-messages-level").expand();
      await (0, _selectKitHelper.default)("#user-email-messages-level").selectRowByValue(2); // never option

      await (0, _testHelpers.click)(".save-changes");
      assert.ok(spy.calledWithMatch({
        email_messages_level: 2
      }), "is able to save a different user_option on a subsequent request");
    });
  });
  (0, _qunitHelpers.acceptance)("User - Notification level dropdown visibility", function (needs) {
    needs.user({
      username: "eviltrout",
      id: 1,
      ignored_ids: []
    });
    needs.pretender((server, helper) => {
      server.get("/u/charlie.json", () => {
        const cloned = (0, _object2.cloneJSON)(_userFixtures.default["/u/charlie.json"]);
        cloned.user.can_ignore_user = false;
        cloned.user.can_mute_user = false;
        return helper.response(200, cloned);
      });
    });
    (0, _qunit.test)("Notification level button is not rendered for user who cannot mute or ignore another user", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie");
      assert.notOk((0, _qunitHelpers.exists)(".user-notifications-dropdown"));
    });
  });
  (0, _qunitHelpers.acceptance)("User - Muting other user with notification level dropdown", function (needs) {
    needs.user({
      username: "eviltrout",
      id: 1,
      ignored_ids: []
    });
    needs.pretender((server, helper) => {
      server.get("/u/charlie.json", () => {
        const cloned = (0, _object2.cloneJSON)(_userFixtures.default["/u/charlie.json"]);
        cloned.user.can_mute_user = true;
        return helper.response(200, cloned);
      });
      server.put("/u/charlie/notification_level.json", request => {
        let requestParams = new URLSearchParams(request.requestBody); // Ensure the correct `notification_level` param is sent to the server

        if (requestParams.get("notification_level") === "mute") {
          return helper.response(200, {});
        } else {
          return helper.response(422, {});
        }
      });
    });
    (0, _qunit.test)("Notification level is set to normal and can be changed to muted", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie");
      assert.ok((0, _qunitHelpers.exists)(".user-notifications-dropdown"), "Notification level dropdown is present");
      const dropdown = (0, _selectKitHelper.default)(".user-notifications-dropdown");
      await dropdown.expand();
      assert.strictEqual(dropdown.selectedRow().value(), "changeToNormal");
      await dropdown.selectRowByValue("changeToMuted");
      await dropdown.expand();
      assert.strictEqual(dropdown.selectedRow().value(), "changeToMuted");
    });
  });
  (0, _qunitHelpers.acceptance)("User - Ignoring other user with notification level dropdown", function (needs) {
    needs.user({
      username: "eviltrout",
      id: 1,
      ignored_ids: []
    });
    needs.pretender((server, helper) => {
      server.get("/u/charlie.json", () => {
        const cloned = (0, _object2.cloneJSON)(_userFixtures.default["/u/charlie.json"]);
        cloned.user.can_ignore_user = true;
        return helper.response(200, cloned);
      });
      server.put("/u/charlie/notification_level.json", request => {
        let requestParams = new URLSearchParams(request.requestBody); // Ensure the correct `notification_level` param is sent to the server

        if (requestParams.get("notification_level") === "ignore") {
          return helper.response(200, {});
        } else {
          return helper.response(422, {});
        }
      });
    });
    (0, _qunit.test)("Notification level can be changed to ignored", async function (assert) {
      await (0, _testHelpers.visit)("/u/charlie");
      assert.ok((0, _qunitHelpers.exists)(".user-notifications-dropdown"), "Notification level dropdown is present");
      const notificationLevelDropdown = (0, _selectKitHelper.default)(".user-notifications-dropdown");
      await notificationLevelDropdown.expand();
      assert.strictEqual(notificationLevelDropdown.selectedRow().value(), "changeToNormal");
      await notificationLevelDropdown.selectRowByValue("changeToIgnored");
      assert.ok((0, _qunitHelpers.exists)(".ignore-duration-modal"));
      const durationDropdown = (0, _selectKitHelper.default)(".ignore-duration-modal .future-date-input-selector");
      await durationDropdown.expand();
      await durationDropdown.selectRowByIndex(0);
      await (0, _testHelpers.click)(".modal-footer .ignore-duration-save");
      await notificationLevelDropdown.expand();
      assert.strictEqual(notificationLevelDropdown.selectedRow().value(), "changeToIgnored");
    });
  });
});
define("discourse/tests/acceptance/users-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("User Directory", function () {
    (0, _qunit.test)("Visit Page", async function (assert) {
      await (0, _testHelpers.visit)("/u");
      assert.ok(document.body.classList.contains("users-page"), "has the body class");
      assert.ok((0, _qunitHelpers.exists)(".directory table tr"), "has a list of users");
    });
    (0, _qunit.test)("Visit All Time", async function (assert) {
      await (0, _testHelpers.visit)("/u?period=all");
      assert.ok((0, _qunitHelpers.exists)(".time-read"), "has time read column");
    });
    (0, _qunit.test)("Visit Without Usernames", async function (assert) {
      await (0, _testHelpers.visit)("/u?exclude_usernames=system");
      assert.ok(document.body.classList.contains("users-page"), "has the body class");
      assert.ok((0, _qunitHelpers.exists)(".directory table tr"), "has a list of users");
    });
    (0, _qunit.test)("Visit With Group Filter", async function (assert) {
      await (0, _testHelpers.visit)("/u?group=trust_level_0");
      assert.ok(document.body.classList.contains("users-page"), "has the body class");
      assert.ok((0, _qunitHelpers.exists)(".directory table tr"), "has a list of users");
    });
    (0, _qunit.test)("Custom user fields are present", async function (assert) {
      await (0, _testHelpers.visit)("/u");
      const firstRow = (0, _qunitHelpers.query)(".users-directory table tr");
      const columnData = firstRow.querySelectorAll("td");
      const favoriteColorTd = columnData[columnData.length - 1];
      assert.strictEqual(favoriteColorTd.querySelector("span").textContent, "Blue");
    });
    (0, _qunit.test)("Can sort table via keyboard", async function (assert) {
      await (0, _testHelpers.visit)("/u");
      const secondHeading = ".users-directory table th:nth-child(2) .header-contents";
      await (0, _testHelpers.triggerKeyEvent)(secondHeading, "keypress", "Enter");
      assert.ok((0, _qunitHelpers.query)(`${secondHeading} .d-icon-chevron-up`), "list has been sorted");
    });
  });
  (0, _qunitHelpers.acceptance)("User directory - Editing columns", function (needs) {
    needs.user({
      moderator: true,
      admin: true
    });
    (0, _qunit.test)("The automatic columns are checked and the user field columns are unchecked by default", async function (assert) {
      await (0, _testHelpers.visit)("/u");
      await (0, _testHelpers.click)(".open-edit-columns-btn");
      const columns = (0, _qunitHelpers.queryAll)(".edit-directory-columns-container .edit-directory-column");
      assert.strictEqual(columns.length, 8);
      const checked = (0, _qunitHelpers.queryAll)(".edit-directory-columns-container .edit-directory-column input[type='checkbox']:checked");
      assert.strictEqual(checked.length, 7);
      const unchecked = (0, _qunitHelpers.queryAll)(".edit-directory-columns-container .edit-directory-column input[type='checkbox']:not(:checked)");
      assert.strictEqual(unchecked.length, 1);
    });

    const fetchColumns = function () {
      return (0, _qunitHelpers.queryAll)(".edit-directory-columns-container .edit-directory-column");
    };

    (0, _qunit.test)("Reordering and restoring default positions", async function (assert) {
      await (0, _testHelpers.visit)("/u");
      await (0, _testHelpers.click)(".open-edit-columns-btn");
      let columns;
      columns = fetchColumns();
      assert.strictEqual(columns[3].querySelector(".column-name").textContent.trim(), "Replies Posted");
      assert.strictEqual(columns[4].querySelector(".column-name").textContent.trim(), "Topics Viewed"); // Click on row 4 and see if they are swapped

      await (0, _testHelpers.click)(columns[4].querySelector(".move-column-up"));
      columns = fetchColumns();
      assert.strictEqual(columns[3].querySelector(".column-name").textContent.trim(), "Topics Viewed");
      assert.strictEqual(columns[4].querySelector(".column-name").textContent.trim(), "Replies Posted");
      const moveUserFieldColumnUpBtn = columns[columns.length - 1].querySelector(".move-column-up");
      await (0, _testHelpers.click)(moveUserFieldColumnUpBtn);
      await (0, _testHelpers.click)(moveUserFieldColumnUpBtn);
      await (0, _testHelpers.click)(moveUserFieldColumnUpBtn);
      columns = fetchColumns();
      assert.strictEqual(columns[4].querySelector(".column-name").textContent.trim(), "Favorite Color");
      assert.strictEqual(columns[5].querySelector(".column-name").textContent.trim(), "Replies Posted"); // Now click restore default and check order of column names

      await (0, _testHelpers.click)(".reset-to-default");
      let columnNames = (0, _qunitHelpers.queryAll)(".edit-directory-columns-container .edit-directory-column .column-name").toArray();
      columnNames = columnNames.map(el => el.textContent.trim());
      assert.deepEqual(columnNames, ["Received", "Given", "Topics Created", "Replies Posted", "Topics Viewed", "Posts Read", "Days Visited", "Favorite Color"]);
    });
  });
});
define("discourse/tests/acceptance/welcome-topic-banner-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers"], function (_qunitHelpers, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Welcome Topic Banner", function (needs) {
    needs.user();
    needs.site({
      show_welcome_topic_banner: true
    });
    (0, _qunit.test)("Navigation", async function (assert) {
      await (0, _testHelpers.visit)("/");
      assert.ok((0, _qunitHelpers.exists)(".welcome-topic-banner"), "has the welcome topic banner");
      assert.ok((0, _qunitHelpers.exists)("button.welcome-topic-cta"), "has the welcome topic edit button");
    });
  });
});
define("discourse/tests/acceptance/wizard-test", ["discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "qunit"], function (_qunitHelpers, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("Wizard", function (needs) {
    needs.user();
    (0, _qunit.test)("Wizard starts", async function (assert) {
      await (0, _testHelpers.visit)("/wizard");
      assert.ok((0, _qunitHelpers.exists)(".wizard-container"));
      assert.notOk((0, _qunitHelpers.exists)(".d-header-wrap"), "header is not rendered on wizard pages");
      assert.strictEqual((0, _testHelpers.currentRouteName)(), "wizard.step");
    });
    (0, _qunit.test)("Going back and forth in steps", async function (assert) {
      await (0, _testHelpers.visit)("/wizard/steps/hello-world");
      assert.ok((0, _qunitHelpers.exists)(".wizard-container__step"));
      assert.ok((0, _qunitHelpers.exists)(".wizard-container__step.hello-world"), "it adds a class for the step id");
      assert.ok(!(0, _qunitHelpers.exists)(".wizard-container__button.finish"), "cannot finish on first step");
      assert.ok((0, _qunitHelpers.exists)(".wizard-container__step-progress"));
      assert.ok((0, _qunitHelpers.exists)(".wizard-container__step-title"));
      assert.ok((0, _qunitHelpers.exists)(".wizard-container__step-description"));
      assert.ok(!(0, _qunitHelpers.exists)(".invalid #full_name"), "don't show it as invalid until the user does something");
      assert.ok(!(0, _qunitHelpers.exists)(".wizard-container__button.back"));
      assert.ok(!(0, _qunitHelpers.exists)(".wizard-container__field .error")); // invalid data

      await (0, _testHelpers.click)(".wizard-container__button.next");
      assert.ok((0, _qunitHelpers.exists)(".invalid #full_name")); // server validation fail

      await (0, _testHelpers.fillIn)("input#full_name", "Server Fail");
      await (0, _testHelpers.click)(".wizard-container__button.next");
      assert.ok((0, _qunitHelpers.exists)(".invalid #full_name"));
      assert.ok((0, _qunitHelpers.exists)(".wizard-container__field .error")); // server validation ok

      await (0, _testHelpers.fillIn)("input#full_name", "Evil Trout");
      await (0, _testHelpers.click)(".wizard-container__button.next");
      assert.ok(!(0, _qunitHelpers.exists)(".wizard-container__field .error"));
      assert.ok(!(0, _qunitHelpers.exists)(".wizard-container__step-description"));
      assert.ok((0, _qunitHelpers.exists)(".wizard-container__button.finish"), "shows finish on an intermediate step");
      await (0, _testHelpers.click)(".wizard-container__button.finish");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/latest", "it should transition to the homepage");
      await (0, _testHelpers.visit)("/wizard/steps/styling");
      await (0, _testHelpers.click)(".wizard-container__button.next");
      assert.ok((0, _qunitHelpers.exists)(".wizard-container__text-input#company_name"), "went to the next step");
      assert.ok((0, _qunitHelpers.exists)(".wizard-container__preview"), "renders the component field");
      assert.ok((0, _qunitHelpers.exists)(".wizard-container__button.jump-in"), "last step shows a jump in button");
      assert.ok((0, _qunitHelpers.exists)(".wizard-container__link.back"), "shows the back button");
      assert.ok(!(0, _qunitHelpers.exists)(".wizard-container__step-title"));
      assert.ok(!(0, _qunitHelpers.exists)(".wizard-container__button.next"), "does not show next button");
      assert.ok(!(0, _qunitHelpers.exists)(".wizard-container__button.finish"), "cannot finish on last step");
      await (0, _testHelpers.click)(".wizard-container__link.back");
      assert.ok((0, _qunitHelpers.exists)(".wizard-container__step-title"), "shows the step title");
      assert.ok((0, _qunitHelpers.exists)(".wizard-container__button.next"), "shows the next button");
      await (0, _testHelpers.click)(".wizard-container__button.next"); // server validation fail

      await (0, _testHelpers.fillIn)("input#company_name", "Server Fail");
      await (0, _testHelpers.click)(".wizard-container__button.jump-in");
      assert.ok((0, _qunitHelpers.exists)(".invalid #company_name"), "highlights the field with error");
      assert.ok((0, _qunitHelpers.exists)(".wizard-container__field .error"), "shows the error");
      await (0, _testHelpers.fillIn)("input#company_name", "Foo Bar");
      await (0, _testHelpers.click)(".wizard-container__button.jump-in");
      assert.strictEqual((0, _testHelpers.currentURL)(), "/latest", "it should transition to the homepage");
    });
  });
});
define("discourse/tests/helpers/component-test", ["exports", "@ember/test-helpers", "discourse/models/session", "discourse/models/site", "discourse/models/topic-tracking-state", "discourse/models/user", "discourse/initializers/auto-load-modules", "qunit", "ember-qunit", "discourse/tests/helpers/site-settings", "discourse/pre-initializers/inject-discourse-objects"], function (_exports, _testHelpers, _session, _site, _topicTrackingState, _user, _autoLoadModules, _qunit, _emberQunit, _siteSettings, _injectDiscourseObjects) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.default = _default;
  _exports.setupRenderingTest = setupRenderingTest;
  0; //eaimeta@70e063a35619d71f0,"@ember/test-helpers",0,"discourse/models/session",0,"discourse/models/site",0,"discourse/models/topic-tracking-state",0,"discourse/models/user",0,"discourse/initializers/auto-load-modules",0,"qunit",0,"ember-qunit",0,"discourse/tests/helpers/site-settings",0,"discourse/pre-initializers/inject-discourse-objects"eaimeta@70e063a35619d71f

  function setupRenderingTest(hooks) {
    (0, _emberQunit.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      if (!hooks.usingDiscourseModule) {
        this.siteSettings = (0, _siteSettings.currentSettings)();
        this.registry ||= this.owner.__registry__;
        this.container = this.owner;
      }

      this.site = _site.default.current();
      this.session = _session.default.current();

      const currentUser = _user.default.create({
        username: "eviltrout",
        timezone: "Australia/Brisbane"
      });

      this.currentUser = currentUser;
      this.owner.unregister("service:current-user");
      this.owner.register("service:current-user", currentUser, {
        instantiate: false
      });
      this.owner.inject("component", "currentUser", "service:current-user");
      (0, _injectDiscourseObjects.injectServiceIntoService)({
        app: this.owner.application,
        property: "currentUser",
        specifier: "service:current-user"
      });
      this.owner.unregister("service:topic-tracking-state");
      this.owner.register("service:topic-tracking-state", _topicTrackingState.default.create({
        currentUser
      }), {
        instantiate: false
      });
      (0, _injectDiscourseObjects.injectServiceIntoService)({
        app: this.owner.application,
        property: "topicTrackingState",
        specifier: "service:topic-tracking-state"
      });
      (0, _autoLoadModules.autoLoadModules)(this.owner, this.registry);
      this.owner.lookup("service:store");

      $.fn.autocomplete = function () {};
    });
  }

  function _default(name, hooks, opts) {
    if (opts === undefined) {
      opts = hooks;
    }

    opts = opts || {};

    if (opts.skip) {
      return;
    }

    if (typeof opts.template === "string") {
      let testName = _qunit.default.config.currentModule.name + " " + name; // eslint-disable-next-line

      console.warn(`${testName} skipped; template must be compiled and not a string`);
      return;
    }

    (0, _qunit.test)(name, async function (assert) {
      if (opts.anonymous) {
        this.owner.unregister("service:current-user");
      }

      if (opts.beforeEach) {
        const store = this.owner.lookup("service:store");
        await opts.beforeEach.call(this, store);
      }

      try {
        await (0, _testHelpers.render)(opts.template);
        await opts.test.call(this, assert);
      } finally {
        if (opts.afterEach) {
          await opts.afterEach.call(opts);
        }
      }
    });
  }
});
define("discourse/tests/integration/components/ace-editor-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | ace-editor", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("css editor", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <AceEditor @mode="css" />
      */
      {
        "id": "7jSDVf+O",
        "block": "[[[8,[39,0],null,[[\"@mode\"],[\"css\"]],null]],[],false,[\"ace-editor\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".ace_editor"), "it renders the ace editor");
    });
    (0, _qunit.test)("html editor", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <AceEditor @mode="html" @content="<b>wat</b>" />
      */
      {
        "id": "d6baBvT3",
        "block": "[[[8,[39,0],null,[[\"@mode\",\"@content\"],[\"html\",\"<b>wat</b>\"]],null]],[],false,[\"ace-editor\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".ace_editor"), "it renders the ace editor");
    });
    (0, _qunit.test)("sql editor", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <AceEditor @mode="sql" @content="SELECT * FROM users" />
      */
      {
        "id": "HKNGqwVm",
        "block": "[[[8,[39,0],null,[[\"@mode\",\"@content\"],[\"sql\",\"SELECT * FROM users\"]],null]],[],false,[\"ace-editor\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".ace_editor"), "it renders the ace editor");
    });
    (0, _qunit.test)("disabled editor", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <AceEditor @mode="sql" @content="SELECT * FROM users" @disabled=true />
          
      */
      {
        "id": "J3kMW4yM",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@mode\",\"@content\",\"@disabled\"],[\"sql\",\"SELECT * FROM users\",\"true\"]],null],[1,\"\\n    \"]],[],false,[\"ace-editor\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".ace_editor"), "it renders the ace editor");
      assert.strictEqual((0, _qunitHelpers.count)(".ace-wrapper[data-disabled]"), 1, "it has a data-disabled attr");
    });
  });
});
define("discourse/tests/integration/components/activation-controls-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | activation-controls", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("hides change email button", async function (assert) {
      this.siteSettings.enable_local_logins = false;
      this.siteSettings.email_editable = false;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <ActivationControls />
      */
      {
        "id": "m2ULMU3q",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"activation-controls\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)("button.edit-email"));
    });
  });
});
define("discourse/tests/integration/components/admin-report-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/create-pretender"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _createPretender) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/create-pretender"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | admin-report", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("default", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <AdminReport @dataSourceName="signups" />
      */
      {
        "id": "NRoREgp3",
        "block": "[[[8,[39,0],null,[[\"@dataSourceName\"],[\"signups\"]],null]],[],false,[\"admin-report\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".admin-report.signups"));
      assert.ok((0, _qunitHelpers.exists)(".admin-report.signups", "it defaults to table mode"));
      assert.strictEqual((0, _qunitHelpers.query)(".header .item.report").innerText.trim(), "Signups", "it has a title");
      assert.strictEqual((0, _qunitHelpers.query)(".header .info").getAttribute("data-tooltip"), "New account registrations for this period", "it has a description");
      assert.strictEqual((0, _qunitHelpers.query)(".admin-report-table thead tr th:first-child .title").innerText.trim(), "Day", "it has col headers");
      assert.strictEqual((0, _qunitHelpers.query)(".admin-report-table thead tr th:nth-child(2) .title").innerText.trim(), "Count", "it has col headers");
      assert.strictEqual((0, _qunitHelpers.query)(".admin-report-table tbody tr:nth-child(1) td:nth-child(1)").innerText.trim(), "June 16, 2018", "it has rows");
      assert.strictEqual((0, _qunitHelpers.query)(".admin-report-table tbody tr:nth-child(1) td:nth-child(2)").innerText.trim(), "12", "it has rows");
      assert.ok((0, _qunitHelpers.exists)(".total-row"), "it has totals");
      await (0, _testHelpers.click)(".admin-report-table-header.y .sort-btn");
      assert.strictEqual((0, _qunitHelpers.query)(".admin-report-table tbody tr:nth-child(1) td:nth-child(2)").innerText.trim(), "7", "it can sort rows");
    });
    (0, _qunit.test)("options", async function (assert) {
      this.set("options", {
        table: {
          perPage: 4,
          total: false
        }
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <AdminReport @dataSourceName="signups" @reportOptions={{this.options}} />
      */
      {
        "id": "uEiy0Pb9",
        "block": "[[[8,[39,0],null,[[\"@dataSourceName\",\"@reportOptions\"],[\"signups\",[30,0,[\"options\"]]]],null]],[],false,[\"admin-report\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".pagination"), "it paginates the results");
      assert.strictEqual((0, _qunitHelpers.count)(".pagination button"), 3, "it creates the correct number of pages");
      assert.notOk((0, _qunitHelpers.exists)(".totals-sample-table"), "it hides totals");
    });
    (0, _qunit.test)("switch modes", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <AdminReport @dataSourceName="signups" @showFilteringUI={{true}} />
      */
      {
        "id": "pcnQISCL",
        "block": "[[[8,[39,0],null,[[\"@dataSourceName\",\"@showFilteringUI\"],[\"signups\",true]],null]],[],false,[\"admin-report\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".mode-btn.chart");
      assert.notOk((0, _qunitHelpers.exists)(".admin-report-table"), "it removes the table");
      assert.ok((0, _qunitHelpers.exists)(".admin-report-chart"), "it shows the chart");
    });
    (0, _qunit.test)("timeout", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <AdminReport @dataSourceName="signups_timeout" />
      */
      {
        "id": "FH+DpEGK",
        "block": "[[[8,[39,0],null,[[\"@dataSourceName\"],[\"signups_timeout\"]],null]],[],false,[\"admin-report\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".alert-error.timeout"), "it displays a timeout error");
    });
    (0, _qunit.test)("no data", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <AdminReport @dataSourceName="posts" />
      */
      {
        "id": "f0wZu1LZ",
        "block": "[[[8,[39,0],null,[[\"@dataSourceName\"],[\"posts\"]],null]],[],false,[\"admin-report\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".no-data"), "it displays a no data alert");
    });
    (0, _qunit.test)("exception", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <AdminReport @dataSourceName="signups_exception" />
      */
      {
        "id": "eP9TfiaZ",
        "block": "[[[8,[39,0],null,[[\"@dataSourceName\"],[\"signups_exception\"]],null]],[],false,[\"admin-report\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".alert-error.exception"), "it displays an error");
    });
    (0, _qunit.test)("rate limited", async function (assert) {
      _createPretender.default.get("/admin/reports/bulk", () => (0, _createPretender.response)(429, {
        errors: ["Youve performed this action too many times. Please wait 10 seconds before trying again."],
        error_type: "rate_limit",
        extras: {
          wait_seconds: 10
        }
      }));

      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <AdminReport @dataSourceName="signups_rate_limited" />
      */
      {
        "id": "Z86OA69H",
        "block": "[[[8,[39,0],null,[[\"@dataSourceName\"],[\"signups_rate_limited\"]],null]],[],false,[\"admin-report\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".alert-error.rate-limited"), "it displays a rate limited error");
    });
    (0, _qunit.test)("post edits", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <AdminReport @dataSourceName="post_edits" />
      */
      {
        "id": "oGaMXGAy",
        "block": "[[[8,[39,0],null,[[\"@dataSourceName\"],[\"post_edits\"]],null]],[],false,[\"admin-report\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".admin-report.post-edits"), "it displays the post edits report");
    });
    (0, _qunit.test)("not found", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <AdminReport @dataSourceName="not_found" />
      */
      {
        "id": "Rq6ioTkU",
        "block": "[[[8,[39,0],null,[[\"@dataSourceName\"],[\"not_found\"]],null]],[],false,[\"admin-report\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".alert-error.not-found"), "it displays a not found error");
    });
  });
});
define("discourse/tests/integration/components/admin-user-field-item-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "I18n"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | admin-user-field-item", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("user field without an id", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <AdminUserFieldItem @userField={{this.userField}} />
      */
      {
        "id": "K198Mh3A",
        "block": "[[[8,[39,0],null,[[\"@userField\"],[[30,0,[\"userField\"]]]],null]],[],false,[\"admin-user-field-item\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".save"), "displays editing mode");
    });
    (0, _qunit.test)("cancel action", async function (assert) {
      this.set("userField", {
        id: 1,
        field_type: "text"
      });
      this.set("isEditing", true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <AdminUserFieldItem @isEditing={{this.isEditing}} @destroyAction={{this.destroyAction}} @userField={{this.userField}} />
      */
      {
        "id": "fhdsU+Xo",
        "block": "[[[8,[39,0],null,[[\"@isEditing\",\"@destroyAction\",\"@userField\"],[[30,0,[\"isEditing\"]],[30,0,[\"destroyAction\"]],[30,0,[\"userField\"]]]],null]],[],false,[\"admin-user-field-item\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".cancel");
      assert.ok((0, _qunitHelpers.exists)(".edit"));
    });
    (0, _qunit.test)("edit action", async function (assert) {
      this.set("userField", {
        id: 1,
        field_type: "text"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <AdminUserFieldItem @destroyAction={{this.destroyAction}} @userField={{this.userField}} />
      */
      {
        "id": "cr3chEeL",
        "block": "[[[8,[39,0],null,[[\"@destroyAction\",\"@userField\"],[[30,0,[\"destroyAction\"]],[30,0,[\"userField\"]]]],null]],[],false,[\"admin-user-field-item\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".edit");
      assert.ok((0, _qunitHelpers.exists)(".save"));
    });
    (0, _qunit.test)("user field with an id", async function (assert) {
      this.set("userField", {
        id: 1,
        field_type: "text",
        name: "foo",
        description: "what is foo"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <AdminUserFieldItem @userField={{this.userField}} />
      */
      {
        "id": "K198Mh3A",
        "block": "[[[8,[39,0],null,[[\"@userField\"],[[30,0,[\"userField\"]]]],null]],[],false,[\"admin-user-field-item\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".name").innerText, this.userField.name);
      assert.strictEqual((0, _qunitHelpers.query)(".description").innerText, this.userField.description);
      assert.strictEqual((0, _qunitHelpers.query)(".field-type").innerText, _I18n.default.t("admin.user_fields.field_types.text"));
    });
  });
});
define("discourse/tests/integration/components/avatar-uploader-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/create-pretender"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _createPretender) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/create-pretender"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | avatar-uploader", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      _createPretender.default.post("/uploads.json", () => (0, _createPretender.response)({}));
    });
    (0, _qunit.test)("default", async function (assert) {
      const done = assert.async();
      this.set("done", () => {
        assert.ok(true, "action is called after avatar is uploaded");
        done();
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <AvatarUploader
              @id="avatar-uploader"
              @done={{this.done}}
            />
          
      */
      {
        "id": "Op8fFYe2",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@id\",\"@done\"],[\"avatar-uploader\",[30,0,[\"done\"]]]],null],[1,\"\\n    \"]],[],false,[\"avatar-uploader\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.container.lookup("service:app-events").trigger("upload-mixin:avatar-uploader:add-files", [(0, _qunitHelpers.createFile)("avatar.png")]);
    });
  });
});
define("discourse/tests/integration/components/badge-button-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | badge-button", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("disabled badge", async function (assert) {
      this.set("badge", {
        enabled: false
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <BadgeButton @badge={{this.badge}} />
      */
      {
        "id": "uSc8w8Uk",
        "block": "[[[8,[39,0],null,[[\"@badge\"],[[30,0,[\"badge\"]]]],null]],[],false,[\"badge-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".user-badge.disabled"));
    });
    (0, _qunit.test)("enabled badge", async function (assert) {
      this.set("badge", {
        enabled: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <BadgeButton @badge={{this.badge}} />
      */
      {
        "id": "uSc8w8Uk",
        "block": "[[[8,[39,0],null,[[\"@badge\"],[[30,0,[\"badge\"]]]],null]],[],false,[\"badge-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.notOk((0, _qunitHelpers.exists)(".user-badge.disabled"));
    });
    (0, _qunit.test)("data-badge-name", async function (assert) {
      this.set("badge", {
        name: "foo"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <BadgeButton @badge={{this.badge}} />
      */
      {
        "id": "uSc8w8Uk",
        "block": "[[[8,[39,0],null,[[\"@badge\"],[[30,0,[\"badge\"]]]],null]],[],false,[\"badge-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)('.user-badge[data-badge-name="foo"]'));
    });
    (0, _qunit.test)("title", async function (assert) {
      this.set("badge", {
        description: "a <a href>good</a> run"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <BadgeButton @badge={{this.badge}} />
      */
      {
        "id": "uSc8w8Uk",
        "block": "[[[8,[39,0],null,[[\"@badge\"],[[30,0,[\"badge\"]]]],null]],[],false,[\"badge-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".user-badge").title, "a good run", "it strips html");
      this.set("badge", {
        description: "a bad run"
      });
      assert.strictEqual((0, _qunitHelpers.query)(".user-badge").title, "a bad run", "it updates title when changing description");
    });
    (0, _qunit.test)("icon", async function (assert) {
      this.set("badge", {
        icon: "times"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <BadgeButton @badge={{this.badge}} />
      */
      {
        "id": "uSc8w8Uk",
        "block": "[[[8,[39,0],null,[[\"@badge\"],[[30,0,[\"badge\"]]]],null]],[],false,[\"badge-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".d-icon.d-icon-times"));
    });
    (0, _qunit.test)("accepts block", async function (assert) {
      this.set("badge", {});
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <BadgeButton @badge={{this.badge}}>
              <span class="test"></span>
            </BadgeButton>
          
      */
      {
        "id": "Hf7olqav",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@badge\"],[[30,0,[\"badge\"]]]],[[\"default\"],[[[[1,\"\\n        \"],[10,1],[14,0,\"test\"],[12],[13],[1,\"\\n      \"]],[]]]]],[1,\"\\n    \"]],[],false,[\"badge-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".test"));
    });
    (0, _qunit.test)("badgeTypeClassName", async function (assert) {
      this.set("badge", {
        badgeTypeClassName: "foo"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <BadgeButton @badge={{this.badge}} />
      */
      {
        "id": "uSc8w8Uk",
        "block": "[[[8,[39,0],null,[[\"@badge\"],[[30,0,[\"badge\"]]]],null]],[],false,[\"badge-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".user-badge.foo"));
    });
  });
});
define("discourse/tests/integration/components/badge-title-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/create-pretender", "discourse/tests/helpers/select-kit-helper", "@ember/object"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _createPretender, _selectKitHelper, _object) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/create-pretender",0,"discourse/tests/helpers/select-kit-helper",0,"@ember/object"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | badge-title", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("badge title", async function (assert) {
      this.set("subject", (0, _selectKitHelper.default)());
      this.set("selectableUserBadges", [_object.default.create({
        id: 0,
        badge: {
          name: "(none)"
        }
      }), _object.default.create({
        id: 42,
        badge_id: 102,
        badge: {
          name: "Test"
        }
      })]);

      _createPretender.default.put("/u/eviltrout/preferences/badge_title", () => (0, _createPretender.response)({}));

      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <BadgeTitle @selectableUserBadges={{this.selectableUserBadges}} />
          
      */
      {
        "id": "rnpDxUCK",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@selectableUserBadges\"],[[30,0,[\"selectableUserBadges\"]]]],null],[1,\"\\n    \"]],[],false,[\"badge-title\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      await this.subject.selectRowByValue(42);
      await (0, _testHelpers.click)(".btn");
      assert.strictEqual(this.currentUser.title, "Test");
    });
  });
});
define("discourse/tests/integration/components/bookmark-icon-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/models/bookmark", "I18n", "discourse/lib/bookmark", "discourse/lib/time-utils"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _bookmark, _I18n, _bookmark2, _timeUtils) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/models/bookmark",0,"I18n",0,"discourse/lib/bookmark",0,"discourse/lib/time-utils"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | bookmark-icon", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("with reminder", async function (assert) {
      this.setProperties({
        bookmark: _bookmark.default.create({
          reminder_at: (0, _timeUtils.tomorrow)(this.currentUser.timezone),
          name: "some name"
        })
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <BookmarkIcon @bookmark={{this.bookmark}} />
      */
      {
        "id": "y0IqfONL",
        "block": "[[[8,[39,0],null,[[\"@bookmark\"],[[30,0,[\"bookmark\"]]]],null]],[],false,[\"bookmark-icon\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".d-icon-discourse-bookmark-clock.bookmark-icon__bookmarked"));
      assert.strictEqual((0, _qunitHelpers.query)(".svg-icon-title").title, _I18n.default.t("bookmarks.created_with_reminder_generic", {
        date: (0, _bookmark2.formattedReminderTime)(this.bookmark.reminder_at, this.currentUser.timezone),
        name: "some name"
      }));
    });
    (0, _qunit.test)("no reminder", async function (assert) {
      this.set("bookmark", _bookmark.default.create({
        name: "some name"
      }));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <BookmarkIcon @bookmark={{this.bookmark}} />
      */
      {
        "id": "y0IqfONL",
        "block": "[[[8,[39,0],null,[[\"@bookmark\"],[[30,0,[\"bookmark\"]]]],null]],[],false,[\"bookmark-icon\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".d-icon-bookmark.bookmark-icon__bookmarked"));
      assert.strictEqual((0, _qunitHelpers.query)(".svg-icon-title").title, _I18n.default.t("bookmarks.created_generic", {
        name: "some name"
      }));
    });
    (0, _qunit.test)("null bookmark", async function (assert) {
      this.setProperties({
        bookmark: null
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <BookmarkIcon @bookmark={{this.bookmark}} />
      */
      {
        "id": "y0IqfONL",
        "block": "[[[8,[39,0],null,[[\"@bookmark\"],[[30,0,[\"bookmark\"]]]],null]],[],false,[\"bookmark-icon\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".d-icon-bookmark.bookmark-icon"));
      assert.strictEqual((0, _qunitHelpers.query)(".svg-icon-title").title, _I18n.default.t("bookmarks.create"));
    });
  });
});
define("discourse/tests/integration/components/bookmark-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | bookmark", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.setProperties({
        model: {},
        closeModal: () => {},
        afterSave: () => {},
        afterDelete: () => {},
        registerOnCloseHandler: () => {},
        onCloseWithoutSaving: () => {}
      });
    });
    (0, _qunit.test)("prefills the custom reminder type date and time", async function (assert) {
      let name = "test";
      let reminderAt = "2020-05-15T09:45:00";
      this.model = {
        id: 1,
        name,
        reminderAt
      };
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <Bookmark
              @model={{this.model}}
              @afterSave={{this.afterSave}}
              @afterDelete={{this.afterDelete}}
              @onCloseWithoutSaving={{this.onCloseWithoutSaving}}
              @registerOnCloseHandler={{this.registerOnCloseHandler}}
              @closeModal={{this.closeModal}}
            />
          
      */
      {
        "id": "oGi0ZK3d",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@model\",\"@afterSave\",\"@afterDelete\",\"@onCloseWithoutSaving\",\"@registerOnCloseHandler\",\"@closeModal\"],[[30,0,[\"model\"]],[30,0,[\"afterSave\"]],[30,0,[\"afterDelete\"]],[30,0,[\"onCloseWithoutSaving\"]],[30,0,[\"registerOnCloseHandler\"]],[30,0,[\"closeModal\"]]]],null],[1,\"\\n    \"]],[],false,[\"bookmark\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("#bookmark-name").value, "test");
      assert.strictEqual((0, _qunitHelpers.query)("#custom-date > .date-picker").value, "2020-05-15");
      assert.strictEqual((0, _qunitHelpers.query)("#custom-time").value, "09:45");
    });
  });
});
define("discourse/tests/integration/components/category-badge-helper-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/models/category"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _category) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/models/category"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | category-badge helper", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("displays category", async function (assert) {
      this.set("category", _category.default.findById(1));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        {{category-badge category}}
      */
      {
        "id": "74RfS3pG",
        "block": "[[[1,[28,[35,0],[[33,1]],null]]],[],false,[\"category-badge\",\"category\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".category-name").innerText.trim(), this.category.name);
    });
    (0, _qunit.test)("options.link", async function (assert) {
      this.set("category", _category.default.findById(1));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        {{category-badge category link=true}}
      */
      {
        "id": "EQKMYN4J",
        "block": "[[[1,[28,[35,0],[[33,1]],[[\"link\"],[true]]]]],[],false,[\"category-badge\",\"category\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(`a.badge-wrapper[href="/c/${this.category.slug}/${this.category.id}"]`));
    });
  });
});
define("discourse/tests/integration/components/cook-text-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/create-pretender", "pretty-text/upload-short-url"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _createPretender, _uploadShortUrl) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/create-pretender",0,"pretty-text/upload-short-url"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | cook-text", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.afterEach(function () {
      (0, _uploadShortUrl.resetCache)();
    });
    (0, _qunit.test)("renders markdown", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <CookText @rawText="_foo_" @class="post-body" />
      */
      {
        "id": "L7PxvjXa",
        "block": "[[[8,[39,0],null,[[\"@rawText\",\"@class\"],[\"_foo_\",\"post-body\"]],null]],[],false,[\"cook-text\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const html = (0, _qunitHelpers.query)(".post-body").innerHTML.trim();
      assert.strictEqual(html, "<p><em>foo</em></p>");
    });
    (0, _qunit.test)("resolves short URLs", async function (assert) {
      _createPretender.default.post("/uploads/lookup-urls", () => (0, _createPretender.response)([{
        short_url: "upload://a.png",
        url: "/images/avatar.png",
        short_path: "/images/d-logo-sketch.png"
      }]));

      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <CookText @rawText="![an image](upload://a.png)" @class="post-body" />
      */
      {
        "id": "vvOHf1fI",
        "block": "[[[8,[39,0],null,[[\"@rawText\",\"@class\"],[\"![an image](upload://a.png)\",\"post-body\"]],null]],[],false,[\"cook-text\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const html = (0, _qunitHelpers.query)(".post-body").innerHTML.trim();
      assert.strictEqual(html, '<p><img src="/images/avatar.png" alt="an image"></p>');
    });
  });
});
define("discourse/tests/integration/components/d-button-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "I18n"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"I18n",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | d-button", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("icon only button", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DButton @icon="plus" tabindex="3" />
      */
      {
        "id": "sd4QLGKH",
        "block": "[[[8,[39,0],[[24,\"tabindex\",\"3\"]],[[\"@icon\"],[\"plus\"]],null]],[],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("button.btn.btn-icon.no-text"), "it has all the classes");
      assert.ok((0, _qunitHelpers.exists)("button .d-icon.d-icon-plus"), "it has the icon");
      assert.strictEqual((0, _qunitHelpers.query)("button").getAttribute("tabindex"), "3", "it has the tabindex");
    });
    (0, _qunit.test)("icon and text button", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DButton @icon="plus" @label="topic.create" />
      */
      {
        "id": "RwH15QHp",
        "block": "[[[8,[39,0],null,[[\"@icon\",\"@label\"],[\"plus\",\"topic.create\"]],null]],[],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("button.btn.btn-icon-text"), "it has all the classes");
      assert.ok((0, _qunitHelpers.exists)("button .d-icon.d-icon-plus"), "it has the icon");
      assert.ok((0, _qunitHelpers.exists)("button span.d-button-label"), "it has the label");
    });
    (0, _qunit.test)("text only button", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DButton @label="topic.create" />
      */
      {
        "id": "4xIyfUsn",
        "block": "[[[8,[39,0],null,[[\"@label\"],[\"topic.create\"]],null]],[],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("button.btn.btn-text"), "it has all the classes");
      assert.ok((0, _qunitHelpers.exists)("button span.d-button-label"), "it has the label");
    });
    (0, _qunit.test)("form attribute", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DButton @form="login-form" />
      */
      {
        "id": "s0c1yk2S",
        "block": "[[[8,[39,0],null,[[\"@form\"],[\"login-form\"]],null]],[],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("button[form=login-form]"), "it has the form attribute");
    });
    (0, _qunit.test)("link-styled button", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DButton @display="link" />
      */
      {
        "id": "RnFJ5i/v",
        "block": "[[[8,[39,0],null,[[\"@display\"],[\"link\"]],null]],[],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("button.btn-link:not(.btn)"), "it has the right classes");
    });
    (0, _qunit.test)("isLoading button", async function (assert) {
      this.set("isLoading", true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DButton @isLoading={{this.isLoading}} />
      */
      {
        "id": "PiGnZLF7",
        "block": "[[[8,[39,0],null,[[\"@isLoading\"],[[30,0,[\"isLoading\"]]]],null]],[],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("button.is-loading .loading-icon"), "it has a spinner showing");
      assert.ok((0, _qunitHelpers.exists)("button[disabled]"), "while loading the button is disabled");
      this.set("isLoading", false);
      assert.notOk((0, _qunitHelpers.exists)("button .loading-icon"), "it doesn't have a spinner showing");
      assert.ok((0, _qunitHelpers.exists)("button:not([disabled])"), "while not loading the button is enabled");
    });
    (0, _qunit.test)("button without isLoading attribute", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DButton />
      */
      {
        "id": "ihK0MX9N",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.notOk((0, _qunitHelpers.exists)("button.is-loading"), "it doesn't have class is-loading");
      assert.notOk((0, _qunitHelpers.exists)("button .loading-icon"), "it doesn't have a spinner showing");
      assert.notOk((0, _qunitHelpers.exists)("button[disabled]"), "it isn't disabled");
    });
    (0, _qunit.test)("isLoading button explicitly set to undefined state", async function (assert) {
      this.set("isLoading");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DButton @isLoading={{this.isLoading}} />
      */
      {
        "id": "PiGnZLF7",
        "block": "[[[8,[39,0],null,[[\"@isLoading\"],[[30,0,[\"isLoading\"]]]],null]],[],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.notOk((0, _qunitHelpers.exists)("button.is-loading"), "it doesn't have class is-loading");
      assert.notOk((0, _qunitHelpers.exists)("button .loading-icon"), "it doesn't have a spinner showing");
      assert.notOk((0, _qunitHelpers.exists)("button[disabled]"), "it isn't disabled");
    });
    (0, _qunit.test)("disabled button", async function (assert) {
      this.set("disabled", true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DButton @disabled={{this.disabled}} />
      */
      {
        "id": "xZhAVQmk",
        "block": "[[[8,[39,0],null,[[\"@disabled\"],[[30,0,[\"disabled\"]]]],null]],[],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("button[disabled]"), "the button is disabled");
      this.set("disabled", false);
      assert.ok((0, _qunitHelpers.exists)("button:not([disabled])"), "the button is enabled");
    });
    (0, _qunit.test)("aria-label", async function (assert) {
      _I18n.default.translations[_I18n.default.locale].js.test = {
        fooAriaLabel: "foo"
      };
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DButton @ariaLabel={{this.ariaLabel}} @translatedAriaLabel={{this.translatedAriaLabel}} />
      */
      {
        "id": "S3jWMz6/",
        "block": "[[[8,[39,0],null,[[\"@ariaLabel\",\"@translatedAriaLabel\"],[[30,0,[\"ariaLabel\"]],[30,0,[\"translatedAriaLabel\"]]]],null]],[],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      this.set("ariaLabel", "test.fooAriaLabel");
      assert.strictEqual((0, _qunitHelpers.query)("button").getAttribute("aria-label"), _I18n.default.t("test.fooAriaLabel"));
      this.setProperties({
        ariaLabel: null,
        translatedAriaLabel: "bar"
      });
      assert.strictEqual((0, _qunitHelpers.query)("button").getAttribute("aria-label"), "bar");
    });
    (0, _qunit.test)("title", async function (assert) {
      _I18n.default.translations[_I18n.default.locale].js.test = {
        fooTitle: "foo"
      };
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DButton @title={{this.title}} @translatedTitle={{this.translatedTitle}} />
      */
      {
        "id": "vjJUhKWt",
        "block": "[[[8,[39,0],null,[[\"@title\",\"@translatedTitle\"],[[30,0,[\"title\"]],[30,0,[\"translatedTitle\"]]]],null]],[],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      this.set("title", "test.fooTitle");
      assert.strictEqual((0, _qunitHelpers.query)("button").getAttribute("title"), _I18n.default.t("test.fooTitle"));
      this.setProperties({
        title: null,
        translatedTitle: "bar"
      });
      assert.strictEqual((0, _qunitHelpers.query)("button").getAttribute("title"), "bar");
    });
    (0, _qunit.test)("label", async function (assert) {
      _I18n.default.translations[_I18n.default.locale].js.test = {
        fooLabel: "foo"
      };
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DButton @label={{this.label}} @translatedLabel={{this.translatedLabel}} />
      */
      {
        "id": "EQDVumIk",
        "block": "[[[8,[39,0],null,[[\"@label\",\"@translatedLabel\"],[[30,0,[\"label\"]],[30,0,[\"translatedLabel\"]]]],null]],[],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      this.set("label", "test.fooLabel");
      assert.strictEqual((0, _qunitHelpers.query)("button .d-button-label").innerText, _I18n.default.t("test.fooLabel"));
      this.setProperties({
        label: null,
        translatedLabel: "bar"
      });
      assert.strictEqual((0, _qunitHelpers.query)("button .d-button-label").innerText, "bar");
    });
    (0, _qunit.test)("aria-expanded", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DButton @ariaExpanded={{this.ariaExpanded}} />
      */
      {
        "id": "dC6t0CHV",
        "block": "[[[8,[39,0],null,[[\"@ariaExpanded\"],[[30,0,[\"ariaExpanded\"]]]],null]],[],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("button").getAttribute("aria-expanded"), null);
      this.set("ariaExpanded", true);
      assert.strictEqual((0, _qunitHelpers.query)("button").getAttribute("aria-expanded"), "true");
      this.set("ariaExpanded", false);
      assert.strictEqual((0, _qunitHelpers.query)("button").getAttribute("aria-expanded"), "false");
      this.set("ariaExpanded", "false");
      assert.strictEqual((0, _qunitHelpers.query)("button").getAttribute("aria-expanded"), null);
      this.set("ariaExpanded", "true");
      assert.strictEqual((0, _qunitHelpers.query)("button").getAttribute("aria-expanded"), null);
    });
    (0, _qunit.test)("aria-controls", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DButton @ariaControls={{this.ariaControls}} />
      */
      {
        "id": "ZU5Zz88J",
        "block": "[[[8,[39,0],null,[[\"@ariaControls\"],[[30,0,[\"ariaControls\"]]]],null]],[],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      this.set("ariaControls", "foo-bar");
      assert.strictEqual((0, _qunitHelpers.query)("button").getAttribute("aria-controls"), "foo-bar");
    });
    (0, _qunit.test)("onKeyDown callback", async function (assert) {
      this.set("foo", null);
      this.set("onKeyDown", () => {
        this.set("foo", "bar");
      });
      this.set("action", () => {
        this.set("foo", "baz");
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DButton @action={{this.action}} @onKeyDown={{this.onKeyDown}} />
      */
      {
        "id": "JRndHulv",
        "block": "[[[8,[39,0],null,[[\"@action\",\"@onKeyDown\"],[[30,0,[\"action\"]],[30,0,[\"onKeyDown\"]]]],null]],[],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.triggerKeyEvent)(".btn", "keydown", "Space");
      assert.strictEqual(this.foo, "bar");
      await (0, _testHelpers.triggerKeyEvent)(".btn", "keydown", "Enter");
      assert.strictEqual(this.foo, "bar");
    });
    (0, _qunit.test)("press Enter", async function (assert) {
      this.set("foo", null);
      this.set("action", () => {
        this.set("foo", "bar");
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DButton @action={{this.action}} />
      */
      {
        "id": "5Igr4Dx6",
        "block": "[[[8,[39,0],null,[[\"@action\"],[[30,0,[\"action\"]]]],null]],[],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.triggerKeyEvent)(".btn", "keydown", "Space");
      assert.strictEqual(this.foo, null);
      await (0, _testHelpers.triggerKeyEvent)(".btn", "keydown", "Enter");
      assert.strictEqual(this.foo, "bar");
    });
  });
});
define("discourse/tests/integration/components/d-document-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  function getTitleCount() {
    const match = document.title.match(/^\((\d+)\)\s/);

    if (match) {
      return parseInt(match[1], 10);
    } else {
      return null;
    }
  }

  function triggerTitleUpdate(appEvents) {
    appEvents.trigger("notifications:changed", {
      forced: true
    });
  }

  (0, _qunit.module)("Integration | Component | d-document", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("when experimental user menu is enabled", async function (assert) {
      const titleBefore = document.title;

      try {
        this.currentUser.redesigned_user_menu_enabled = true;
        this.currentUser.title_count_mode = "notifications";
        await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
        /*
          <DDocument />
        */
        {
          "id": "1nH/aZIU",
          "block": "[[[8,[39,0],null,null,null]],[],false,[\"d-document\"]]",
          "moduleName": "(unknown template module)",
          "isStrictMode": false
        }));
        assert.strictEqual(getTitleCount(), null, "title doesn't have a count initially");
        this.currentUser.unread_high_priority_notifications = 1;
        this.currentUser.unread_notifications = 2;
        this.currentUser.all_unread_notifications_count = 4;
        this.currentUser.unseen_reviewable_count = 8;
        triggerTitleUpdate(this.currentUser.appEvents);
        assert.strictEqual(getTitleCount(), 12, "count in the title is the sum of all_unread_notifications_count and unseen_reviewable_count");
      } finally {
        document.title = titleBefore;
      }
    });
    (0, _qunit.test)("when experimental user menu is disabled", async function (assert) {
      const titleBefore = document.title;

      try {
        this.currentUser.redesigned_user_menu_enabled = false;
        this.currentUser.title_count_mode = "notifications";
        await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
        /*
          <DDocument />
        */
        {
          "id": "1nH/aZIU",
          "block": "[[[8,[39,0],null,null,null]],[],false,[\"d-document\"]]",
          "moduleName": "(unknown template module)",
          "isStrictMode": false
        }));
        assert.strictEqual(getTitleCount(), null, "title doesn't have a count initially");
        this.currentUser.unread_high_priority_notifications = 1;
        this.currentUser.unread_notifications = 2;
        this.currentUser.all_unread_notifications_count = 4;
        this.currentUser.unseen_reviewable_count = 8;
        triggerTitleUpdate(this.currentUser.appEvents);
        assert.strictEqual(getTitleCount(), 3, "count in the title is the sum of unread_notifications and unread_high_priority_notifications");
      } finally {
        document.title = titleBefore;
      }
    });
  });
});
define("discourse/tests/integration/components/d-editor-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/textarea-selection-helper", "I18n", "discourse/tests/helpers/d-editor-helper", "@ember/runloop", "discourse/lib/plugin-api"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _textareaSelectionHelper, _I18n, _dEditorHelper, _runloop, _pluginApi) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/tests/helpers/textarea-selection-helper",0,"ember-cli-htmlbars",0,"I18n",0,"discourse/tests/helpers/d-editor-helper",0,"@ember/runloop",0,"discourse/lib/plugin-api"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | d-editor", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("preview updates with markdown", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DEditor @value={{this.value}} />
      */
      {
        "id": "FbkDAsT3",
        "block": "[[[8,[39,0],null,[[\"@value\"],[[30,0,[\"value\"]]]],null]],[],false,[\"d-editor\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".d-editor-button-bar"));
      await (0, _testHelpers.fillIn)(".d-editor-input", "hello **world**");
      assert.strictEqual(this.value, "hello **world**");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-preview").innerHTML.trim(), "<p>hello <strong>world</strong></p>");
    });
    (0, _qunit.test)("links in preview are not tabbable", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DEditor @value={{this.value}} />
      */
      {
        "id": "FbkDAsT3",
        "block": "[[[8,[39,0],null,[[\"@value\"],[[30,0,[\"value\"]]]],null]],[],false,[\"d-editor\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.fillIn)(".d-editor-input", "[discourse](https://www.discourse.org)");
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-preview").innerHTML.trim(), '<p><a href="https://www.discourse.org" tabindex="-1">discourse</a></p>');
    });
    (0, _qunit.test)("preview sanitizes HTML", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DEditor @value={{this.value}} />
      */
      {
        "id": "FbkDAsT3",
        "block": "[[[8,[39,0],null,[[\"@value\"],[[30,0,[\"value\"]]]],null]],[],false,[\"d-editor\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.fillIn)(".d-editor-input", `"><svg onload="prompt(/xss/)"></svg>`);
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-preview").innerHTML.trim(), '<p>"&gt;</p>');
    });
    (0, _qunit.test)("updating the value refreshes the preview", async function (assert) {
      this.set("value", "evil trout");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DEditor @value={{this.value}} />
      */
      {
        "id": "FbkDAsT3",
        "block": "[[[8,[39,0],null,[[\"@value\"],[[30,0,[\"value\"]]]],null]],[],false,[\"d-editor\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-preview").innerHTML.trim(), "<p>evil trout</p>");
      this.set("value", "zogstrip");
      await (0, _testHelpers.settled)();
      assert.strictEqual((0, _qunitHelpers.query)(".d-editor-preview").innerHTML.trim(), "<p>zogstrip</p>");
    });

    function jumpEnd(textarea) {
      textarea.selectionStart = textarea.value.length;
      textarea.selectionEnd = textarea.value.length;
      return textarea;
    }

    function testCase(title, testFunc) {
      (0, _qunitHelpers.chromeTest)(title, async function (assert) {
        this.set("value", "hello world.");
        await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
        /*
          <DEditor @value={{this.value}} />
        */
        {
          "id": "FbkDAsT3",
          "block": "[[[8,[39,0],null,[[\"@value\"],[[30,0,[\"value\"]]]],null]],[],false,[\"d-editor\"]]",
          "moduleName": "(unknown template module)",
          "isStrictMode": false
        }));
        const textarea = jumpEnd((0, _qunitHelpers.query)("textarea.d-editor-input"));
        await testFunc.call(this, assert, textarea);
      });
    }

    function composerTestCase(title, testFunc) {
      (0, _qunit.test)(title, async function (assert) {
        this.set("value", "hello world.");
        await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
        /*
          <DEditor @value={{this.value}} @composerEvents={{true}} />
        */
        {
          "id": "l1zUhjwv",
          "block": "[[[8,[39,0],null,[[\"@value\",\"@composerEvents\"],[[30,0,[\"value\"]],true]],null]],[],false,[\"d-editor\"]]",
          "moduleName": "(unknown template module)",
          "isStrictMode": false
        }));
        const textarea = jumpEnd((0, _qunitHelpers.query)("textarea.d-editor-input"));
        await testFunc.call(this, assert, textarea);
      });
    }

    testCase(`selecting the space before a word`, async function (assert, textarea) {
      textarea.selectionStart = 5;
      textarea.selectionEnd = 7;
      await (0, _testHelpers.click)(`button.bold`);
      assert.strictEqual(this.value, `hello **w**orld.`);
      assert.strictEqual(textarea.selectionStart, 8);
      assert.strictEqual(textarea.selectionEnd, 9);
    });
    testCase(`selecting the space after a word`, async function (assert, textarea) {
      textarea.selectionStart = 0;
      textarea.selectionEnd = 6;
      await (0, _testHelpers.click)(`button.bold`);
      assert.strictEqual(this.value, `**hello** world.`);
      assert.strictEqual(textarea.selectionStart, 2);
      assert.strictEqual(textarea.selectionEnd, 7);
    });
    testCase(`bold button with no selection`, async function (assert, textarea) {
      await (0, _testHelpers.click)(`button.bold`);

      const example = _I18n.default.t(`composer.bold_text`);

      assert.strictEqual(this.value, `hello world.**${example}**`);
      assert.strictEqual(textarea.selectionStart, 14);
      assert.strictEqual(textarea.selectionEnd, 14 + example.length);
    });
    testCase(`bold button with a selection`, async function (assert, textarea) {
      textarea.selectionStart = 6;
      textarea.selectionEnd = 11;
      await (0, _testHelpers.click)(`button.bold`);
      assert.strictEqual(this.value, `hello **world**.`);
      assert.strictEqual(textarea.selectionStart, 8);
      assert.strictEqual(textarea.selectionEnd, 13);
      await (0, _testHelpers.click)(`button.bold`);
      assert.strictEqual(this.value, "hello world.");
      assert.strictEqual(textarea.selectionStart, 6);
      assert.strictEqual(textarea.selectionEnd, 11);
    });
    testCase("bold button maintains undo history", async function (assert, textarea) {
      textarea.selectionStart = 6;
      textarea.selectionEnd = 11;
      await (0, _testHelpers.click)("button.bold");
      assert.strictEqual(this.value, "hello **world**.");
      assert.strictEqual(textarea.selectionStart, 8);
      assert.strictEqual(textarea.selectionEnd, 13);
      document.execCommand("undo");
      assert.strictEqual(this.value, "hello world.");
    });
    testCase(`bold with a multiline selection`, async function (assert, textarea) {
      this.set("value", "hello\n\nworld\n\ntest.");
      textarea.selectionStart = 0;
      textarea.selectionEnd = 12;
      await (0, _testHelpers.click)(`button.bold`);
      assert.strictEqual(this.value, `**hello**\n\n**world**\n\ntest.`);
      assert.strictEqual(textarea.selectionStart, 0);
      assert.strictEqual(textarea.selectionEnd, 20);
      await (0, _testHelpers.click)(`button.bold`);
      assert.strictEqual(this.value, `hello\n\nworld\n\ntest.`);
      assert.strictEqual(textarea.selectionStart, 0);
      assert.strictEqual(textarea.selectionEnd, 12);
    });
    testCase(`italic button with no selection`, async function (assert, textarea) {
      await (0, _testHelpers.click)(`button.italic`);

      const example = _I18n.default.t(`composer.italic_text`);

      assert.strictEqual(this.value, `hello world.*${example}*`);
      assert.strictEqual(textarea.selectionStart, 13);
      assert.strictEqual(textarea.selectionEnd, 13 + example.length);
    });
    testCase(`italic button with a selection`, async function (assert, textarea) {
      textarea.selectionStart = 6;
      textarea.selectionEnd = 11;
      await (0, _testHelpers.click)(`button.italic`);
      assert.strictEqual(this.value, `hello *world*.`);
      assert.strictEqual(textarea.selectionStart, 7);
      assert.strictEqual(textarea.selectionEnd, 12);
      await (0, _testHelpers.click)(`button.italic`);
      assert.strictEqual(this.value, "hello world.");
      assert.strictEqual(textarea.selectionStart, 6);
      assert.strictEqual(textarea.selectionEnd, 11);
    });
    testCase(`italic with a multiline selection`, async function (assert, textarea) {
      this.set("value", "hello\n\nworld\n\ntest.");
      textarea.selectionStart = 0;
      textarea.selectionEnd = 12;
      await (0, _testHelpers.click)(`button.italic`);
      assert.strictEqual(this.value, `*hello*\n\n*world*\n\ntest.`);
      assert.strictEqual(textarea.selectionStart, 0);
      assert.strictEqual(textarea.selectionEnd, 16);
      await (0, _testHelpers.click)(`button.italic`);
      assert.strictEqual(this.value, `hello\n\nworld\n\ntest.`);
      assert.strictEqual(textarea.selectionStart, 0);
      assert.strictEqual(textarea.selectionEnd, 12);
    });
    (0, _qunit.test)("advanced code", async function (assert) {
      this.siteSettings.code_formatting_style = "4-spaces-indent";
      this.set("value", `
function xyz(x, y, z) {
  if (y === z) {
    return true;
  }
}
`);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DEditor @value={{this.value}} />
      */
      {
        "id": "FbkDAsT3",
        "block": "[[[8,[39,0],null,[[\"@value\"],[[30,0,[\"value\"]]]],null]],[],false,[\"d-editor\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const textarea = (0, _qunitHelpers.query)("textarea.d-editor-input");
      textarea.selectionStart = 0;
      textarea.selectionEnd = textarea.value.length;
      await (0, _testHelpers.click)("button.code");
      assert.strictEqual(this.value, `
    function xyz(x, y, z) {
      if (y === z) {
        return true;
      }
    }
`);
    });
    (0, _qunit.test)("code button", async function (assert) {
      this.siteSettings.code_formatting_style = "4-spaces-indent";
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DEditor @value={{this.value}} />
      */
      {
        "id": "FbkDAsT3",
        "block": "[[[8,[39,0],null,[[\"@value\"],[[30,0,[\"value\"]]]],null]],[],false,[\"d-editor\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const textarea = jumpEnd((0, _qunitHelpers.query)("textarea.d-editor-input"));
      await (0, _testHelpers.click)("button.code");
      assert.strictEqual(this.value, `    ${_I18n.default.t("composer.code_text")}`);
      this.set("value", "first line\n\nsecond line\n\nthird line");
      textarea.selectionStart = 11;
      textarea.selectionEnd = 11;
      await (0, _testHelpers.click)("button.code");
      assert.strictEqual(this.value, `first line
    ${_I18n.default.t("composer.code_text")}
second line

third line`);
      this.set("value", "first line\n\nsecond line\n\nthird line");
      await (0, _testHelpers.click)("button.code");
      assert.strictEqual(this.value, `first line

second line

third line\`${_I18n.default.t("composer.code_title")}\``);
      this.set("value", "first line\n\nsecond line\n\nthird line");
      textarea.selectionStart = 5;
      textarea.selectionEnd = 5;
      await (0, _testHelpers.click)("button.code");
      assert.strictEqual(this.value, `first\`${_I18n.default.t("composer.code_title")}\` line

second line

third line`);
      this.set("value", "first line\n\nsecond line\n\nthird line");
      textarea.selectionStart = 6;
      textarea.selectionEnd = 10;
      await (0, _testHelpers.click)("button.code");
      assert.strictEqual(this.value, "first `line`\n\nsecond line\n\nthird line");
      assert.strictEqual(textarea.selectionStart, 7);
      assert.strictEqual(textarea.selectionEnd, 11);
      await (0, _testHelpers.click)("button.code");
      assert.strictEqual(this.value, "first line\n\nsecond line\n\nthird line");
      assert.strictEqual(textarea.selectionStart, 6);
      assert.strictEqual(textarea.selectionEnd, 10);
      textarea.selectionStart = 0;
      textarea.selectionEnd = 23;
      await (0, _testHelpers.click)("button.code");
      assert.strictEqual(this.value, "    first line\n\n    second line\n\nthird line");
      assert.strictEqual(textarea.selectionStart, 0);
      assert.strictEqual(textarea.selectionEnd, 31);
      await (0, _testHelpers.click)("button.code");
      assert.strictEqual(this.value, "first line\n\nsecond line\n\nthird line");
      assert.strictEqual(textarea.selectionStart, 0);
      assert.strictEqual(textarea.selectionEnd, 23);
    });
    (0, _qunit.test)("code fences", async function (assert) {
      this.set("value", "");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DEditor @value={{this.value}} />
      */
      {
        "id": "FbkDAsT3",
        "block": "[[[8,[39,0],null,[[\"@value\"],[[30,0,[\"value\"]]]],null]],[],false,[\"d-editor\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const textarea = jumpEnd((0, _qunitHelpers.query)("textarea.d-editor-input"));
      await (0, _testHelpers.click)("button.code");
      assert.strictEqual(this.value, `\`\`\`
${_I18n.default.t("composer.paste_code_text")}
\`\`\``);
      assert.strictEqual(textarea.selectionStart, 4);
      assert.strictEqual(textarea.selectionEnd, 27);
      this.set("value", "first line\nsecond line\nthird line");
      textarea.selectionStart = 0;
      textarea.selectionEnd = textarea.value.length;
      await (0, _testHelpers.click)("button.code");
      assert.strictEqual(this.value, `\`\`\`
first line
second line
third line
\`\`\`
`);
      assert.strictEqual(textarea.selectionStart, textarea.value.length);
      assert.strictEqual(textarea.selectionEnd, textarea.value.length);
      this.set("value", "first line\nsecond line\nthird line");
      textarea.selectionStart = 0;
      textarea.selectionEnd = 0;
      await (0, _testHelpers.click)("button.code");
      assert.strictEqual(this.value, `\`${_I18n.default.t("composer.code_title")}\`first line
second line
third line`);
      assert.strictEqual(textarea.selectionStart, 1);
      assert.strictEqual(textarea.selectionEnd, _I18n.default.t("composer.code_title").length + 1);
      this.set("value", "first line\nsecond line\nthird line");
      textarea.selectionStart = 0;
      textarea.selectionEnd = 10;
      await (0, _testHelpers.click)("button.code");
      assert.strictEqual(this.value, `\`first line\`
second line
third line`);
      assert.strictEqual(textarea.selectionStart, 1);
      assert.strictEqual(textarea.selectionEnd, 11);
      this.set("value", "first line\nsecond line\nthird line");
      textarea.selectionStart = 0;
      textarea.selectionEnd = 23;
      await (0, _testHelpers.click)("button.code");
      assert.strictEqual(this.value, `\`\`\`
first line
second line
\`\`\`
third line`);
      assert.strictEqual(textarea.selectionStart, 30);
      assert.strictEqual(textarea.selectionEnd, 30);
      this.set("value", "first line\nsecond line\nthird line");
      textarea.selectionStart = 6;
      textarea.selectionEnd = 17;
      await (0, _testHelpers.click)("button.code");
      assert.strictEqual(this.value, `first \n\`\`\`\nline\nsecond\n\`\`\`\n line\nthird line`);
      assert.strictEqual(textarea.selectionStart, 27);
      assert.strictEqual(textarea.selectionEnd, 27);
      document.execCommand("undo");
      assert.strictEqual(this.value, "first line\nsecond line\nthird line");
    });
    (0, _qunit.test)("quote button - empty lines", async function (assert) {
      this.set("value", "one\n\ntwo\n\nthree");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DEditor @value={{this.value}} @composerEvents={{true}} />
      */
      {
        "id": "l1zUhjwv",
        "block": "[[[8,[39,0],null,[[\"@value\",\"@composerEvents\"],[[30,0,[\"value\"]],true]],null]],[],false,[\"d-editor\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const textarea = jumpEnd((0, _qunitHelpers.query)("textarea.d-editor-input"));
      textarea.selectionStart = 0;
      await (0, _testHelpers.click)("button.blockquote");
      assert.strictEqual(this.value, "> one\n> \n> two\n> \n> three");
      assert.strictEqual(textarea.selectionStart, 0);
      assert.strictEqual(textarea.selectionEnd, 25);
      await (0, _testHelpers.click)("button.blockquote");
      assert.strictEqual(this.value, "one\n\ntwo\n\nthree");
    });
    (0, _qunit.test)("quote button - selecting empty lines", async function (assert) {
      this.set("value", "one\n\n\n\ntwo");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DEditor @value={{this.value}} @composerEvents={{true}} />
      */
      {
        "id": "l1zUhjwv",
        "block": "[[[8,[39,0],null,[[\"@value\",\"@composerEvents\"],[[30,0,[\"value\"]],true]],null]],[],false,[\"d-editor\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const textarea = jumpEnd((0, _qunitHelpers.query)("textarea.d-editor-input"));
      textarea.selectionStart = 6;
      textarea.selectionEnd = 10;
      await (0, _testHelpers.click)("button.blockquote");
      assert.strictEqual(this.value, "one\n\n\n> \n> two");
      document.execCommand("undo");
      assert.strictEqual(this.value, "one\n\n\n\ntwo");
    });
    testCase("quote button", async function (assert, textarea) {
      textarea.selectionStart = 6;
      textarea.selectionEnd = 9;
      await (0, _testHelpers.click)("button.blockquote");
      assert.strictEqual(this.value, "hello\n\n> wor\n\nld.");
      assert.strictEqual(textarea.selectionStart, 7);
      assert.strictEqual(textarea.selectionEnd, 12);
      await (0, _testHelpers.click)("button.blockquote");
      assert.strictEqual(this.value, "hello\n\nwor\n\nld.");
      assert.strictEqual(textarea.selectionStart, 7);
      assert.strictEqual(textarea.selectionEnd, 10);
      textarea.selectionStart = 15;
      textarea.selectionEnd = 15;
      await (0, _testHelpers.click)("button.blockquote");
      assert.strictEqual(this.value, "hello\n\nwor\n\nld.\n\n> Blockquote");
    });
    testCase(`bullet button with no selection`, async function (assert, textarea) {
      const example = _I18n.default.t("composer.list_item");

      await (0, _testHelpers.click)(`button.bullet`);
      assert.strictEqual(this.value, `hello world.\n\n* ${example}`);
      assert.strictEqual(textarea.selectionStart, 14);
      assert.strictEqual(textarea.selectionEnd, 16 + example.length);
      await (0, _testHelpers.click)(`button.bullet`);
      assert.strictEqual(this.value, `hello world.\n\n${example}`);
    });
    testCase(`bullet button with a selection`, async function (assert, textarea) {
      textarea.selectionStart = 6;
      textarea.selectionEnd = 11;
      await (0, _testHelpers.click)(`button.bullet`);
      assert.strictEqual(this.value, `hello\n\n* world\n\n.`);
      assert.strictEqual(textarea.selectionStart, 7);
      assert.strictEqual(textarea.selectionEnd, 14);
      await (0, _testHelpers.click)(`button.bullet`);
      assert.strictEqual(this.value, `hello\n\nworld\n\n.`);
      assert.strictEqual(textarea.selectionStart, 7);
      assert.strictEqual(textarea.selectionEnd, 12);
    });
    testCase(`bullet button with a multiple line selection`, async function (assert, textarea) {
      this.set("value", "* Hello\n\nWorld\n\nEvil");
      textarea.selectionStart = 0;
      textarea.selectionEnd = 20;
      await (0, _testHelpers.click)(`button.bullet`);
      assert.strictEqual(this.value, "Hello\n\nWorld\n\nEvil");
      assert.strictEqual(textarea.selectionStart, 0);
      assert.strictEqual(textarea.selectionEnd, 18);
      await (0, _testHelpers.click)(`button.bullet`);
      assert.strictEqual(this.value, "* Hello\n\n* World\n\n* Evil");
      assert.strictEqual(textarea.selectionStart, 0);
      assert.strictEqual(textarea.selectionEnd, 24);
    });
    testCase(`list button with no selection`, async function (assert, textarea) {
      const example = _I18n.default.t("composer.list_item");

      await (0, _testHelpers.click)(`button.list`);
      assert.strictEqual(this.value, `hello world.\n\n1. ${example}`);
      assert.strictEqual(textarea.selectionStart, 14);
      assert.strictEqual(textarea.selectionEnd, 17 + example.length);
      await (0, _testHelpers.click)(`button.list`);
      assert.strictEqual(this.value, `hello world.\n\n${example}`);
      assert.strictEqual(textarea.selectionStart, 14);
      assert.strictEqual(textarea.selectionEnd, 14 + example.length);
    });
    testCase(`list button with a selection`, async function (assert, textarea) {
      textarea.selectionStart = 6;
      textarea.selectionEnd = 11;
      await (0, _testHelpers.click)(`button.list`);
      assert.strictEqual(this.value, `hello\n\n1. world\n\n.`);
      assert.strictEqual(textarea.selectionStart, 7);
      assert.strictEqual(textarea.selectionEnd, 15);
      await (0, _testHelpers.click)(`button.list`);
      assert.strictEqual(this.value, `hello\n\nworld\n\n.`);
      assert.strictEqual(textarea.selectionStart, 7);
      assert.strictEqual(textarea.selectionEnd, 12);
    });
    testCase(`list button with line sequence`, async function (assert, textarea) {
      this.set("value", "Hello\n\nWorld\n\nEvil");
      textarea.selectionStart = 0;
      textarea.selectionEnd = 18;
      await (0, _testHelpers.click)(`button.list`);
      assert.strictEqual(this.value, "1. Hello\n\n2. World\n\n3. Evil");
      assert.strictEqual(textarea.selectionStart, 0);
      assert.strictEqual(textarea.selectionEnd, 27);
      await (0, _testHelpers.click)(`button.list`);
      assert.strictEqual(this.value, "Hello\n\nWorld\n\nEvil");
      assert.strictEqual(textarea.selectionStart, 0);
      assert.strictEqual(textarea.selectionEnd, 18);
    });
    (0, _qunit.test)("clicking the toggle-direction changes dir from ltr to rtl", async function (assert) {
      this.siteSettings.support_mixed_text_direction = true;
      this.siteSettings.default_locale = "en";
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DEditor @value={{this.value}} />
      */
      {
        "id": "FbkDAsT3",
        "block": "[[[8,[39,0],null,[[\"@value\"],[[30,0,[\"value\"]]]],null]],[],false,[\"d-editor\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)("button.toggle-direction");
      assert.strictEqual((0, _qunitHelpers.query)("textarea.d-editor-input").getAttribute("dir"), "rtl");
    });
    (0, _qunit.test)("clicking the toggle-direction changes dir from ltr to rtl", async function (assert) {
      this.siteSettings.support_mixed_text_direction = true;
      this.siteSettings.default_locale = "en";
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DEditor @value={{this.value}} />
      */
      {
        "id": "FbkDAsT3",
        "block": "[[[8,[39,0],null,[[\"@value\"],[[30,0,[\"value\"]]]],null]],[],false,[\"d-editor\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const textarea = (0, _qunitHelpers.query)("textarea.d-editor-input");
      textarea.setAttribute("dir", "ltr");
      await (0, _testHelpers.click)("button.toggle-direction");
      assert.strictEqual(textarea.getAttribute("dir"), "rtl");
    });
    testCase(`doesn't jump to bottom with long text`, async function (assert, textarea) {
      this.set("value", "hello world.".repeat(8));
      textarea.scrollTop = 0;
      textarea.selectionStart = 3;
      textarea.selectionEnd = 3;
      await (0, _testHelpers.click)("button.bold");
      assert.strictEqual(textarea.scrollTop, 0, "it stays scrolled up");
    });
    (0, _qunit.test)("emoji", async function (assert) {
      // Test adding a custom button
      (0, _pluginApi.withPluginApi)("0.1", api => {
        api.onToolbarCreate(toolbar => {
          toolbar.addButton({
            id: "emoji",
            group: "extras",
            icon: "far-smile",
            action: () => toolbar.context.send("emoji")
          });
        });
      });
      this.set("value", "hello world.");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DEditor @value={{this.value}} />
      */
      {
        "id": "FbkDAsT3",
        "block": "[[[8,[39,0],null,[[\"@value\"],[[30,0,[\"value\"]]]],null]],[],false,[\"d-editor\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      jumpEnd((0, _qunitHelpers.query)("textarea.d-editor-input"));
      await (0, _testHelpers.click)("button.emoji");
      await (0, _testHelpers.click)('.emoji-picker .section[data-section="smileys_&_emotion"] img.emoji[title="grinning"]');
      assert.strictEqual(this.value, "hello world. :grinning:", "it works when there is no partial emoji");
      await (0, _testHelpers.click)("textarea.d-editor-input");
      await (0, _testHelpers.fillIn)(".d-editor-input", "starting to type an emoji like :gri");
      jumpEnd((0, _qunitHelpers.query)("textarea.d-editor-input"));
      await (0, _testHelpers.click)("button.emoji");
      await (0, _testHelpers.click)('.emoji-picker .section[data-section="smileys_&_emotion"] img.emoji[title="grinning"]');
      assert.strictEqual(this.value, "starting to type an emoji like :grinning:", "it works when there is a partial emoji");
    });
    (0, _qunit.test)("toolbar buttons tabindex", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DEditor />
      */
      {
        "id": "uzv2s8rr",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"d-editor\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const buttons = (0, _qunitHelpers.queryAll)(".d-editor-button-bar .btn");
      assert.strictEqual(buttons[0].getAttribute("tabindex"), "0", "it makes the first button focusable");
      assert.strictEqual(buttons[1].getAttribute("tabindex"), "-1");
    });
    testCase("replace-text event by default", async function (assert) {
      this.set("value", "red green blue");
      await this.container.lookup("service:app-events").trigger("composer:replace-text", "green", "yellow");
      assert.strictEqual(this.value, "red green blue");
    });
    composerTestCase("replace-text event for composer", async function (assert) {
      this.set("value", "red green blue");
      await this.container.lookup("service:app-events").trigger("composer:replace-text", "green", "yellow");
      assert.strictEqual(this.value, "red yellow blue");
    });

    async function indentSelection(container, direction) {
      await container.lookup("service:app-events").trigger("composer:indent-selected-text", direction);
    }

    composerTestCase("indents a single line of text to the right", async function (assert, textarea) {
      this.set("value", "Hello world");
      (0, _textareaSelectionHelper.setTextareaSelection)(textarea, 0, textarea.value.length);
      await indentSelection(this.container, "right");
      assert.strictEqual(this.value, "  Hello world", "a single line of selection is indented correctly");
    });
    composerTestCase("de-indents a single line of text to the left", async function (assert, textarea) {
      this.set("value", "  Hello world");
      (0, _textareaSelectionHelper.setTextareaSelection)(textarea, 0, textarea.value.length);
      await indentSelection(this.container, "left");
      assert.strictEqual(this.value, "Hello world", "a single line of selection is deindented correctly");
    });
    composerTestCase("indents multiple lines of text to the right", async function (assert, textarea) {
      this.set("value", "  Hello world\nThis is me");
      (0, _textareaSelectionHelper.setTextareaSelection)(textarea, 2, textarea.value.length);
      await indentSelection(this.container, "right");
      assert.strictEqual(this.value, "    Hello world\n  This is me", "multiple lines are indented correctly without selecting preceding space");
      this.set("value", "  Hello world\nThis is me");
      (0, _textareaSelectionHelper.setTextareaSelection)(textarea, 0, textarea.value.length);
      await indentSelection(this.container, "right");
      assert.strictEqual(this.value, "    Hello world\n  This is me", "multiple lines are indented correctly with selecting preceding space");
    });
    composerTestCase("de-indents multiple lines of text to the left", async function (assert, textarea) {
      this.set("value", "  Hello world\nThis is me");
      (0, _textareaSelectionHelper.setTextareaSelection)(textarea, 2, textarea.value.length);
      await indentSelection(this.container, "left");
      assert.strictEqual(this.value, "Hello world\nThis is me", "multiple lines are de-indented correctly without selecting preceding space");
    });
    composerTestCase("detects the indentation character (tab vs. string) and uses that", async function (assert, textarea) {
      this.set("value", "```\nfunc init() {\n	strings = generateStrings()\n}\n```");
      (0, _textareaSelectionHelper.setTextareaSelection)(textarea, 4, textarea.value.length - 4);
      await indentSelection(this.container, "right");
      assert.strictEqual(this.value, "```\n	func init() {\n		strings = generateStrings()\n	}\n```", "detects the prevalent indentation character and uses that (tab)");
    });
    (0, _qunit.test)("paste table", async function (assert) {
      this.set("value", "");
      this.siteSettings.enable_rich_text_paste = true;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DEditor @value={{this.value}} @composerEvents={{true}} />
      */
      {
        "id": "l1zUhjwv",
        "block": "[[[8,[39,0],null,[[\"@value\",\"@composerEvents\"],[[30,0,[\"value\"]],true]],null]],[],false,[\"d-editor\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      let element = (0, _qunitHelpers.query)(".d-editor");
      await (0, _qunitHelpers.paste)(element, "\ta\tb\n1\t2\t3");
      assert.strictEqual(this.value, "||a|b|\n|---|---|---|\n|1|2|3|\n");
      document.execCommand("undo");
      assert.strictEqual(this.value, "");
    });
    (0, _qunit.test)("paste a different table", async function (assert) {
      this.set("value", "");
      this.siteSettings.enable_rich_text_paste = true;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DEditor @value={{this.value}} @composerEvents={{true}} />
      */
      {
        "id": "l1zUhjwv",
        "block": "[[[8,[39,0],null,[[\"@value\",\"@composerEvents\"],[[30,0,[\"value\"]],true]],null]],[],false,[\"d-editor\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      let element = (0, _qunitHelpers.query)(".d-editor");
      await (0, _qunitHelpers.paste)(element, '\ta\tb\n1\t"2\n2.5"\t3');
      assert.strictEqual(this.value, "||a|b|\n|---|---|---|\n|1|2<br>2.5|3|\n");
    });
    testCase(`pasting a link into a selection applies a link format`, async function (assert, textarea) {
      this.set("value", "See discourse in action");
      (0, _textareaSelectionHelper.setTextareaSelection)(textarea, 4, 13);
      const element = (0, _qunitHelpers.query)(".d-editor");
      const event = await (0, _qunitHelpers.paste)(element, "https://www.discourse.org/");
      assert.strictEqual(this.value, "See [discourse](https://www.discourse.org/) in action");
      assert.strictEqual(event.defaultPrevented, true);
      document.execCommand("undo");
      assert.strictEqual(this.value, "See discourse in action");
    });
    testCase(`pasting other text into a selection will replace text value`, async function (assert, textarea) {
      this.set("value", "good morning");
      (0, _textareaSelectionHelper.setTextareaSelection)(textarea, 5, 12);
      const element = (0, _qunitHelpers.query)(".d-editor");
      const event = await (0, _qunitHelpers.paste)(element, "evening"); // Synthetic paste events do not manipulate document content.

      assert.strictEqual(this.value, "good morning");
      assert.strictEqual(event.defaultPrevented, false);
    });
    testCase(`pasting a url without a selection will insert the url`, async function (assert, textarea) {
      this.set("value", "a link example:");
      jumpEnd(textarea);
      const element = (0, _qunitHelpers.query)(".d-editor");
      const event = await (0, _qunitHelpers.paste)(element, "https://www.discourse.org/"); // Synthetic paste events do not manipulate document content.

      assert.strictEqual(this.value, "a link example:");
      assert.strictEqual(event.defaultPrevented, false);
    });
    testCase(`pasting text that contains urls and other content will use default paste behavior`, async function (assert, textarea) {
      this.set("value", "a link example:");
      (0, _textareaSelectionHelper.setTextareaSelection)(textarea, 0, 1);
      const element = (0, _qunitHelpers.query)(".d-editor");
      const event = await (0, _qunitHelpers.paste)(element, "Try out Discourse at: https://www.discourse.org/"); // Synthetic paste events do not manipulate document content.

      assert.strictEqual(this.value, "a link example:");
      assert.strictEqual(event.defaultPrevented, false);
    });
    testCase(`pasting an email into a selection applies a link format`, async function (assert, textarea) {
      this.set("value", "team email");
      (0, _textareaSelectionHelper.setTextareaSelection)(textarea, 5, 10);
      const element = (0, _qunitHelpers.query)(".d-editor");
      const event = await (0, _qunitHelpers.paste)(element, "mailto:team@discourse.org");
      assert.strictEqual(this.value, "team [email](mailto:team@discourse.org)");
      assert.strictEqual(event.defaultPrevented, true);
    });
    testCase(`pasting a url onto a selection that contains urls and other content will use default paste behavior`, async function (assert, textarea) {
      this.set("value", "Try https://www.discourse.org");
      (0, _textareaSelectionHelper.setTextareaSelection)(textarea, 0, 29);
      const element = (0, _qunitHelpers.query)(".d-editor");
      const event = await (0, _qunitHelpers.paste)(element, "https://www.discourse.com/"); // Synthetic paste events do not manipulate document content.

      assert.strictEqual(this.value, "Try https://www.discourse.org");
      assert.strictEqual(event.defaultPrevented, false);
    });
    testCase(`pasting a url onto a selection that contains bbcode-like tags will use default paste behavior`, async function (assert, textarea) {
      this.set("value", "hello [url=foobar]foobar[/url]");
      (0, _textareaSelectionHelper.setTextareaSelection)(textarea, 0, 30);
      const element = (0, _qunitHelpers.query)(".d-editor");
      const event = await (0, _qunitHelpers.paste)(element, "https://www.discourse.com/"); // Synthetic paste events do not manipulate document content.

      assert.strictEqual(this.value, "hello [url=foobar]foobar[/url]");
      assert.strictEqual(event.defaultPrevented, false);
    });

    (() => {
      // Tests to check cursor/selection after replace-text event.
      const BEFORE = "red green blue";
      const NEEDLE = "green";
      const REPLACE = "yellow";
      const AFTER = BEFORE.replace(NEEDLE, REPLACE);
      const CASES = [{
        description: "cursor at start remains there",
        before: [0, 0],
        after: [0, 0]
      }, {
        description: "cursor before needle becomes cursor before replacement",
        before: [BEFORE.indexOf(NEEDLE), 0],
        after: [AFTER.indexOf(REPLACE), 0]
      }, {
        description: "cursor at needle start + 1 moves behind replacement",
        before: [BEFORE.indexOf(NEEDLE) + 1, 0],
        after: [AFTER.indexOf(REPLACE) + REPLACE.length, 0]
      }, {
        description: "cursor at needle end - 1 stays behind replacement",
        before: [BEFORE.indexOf(NEEDLE) + NEEDLE.length - 1, 0],
        after: [AFTER.indexOf(REPLACE) + REPLACE.length, 0]
      }, {
        description: "cursor behind needle becomes cursor behind replacement",
        before: [BEFORE.indexOf(NEEDLE) + NEEDLE.length, 0],
        after: [AFTER.indexOf(REPLACE) + REPLACE.length, 0]
      }, {
        description: "cursor at end remains there",
        before: [BEFORE.length, 0],
        after: [AFTER.length, 0]
      }, {
        description: "selection spanning needle start becomes selection until replacement start",
        before: [BEFORE.indexOf(NEEDLE) - 1, 2],
        after: [AFTER.indexOf(REPLACE) - 1, 1]
      }, {
        description: "selection spanning needle end becomes selection from replacement end",
        before: [BEFORE.indexOf(NEEDLE) + NEEDLE.length - 1, 2],
        after: [AFTER.indexOf(REPLACE) + REPLACE.length, 1]
      }, {
        description: "selection spanning needle becomes selection spanning replacement",
        before: [BEFORE.indexOf(NEEDLE) - 1, NEEDLE.length + 2],
        after: [AFTER.indexOf(REPLACE) - 1, REPLACE.length + 2]
      }, {
        description: "complete selection remains complete",
        before: [0, BEFORE.length],
        after: [0, AFTER.length]
      }];

      for (let i = 0; i < CASES.length; i++) {
        const CASE = CASES[i]; // prettier-ignore

        composerTestCase(`replace-text event: ${CASE.description}`, async function (assert, textarea) {
          this.set("value", BEFORE);
          await focus(textarea);
          assert.strictEqual(textarea.value, BEFORE);
          const [start, len] = CASE.before;
          (0, _textareaSelectionHelper.setTextareaSelection)(textarea, start, start + len);
          this.container.lookup("service:app-events").trigger("composer:replace-text", "green", "yellow", {
            forceFocus: true
          });
          (0, _runloop.next)(() => {
            let expect = (0, _dEditorHelper.default)(AFTER, CASE.after);
            let actual = (0, _dEditorHelper.default)(this.value, (0, _textareaSelectionHelper.getTextareaSelection)(textarea));
            assert.strictEqual(actual, expect);
          });
        });
      }
    })();
  });
});
define("discourse/tests/integration/components/d-icon-helper-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | d-icon helper", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("default", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <div class="test">{{d-icon "bars"}}</div>
      */
      {
        "id": "H9tu5d1J",
        "block": "[[[10,0],[14,0,\"test\"],[12],[1,[28,[35,0],[\"bars\"],null]],[13]],[],false,[\"d-icon\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const html = (0, _qunitHelpers.query)(".test").innerHTML.trim();
      assert.strictEqual(html, '<svg class="fa d-icon d-icon-bars svg-icon svg-string" xmlns="http://www.w3.org/2000/svg"><use href="#bars"></use></svg>');
    });
    (0, _qunit.test)("with replacement", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <div class="test">{{d-icon "d-watching"}}</div>
      */
      {
        "id": "vPUbNb45",
        "block": "[[[10,0],[14,0,\"test\"],[12],[1,[28,[35,0],[\"d-watching\"],null]],[13]],[],false,[\"d-icon\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const html = (0, _qunitHelpers.query)(".test").innerHTML.trim();
      assert.strictEqual(html, '<svg class="fa d-icon d-icon-d-watching svg-icon svg-string" xmlns="http://www.w3.org/2000/svg"><use href="#discourse-bell-exclamation"></use></svg>');
    });
  });
});
define("discourse/tests/integration/components/d-navigation-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | d-navigation", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      const categories = this.site.categoriesList.filter(category => !category.parent_category_id).slice(0, 4);
      this.site.setProperties({
        categories
      });
      this.currentUser.set("indirectly_muted_category_ids", categories.slice(0, 3).map(category => category.id));
    });
    (0, _qunit.test)("filters indirectly muted categories", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DNavigation @filterType="categories" />
      */
      {
        "id": "oi7Qc7zq",
        "block": "[[[8,[39,0],null,[[\"@filterType\"],[\"categories\"]],null]],[],false,[\"d-navigation\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".category-drop .select-kit-header-wrapper");
      assert.strictEqual((0, _qunitHelpers.count)(".category-row"), 1, "displays only categories that are not muted");
      assert.strictEqual((0, _qunitHelpers.query)(".category-row .badge-category span").textContent.trim(), "dev");
    });
  });
});
define("discourse/tests/integration/components/d-popover-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/lib/d-popover"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _dPopover) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/lib/d-popover"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | d-popover", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("show/hide popover from lib", async function (assert) {
      this.set("onButtonClick", (_, event) => {
        (0, _dPopover.showPopover)(event, {
          content: "test",
          trigger: "click",
          duration: 0
        });
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <DButton
              @translatedLabel="test"
              @action={{this.onButtonClick}}
              @forwardEvent={{true}}
            />
          
      */
      {
        "id": "5+zsw1+l",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@translatedLabel\",\"@action\",\"@forwardEvent\"],[\"test\",[30,0,[\"onButtonClick\"]],true]],null],[1,\"\\n    \"]],[],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.notOk(document.querySelector("div[data-tippy-root]"));
      await (0, _testHelpers.click)(".btn");
      assert.strictEqual(document.querySelector("div[data-tippy-root]").innerText.trim(), "test");
      await (0, _testHelpers.click)(".btn");
      assert.notOk(document.querySelector("div[data-tippy-root]"));
    });
    (0, _qunit.test)("show/hide popover from component", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <DPopover>
              <DButton class="trigger" @icon="chevron-down" />
              <ul>
                <li class="test">foo</li>
                <li><DButton class="closer" @icon="times" /></li>
              </ul>
            </DPopover>
          
      */
      {
        "id": "89M8uSQ8",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,null,[[\"default\"],[[[[1,\"\\n        \"],[8,[39,1],[[24,0,\"trigger\"]],[[\"@icon\"],[\"chevron-down\"]],null],[1,\"\\n        \"],[10,\"ul\"],[12],[1,\"\\n          \"],[10,\"li\"],[14,0,\"test\"],[12],[1,\"foo\"],[13],[1,\"\\n          \"],[10,\"li\"],[12],[8,[39,1],[[24,0,\"closer\"]],[[\"@icon\"],[\"times\"]],null],[13],[1,\"\\n        \"],[13],[1,\"\\n      \"]],[]]]]],[1,\"\\n    \"]],[],false,[\"d-popover\",\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.notOk((0, _qunitHelpers.exists)(".d-popover.is-expanded"));
      assert.notOk((0, _qunitHelpers.exists)(".test"));
      await (0, _testHelpers.click)(".trigger");
      assert.ok((0, _qunitHelpers.exists)(".d-popover.is-expanded"));
      assert.strictEqual((0, _qunitHelpers.query)(".test").innerText.trim(), "foo");
      await (0, _testHelpers.click)(".closer");
      assert.notOk((0, _qunitHelpers.exists)(".d-popover.is-expanded"));
    });
    (0, _qunit.test)("using options with component", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <DPopover @options={{hash content="bar"}}>
              <DButton @icon="chevron-down" />
            </DPopover>
          
      */
      {
        "id": "u6gooJDp",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@options\"],[[28,[37,1],null,[[\"content\"],[\"bar\"]]]]],[[\"default\"],[[[[1,\"\\n        \"],[8,[39,2],null,[[\"@icon\"],[\"chevron-down\"]],null],[1,\"\\n      \"]],[]]]]],[1,\"\\n    \"]],[],false,[\"d-popover\",\"hash\",\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".btn");
      assert.strictEqual((0, _qunitHelpers.query)(".tippy-content").innerText.trim(), "bar");
    });
    (0, _qunit.test)("d-popover component accepts a block", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <DPopover as |state|>
              <DButton @icon={{if state.isExpanded "chevron-up" "chevron-down"}} />
            </DPopover>
          
      */
      {
        "id": "AIh0nuBu",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,null,[[\"default\"],[[[[1,\"\\n        \"],[8,[39,1],null,[[\"@icon\"],[[52,[30,1,[\"isExpanded\"]],\"chevron-up\",\"chevron-down\"]]],null],[1,\"\\n      \"]],[1]]]]],[1,\"\\n    \"]],[\"state\"],false,[\"d-popover\",\"d-button\",\"if\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".d-icon-chevron-down"));
      await (0, _testHelpers.click)(".btn");
      assert.ok((0, _qunitHelpers.exists)(".d-icon-chevron-up"));
    });
    (0, _qunit.test)("d-popover component accepts a class property", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DPopover @class="foo"></DPopover>
      */
      {
        "id": "HLQyDI8N",
        "block": "[[[8,[39,0],null,[[\"@class\"],[\"foo\"]],[[\"default\"],[[[],[]]]]]],[],false,[\"d-popover\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".d-popover.foo"));
    });
    (0, _qunit.test)("d-popover component closes on escape key", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <DPopover as |state|>
              <DButton @icon={{if state.isExpanded "chevron-up" "chevron-down"}} />
            </DPopover>
          
      */
      {
        "id": "AIh0nuBu",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,null,[[\"default\"],[[[[1,\"\\n        \"],[8,[39,1],null,[[\"@icon\"],[[52,[30,1,[\"isExpanded\"]],\"chevron-up\",\"chevron-down\"]]],null],[1,\"\\n      \"]],[1]]]]],[1,\"\\n    \"]],[\"state\"],false,[\"d-popover\",\"d-button\",\"if\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".btn");
      assert.ok((0, _qunitHelpers.exists)(".d-popover.is-expanded"));
      await (0, _testHelpers.triggerKeyEvent)(document, "keydown", "Escape");
      assert.notOk((0, _qunitHelpers.exists)(".d-popover.is-expanded"));
    });
  });
});
define("discourse/tests/integration/components/d-tooltip-test", ["@ember/template-factory", "qunit", "@ember/test-helpers", "discourse/tests/helpers/component-test", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _testHelpers, _componentTest, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"@ember/test-helpers",0,"discourse/tests/helpers/component-test",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/qunit-helpers"eaimeta@70e063a35619d71f

  async function mouseenter() {
    await (0, _testHelpers.triggerEvent)((0, _qunitHelpers.query)("button"), "mouseenter");
  }

  (0, _qunit.module)("Integration | Component | d-tooltip", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("doesn't show tooltip if it wasn't expanded", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <button>
              <DTooltip>
                Tooltip text
              </DTooltip>
            </button>
           
      */
      {
        "id": "rbsQtKI7",
        "block": "[[[1,\"\\n      \"],[10,\"button\"],[12],[1,\"\\n        \"],[8,[39,0],null,null,[[\"default\"],[[[[1,\"\\n          Tooltip text\\n        \"]],[]]]]],[1,\"\\n      \"],[13],[1,\"\\n     \"]],[],false,[\"d-tooltip\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.notOk(document.querySelector("[data-tippy-root]"));
    });
    (0, _qunit.test)("it shows tooltip on mouseenter", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <button>
              <DTooltip>
                Tooltip text
              </DTooltip>
            </button>
           
      */
      {
        "id": "rbsQtKI7",
        "block": "[[[1,\"\\n      \"],[10,\"button\"],[12],[1,\"\\n        \"],[8,[39,0],null,null,[[\"default\"],[[[[1,\"\\n          Tooltip text\\n        \"]],[]]]]],[1,\"\\n      \"],[13],[1,\"\\n     \"]],[],false,[\"d-tooltip\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await mouseenter();
      assert.ok(document.querySelector("[data-tippy-root]"), "the tooltip is added to the page");
      assert.equal(document.querySelector("[data-tippy-root] .tippy-content").textContent.trim(), "Tooltip text", "the tooltip content is correct");
    });
  });
});
define("discourse/tests/integration/components/date-input-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  function dateInput() {
    return (0, _qunitHelpers.query)(".date-picker");
  }

  function setDate(date) {
    this.set("date", date);
  }

  function noop() {}

  const DEFAULT_DATE = moment("2019-01-29");
  (0, _qunit.module)("Integration | Component | date-input", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("default", async function (assert) {
      this.setProperties({
        date: DEFAULT_DATE
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DateInput @date={{this.date}} />
      */
      {
        "id": "L1pHJM5C",
        "block": "[[[8,[39,0],null,[[\"@date\"],[[30,0,[\"date\"]]]],null]],[],false,[\"date-input\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(dateInput().value, "2019-01-29");
    });
    (0, _qunit.test)("prevents mutations", async function (assert) {
      this.setProperties({
        date: DEFAULT_DATE
      });
      this.set("onChange", noop);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DateInput @date={{this.date}} @onChange={{this.onChange}} />
      */
      {
        "id": "3/xaXC/x",
        "block": "[[[8,[39,0],null,[[\"@date\",\"@onChange\"],[[30,0,[\"date\"]],[30,0,[\"onChange\"]]]],null]],[],false,[\"date-input\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      dateInput().value = "2019-01-02";
      dateInput().dispatchEvent(new Event("change"));
      assert.ok(this.date.isSame(DEFAULT_DATE));
    });
    (0, _qunit.test)("allows mutations through actions", async function (assert) {
      this.setProperties({
        date: DEFAULT_DATE
      });
      this.set("onChange", setDate);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DateInput @date={{this.date}} @onChange={{this.onChange}} />
      */
      {
        "id": "3/xaXC/x",
        "block": "[[[8,[39,0],null,[[\"@date\",\"@onChange\"],[[30,0,[\"date\"]],[30,0,[\"onChange\"]]]],null]],[],false,[\"date-input\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      dateInput().value = "2019-02-02";
      dateInput().dispatchEvent(new Event("change"));
      assert.ok(this.date.isSame(moment("2019-02-02")));
    });
  });
});
define("discourse/tests/integration/components/date-time-input-range-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/select-kit-helper"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _selectKitHelper) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/select-kit-helper"eaimeta@70e063a35619d71f

  function fromDateInput() {
    return (0, _qunitHelpers.query)(".from.d-date-time-input .date-picker");
  }

  function fromTimeInput() {
    return (0, _qunitHelpers.query)(".from.d-date-time-input .d-time-input .combo-box-header");
  }

  function toDateInput() {
    return (0, _qunitHelpers.query)(".to.d-date-time-input .date-picker");
  }

  function toTimeInput() {
    return (0, _qunitHelpers.query)(".to.d-date-time-input .d-time-input .combo-box-header");
  }

  const DEFAULT_DATE_TIME_STRING = "2019-01-29 14:45";
  const DEFAULT_DATE_TIME = moment(DEFAULT_DATE_TIME_STRING);
  (0, _qunit.module)("Integration | Component | date-time-input-range", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("default", async function (assert) {
      this.setProperties({
        state: {
          from: DEFAULT_DATE_TIME,
          to: null
        }
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DateTimeInputRange @from={{this.state.from}} @to={{this.state.to}} @onChange={{action (mut this.state)}} />
      */
      {
        "id": "TSD/7Uks",
        "block": "[[[8,[39,0],null,[[\"@from\",\"@to\",\"@onChange\"],[[30,0,[\"state\",\"from\"]],[30,0,[\"state\",\"to\"]],[28,[37,1],[[30,0],[28,[37,2],[[30,0,[\"state\"]]],null]],null]]],null]],[],false,[\"date-time-input-range\",\"action\",\"mut\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(fromDateInput().value, "2019-01-29");
      assert.strictEqual(fromTimeInput().dataset.name, "14:45");
      assert.strictEqual(toDateInput().value, "");
      assert.strictEqual(toTimeInput().dataset.name, "--:--");
      await (0, _testHelpers.fillIn)(toDateInput(), "2019-01-29");
      const toTimeSelectKit = (0, _selectKitHelper.default)(".to .d-time-input .select-kit");
      await toTimeSelectKit.expand();
      let rows = toTimeSelectKit.rows();
      assert.equal(rows[0].dataset.name, "14:45");
      assert.equal(rows[rows.length - 1].dataset.name, "23:45");
      await toTimeSelectKit.collapse();
      await (0, _testHelpers.fillIn)(toDateInput(), "2019-01-30");
      await toTimeSelectKit.expand();
      rows = toTimeSelectKit.rows();
      assert.equal(rows[0].dataset.name, "00:00");
      assert.equal(rows[rows.length - 1].dataset.name, "23:45");
    });
    (0, _qunit.test)("timezone support", async function (assert) {
      this.setProperties({
        state: {
          from: moment.tz(DEFAULT_DATE_TIME_STRING, "Europe/Paris"),
          to: null
        }
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DateTimeInputRange @from={{this.state.from}} @to={{this.state.to}} @onChange={{action (mut this.state)}} @timezone="Europe/Paris" />
      */
      {
        "id": "P086NqOx",
        "block": "[[[8,[39,0],null,[[\"@from\",\"@to\",\"@onChange\",\"@timezone\"],[[30,0,[\"state\",\"from\"]],[30,0,[\"state\",\"to\"]],[28,[37,1],[[30,0],[28,[37,2],[[30,0,[\"state\"]]],null]],null],\"Europe/Paris\"]],null]],[],false,[\"date-time-input-range\",\"action\",\"mut\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(fromDateInput().value, "2019-01-29");
      assert.strictEqual(fromTimeInput().dataset.name, "14:45");
      assert.strictEqual(toDateInput().value, "");
      assert.strictEqual(toTimeInput().dataset.name, "--:--");
      await (0, _testHelpers.fillIn)(toDateInput(), "2019-01-29");
      const toTimeSelectKit = (0, _selectKitHelper.default)(".to .d-time-input .select-kit");
      await toTimeSelectKit.expand();
      await toTimeSelectKit.selectRowByName("19:15");
      assert.equal(this.state.to.toString(), "Tue Jan 29 2019 19:15:00 GMT+0100");
    });
  });
});
define("discourse/tests/integration/components/date-time-input-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  function dateInput() {
    return (0, _qunitHelpers.query)(".date-picker");
  }

  function timeInput() {
    return (0, _qunitHelpers.query)(".d-time-input .combo-box-header");
  }

  function setDate(date) {
    this.set("date", date);
  }

  const DEFAULT_DATE_TIME = moment("2019-01-29 14:45");
  (0, _qunit.module)("Integration | Component | date-time-input", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("default", async function (assert) {
      this.setProperties({
        date: DEFAULT_DATE_TIME
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DateTimeInput @date={{this.date}} />
      */
      {
        "id": "8GoS37HT",
        "block": "[[[8,[39,0],null,[[\"@date\"],[[30,0,[\"date\"]]]],null]],[],false,[\"date-time-input\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(dateInput().value, "2019-01-29");
      assert.strictEqual(timeInput().dataset.name, "14:45");
    });
    (0, _qunit.test)("prevents mutations", async function (assert) {
      this.setProperties({
        date: DEFAULT_DATE_TIME
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DateTimeInput @date={{this.date}} />
      */
      {
        "id": "8GoS37HT",
        "block": "[[[8,[39,0],null,[[\"@date\"],[[30,0,[\"date\"]]]],null]],[],false,[\"date-time-input\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      dateInput().value = "2019-01-02";
      assert.ok(this.date.isSame(DEFAULT_DATE_TIME));
    });
    (0, _qunit.test)("allows mutations through actions", async function (assert) {
      this.setProperties({
        date: DEFAULT_DATE_TIME
      });
      this.set("onChange", setDate);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DateTimeInput @date={{this.date}} @onChange={{this.onChange}} />
      */
      {
        "id": "WNLHDnGF",
        "block": "[[[8,[39,0],null,[[\"@date\",\"@onChange\"],[[30,0,[\"date\"]],[30,0,[\"onChange\"]]]],null]],[],false,[\"date-time-input\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      dateInput().value = "2019-01-02";
      dateInput().dispatchEvent(new Event("change"));
      assert.ok(this.date.isSame(moment("2019-01-02 14:45")));
    });
    (0, _qunit.test)("can hide time", async function (assert) {
      this.setProperties({
        date: DEFAULT_DATE_TIME
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DateTimeInput @date={{this.date}} @showTime={{false}} />
      */
      {
        "id": "wgOQQcR5",
        "block": "[[[8,[39,0],null,[[\"@date\",\"@showTime\"],[[30,0,[\"date\"]],false]],null]],[],false,[\"date-time-input\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.notOk((0, _qunitHelpers.exists)(timeInput()));
    });
  });
});
define("discourse/tests/integration/components/dialog-holder-test", ["@ember/template-factory", "I18n", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _I18n, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"I18n",0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/qunit-helpers"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | dialog-holder", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.dialog = this.container.lookup("service:dialog");
    });
    (0, _qunit.test)("basics", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DialogHolder />
      */
      {
        "id": "dFtLGLB2",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"dialog-holder\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.query)("#dialog-holder"), "element is in DOM");
      assert.strictEqual((0, _qunitHelpers.query)("#dialog-holder").innerText.trim(), "", "dialog is empty by default");
      this.dialog.alert({
        message: "This is an error"
      });
      await (0, _testHelpers.settled)();
      assert.ok((0, _qunitHelpers.query)(".dialog-overlay").offsetWidth > 0, true, "overlay is visible");
      assert.strictEqual((0, _qunitHelpers.query)(".dialog-body").innerText.trim(), "This is an error", "dialog has error message"); // dismiss by clicking on overlay

      await (0, _testHelpers.click)(".dialog-overlay");
      assert.ok((0, _qunitHelpers.query)("#dialog-holder"), "element is still in DOM");
      assert.strictEqual((0, _qunitHelpers.query)(".dialog-overlay").offsetWidth, 0, "overlay is not visible");
      assert.strictEqual((0, _qunitHelpers.query)("#dialog-holder").innerText.trim(), "", "dialog is empty");
    });
    (0, _qunit.test)("basics - dismiss using Esc", async function (assert) {
      let cancelCallbackCalled = false;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DialogHolder />
      */
      {
        "id": "dFtLGLB2",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"dialog-holder\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.query)("#dialog-holder"), "element is in DOM");
      assert.strictEqual((0, _qunitHelpers.query)("#dialog-holder").innerText.trim(), "", "dialog is empty by default");
      this.dialog.alert({
        message: "This is an error",
        didCancel: () => {
          cancelCallbackCalled = true;
        }
      });
      await (0, _testHelpers.settled)();
      assert.ok((0, _qunitHelpers.query)(".dialog-overlay").offsetWidth > 0, true, "overlay is visible");
      assert.strictEqual((0, _qunitHelpers.query)(".dialog-body").innerText.trim(), "This is an error", "dialog has error message"); // dismiss by pressing Esc

      await (0, _testHelpers.triggerKeyEvent)(document, "keydown", "Escape");
      assert.ok(cancelCallbackCalled, "cancel callback called");
      assert.ok((0, _qunitHelpers.query)("#dialog-holder"), "element is still in DOM");
      assert.strictEqual((0, _qunitHelpers.query)(".dialog-overlay").offsetWidth, 0, "overlay is not visible");
      assert.strictEqual((0, _qunitHelpers.query)("#dialog-holder").innerText.trim(), "", "dialog is empty");
    });
    (0, _qunit.test)("alert with title", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DialogHolder />
      */
      {
        "id": "dFtLGLB2",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"dialog-holder\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      this.dialog.alert({
        message: "This is a note.",
        title: "And this is a title"
      });
      await (0, _testHelpers.settled)();
      assert.strictEqual((0, _qunitHelpers.query)("#dialog-title").innerText.trim(), "And this is a title", "dialog has title");
      assert.ok((0, _qunitHelpers.query)("#dialog-holder[aria-labelledby='dialog-title']"), "aria-labelledby is correctly set");
      assert.ok((0, _qunitHelpers.query)(".dialog-close"), "close button present");
      assert.ok((0, _qunitHelpers.query)("#dialog-holder"), "element is still in DOM");
      assert.strictEqual((0, _qunitHelpers.query)(".dialog-body").innerText.trim(), "This is a note.", "dialog message is shown");
      await (0, _testHelpers.click)(".dialog-close");
      assert.ok((0, _qunitHelpers.query)("#dialog-holder"), "element is still in DOM");
      assert.strictEqual((0, _qunitHelpers.query)(".dialog-overlay").offsetWidth, 0, "overlay is not visible");
      assert.strictEqual((0, _qunitHelpers.query)("#dialog-holder").innerText.trim(), "", "dialog is empty");
    });
    (0, _qunit.test)("alert with a string parameter", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DialogHolder />
      */
      {
        "id": "dFtLGLB2",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"dialog-holder\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      this.dialog.alert("An alert message");
      await (0, _testHelpers.settled)();
      assert.strictEqual((0, _qunitHelpers.query)(".dialog-body").innerText.trim(), "An alert message", "dialog message is shown");
    });
    (0, _qunit.test)("confirm", async function (assert) {
      let confirmCallbackCalled = false;
      let cancelCallbackCalled = false;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DialogHolder />
      */
      {
        "id": "dFtLGLB2",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"dialog-holder\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      this.dialog.confirm({
        message: "A confirm message",
        didConfirm: () => {
          confirmCallbackCalled = true;
        },
        didCancel: () => {
          cancelCallbackCalled = true;
        }
      });
      await (0, _testHelpers.settled)();
      assert.strictEqual((0, _qunitHelpers.query)(".dialog-body").innerText.trim(), "A confirm message", "dialog message is shown");
      assert.strictEqual((0, _qunitHelpers.query)(".dialog-footer .btn-primary").innerText.trim(), _I18n.default.t("ok_value"), "dialog primary button says Ok");
      assert.strictEqual((0, _qunitHelpers.query)(".dialog-footer .btn-default").innerText.trim(), _I18n.default.t("cancel_value"), "dialog second button is present and says No");
      await (0, _testHelpers.click)(".dialog-footer .btn-primary");
      assert.ok(confirmCallbackCalled, "confirm callback called");
      assert.notOk(cancelCallbackCalled, "cancel callback NOT called");
      assert.strictEqual((0, _qunitHelpers.query)("#dialog-holder").innerText.trim(), "", "dialog is empty");
    });
    (0, _qunit.test)("cancel callback", async function (assert) {
      let confirmCallbackCalled = false;
      let cancelCallbackCalled = false;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DialogHolder />
      */
      {
        "id": "dFtLGLB2",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"dialog-holder\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      this.dialog.confirm({
        message: "A confirm message",
        didConfirm: () => {
          confirmCallbackCalled = true;
        },
        didCancel: () => {
          cancelCallbackCalled = true;
        }
      });
      await (0, _testHelpers.settled)();
      assert.strictEqual((0, _qunitHelpers.query)(".dialog-body").innerText.trim(), "A confirm message", "dialog message is shown");
      await (0, _testHelpers.click)(".dialog-footer .btn-default");
      assert.notOk(confirmCallbackCalled, "confirm callback NOT called");
      assert.ok(cancelCallbackCalled, "cancel callback called");
      assert.strictEqual((0, _qunitHelpers.query)("#dialog-holder").innerText.trim(), "", "dialog has been dismissed");
    });
    (0, _qunit.test)("yes/no confirm", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DialogHolder />
      */
      {
        "id": "dFtLGLB2",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"dialog-holder\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      this.dialog.yesNoConfirm({
        message: "A yes/no confirm message"
      });
      await (0, _testHelpers.settled)();
      assert.strictEqual((0, _qunitHelpers.query)(".dialog-body").innerText.trim(), "A yes/no confirm message", "dialog message is shown");
      assert.strictEqual((0, _qunitHelpers.query)(".dialog-footer .btn-primary").innerText.trim(), _I18n.default.t("yes_value"), "dialog primary button says Yes");
      assert.strictEqual((0, _qunitHelpers.query)(".dialog-footer .btn-default").innerText.trim(), _I18n.default.t("no_value"), "dialog second button is present and says No");
    });
    (0, _qunit.test)("alert with custom buttons", async function (assert) {
      let customCallbackTriggered = false;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DialogHolder />
      */
      {
        "id": "dFtLGLB2",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"dialog-holder\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      this.dialog.alert({
        message: "An alert with custom buttons",
        buttons: [{
          icon: "cog",
          label: "Danger ahead",
          class: "btn-danger",
          action: () => {
            return new Promise(resolve => {
              customCallbackTriggered = true;
              return resolve();
            });
          }
        }]
      });
      await (0, _testHelpers.settled)();
      assert.strictEqual((0, _qunitHelpers.query)(".dialog-body").innerText.trim(), "An alert with custom buttons", "dialog message is shown");
      assert.strictEqual((0, _qunitHelpers.query)(".dialog-footer .btn-danger").innerText.trim(), "Danger ahead", "dialog custom button is present");
      assert.notOk((0, _qunitHelpers.query)(".dialog-footer .btn-primary"), "default confirm button is not present");
      assert.notOk((0, _qunitHelpers.query)(".dialog-footer .btn-default"), "default cancel button is not present");
      await (0, _testHelpers.click)(".dialog-footer .btn-danger");
      assert.ok(customCallbackTriggered, "custom action was triggered");
      assert.strictEqual((0, _qunitHelpers.query)("#dialog-holder").innerText.trim(), "", "dialog has been dismissed");
    });
    (0, _qunit.test)("alert with custom classes", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DialogHolder />
      */
      {
        "id": "dFtLGLB2",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"dialog-holder\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      this.dialog.alert({
        message: "An alert with custom classes",
        class: "dialog-special dialog-super"
      });
      await (0, _testHelpers.settled)();
      assert.strictEqual((0, _qunitHelpers.query)(".dialog-body").innerText.trim(), "An alert with custom classes", "dialog message is shown");
      assert.ok((0, _qunitHelpers.query)("#dialog-holder.dialog-special.dialog-super"), "additional classes are present");
      await (0, _testHelpers.click)(".dialog-footer .btn-primary");
      assert.notOk((0, _qunitHelpers.query)("#dialog-holder.dialog-special"), "additional class removed on dismissal");
      assert.notOk((0, _qunitHelpers.query)("#dialog-holder.dialog-super"), "additional class removed on dismissal");
    });
    (0, _qunit.test)("notice", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DialogHolder />
      */
      {
        "id": "dFtLGLB2",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"dialog-holder\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      this.dialog.notice("Noted!");
      await (0, _testHelpers.settled)();
      assert.strictEqual((0, _qunitHelpers.query)(".dialog-body").innerText.trim(), "Noted!", "message is shown");
      assert.notOk((0, _qunitHelpers.query)(".dialog-footer"), "no footer");
      assert.notOk((0, _qunitHelpers.query)(".dialog-header"), "no header");
    });
  });
});
define("discourse/tests/integration/components/emoji-picker-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | emoji-picker", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("when placement == bottom, places the picker on the bottom", async function (assert) {
      this.set("showEmojiPicker", () => {
        this.set("pickerIsActive", true);
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <DButton class="emoji-picker-anchor" @action={{this.showEmojiPicker}} />
            <EmojiPicker @isActive={{this.pickerIsActive}} @placement="bottom" />
          
      */
      {
        "id": "ui5MOMEG",
        "block": "[[[1,\"\\n      \"],[8,[39,0],[[24,0,\"emoji-picker-anchor\"]],[[\"@action\"],[[30,0,[\"showEmojiPicker\"]]]],null],[1,\"\\n      \"],[8,[39,1],null,[[\"@isActive\",\"@placement\"],[[30,0,[\"pickerIsActive\"]],\"bottom\"]],null],[1,\"\\n    \"]],[],false,[\"d-button\",\"emoji-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".emoji-picker-anchor");
      assert.strictEqual((0, _qunitHelpers.query)(".emoji-picker.opened").getAttribute("data-popper-placement"), "bottom");
    });
    (0, _qunit.test)("when placement == right, places the picker on the right", async function (assert) {
      this.set("showEmojiPicker", () => {
        this.set("pickerIsActive", true);
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <DButton class="emoji-picker-anchor" @action={{this.showEmojiPicker}} />
            <EmojiPicker @isActive={{this.pickerIsActive}} @placement="right" />
          
      */
      {
        "id": "1YliH2ka",
        "block": "[[[1,\"\\n      \"],[8,[39,0],[[24,0,\"emoji-picker-anchor\"]],[[\"@action\"],[[30,0,[\"showEmojiPicker\"]]]],null],[1,\"\\n      \"],[8,[39,1],null,[[\"@isActive\",\"@placement\"],[[30,0,[\"pickerIsActive\"]],\"right\"]],null],[1,\"\\n    \"]],[],false,[\"d-button\",\"emoji-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".emoji-picker-anchor");
      assert.strictEqual((0, _qunitHelpers.query)(".emoji-picker.opened").getAttribute("data-popper-placement"), "right");
    });
  });
});
define("discourse/tests/integration/components/emoji-uploader-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/create-pretender", "discourse/tests/helpers/select-kit-helper"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _createPretender, _selectKitHelper) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/create-pretender",0,"discourse/tests/helpers/select-kit-helper"eaimeta@70e063a35619d71f

  let requestNumber;
  (0, _qunit.module)("Integration | Component | emoji-uploader", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      requestNumber = 0;
      this.setProperties({
        emojiGroups: ["default", "cool-emojis"]
      });

      _createPretender.default.post("/admin/customize/emojis.json", () => {
        requestNumber++;

        if (requestNumber === 1) {
          return (0, _createPretender.response)({
            group: "cool-emojis",
            name: "okay",
            url: "//upload.s3.dualstack.us-east-2.amazonaws.com/original/1X/123.png"
          });
        } else if (requestNumber === 2) {
          return (0, _createPretender.response)({
            group: "cool-emojis",
            name: null,
            url: "//upload.s3.dualstack.us-east-2.amazonaws.com/original/1X/456.png"
          });
        }
      });
    });
    (0, _qunit.test)("uses the selected group for the upload", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <EmojiUploader
              @id="emoji-uploader"
              @emojiGroups={{this.emojiGroups}}
              @done={{this.doneUpload}}
            />
          
      */
      {
        "id": "gsvN5e5a",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@id\",\"@emojiGroups\",\"@done\"],[\"emoji-uploader\",[30,0,[\"emojiGroups\"]],[30,0,[\"doneUpload\"]]]],null],[1,\"\\n    \"]],[],false,[\"emoji-uploader\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const done = assert.async();
      await (0, _selectKitHelper.default)("#emoji-group-selector").expand();
      await (0, _selectKitHelper.default)("#emoji-group-selector").selectRowByValue("cool-emojis");
      this.set("doneUpload", (upload, group) => {
        assert.strictEqual("cool-emojis", group);
        done();
      });
      const image = (0, _qunitHelpers.createFile)("avatar.png");
      await this.container.lookup("service:app-events").trigger("upload-mixin:emoji-uploader:add-files", image);
    });
    (0, _qunit.test)("does not clear the selected group between multiple uploads", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <EmojiUploader
              @id="emoji-uploader"
              @emojiGroups={{this.emojiGroups}}
              @done={{this.doneUpload}}
            />
          
      */
      {
        "id": "gsvN5e5a",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@id\",\"@emojiGroups\",\"@done\"],[\"emoji-uploader\",[30,0,[\"emojiGroups\"]],[30,0,[\"doneUpload\"]]]],null],[1,\"\\n    \"]],[],false,[\"emoji-uploader\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const done = assert.async();
      await (0, _selectKitHelper.default)("#emoji-group-selector").expand();
      await (0, _selectKitHelper.default)("#emoji-group-selector").selectRowByValue("cool-emojis");
      let uploadDoneCount = 0;
      this.set("doneUpload", (upload, group) => {
        uploadDoneCount++;
        assert.strictEqual("cool-emojis", group);

        if (uploadDoneCount === 2) {
          done();
        }
      });
      const image = (0, _qunitHelpers.createFile)("avatar.png");
      const image2 = (0, _qunitHelpers.createFile)("avatar2.png");
      await this.container.lookup("service:app-events").trigger("upload-mixin:emoji-uploader:add-files", [image, image2]);
    });
    (0, _qunit.test)("clears the name after the first upload to avoid duplicate names", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <EmojiUploader
              @id="emoji-uploader"
              @emojiGroups={{this.emojiGroups}}
              @done={{this.doneUpload}}
            />
          
      */
      {
        "id": "gsvN5e5a",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@id\",\"@emojiGroups\",\"@done\"],[\"emoji-uploader\",[30,0,[\"emojiGroups\"]],[30,0,[\"doneUpload\"]]]],null],[1,\"\\n    \"]],[],false,[\"emoji-uploader\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const done = assert.async();
      await (0, _selectKitHelper.default)("#emoji-group-selector").expand();
      await (0, _selectKitHelper.default)("#emoji-group-selector").selectRowByValue("cool-emojis");
      await (0, _testHelpers.fillIn)("#emoji-name", "okay");
      let uploadDoneCount = 0;
      this.set("doneUpload", upload => {
        uploadDoneCount++;

        if (uploadDoneCount === 1) {
          assert.strictEqual(upload.name, "okay");
        }

        if (uploadDoneCount === 2) {
          assert.strictEqual(upload.name, null);
          done();
        }
      });
      const image = (0, _qunitHelpers.createFile)("avatar.png");
      const image2 = (0, _qunitHelpers.createFile)("avatar2.png");
      await this.container.lookup("service:app-events").trigger("upload-mixin:emoji-uploader:add-files", [image, image2]);
    });
  });
});
define("discourse/tests/integration/components/empty-state-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | empty-state", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("it renders", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <EmptyState @title="title" @body="body" />
      */
      {
        "id": "H/Je/Fpe",
        "block": "[[[8,[39,0],null,[[\"@title\",\"@body\"],[\"title\",\"body\"]],null]],[],false,[\"empty-state\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("[data-test-title]").textContent, "title");
      assert.strictEqual((0, _qunitHelpers.query)("[data-test-body]").textContent, "body");
    });
  });
});
define("discourse/tests/integration/components/flat-button-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | flat-button", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("press Enter", async function (assert) {
      this.set("foo", null);
      this.set("action", () => {
        this.set("foo", "bar");
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <FlatButton @action={{this.action}} />
      */
      {
        "id": "s0GhFPkE",
        "block": "[[[8,[39,0],null,[[\"@action\"],[[30,0,[\"action\"]]]],null]],[],false,[\"flat-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.triggerKeyEvent)(".btn-flat", "keydown", "Space");
      assert.strictEqual(this.foo, null);
      await (0, _testHelpers.triggerKeyEvent)(".btn-flat", "keydown", "Enter");
      assert.strictEqual(this.foo, "bar");
    });
    (0, _qunit.test)("click", async function (assert) {
      this.set("foo", null);
      this.set("action", () => {
        this.set("foo", "bar");
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <FlatButton @action={{this.action}} />
      */
      {
        "id": "s0GhFPkE",
        "block": "[[[8,[39,0],null,[[\"@action\"],[[30,0,[\"action\"]]]],null]],[],false,[\"flat-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".btn-flat");
      assert.strictEqual(this.foo, "bar");
    });
  });
});
define("discourse/tests/integration/components/group-list-setting-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/select-kit-helper", "@ember/object"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _selectKitHelper, _object) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"ember-cli-htmlbars",0,"@ember/object"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | group-list site-setting", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("default", async function (assert) {
      this.site.groups = [{
        id: 1,
        name: "Donuts"
      }, {
        id: 2,
        name: "Cheese cake"
      }];
      this.set("setting", _object.default.create({
        allowsNone: undefined,
        category: "foo",
        default: "",
        description: "Choose groups",
        overridden: false,
        placeholder: null,
        preview: null,
        secret: false,
        setting: "foo_bar",
        type: "group_list",
        validValues: undefined,
        value: "1"
      }));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SiteSetting @setting={{this.setting}} />
      */
      {
        "id": "cpfqOO/4",
        "block": "[[[8,[39,0],null,[[\"@setting\"],[[30,0,[\"setting\"]]]],null]],[],false,[\"site-setting\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const subject = (0, _selectKitHelper.default)(".list-setting");
      assert.strictEqual(subject.header().value(), "1", "it selects the setting's value");
      await subject.expand();
      await subject.selectRowByValue("2");
      assert.strictEqual(subject.header().value(), "1,2", "it allows to select a setting from the list of choices");
    });
  });
});
define("discourse/tests/integration/components/group-membership-button-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | group-membership-button", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("canJoinGroup", async function (assert) {
      this.set("model", {
        public_admission: false,
        is_group_user: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <GroupMembershipButton @model={{this.model}} />
      */
      {
        "id": "tFrMlzxO",
        "block": "[[[8,[39,0],null,[[\"@model\"],[[30,0,[\"model\"]]]],null]],[],false,[\"group-membership-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".group-index-join"), "can't join group if public_admission is false");
      this.set("model.public_admission", true);
      assert.ok(!(0, _qunitHelpers.exists)(".group-index-join"), "can't join group if user is already in the group");
      this.set("model.is_group_user", false);
      assert.ok((0, _qunitHelpers.exists)(".group-index-join"), "allowed to join group");
    });
    (0, _qunit.test)("canLeaveGroup", async function (assert) {
      this.set("model", {
        public_exit: false,
        is_group_user: false
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <GroupMembershipButton @model={{this.model}} />
      */
      {
        "id": "tFrMlzxO",
        "block": "[[[8,[39,0],null,[[\"@model\"],[[30,0,[\"model\"]]]],null]],[],false,[\"group-membership-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".group-index-leave"), "can't leave group if public_exit is false");
      this.set("model.public_exit", true);
      assert.ok(!(0, _qunitHelpers.exists)(".group-index-leave"), "can't leave group if user is not in the group");
      this.set("model.is_group_user", true);
      assert.strictEqual((0, _qunitHelpers.count)(".group-index-leave"), 1, "allowed to leave group");
    });
    (0, _qunit.test)("canRequestMembership", async function (assert) {
      this.set("model", {
        allow_membership_requests: true,
        is_group_user: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <GroupMembershipButton @model={{this.model}} />
      */
      {
        "id": "tFrMlzxO",
        "block": "[[[8,[39,0],null,[[\"@model\"],[[30,0,[\"model\"]]]],null]],[],false,[\"group-membership-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".group-index-request"), "can't request for membership if user is already in the group");
      this.set("model.is_group_user", false);
      assert.ok((0, _qunitHelpers.exists)(".group-index-request"), "allowed to request for group membership");
    });
  });
});
define("discourse/tests/integration/components/hidden-details-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "I18n"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | hidden-details", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("Shows a link and turns link into details on click", async function (assert) {
      this.set("label", "label");
      this.set("details", "details");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <HiddenDetails @label={{this.label}} @details={{this.details}} />
      */
      {
        "id": "5cv+S/Qh",
        "block": "[[[8,[39,0],null,[[\"@label\",\"@details\"],[[30,0,[\"label\"]],[30,0,[\"details\"]]]],null]],[],false,[\"hidden-details\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".btn-link"));
      assert.strictEqual((0, _qunitHelpers.query)(".btn-link span").innerText, _I18n.default.t("label"));
      assert.notOk((0, _qunitHelpers.exists)(".description"));
      await (0, _testHelpers.click)(".btn-link");
      assert.notOk((0, _qunitHelpers.exists)(".btn-link"));
      assert.ok((0, _qunitHelpers.exists)(".description"));
      assert.strictEqual((0, _qunitHelpers.query)(".description").innerText, "details");
    });
  });
});
define("discourse/tests/integration/components/highlighted-code-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  const LONG_CODE_BLOCK = "puts a\n".repeat(15000);
  (0, _qunit.module)("Integration | Component | highlighted-code", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("highlighting code", async function (assert) {
      this.session.highlightJsPath = "/assets/highlightjs/highlight-test-bundle.min.js";
      this.set("code", "def test; end");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <HighlightedCode @lang="ruby" @code={{this.code}} />
      */
      {
        "id": "Y8GnwIkC",
        "block": "[[[8,[39,0],null,[[\"@lang\",\"@code\"],[\"ruby\",[30,0,[\"code\"]]]],null]],[],false,[\"highlighted-code\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("code.ruby.hljs .hljs-function .hljs-keyword").innerText.trim(), "def");
    });
    (0, _qunit.test)("large code blocks are not highlighted", async function (assert) {
      this.session.highlightJsPath = "/assets/highlightjs/highlight-test-bundle.min.js";
      this.set("code", LONG_CODE_BLOCK);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <HighlightedCode @lang="ruby" @code={{this.code}} />
      */
      {
        "id": "Y8GnwIkC",
        "block": "[[[8,[39,0],null,[[\"@lang\",\"@code\"],[\"ruby\",[30,0,[\"code\"]]]],null]],[],false,[\"highlighted-code\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("code").innerText.trim(), LONG_CODE_BLOCK.trim());
    });
  });
});
define("discourse/tests/integration/components/html-safe-helper-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | html-safe-helper", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("default", async function (assert) {
      this.set("string", "<p class='cookies'>biscuits</p>");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        {{html-safe string}}
      */
      {
        "id": "A7LMLkjD",
        "block": "[[[1,[28,[35,0],[[33,1]],null]]],[],false,[\"html-safe\",\"string\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("p.cookies"), "it displays the string as html");
    });
  });
});
define("discourse/tests/integration/components/iframed-html-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | iframed-html", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("appends the html into the iframe", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <IframedHtml @html="<h1 id='find-me'>hello</h1>" @className="this-is-an-iframe" />
      */
      {
        "id": "S/FcfMty",
        "block": "[[[8,[39,0],null,[[\"@html\",\"@className\"],[\"<h1 id='find-me'>hello</h1>\",\"this-is-an-iframe\"]],null]],[],false,[\"iframed-html\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const iframe = (0, _qunitHelpers.queryAll)("iframe.this-is-an-iframe");
      assert.strictEqual(iframe.length, 1, "inserts an iframe");
      assert.ok(iframe[0].classList.contains("this-is-an-iframe"), "Adds className to the iframes classList");
      assert.strictEqual(iframe[0].contentWindow.document.body.querySelectorAll("#find-me").length, 1, "inserts the passed in html into the iframe");
    });
  });
});
define("discourse/tests/integration/components/input-size-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | consistent input/dropdown/button sizes", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks); // these tests fail on Firefox 78 in CI, skipping for now

    (0, _qunitHelpers.chromeTest)("icon only button, icon and text button, text only button", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <DButton @icon="plus" /> <DButton @icon="plus" @label="topic.create" /> <DButton @label="topic.create" />
      */
      {
        "id": "kAFBrWND",
        "block": "[[[8,[39,0],null,[[\"@icon\"],[\"plus\"]],null],[1,\" \"],[8,[39,0],null,[[\"@icon\",\"@label\"],[\"plus\",\"topic.create\"]],null],[1,\" \"],[8,[39,0],null,[[\"@label\"],[\"topic.create\"]],null]],[],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".btn:nth-child(1)").offsetHeight, (0, _qunitHelpers.query)(".btn:nth-child(2)").offsetHeight, "have equal height");
      assert.strictEqual((0, _qunitHelpers.query)(".btn:nth-child(1)").offsetHeight, (0, _qunitHelpers.query)(".btn:nth-child(3)").offsetHeight, "have equal height");
    });
    (0, _qunitHelpers.chromeTest)("button + text input", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TextField /> <DButton @icon="plus" @label="topic.create" />
      */
      {
        "id": "QZ0HfaFg",
        "block": "[[[8,[39,0],null,null,null],[1,\" \"],[8,[39,1],null,[[\"@icon\",\"@label\"],[\"plus\",\"topic.create\"]],null]],[],false,[\"text-field\",\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("input").offsetHeight, (0, _qunitHelpers.query)(".btn").offsetHeight, "have equal height");
    });
    (0, _qunitHelpers.chromeTest)("combo box + input", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <ComboBox @options={{hash none="category.none"}} /> <TextField />
      */
      {
        "id": "7+vjDLpW",
        "block": "[[[8,[39,0],null,[[\"@options\"],[[28,[37,1],null,[[\"none\"],[\"category.none\"]]]]],null],[1,\" \"],[8,[39,2],null,null,null]],[],false,[\"combo-box\",\"hash\",\"text-field\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("input").offsetHeight, (0, _qunitHelpers.query)(".combo-box").offsetHeight, "have equal height");
    });
  });
});
define("discourse/tests/integration/components/invite-panel-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/create-pretender", "discourse/tests/helpers/select-kit-helper", "discourse/models/user"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _createPretender, _selectKitHelper, _user) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/create-pretender",0,"discourse/tests/helpers/select-kit-helper",0,"discourse/models/user"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | invite-panel", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("shows the invite link after it is generated", async function (assert) {
      _createPretender.default.get("/u/search/users", () => (0, _createPretender.response)({
        users: []
      }));

      _createPretender.default.post("/invites", () => (0, _createPretender.response)({
        link: "http://example.com/invites/92c297e886a0ca03089a109ccd6be155"
      }));

      this.currentUser.set("details", {
        can_invite_via_email: true
      });
      this.set("panel", {
        id: "invite",
        model: {
          inviteModel: _user.default.create(this.currentUser)
        }
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <InvitePanel @panel={{this.panel}} />
      */
      {
        "id": "0ROYFFxy",
        "block": "[[[8,[39,0],null,[[\"@panel\"],[[30,0,[\"panel\"]]]],null]],[],false,[\"invite-panel\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const input = (0, _selectKitHelper.default)(".invite-user-input");
      await input.expand();
      await input.fillInFilter("eviltrout@example.com");
      await input.selectRowByValue("eviltrout@example.com");
      assert.ok(!(0, _qunitHelpers.exists)(".send-invite:disabled"));
      await (0, _testHelpers.click)(".generate-invite-link");
      assert.strictEqual((0, _qunitHelpers.query)(".invite-link-input").value, "http://example.com/invites/92c297e886a0ca03089a109ccd6be155");
    });
  });
});
define("discourse/tests/integration/components/load-more-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/lib/eyeline"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _eyeline) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/lib/eyeline",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | load-more", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      (0, _eyeline.configureEyeline)({
        skipUpdate: false,
        rootElement: "#ember-testing"
      });
    });
    hooks.afterEach(function () {
      (0, _eyeline.configureEyeline)();
    });
    (0, _qunit.test)("updates once after initialization", async function (assert) {
      this.set("loadMore", () => this.set("loadedMore", true));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <LoadMore @selector=".numbers tr" @action={{this.loadMore}}>
              <table class="numbers"><tr></tr></table>
            </LoadMore>
          
      */
      {
        "id": "mactDcCy",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@selector\",\"@action\"],[\".numbers tr\",[30,0,[\"loadMore\"]]]],[[\"default\"],[[[[1,\"\\n        \"],[10,\"table\"],[14,0,\"numbers\"],[12],[10,\"tr\"],[12],[13],[13],[1,\"\\n      \"]],[]]]]],[1,\"\\n    \"]],[],false,[\"load-more\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(this.loadedMore);
    });
  });
});
define("discourse/tests/integration/components/pending-post-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/create-store"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _createStore) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/create-store"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | pending-post", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("it renders", async function (assert) {
      const store = (0, _createStore.default)();
      store.createRecord("category", {
        id: 2
      });
      const post = store.createRecord("pending-post", {
        id: 1,
        topic_url: "topic-url",
        username: "USERNAME",
        category_id: 2,
        raw_text: "**bold text**"
      });
      this.set("post", post);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <PendingPost @post={{this.post}}/>
      */
      {
        "id": "RkZcptz1",
        "block": "[[[8,[39,0],null,[[\"@post\"],[[30,0,[\"post\"]]]],null]],[],false,[\"pending-post\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("p.excerpt").textContent.trim(), "bold text", "renders the cooked text");
    });
  });
});
define("discourse/tests/integration/components/relative-time-picker-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/select-kit-helper"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _selectKitHelper) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/select-kit-helper"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | relative-time-picker", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.set("subject", (0, _selectKitHelper.default)());
    });
    (0, _qunit.test)("prefills and preselects minutes", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <RelativeTimePicker @durationMinutes="5" />
      */
      {
        "id": "vgN7mZDR",
        "block": "[[[8,[39,0],null,[[\"@durationMinutes\"],[\"5\"]],null]],[],false,[\"relative-time-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const prefilledDuration = (0, _qunitHelpers.query)(".relative-time-duration").value;
      assert.strictEqual(this.subject.header().value(), "mins");
      assert.strictEqual(prefilledDuration, "5");
    });
    (0, _qunit.test)("prefills and preselects hours based on translated minutes", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <RelativeTimePicker @durationMinutes="90" />
      */
      {
        "id": "x55+mgzW",
        "block": "[[[8,[39,0],null,[[\"@durationMinutes\"],[\"90\"]],null]],[],false,[\"relative-time-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const prefilledDuration = (0, _qunitHelpers.query)(".relative-time-duration").value;
      assert.strictEqual(this.subject.header().value(), "hours");
      assert.strictEqual(prefilledDuration, "1.5");
    });
    (0, _qunit.test)("prefills and preselects days based on translated minutes", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <RelativeTimePicker @durationMinutes="2880" />
      */
      {
        "id": "X5uOzze7",
        "block": "[[[8,[39,0],null,[[\"@durationMinutes\"],[\"2880\"]],null]],[],false,[\"relative-time-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const prefilledDuration = (0, _qunitHelpers.query)(".relative-time-duration").value;
      assert.strictEqual(this.subject.header().value(), "days");
      assert.strictEqual(prefilledDuration, "2");
    });
    (0, _qunit.test)("prefills and preselects months based on translated minutes", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <RelativeTimePicker @durationMinutes="129600" />
      */
      {
        "id": "+WrCbkn0",
        "block": "[[[8,[39,0],null,[[\"@durationMinutes\"],[\"129600\"]],null]],[],false,[\"relative-time-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const prefilledDuration = (0, _qunitHelpers.query)(".relative-time-duration").value;
      assert.strictEqual(this.subject.header().value(), "months");
      assert.strictEqual(prefilledDuration, "3");
    });
    (0, _qunit.test)("prefills and preselects years based on translated minutes", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <RelativeTimePicker @durationMinutes="525600" />
      */
      {
        "id": "SE7knuO9",
        "block": "[[[8,[39,0],null,[[\"@durationMinutes\"],[\"525600\"]],null]],[],false,[\"relative-time-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const prefilledDuration = (0, _qunitHelpers.query)(".relative-time-duration").value;
      assert.strictEqual(this.subject.header().value(), "years");
      assert.strictEqual(prefilledDuration, "1");
    });
    (0, _qunit.test)("prefills and preselects hours", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <RelativeTimePicker @durationHours="5" />
      */
      {
        "id": "d276e+k+",
        "block": "[[[8,[39,0],null,[[\"@durationHours\"],[\"5\"]],null]],[],false,[\"relative-time-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const prefilledDuration = (0, _qunitHelpers.query)(".relative-time-duration").value;
      assert.strictEqual(this.subject.header().value(), "hours");
      assert.strictEqual(prefilledDuration, "5");
    });
    (0, _qunit.test)("prefills and preselects minutes based on translated hours", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <RelativeTimePicker @durationHours="0.5" />
      */
      {
        "id": "ZJR7bdK5",
        "block": "[[[8,[39,0],null,[[\"@durationHours\"],[\"0.5\"]],null]],[],false,[\"relative-time-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const prefilledDuration = (0, _qunitHelpers.query)(".relative-time-duration").value;
      assert.strictEqual(this.subject.header().value(), "mins");
      assert.strictEqual(prefilledDuration, "30");
    });
    (0, _qunit.test)("prefills and preselects days based on translated hours", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <RelativeTimePicker @durationHours="48" />
      */
      {
        "id": "CiOw8Pmb",
        "block": "[[[8,[39,0],null,[[\"@durationHours\"],[\"48\"]],null]],[],false,[\"relative-time-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const prefilledDuration = (0, _qunitHelpers.query)(".relative-time-duration").value;
      assert.strictEqual(this.subject.header().value(), "days");
      assert.strictEqual(prefilledDuration, "2");
    });
    (0, _qunit.test)("prefills and preselects months based on translated hours", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <RelativeTimePicker @durationHours="2160" />
      */
      {
        "id": "51/SjPAZ",
        "block": "[[[8,[39,0],null,[[\"@durationHours\"],[\"2160\"]],null]],[],false,[\"relative-time-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const prefilledDuration = (0, _qunitHelpers.query)(".relative-time-duration").value;
      assert.strictEqual(this.subject.header().value(), "months");
      assert.strictEqual(prefilledDuration, "3");
    });
    (0, _qunit.test)("prefills and preselects years based on translated hours", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <RelativeTimePicker @durationHours="17520" />
      */
      {
        "id": "ZNFcVPgh",
        "block": "[[[8,[39,0],null,[[\"@durationHours\"],[\"17520\"]],null]],[],false,[\"relative-time-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const prefilledDuration = (0, _qunitHelpers.query)(".relative-time-duration").value;
      assert.strictEqual(this.subject.header().value(), "years");
      assert.strictEqual(prefilledDuration, "2");
    });
  });
});
define("discourse/tests/integration/components/secret-value-list-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "I18n"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"I18n",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | secret-value-list", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("adding a value", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SecretValueList @values={{this.values}} />
      */
      {
        "id": "MV1ka+AI",
        "block": "[[[8,[39,0],null,[[\"@values\"],[[30,0,[\"values\"]]]],null]],[],false,[\"secret-value-list\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      this.set("values", "firstKey|FirstValue\nsecondKey|secondValue");
      await (0, _testHelpers.fillIn)(".new-value-input.key", "thirdKey");
      await (0, _testHelpers.click)(".add-value-btn");
      assert.strictEqual((0, _qunitHelpers.count)(".values .value"), 2, "it doesn't add the value to the list if secret is missing");
      await (0, _testHelpers.fillIn)(".new-value-input.key", "");
      await (0, _testHelpers.fillIn)(".new-value-input.secret", "thirdValue");
      await (0, _testHelpers.click)(".add-value-btn");
      assert.strictEqual((0, _qunitHelpers.count)(".values .value"), 2, "it doesn't add the value to the list if key is missing");
      await (0, _testHelpers.fillIn)(".new-value-input.key", "thirdKey");
      await (0, _testHelpers.fillIn)(".new-value-input.secret", "thirdValue");
      await (0, _testHelpers.click)(".add-value-btn");
      assert.strictEqual((0, _qunitHelpers.count)(".values .value"), 3, "it adds the value to the list of values");
      assert.deepEqual(this.values, "firstKey|FirstValue\nsecondKey|secondValue\nthirdKey|thirdValue", "it adds the value to the list of values");
    });
    (0, _qunit.test)("adding an invalid value", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SecretValueList @values={{this.values}} />
      */
      {
        "id": "MV1ka+AI",
        "block": "[[[8,[39,0],null,[[\"@values\"],[[30,0,[\"values\"]]]],null]],[],false,[\"secret-value-list\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.fillIn)(".new-value-input.key", "someString");
      await (0, _testHelpers.fillIn)(".new-value-input.secret", "keyWithAPipe|Hidden");
      await (0, _testHelpers.click)(".add-value-btn");
      assert.ok(!(0, _qunitHelpers.exists)(".values .value"), "it doesn't add the value to the list of values");
      assert.deepEqual(this.values, undefined, "it doesn't add the value to the list of values");
      assert.ok((0, _qunitHelpers.query)(".validation-error").innerText.includes(_I18n.default.t("admin.site_settings.secret_list.invalid_input")), "it shows validation error");
    });
    (0, _qunit.test)("changing a value", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SecretValueList @values={{this.values}} />
      */
      {
        "id": "MV1ka+AI",
        "block": "[[[8,[39,0],null,[[\"@values\"],[[30,0,[\"values\"]]]],null]],[],false,[\"secret-value-list\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      this.set("values", "firstKey|FirstValue\nsecondKey|secondValue");
      await (0, _testHelpers.fillIn)(".values .value[data-index='1'] .value-input:first-of-type", "changedKey");
      await (0, _testHelpers.blur)(".values .value[data-index='1'] .value-input:first-of-type");
      assert.strictEqual((0, _qunitHelpers.query)(".values .value[data-index='1'] .value-input:first-of-type").value, "changedKey");
      await (0, _testHelpers.fillIn)(".values .value[data-index='1'] .value-input:last-of-type", "changedValue");
      await (0, _testHelpers.blur)(".values .value[data-index='1'] .value-input:last-of-type");
      assert.strictEqual((0, _qunitHelpers.query)(".values .value[data-index='1'] .value-input:last-of-type").value, "changedValue");
      assert.deepEqual(this.values, "firstKey|FirstValue\nchangedKey|changedValue", "updates the value list");
    });
    (0, _qunit.test)("removing a value", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SecretValueList @values={{this.values}} />
      */
      {
        "id": "MV1ka+AI",
        "block": "[[[8,[39,0],null,[[\"@values\"],[[30,0,[\"values\"]]]],null]],[],false,[\"secret-value-list\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      this.set("values", "firstKey|FirstValue\nsecondKey|secondValue");
      await (0, _testHelpers.click)(".values .value[data-index='0'] .remove-value-btn");
      assert.strictEqual((0, _qunitHelpers.count)(".values .value"), 1, "it removes the value from the list of values");
      assert.strictEqual(this.values, "secondKey|secondValue", "it removes the expected value");
    });
  });
});
define("discourse/tests/integration/components/select-kit/api-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/select-kit-helper", "select-kit/mixins/plugin-api", "discourse/lib/plugin-api"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _selectKitHelper, _pluginApi, _pluginApi2) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"select-kit/mixins/plugin-api",0,"ember-cli-htmlbars",0,"discourse/lib/plugin-api"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | select-kit/api", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.setProperties({
        comboBox: (0, _selectKitHelper.default)(".combo-box"),
        singleSelect: (0, _selectKitHelper.default)(".single-select:not(.combo-box)")
      });
    });
    hooks.afterEach(function () {
      (0, _pluginApi.clearCallbacks)();
    });
    (0, _qunit.test)("modifySelectKit(identifier).appendContent", async function (assert) {
      (0, _selectKitHelper.setDefaultState)(this, null, {
        content: _selectKitHelper.DEFAULT_CONTENT
      });
      (0, _pluginApi2.withPluginApi)("0.8.43", api => {
        api.modifySelectKit("combo-box").appendContent(() => {
          return {
            id: "alpaca",
            name: "Alpaca"
          };
        });
        api.modifySelectKit("combo-box").appendContent(() => {});
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <ComboBox @value={{this.value}} @content={{this.content}} @onChange={{this.onChange}} />
            <SingleSelect @value={{this.value}} @content={{this.content}} @onChange={{this.onChange}} />
          
      */
      {
        "id": "t48En7yk",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@value\",\"@content\",\"@onChange\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],[30,0,[\"onChange\"]]]],null],[1,\"\\n      \"],[8,[39,1],null,[[\"@value\",\"@content\",\"@onChange\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],[30,0,[\"onChange\"]]]],null],[1,\"\\n    \"]],[],false,[\"combo-box\",\"single-select\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.comboBox.expand();
      assert.strictEqual(this.comboBox.rows().length, 4);
      const appendedRow = this.comboBox.rowByIndex(3);
      assert.ok(appendedRow.exists());
      assert.strictEqual(appendedRow.value(), "alpaca");
      await this.comboBox.collapse();
      assert.notOk(this.singleSelect.rowByValue("alpaca").exists());
    });
    (0, _qunit.test)("modifySelectKit(identifier).prependContent", async function (assert) {
      (0, _selectKitHelper.setDefaultState)(this, null, {
        content: _selectKitHelper.DEFAULT_CONTENT
      });
      (0, _pluginApi2.withPluginApi)("0.8.43", api => {
        api.modifySelectKit("combo-box").prependContent(() => {
          return {
            id: "alpaca",
            name: "Alpaca"
          };
        });
        api.modifySelectKit("combo-box").prependContent(() => {});
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <ComboBox @value={{this.value}} @content={{this.content}} @onChange={{this.onChange}} />
            <SingleSelect @value={{this.value}} @content={{this.content}} @onChange={{this.onChange}} />
          
      */
      {
        "id": "t48En7yk",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@value\",\"@content\",\"@onChange\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],[30,0,[\"onChange\"]]]],null],[1,\"\\n      \"],[8,[39,1],null,[[\"@value\",\"@content\",\"@onChange\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],[30,0,[\"onChange\"]]]],null],[1,\"\\n    \"]],[],false,[\"combo-box\",\"single-select\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.comboBox.expand();
      assert.strictEqual(this.comboBox.rows().length, 4);
      const prependedRow = this.comboBox.rowByIndex(0);
      assert.ok(prependedRow.exists());
      assert.strictEqual(prependedRow.value(), "alpaca");
      await this.comboBox.collapse();
      assert.notOk(this.singleSelect.rowByValue("alpaca").exists());
    });
    (0, _qunit.test)("modifySelectKit(identifier).onChange", async function (assert) {
      (0, _selectKitHelper.setDefaultState)(this, null, {
        content: _selectKitHelper.DEFAULT_CONTENT
      });
      (0, _pluginApi2.withPluginApi)("0.8.43", api => {
        api.modifySelectKit("combo-box").onChange((component, value, item) => {
          (0, _qunitHelpers.query)("#test").innerText = item.name;
        });
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <div id="test"></div>
            <ComboBox @value={{this.value}} @content={{this.content}} @onChange={{this.onChange}} />
          
      */
      {
        "id": "+v95m3lt",
        "block": "[[[1,\"\\n      \"],[10,0],[14,1,\"test\"],[12],[13],[1,\"\\n      \"],[8,[39,0],null,[[\"@value\",\"@content\",\"@onChange\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],[30,0,[\"onChange\"]]]],null],[1,\"\\n    \"]],[],false,[\"combo-box\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.comboBox.expand();
      await this.comboBox.selectRowByIndex(0);
      assert.strictEqual((0, _qunitHelpers.query)("#test").innerText, "foo");
    });
  });
});
define("discourse/tests/integration/components/select-kit/category-chooser-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "I18n", "discourse/tests/helpers/create-store", "discourse/tests/helpers/select-kit-helper"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _I18n, _createStore, _selectKitHelper) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"I18n",0,"discourse/tests/helpers/create-store",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/select-kit-helper"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | select-kit/category-chooser", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.set("subject", (0, _selectKitHelper.default)());
    });
    (0, _qunit.test)("with value", async function (assert) {
      this.set("value", 2);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <CategoryChooser
                @value={{this.value}}
              />
            
      */
      {
        "id": "oLfwjmEi",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@value\"],[[30,0,[\"value\"]]]],null],[1,\"\\n      \"]],[],false,[\"category-chooser\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().value(), "2");
      assert.strictEqual(this.subject.header().label(), "feature");
    });
    (0, _qunit.test)("with excludeCategoryId", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <CategoryChooser
                @value={{this.value}}
                @options={{hash
                  excludeCategoryId=2
                }}
              />
            
      */
      {
        "id": "oVNew+iy",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@value\",\"@options\"],[[30,0,[\"value\"]],[28,[37,1],null,[[\"excludeCategoryId\"],[2]]]]],null],[1,\"\\n      \"]],[],false,[\"category-chooser\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      assert.notOk(this.subject.rowByValue(2).exists());
    });
    (0, _qunit.test)("with scopedCategoryId", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <CategoryChooser
                @value={{this.value}}
                @options={{hash
                  scopedCategoryId=2
                }}
              />
            
      */
      {
        "id": "mi4WcFwf",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@value\",\"@options\"],[[30,0,[\"value\"]],[28,[37,1],null,[[\"scopedCategoryId\"],[2]]]]],null],[1,\"\\n      \"]],[],false,[\"category-chooser\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      assert.strictEqual(this.subject.rowByIndex(0).title(), "feature");
      assert.strictEqual(this.subject.rowByIndex(0).value(), "2");
      assert.strictEqual(this.subject.rowByIndex(1).title(), "spec");
      assert.strictEqual(this.subject.rowByIndex(1).value(), "26");
      assert.strictEqual(this.subject.rows().length, 2, "default content is scoped");
      await this.subject.fillInFilter("bug");
      assert.strictEqual(this.subject.rowByIndex(0).name(), "bug", "search finds outside of scope");
    });
    (0, _qunit.test)("with prioritizedCategoryId", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <CategoryChooser
                @value={{this.value}}
                @options={{hash
                  prioritizedCategoryId=5
                }}
              />
            
      */
      {
        "id": "0PaOCHrM",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@value\",\"@options\"],[[30,0,[\"value\"]],[28,[37,1],null,[[\"prioritizedCategoryId\"],[5]]]]],null],[1,\"\\n      \"]],[],false,[\"category-chooser\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand(); // The prioritized category

      assert.strictEqual(this.subject.rowByIndex(0).value(), "5"); // The prioritized category's child

      assert.strictEqual(this.subject.rowByIndex(1).value(), "22"); // Other categories in the default order

      assert.strictEqual(this.subject.rowByIndex(2).value(), "6");
      assert.strictEqual(this.subject.rowByIndex(3).value(), "21");
      assert.strictEqual(this.subject.rowByIndex(4).value(), "1");
      assert.strictEqual(this.subject.rows().length, 25, "all categories are visible");
      await this.subject.fillInFilter("bug");
      assert.strictEqual(this.subject.rowByIndex(0).name(), "bug", "search still finds categories");
    });
    (0, _qunit.test)("with allowUncategorized=null", async function (assert) {
      this.siteSettings.allow_uncategorized_topics = false;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <CategoryChooser
                @value={{this.value}}
                @options={{hash
                  allowUncategorized=null
                }}
              />
            
      */
      {
        "id": "1hBGVRdx",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@value\",\"@options\"],[[30,0,[\"value\"]],[28,[37,1],null,[[\"allowUncategorized\"],[null]]]]],null],[1,\"\\n      \"]],[],false,[\"category-chooser\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().value(), null);
      assert.strictEqual(this.subject.header().label(), "category");
    });
    (0, _qunit.test)("with allowUncategorized=null none=true", async function (assert) {
      this.siteSettings.allow_uncategorized_topics = false;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <CategoryChooser
                @value={{this.value}}
                @options={{hash
                  allowUncategorized=null
                  none=true
                }}
              />
            
      */
      {
        "id": "jFhcPBLe",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@value\",\"@options\"],[[30,0,[\"value\"]],[28,[37,1],null,[[\"allowUncategorized\",\"none\"],[null,true]]]]],null],[1,\"\\n      \"]],[],false,[\"category-chooser\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().value(), null);
      assert.strictEqual(this.subject.header().label(), "(no category)");
    });
    (0, _qunit.test)("with disallowed uncategorized, none", async function (assert) {
      _I18n.default.translations[_I18n.default.locale].js.test = {
        root: "root none label"
      };
      this.siteSettings.allow_uncategorized_topics = false;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <CategoryChooser
                @value={{this.value}}
                @options={{hash
                  allowUncategorized=null
                  none="test.root"
                }}
              />
            
      */
      {
        "id": "dvGu9iZN",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@value\",\"@options\"],[[30,0,[\"value\"]],[28,[37,1],null,[[\"allowUncategorized\",\"none\"],[null,\"test.root\"]]]]],null],[1,\"\\n      \"]],[],false,[\"category-chooser\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().value(), null);
      assert.strictEqual(this.subject.header().label(), "root none label");
    });
    (0, _qunit.test)("with allowed uncategorized", async function (assert) {
      this.siteSettings.allow_uncategorized_topics = true;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <CategoryChooser
                @value={{this.value}}
                @options={{hash
                  allowUncategorized=true
                }}
              />
            
      */
      {
        "id": "FbaWahtN",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@value\",\"@options\"],[[30,0,[\"value\"]],[28,[37,1],null,[[\"allowUncategorized\"],[true]]]]],null],[1,\"\\n      \"]],[],false,[\"category-chooser\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().value(), null);
      assert.strictEqual(this.subject.header().label(), "uncategorized");
    });
    (0, _qunit.test)("with allowed uncategorized and none=true", async function (assert) {
      this.siteSettings.allow_uncategorized_topics = true;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <CategoryChooser
                @value={{this.value}}
                @options={{hash
                  allowUncategorized=true
                  none=true
                }}
              />
            
      */
      {
        "id": "z8BqHUnd",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@value\",\"@options\"],[[30,0,[\"value\"]],[28,[37,1],null,[[\"allowUncategorized\",\"none\"],[true,true]]]]],null],[1,\"\\n      \"]],[],false,[\"category-chooser\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().value(), null);
      assert.strictEqual(this.subject.header().label(), "(no category)");
    });
    (0, _qunit.test)("with allowed uncategorized and none", async function (assert) {
      _I18n.default.translations[_I18n.default.locale].js.test = {
        root: "root none label"
      };
      this.siteSettings.allow_uncategorized_topics = true;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <CategoryChooser
                @value={{this.value}}
                @options={{hash
                  allowUncategorized=true
                  none="test.root"
                }}
              />
            
      */
      {
        "id": "u3woMbfj",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@value\",\"@options\"],[[30,0,[\"value\"]],[28,[37,1],null,[[\"allowUncategorized\",\"none\"],[true,\"test.root\"]]]]],null],[1,\"\\n      \"]],[],false,[\"category-chooser\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().value(), null);
      assert.strictEqual(this.subject.header().label(), "root none label");
    });
    (0, _qunit.test)("filter is case insensitive", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <CategoryChooser
                @value={{this.value}}
              />
            
      */
      {
        "id": "oLfwjmEi",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@value\"],[[30,0,[\"value\"]]]],null],[1,\"\\n      \"]],[],false,[\"category-chooser\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      await this.subject.fillInFilter("bug");
      assert.strictEqual(this.subject.rows().length, 1);
      assert.strictEqual(this.subject.rowByIndex(0).name(), "bug");
      await this.subject.emptyFilter();
      await this.subject.fillInFilter("Bug");
      assert.strictEqual(this.subject.rows().length, 1);
      assert.strictEqual(this.subject.rowByIndex(0).name(), "bug");
    });
    (0, _qunit.test)("filter works with non english characters", async function (assert) {
      const store = (0, _createStore.default)();
      store.createRecord("category", {
        id: 1,
        name: "ch Quc ng"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <CategoryChooser
                @value={{this.value}}
              />
            
      */
      {
        "id": "oLfwjmEi",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@value\"],[[30,0,[\"value\"]]]],null],[1,\"\\n      \"]],[],false,[\"category-chooser\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      await this.subject.fillInFilter("g");
      assert.strictEqual(this.subject.rows().length, 1);
      assert.strictEqual(this.subject.rowByIndex(0).name(), "ch Quc ng");
    });
    (0, _qunit.test)("decodes entities in row title", async function (assert) {
      const store = (0, _createStore.default)();
      store.createRecord("category", {
        id: 1,
        name: "cat-with-entities",
        description_text: "baz &quot;bar foo"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <CategoryChooser
                @value={{this.value}}
                @options={{hash scopedCategoryId=1}}
              />
            
      */
      {
        "id": "ruM5qXPn",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@value\",\"@options\"],[[30,0,[\"value\"]],[28,[37,1],null,[[\"scopedCategoryId\"],[1]]]]],null],[1,\"\\n      \"]],[],false,[\"category-chooser\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      assert.strictEqual(this.subject.rowByIndex(0).el().querySelector(".category-desc").innerText, 'baz "bar foo');
    });
  });
});
define("discourse/tests/integration/components/select-kit/category-drop-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "select-kit/components/category-drop", "discourse/models/category", "discourse/lib/url", "I18n", "discourse/tests/helpers/select-kit-helper", "@ember/object", "sinon"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _categoryDrop, _category, _url, _I18n, _selectKitHelper, _object, _sinon) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"select-kit/components/category-drop",0,"discourse/models/category",0,"discourse/lib/url",0,"I18n",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/select-kit-helper",0,"@ember/object",0,"sinon"eaimeta@70e063a35619d71f

  function initCategories(context) {
    const categories = context.site.categoriesList;
    context.setProperties({
      category: categories.firstObject,
      categories
    });
  }

  function initCategoriesWithParentCategory(context) {
    const parentCategory = _category.default.findById(2);

    const childCategories = context.site.categoriesList.filter(c => {
      return c.parentCategory === parentCategory;
    });
    context.setProperties({
      parentCategory,
      category: null,
      categories: childCategories
    });
  }

  (0, _qunit.module)("Integration | Component | select-kit/category-drop", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.set("subject", (0, _selectKitHelper.default)());
    });
    (0, _qunit.test)("caretUpIcon", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <CategoryDrop
              @category={{this.value}}
              @categories={{this.content}}
            />
          
      */
      {
        "id": "S1YUfxsO",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@category\",\"@categories\"],[[30,0,[\"value\"]],[30,0,[\"content\"]]]],null],[1,\"\\n    \"]],[],false,[\"category-drop\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const header = this.subject.header().el();
      assert.ok(header.querySelector(`.d-icon-caret-right`), "it uses the correct default icon");
    });
    (0, _qunit.test)("none", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <CategoryDrop
              @category={{this.value}}
              @categories={{this.content}}
            />
          
      */
      {
        "id": "S1YUfxsO",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@category\",\"@categories\"],[[30,0,[\"value\"]],[30,0,[\"content\"]]]],null],[1,\"\\n    \"]],[],false,[\"category-drop\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const text = this.subject.header().label();
      assert.strictEqual(text, _I18n.default.t("category.all").toLowerCase(), "it uses the noneLabel");
    });
    (0, _qunit.test)("[not staff - TL0] displayCategoryDescription", async function (assert) {
      (0, _object.set)(this.currentUser, "staff", false);
      (0, _object.set)(this.currentUser, "trust_level", 0);
      initCategories(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <CategoryDrop
              @category={{this.category}}
              @categories={{this.categories}}
              @parentCategory={{this.parentCategory}}
            />
          
      */
      {
        "id": "6ig0Zi2b",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@category\",\"@categories\",\"@parentCategory\"],[[30,0,[\"category\"]],[30,0,[\"categories\"]],[30,0,[\"parentCategory\"]]]],null],[1,\"\\n    \"]],[],false,[\"category-drop\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      const row = this.subject.rowByValue(this.category.id);
      assert.ok(row.el().querySelector(".category-desc"), "it shows category description for newcomers");
    });
    (0, _qunit.test)("[not staff - TL1] displayCategoryDescription", async function (assert) {
      (0, _object.set)(this.currentUser, "moderator", false);
      (0, _object.set)(this.currentUser, "admin", false);
      (0, _object.set)(this.currentUser, "trust_level", 1);
      initCategories(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <CategoryDrop
              @category={{this.category}}
              @categories={{this.categories}}
              @parentCategory={{this.parentCategory}}
            />
          
      */
      {
        "id": "6ig0Zi2b",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@category\",\"@categories\",\"@parentCategory\"],[[30,0,[\"category\"]],[30,0,[\"categories\"]],[30,0,[\"parentCategory\"]]]],null],[1,\"\\n    \"]],[],false,[\"category-drop\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      const row = this.subject.rowByValue(this.category.id);
      assert.notOk(row.el().querySelector(".category-desc"), "it doesn't shows category description for TL0+");
    });
    (0, _qunit.test)("[staff - TL0] displayCategoryDescription", async function (assert) {
      (0, _object.set)(this.currentUser, "moderator", true);
      (0, _object.set)(this.currentUser, "trust_level", 0);
      initCategories(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <CategoryDrop
              @category={{this.category}}
              @categories={{this.categories}}
              @parentCategory={{this.parentCategory}}
            />
          
      */
      {
        "id": "6ig0Zi2b",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@category\",\"@categories\",\"@parentCategory\"],[[30,0,[\"category\"]],[30,0,[\"categories\"]],[30,0,[\"parentCategory\"]]]],null],[1,\"\\n    \"]],[],false,[\"category-drop\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      const row = this.subject.rowByValue(this.category.id);
      assert.notOk(row.el().querySelector(".category-desc"), "it doesn't show category description for staff");
    });
    (0, _qunit.test)("hideParentCategory (default: false)", async function (assert) {
      initCategories(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <CategoryDrop
              @category={{this.category}}
              @categories={{this.categories}}
              @parentCategory={{this.parentCategory}}
            />
          
      */
      {
        "id": "6ig0Zi2b",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@category\",\"@categories\",\"@parentCategory\"],[[30,0,[\"category\"]],[30,0,[\"categories\"]],[30,0,[\"parentCategory\"]]]],null],[1,\"\\n    \"]],[],false,[\"category-drop\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      const row = this.subject.rowByValue(this.category.id);
      assert.strictEqual(row.value(), this.category.id.toString());
      assert.strictEqual(this.category.parent_category_id, undefined);
    });
    (0, _qunit.test)("hideParentCategory (true)", async function (assert) {
      initCategoriesWithParentCategory(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <CategoryDrop
              @category={{this.category}}
              @categories={{this.categories}}
              @parentCategory={{this.parentCategory}}
              @options={{hash
                hideParentCategory=true
              }}
            />
          
      */
      {
        "id": "Ote01Drf",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@category\",\"@categories\",\"@parentCategory\",\"@options\"],[[30,0,[\"category\"]],[30,0,[\"categories\"]],[30,0,[\"parentCategory\"]],[28,[37,1],null,[[\"hideParentCategory\"],[true]]]]],null],[1,\"\\n    \"]],[],false,[\"category-drop\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      const parentRow = this.subject.rowByValue(this.parentCategory.id);
      assert.notOk(parentRow.exists(), "the parent row is not showing");
      const childCategory = this.categories.firstObject;
      const childCategoryId = childCategory.id;
      const childRow = this.subject.rowByValue(childCategoryId);
      assert.ok(childRow.exists(), "the child row is showing");
      const categoryStatus = childRow.el().querySelector(".category-status");
      assert.ok(categoryStatus.innerText.trim().match(/^spec/));
    });
    (0, _qunit.test)("allow_uncategorized_topics (true)", async function (assert) {
      this.siteSettings.allow_uncategorized_topics = true;
      initCategories(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <CategoryDrop
              @category={{this.category}}
              @categories={{this.categories}}
              @parentCategory={{this.parentCategory}}
            />
          
      */
      {
        "id": "6ig0Zi2b",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@category\",\"@categories\",\"@parentCategory\"],[[30,0,[\"category\"]],[30,0,[\"categories\"]],[30,0,[\"parentCategory\"]]]],null],[1,\"\\n    \"]],[],false,[\"category-drop\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      const uncategorizedCategoryId = this.site.uncategorized_category_id;
      const row = this.subject.rowByValue(uncategorizedCategoryId);
      assert.ok(row.exists(), "the uncategorized row is showing");
    });
    (0, _qunit.test)("allow_uncategorized_topics (false)", async function (assert) {
      this.siteSettings.allow_uncategorized_topics = false;
      initCategories(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <CategoryDrop
              @category={{this.category}}
              @categories={{this.categories}}
              @parentCategory={{this.parentCategory}}
            />
          
      */
      {
        "id": "6ig0Zi2b",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@category\",\"@categories\",\"@parentCategory\"],[[30,0,[\"category\"]],[30,0,[\"categories\"]],[30,0,[\"parentCategory\"]]]],null],[1,\"\\n    \"]],[],false,[\"category-drop\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      const uncategorizedCategoryId = this.site.uncategorized_category_id;
      const row = this.subject.rowByValue(uncategorizedCategoryId);
      assert.notOk(row.exists(), "the uncategorized row is not showing");
    });
    (0, _qunit.test)("countSubcategories (default: false)", async function (assert) {
      initCategories(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <CategoryDrop
              @category={{this.category}}
              @categories={{this.categories}}
              @parentCategory={{this.parentCategory}}
            />
          
      */
      {
        "id": "6ig0Zi2b",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@category\",\"@categories\",\"@parentCategory\"],[[30,0,[\"category\"]],[30,0,[\"categories\"]],[30,0,[\"parentCategory\"]]]],null],[1,\"\\n    \"]],[],false,[\"category-drop\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();

      const category = _category.default.findById(7);

      const row = this.subject.rowByValue(category.id);
      const topicCount = row.el().querySelector(".topic-count").innerText.trim();
      assert.strictEqual(topicCount, " 481", "it doesn't include the topic count of subcategories");
    });
    (0, _qunit.test)("countSubcategories (true)", async function (assert) {
      initCategories(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <CategoryDrop
              @category={{this.category}}
              @categories={{this.categories}}
              @parentCategory={{this.parentCategory}}
              @options={{hash
                countSubcategories=true
              }}
            />
          
      */
      {
        "id": "UiISaKrm",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@category\",\"@categories\",\"@parentCategory\",\"@options\"],[[30,0,[\"category\"]],[30,0,[\"categories\"]],[30,0,[\"parentCategory\"]],[28,[37,1],null,[[\"countSubcategories\"],[true]]]]],null],[1,\"\\n    \"]],[],false,[\"category-drop\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();

      const category = _category.default.findById(7);

      const row = this.subject.rowByValue(category.id);
      const topicCount = row.el().querySelector(".topic-count").innerText.trim();
      assert.strictEqual(topicCount, " 584", "it includes the topic count of subcategories");
    });
    (0, _qunit.test)("shortcuts:default", async function (assert) {
      initCategories(this);
      this.set("category", null);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <CategoryDrop
              @category={{this.category}}
              @categories={{this.categories}}
              @parentCategory={{this.parentCategory}}
            />
          
      */
      {
        "id": "6ig0Zi2b",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@category\",\"@categories\",\"@parentCategory\"],[[30,0,[\"category\"]],[30,0,[\"categories\"]],[30,0,[\"parentCategory\"]]]],null],[1,\"\\n    \"]],[],false,[\"category-drop\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      assert.strictEqual(this.subject.rowByIndex(0).value(), this.categories.firstObject.id.toString(), "Shortcuts are not prepended when no category is selected");
    });
    (0, _qunit.test)("shortcuts:category is set", async function (assert) {
      initCategories(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <CategoryDrop
              @category={{this.category}}
              @categories={{this.categories}}
              @parentCategory={{this.parentCategory}}
            />
          
      */
      {
        "id": "6ig0Zi2b",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@category\",\"@categories\",\"@parentCategory\"],[[30,0,[\"category\"]],[30,0,[\"categories\"]],[30,0,[\"parentCategory\"]]]],null],[1,\"\\n    \"]],[],false,[\"category-drop\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      assert.strictEqual(this.subject.rowByIndex(0).value(), _categoryDrop.ALL_CATEGORIES_ID);
    });
    (0, _qunit.test)("shortcuts with parentCategory/subCategory=true:default", async function (assert) {
      initCategoriesWithParentCategory(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <CategoryDrop
              @category={{this.category}}
              @categories={{this.categories}}
              @parentCategory={{this.parentCategory}}
              @options={{hash
                subCategory=true
              }}
            />
          
      */
      {
        "id": "DtfIp3bD",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@category\",\"@categories\",\"@parentCategory\",\"@options\"],[[30,0,[\"category\"]],[30,0,[\"categories\"]],[30,0,[\"parentCategory\"]],[28,[37,1],null,[[\"subCategory\"],[true]]]]],null],[1,\"\\n    \"]],[],false,[\"category-drop\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      assert.strictEqual(this.subject.rowByIndex(0).value(), _categoryDrop.NO_CATEGORIES_ID);
    });
    (0, _qunit.test)("shortcuts with parentCategory/subCategory=true:category is selected", async function (assert) {
      initCategoriesWithParentCategory(this);
      this.set("category", this.categories.firstObject);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <CategoryDrop
              @category={{this.category}}
              @categories={{this.categories}}
              @parentCategory={{this.parentCategory}}
              @options={{hash
                subCategory=true
              }}
            />
          
      */
      {
        "id": "DtfIp3bD",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@category\",\"@categories\",\"@parentCategory\",\"@options\"],[[30,0,[\"category\"]],[30,0,[\"categories\"]],[30,0,[\"parentCategory\"]],[28,[37,1],null,[[\"subCategory\"],[true]]]]],null],[1,\"\\n    \"]],[],false,[\"category-drop\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      assert.strictEqual(this.subject.rowByIndex(0).value(), _categoryDrop.ALL_CATEGORIES_ID);
      assert.strictEqual(this.subject.rowByIndex(1).value(), _categoryDrop.NO_CATEGORIES_ID);
    });
    (0, _qunit.test)("category url", async function (assert) {
      initCategoriesWithParentCategory(this);

      _sinon.default.stub(_url.default, "routeTo");

      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <CategoryDrop
              @category={{this.category}}
              @categories={{this.categories}}
              @parentCategory={{this.parentCategory}}
            />
          
      */
      {
        "id": "6ig0Zi2b",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@category\",\"@categories\",\"@parentCategory\"],[[30,0,[\"category\"]],[30,0,[\"categories\"]],[30,0,[\"parentCategory\"]]]],null],[1,\"\\n    \"]],[],false,[\"category-drop\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      await this.subject.selectRowByValue(26);
      assert.ok(_url.default.routeTo.calledWith("/c/feature/spec/26"), "it builds a correct URL");
    });
  });
});
define("discourse/tests/integration/components/select-kit/combo-box-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/select-kit-helper"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _selectKitHelper) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/select-kit-helper"eaimeta@70e063a35619d71f

  const DEFAULT_CONTENT = [{
    id: 1,
    name: "foo"
  }, {
    id: 2,
    name: "bar"
  }, {
    id: 3,
    name: "baz"
  }];
  const DEFAULT_VALUE = 1;

  const setDefaultState = function (ctx) {
    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    const properties = Object.assign({
      content: DEFAULT_CONTENT,
      value: DEFAULT_VALUE
    }, options);
    ctx.setProperties(properties);
  };

  (0, _qunit.module)("Integration | Component | select-kit/combo-box", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.set("subject", (0, _selectKitHelper.default)());
    });
    (0, _qunit.test)("options.clearable", async function (assert) {
      setDefaultState(this, {
        clearable: true,
        onChange: value => {
          this.set("value", value);
        }
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <ComboBox
              @value={{this.value}}
              @content={{this.content}}
              @onChange={{this.onChange}}
              @options={{hash clearable=this.clearable}}
            />
          
      */
      {
        "id": "yTzkm25l",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@value\",\"@content\",\"@onChange\",\"@options\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],[30,0,[\"onChange\"]],[28,[37,1],null,[[\"clearable\"],[[30,0,[\"clearable\"]]]]]]],null],[1,\"\\n    \"]],[],false,[\"combo-box\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const header = this.subject.header();
      assert.ok(header.el().querySelector(".btn-clear"), "it shows the clear button");
      assert.strictEqual(header.value(), DEFAULT_VALUE.toString());
      await (0, _testHelpers.click)(header.el().querySelector(".btn-clear"));
      assert.notOk(header.el().querySelector(".btn-clear"), "it hides the clear button");
      assert.strictEqual(header.value(), null);
    });
    (0, _qunit.test)("options.{caretUpIcon,caretDownIcon}", async function (assert) {
      setDefaultState(this, {
        caretUpIcon: "pencil-alt",
        caretDownIcon: "trash-alt"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <ComboBox
              @value={{this.value}}
              @content={{this.content}}
              @options={{hash
                caretUpIcon=caretUpIcon
                caretDownIcon=caretDownIcon
              }}
            />
          
      */
      {
        "id": "pXvOveHx",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@value\",\"@content\",\"@options\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],[28,[37,1],null,[[\"caretUpIcon\",\"caretDownIcon\"],[[33,2],[33,3]]]]]],null],[1,\"\\n    \"]],[],false,[\"combo-box\",\"hash\",\"caretUpIcon\",\"caretDownIcon\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const header = this.subject.header().el();
      assert.ok(header.querySelector(`.d-icon-${this.caretDownIcon}`), "it uses the icon provided");
      await this.subject.expand();
      assert.ok(header.querySelector(`.d-icon-${this.caretUpIcon}`), "it uses the icon provided");
    });
  });
});
define("discourse/tests/integration/components/select-kit/dropdown-select-box-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/select-kit-helper"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _selectKitHelper) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/select-kit-helper"eaimeta@70e063a35619d71f

  const DEFAULT_CONTENT = [{
    id: 1,
    name: "foo"
  }, {
    id: 2,
    name: "bar"
  }, {
    id: 3,
    name: "baz"
  }];
  const DEFAULT_VALUE = 1;

  const setDefaultState = (ctx, options) => {
    const properties = Object.assign({
      content: DEFAULT_CONTENT,
      value: DEFAULT_VALUE,
      onChange: value => {
        (void 0).set("value", value);
      }
    }, options || {});
    ctx.setProperties(properties);
  };

  (0, _qunit.module)("Integration | Component | select-kit/dropdown-select-box", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.set("subject", (0, _selectKitHelper.default)());
    });
    (0, _qunit.test)("selection behavior", async function (assert) {
      setDefaultState(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <DropdownSelectBox
                @value={{this.value}}
                @content={{this.content}}
              />
            
      */
      {
        "id": "TD7p/4mG",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@value\",\"@content\"],[[30,0,[\"value\"]],[30,0,[\"content\"]]]],null],[1,\"\\n      \"]],[],false,[\"dropdown-select-box\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      assert.ok(this.subject.isExpanded());
      await this.subject.selectRowByValue(DEFAULT_VALUE);
      assert.notOk(this.subject.isExpanded(), "it collapses the dropdown on select");
    });
    (0, _qunit.test)("options.showFullTitle=false", async function (assert) {
      setDefaultState(this, {
        value: null,
        showFullTitle: false,
        none: "test_none"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <DropdownSelectBox
                @value={{this.value}}
                @content={{this.content}}
                @options={{hash
                  icon="times"
                  showFullTitle=this.showFullTitle
                  none=this.none
                }}
              />
            
      */
      {
        "id": "8YNfP/nM",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@value\",\"@content\",\"@options\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],[28,[37,1],null,[[\"icon\",\"showFullTitle\",\"none\"],[\"times\",[30,0,[\"showFullTitle\"]],[30,0,[\"none\"]]]]]]],null],[1,\"\\n      \"]],[],false,[\"dropdown-select-box\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.notOk(this.subject.header().el().querySelector(".selected-name"), "it hides the text of the selected item");
      assert.strictEqual(this.subject.header().el().getAttribute("title"), "[en.test_none]", "it adds a title attribute to the button");
    });
    (0, _qunit.test)("options.showFullTitle=true", async function (assert) {
      setDefaultState(this, {
        showFullTitle: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <DropdownSelectBox
                @value={{this.value}}
                @content={{this.content}}
                @options={{hash
                  showFullTitle=this.showFullTitle
                }}
              />
            
      */
      {
        "id": "nfPteNvo",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@value\",\"@content\",\"@options\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],[28,[37,1],null,[[\"showFullTitle\"],[[30,0,[\"showFullTitle\"]]]]]]],null],[1,\"\\n      \"]],[],false,[\"dropdown-select-box\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(this.subject.header().el().querySelector(".selected-name"), "it shows the text of the selected item");
    });
  });
});
define("discourse/tests/integration/components/select-kit/email-group-user-chooser-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/select-kit-helper", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _selectKitHelper, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/select-kit-helper",0,"discourse/tests/helpers/qunit-helpers"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | select-kit/email-group-user-chooser", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.set("subject", (0, _selectKitHelper.default)());
    });
    (0, _qunit.test)("pasting", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <EmailGroupUserChooser/>
      */
      {
        "id": "qeNlM1Iq",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"email-group-user-chooser\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      await (0, _qunitHelpers.paste)((0, _qunitHelpers.query)(".filter-input"), "foo,bar");
      assert.equal(this.subject.header().value(), "foo,bar");
    });
  });
});
define("discourse/tests/integration/components/select-kit/future-date-input-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/select-kit-helper", "I18n"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _selectKitHelper, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/select-kit-helper",0,"I18n"eaimeta@70e063a35619d71f

  function getOptions() {
    return Array.from((0, _qunitHelpers.queryAll)(`.select-kit-collection .select-kit-row`).map((_, span) => span.dataset.name));
  }

  (0, _qunit.module)("Integration | Component | select-kit/future-date-input", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.set("subject", (0, _selectKitHelper.default)());
    });
    hooks.afterEach(function () {
      this.clock?.restore();
    });
    (0, _qunit.test)("rendering and expanding", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <FutureDateInput
                @options={{hash
                  none="time_shortcut.select_timeframe"
                }}
              />
            
      */
      {
        "id": "A7jKGTT+",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@options\"],[[28,[37,1],null,[[\"none\"],[\"time_shortcut.select_timeframe\"]]]]],null],[1,\"\\n      \"]],[],false,[\"future-date-input\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".future-date-input-selector"), "Selector is rendered");
      assert.strictEqual(this.subject.header().label(), _I18n.default.t("time_shortcut.select_timeframe"), "Default text is rendered");
      await this.subject.expand();
      assert.ok((0, _qunitHelpers.exists)(".select-kit-collection"), "List of options is rendered");
    });
    (0, _qunit.test)("renders default options", async function (assert) {
      const monday = "2100-12-13T08:00:00";
      this.clock = (0, _qunitHelpers.fakeTime)(monday, this.currentUser.timezone, true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <FutureDateInput />
      */
      {
        "id": "xd70e3/H",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"future-date-input\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      const options = getOptions();
      const expected = [_I18n.default.t("time_shortcut.later_today"), _I18n.default.t("time_shortcut.tomorrow"), _I18n.default.t("time_shortcut.later_this_week"), _I18n.default.t("time_shortcut.start_of_next_business_week_alt"), _I18n.default.t("time_shortcut.two_weeks"), _I18n.default.t("time_shortcut.next_month"), _I18n.default.t("time_shortcut.two_months"), _I18n.default.t("time_shortcut.three_months"), _I18n.default.t("time_shortcut.four_months"), _I18n.default.t("time_shortcut.six_months"), _I18n.default.t("time_shortcut.one_year"), _I18n.default.t("time_shortcut.forever"), _I18n.default.t("time_shortcut.custom")];
      assert.deepEqual(options, expected);
    });
    (0, _qunit.test)("shows 'Custom date and time' by default", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <FutureDateInput />
      */
      {
        "id": "xd70e3/H",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"future-date-input\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      const options = getOptions();

      const customDateAndTime = _I18n.default.t("time_shortcut.custom");

      assert.ok(options.includes(customDateAndTime));
    });
    (0, _qunit.test)("doesn't show 'Custom date and time' if disabled", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <FutureDateInput
                @includeDateTime={{false}}
              />
            
      */
      {
        "id": "wCXS8d2I",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@includeDateTime\"],[false]],null],[1,\"\\n      \"]],[],false,[\"future-date-input\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      const options = getOptions();

      const customDateAndTime = _I18n.default.t("time_shortcut.custom");

      assert.notOk(options.includes(customDateAndTime));
    });
    (0, _qunit.test)("shows the now option if enabled", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <FutureDateInput
                @includeNow={{true}}
              />
            
      */
      {
        "id": "KTFPMgFD",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@includeNow\"],[true]],null],[1,\"\\n      \"]],[],false,[\"future-date-input\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      const options = getOptions();

      const now = _I18n.default.t("time_shortcut.now");

      assert.ok(options.includes(now));
    });
    (0, _qunit.test)("changing date/time updates the input correctly", async function (assert) {
      this.set("input", moment("2032-01-01 11:10"));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <FutureDateInput @input={{this.input}} @onChangeInput={{action (mut input)}} />
      */
      {
        "id": "G8clMwKa",
        "block": "[[[8,[39,0],null,[[\"@input\",\"@onChangeInput\"],[[30,0,[\"input\"]],[28,[37,1],[[30,0],[28,[37,2],[[33,3]],null]],null]]],null]],[],false,[\"future-date-input\",\"action\",\"mut\",\"input\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.fillIn)(".time-input", "11:15");
      assert.ok(this.input.includes("2032-01-01"));
      assert.ok(this.input.includes("11:15"));
      await (0, _testHelpers.fillIn)(".date-picker", "2033-01-01 ");
      assert.ok(this.input.includes("2033-01-01"));
      assert.ok(this.input.includes("11:15"));
    });
  });
});
define("discourse/tests/integration/components/select-kit/list-setting-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/select-kit-helper"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _selectKitHelper) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/select-kit-helper"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | select-kit/list-setting", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.set("subject", (0, _selectKitHelper.default)());
    });
    (0, _qunit.test)("default", async function (assert) {
      this.set("value", ["bold", "italic"]);
      this.set("choices", ["bold", "italic", "underline"]);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <ListSetting
              @value={{this.value}}
              @choices={{this.choices}}
            />
          
      */
      {
        "id": "37SnY2RR",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@value\",\"@choices\"],[[30,0,[\"value\"]],[30,0,[\"choices\"]]]],null],[1,\"\\n    \"]],[],false,[\"list-setting\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().name(), "bold,italic");
      assert.strictEqual(this.subject.header().value(), "bold,italic");
      await this.subject.expand();
      assert.strictEqual(this.subject.rows().length, 1);
      assert.strictEqual(this.subject.rowByIndex(0).value(), "underline");
    });
  });
});
define("discourse/tests/integration/components/select-kit/mini-tag-chooser-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "I18n", "discourse/tests/helpers/select-kit-helper"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _I18n, _selectKitHelper) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"I18n",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/select-kit-helper"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | select-kit/mini-tag-chooser", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.set("subject", (0, _selectKitHelper.default)());
    });
    (0, _qunit.test)("displays tags", async function (assert) {
      this.set("value", ["foo", "bar"]);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MiniTagChooser @value={{this.value}} />
      */
      {
        "id": "aFyhVOHA",
        "block": "[[[8,[39,0],null,[[\"@value\"],[[30,0,[\"value\"]]]],null]],[],false,[\"mini-tag-chooser\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().value(), "foo,bar");
    });
    (0, _qunit.test)("create a tag", async function (assert) {
      this.set("value", ["foo", "bar"]);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MiniTagChooser @value={{this.value}} />
      */
      {
        "id": "aFyhVOHA",
        "block": "[[[8,[39,0],null,[[\"@value\"],[[30,0,[\"value\"]]]],null]],[],false,[\"mini-tag-chooser\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().value(), "foo,bar");
      await this.subject.expand();
      await this.subject.fillInFilter("mon");
      assert.deepEqual([...(0, _qunitHelpers.queryAll)(".select-kit-row")].map(el => el.textContent.trim()), ["monkey x1", "gazelle x2"]);
      await this.subject.fillInFilter("key");
      assert.deepEqual([...(0, _qunitHelpers.queryAll)(".select-kit-row")].map(el => el.textContent.trim()), ["monkey x1", "gazelle x2"]);
      await this.subject.selectRowByValue("monkey");
      assert.strictEqual(this.subject.header().value(), "foo,bar,monkey");
    });
    (0, _qunit.test)("max_tags_per_topic", async function (assert) {
      this.set("value", ["foo", "bar"]);
      this.siteSettings.max_tags_per_topic = 2;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MiniTagChooser @value={{this.value}} />
      */
      {
        "id": "aFyhVOHA",
        "block": "[[[8,[39,0],null,[[\"@value\"],[[30,0,[\"value\"]]]],null]],[],false,[\"mini-tag-chooser\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().value(), "foo,bar");
      await this.subject.expand();
      await this.subject.fillInFilter("baz");
      await this.subject.selectRowByValue("monkey");
      const error = (0, _qunitHelpers.query)(".select-kit-error").innerText;
      assert.strictEqual(error, _I18n.default.t("select_kit.max_content_reached", {
        count: this.siteSettings.max_tags_per_topic
      }));
    });
    (0, _qunit.test)("required_tag_group", async function (assert) {
      this.set("value", ["foo", "bar"]);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MiniTagChooser @value={{this.value}} @options={{hash categoryId=1}} />
      */
      {
        "id": "bSoh0ggH",
        "block": "[[[8,[39,0],null,[[\"@value\",\"@options\"],[[30,0,[\"value\"]],[28,[37,1],null,[[\"categoryId\"],[1]]]]],null]],[],false,[\"mini-tag-chooser\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().value(), "foo,bar");
      await this.subject.expand();
      assert.strictEqual((0, _qunitHelpers.query)("input[name=filter-input-search]").placeholder, _I18n.default.t("tagging.choose_for_topic_required_group", {
        count: 1,
        name: "monkey group"
      }));
      await this.subject.selectRowByValue("monkey");
      assert.strictEqual((0, _qunitHelpers.query)("input[name=filter-input-search]").placeholder, _I18n.default.t("select_kit.filter_placeholder"));
    });
    (0, _qunit.test)("creating a tag using invalid character", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MiniTagChooser @options={{hash allowAny=true}} />
      */
      {
        "id": "q+8fo00B",
        "block": "[[[8,[39,0],null,[[\"@options\"],[[28,[37,1],null,[[\"allowAny\"],[true]]]]],null]],[],false,[\"mini-tag-chooser\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      await this.subject.fillInFilter("#");
      assert.notOk((0, _qunitHelpers.exists)(".select-kit-error"), "it doesnt show any error");
      assert.notOk((0, _qunitHelpers.exists)(".select-kit-row[data-value='#']"), "it doesnt allow to create this tag");
      await this.subject.fillInFilter("test");
      assert.equal(this.subject.filter().value(), "#test");
      assert.ok((0, _qunitHelpers.exists)(".select-kit-row[data-value='test']"), "it filters out the invalid char from the suggested tag");
    });
    (0, _qunit.test)("creating a tag over the length limit", async function (assert) {
      this.siteSettings.max_tag_length = 1;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MiniTagChooser @options={{hash allowAny=true}} />
      */
      {
        "id": "q+8fo00B",
        "block": "[[[8,[39,0],null,[[\"@options\"],[[28,[37,1],null,[[\"allowAny\"],[true]]]]],null]],[],false,[\"mini-tag-chooser\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      await this.subject.fillInFilter("foo");
      assert.ok((0, _qunitHelpers.exists)(".select-kit-row[data-value='f']"), "it forces the max length of the tag");
    });
    (0, _qunit.test)("values in hiddenFromPreview will not display in preview", async function (assert) {
      this.set("value", ["foo", "bar"]);
      this.set("hiddenValues", ["foo"]);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MiniTagChooser @options={{hash allowAny=true hiddenValues=this.hiddenValues}} @value={{this.value}} />
      */
      {
        "id": "vuKOmbaV",
        "block": "[[[8,[39,0],null,[[\"@options\",\"@value\"],[[28,[37,1],null,[[\"allowAny\",\"hiddenValues\"],[true,[30,0,[\"hiddenValues\"]]]]],[30,0,[\"value\"]]]],null]],[],false,[\"mini-tag-chooser\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".formatted-selection").textContent.trim(), "bar");
      await this.subject.expand();
      assert.deepEqual([...(0, _qunitHelpers.queryAll)(".selected-content .selected-choice")].map(el => el.textContent.trim()), ["bar"]);
    });
  });
});
define("discourse/tests/integration/components/select-kit/multi-select-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/select-kit-helper", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _selectKitHelper, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/select-kit-helper",0,"discourse/tests/helpers/qunit-helpers"eaimeta@70e063a35619d71f

  const DEFAULT_CONTENT = [{
    id: 1,
    name: "foo"
  }, {
    id: 2,
    name: "bar"
  }, {
    id: 3,
    name: "baz"
  }];

  const setDefaultState = (ctx, options) => {
    const properties = Object.assign({
      content: DEFAULT_CONTENT,
      value: null
    }, options || {});
    ctx.setProperties(properties);
  };

  (0, _qunit.module)("Integration | Component | select-kit/multi-select", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.set("subject", (0, _selectKitHelper.default)());
    });
    (0, _qunit.test)("content", async function (assert) {
      setDefaultState(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MultiSelect
              @value={{this.value}}
              @content={{this.content}}
            />
          
      */
      {
        "id": "nGdhkHeb",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@value\",\"@content\"],[[30,0,[\"value\"]],[30,0,[\"content\"]]]],null],[1,\"\\n    \"]],[],false,[\"multi-select\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      const content = this.subject.displayedContent();
      assert.strictEqual(content.length, 3, "it shows rows");
      assert.strictEqual(content[0].name, this.content.firstObject.name, "it has the correct name");
      assert.strictEqual(content[0].id, this.content.firstObject.id.toString(), "it has the correct value");
      assert.strictEqual(this.subject.header().value(), null, "it doesn't set a value from the content");
    });
    (0, _qunit.test)("maximum=1", async function (assert) {
      setDefaultState(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MultiSelect
              @value={{this.value}}
              @content={{this.content}}
              @options={{hash maximum=1}}
            />
          
      */
      {
        "id": "3lDSfWmp",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@value\",\"@content\",\"@options\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],[28,[37,1],null,[[\"maximum\"],[1]]]]],null],[1,\"\\n    \"]],[],false,[\"multi-select\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      await this.subject.selectRowByValue(1);
      assert.notOk(this.subject.isExpanded(), "it closes the dropdown");
      await this.subject.expand();
      await this.subject.deselectItemByValue(1);
      assert.ok(this.subject.isExpanded(), "it doesnt close the dropdown when no selection has been made");
    });
    (0, _qunit.test)("maximum=2", async function (assert) {
      setDefaultState(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MultiSelect
              @value={{this.value}}
              @content={{this.content}}
              @options={{hash maximum=2}}
            />
          
      */
      {
        "id": "2+WDRf3V",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@value\",\"@content\",\"@options\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],[28,[37,1],null,[[\"maximum\"],[2]]]]],null],[1,\"\\n    \"]],[],false,[\"multi-select\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      await this.subject.selectRowByValue(1);
      assert.ok(this.subject.isExpanded(), "it doesnt close the dropdown");
    });
    (0, _qunit.test)("pasting", async function (assert) {
      setDefaultState(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MultiSelect
              @value={{this.value}}
              @content={{this.content}}
              @options={{hash maximum=2}}
            />
          
      */
      {
        "id": "2+WDRf3V",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@value\",\"@content\",\"@options\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],[28,[37,1],null,[[\"maximum\"],[2]]]]],null],[1,\"\\n    \"]],[],false,[\"multi-select\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      await (0, _qunitHelpers.paste)((0, _qunitHelpers.query)(".filter-input"), "foo|bar");
      assert.equal(this.subject.header().value(), "1,2");
    });
    (0, _qunit.test)("no value property with no content", async function (assert) {
      setDefaultState(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MultiSelect @valueProperty={{null}} />
          
      */
      {
        "id": "qM0SFpDU",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@valueProperty\"],[null]],null],[1,\"\\n    \"]],[],false,[\"multi-select\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      assert.notOk((0, _qunitHelpers.exists)(".selected-content"), "it doesnt render an empty content div");
    });
  });
});
define("discourse/tests/integration/components/select-kit/notifications-button-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/select-kit-helper"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _selectKitHelper) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/select-kit-helper",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | select-kit/notifications-button", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.set("subject", (0, _selectKitHelper.default)());
    });
    (0, _qunit.test)("default", async function (assert) {
      this.set("value", 1);
      (0, _selectKitHelper.setDefaultState)(this, 1, {
        i18nPrefix: "pre",
        i18nPostfix: "post"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <NotificationsButton
                @value={{this.value}}
                @options={{hash
                  i18nPrefix=this.i18nPrefix
                  i18nPostfix=this.i18nPostfix
                }}
              />
            
      */
      {
        "id": "y2xu3BgX",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@value\",\"@options\"],[[30,0,[\"value\"]],[28,[37,1],null,[[\"i18nPrefix\",\"i18nPostfix\"],[[30,0,[\"i18nPrefix\"]],[30,0,[\"i18nPostfix\"]]]]]]],null],[1,\"\\n      \"]],[],false,[\"notifications-button\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(this.subject.header().value());
      assert.ok(this.subject.header().label().includes(`${this.i18nPrefix}.regular${this.i18nPostfix}`), "it shows the regular choice when value is not set");
      const icon = this.subject.header().icon();
      assert.ok(icon.classList.contains("d-icon-d-regular"), "it shows the correct icon");
    });
  });
});
define("discourse/tests/integration/components/select-kit/pinned-options-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/models/topic", "discourse/tests/helpers/select-kit-helper"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _topic, _selectKitHelper) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/models/topic",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/select-kit-helper"eaimeta@70e063a35619d71f

  const buildTopic = function () {
    let pinned = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;
    return _topic.default.create({
      id: 1234,
      title: "Qunit Test Topic",
      deleted_at: new Date(),
      pinned
    });
  };

  (0, _qunit.module)("Integration | Component | select-kit/pinned-options", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.set("subject", (0, _selectKitHelper.default)());
    });
    (0, _qunit.test)("unpinning", async function (assert) {
      this.siteSettings.automatically_unpin_topics = false;
      this.set("topic", buildTopic());
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <PinnedOptions @value={{this.topic.pinned}} @topic={{this.topic}} />
      */
      {
        "id": "vKhStgdg",
        "block": "[[[8,[39,0],null,[[\"@value\",\"@topic\"],[[30,0,[\"topic\",\"pinned\"]],[30,0,[\"topic\"]]]],null]],[],false,[\"pinned-options\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().name(), "pinned");
      await this.subject.expand();
      await this.subject.selectRowByValue("unpinned");
      assert.strictEqual(this.subject.header().name(), "unpinned");
    });
    (0, _qunit.test)("pinning", async function (assert) {
      this.siteSettings.automatically_unpin_topics = false;
      this.set("topic", buildTopic(false));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <PinnedOptions @value={{this.topic.pinned}} @topic={{this.topic}} />
      */
      {
        "id": "vKhStgdg",
        "block": "[[[8,[39,0],null,[[\"@value\",\"@topic\"],[[30,0,[\"topic\",\"pinned\"]],[30,0,[\"topic\"]]]],null]],[],false,[\"pinned-options\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().name(), "unpinned");
      await this.subject.expand();
      await this.subject.selectRowByValue("pinned");
      assert.strictEqual(this.subject.header().name(), "pinned");
    });
  });
});
define("discourse/tests/integration/components/select-kit/single-select-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "I18n", "discourse/tests/helpers/select-kit-helper"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _I18n, _selectKitHelper) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"I18n",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/select-kit-helper"eaimeta@70e063a35619d71f

  const DEFAULT_CONTENT = [{
    id: 1,
    name: "foo"
  }, {
    id: 2,
    name: "bar"
  }, {
    id: 3,
    name: "baz"
  }];
  const DEFAULT_VALUE = 1;

  const setDefaultState = (ctx, options) => {
    const properties = Object.assign({
      content: DEFAULT_CONTENT,
      value: DEFAULT_VALUE,
      nameProperty: "name",
      valueProperty: "id",
      onChange: value => {
        ctx.set("value", value);
      }
    }, options || {});
    ctx.setProperties(properties);
  };

  (0, _qunit.module)("Integration | Component | select-kit/single-select", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.set("subject", (0, _selectKitHelper.default)());
    });
    (0, _qunit.test)("content", async function (assert) {
      setDefaultState(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SingleSelect @content={{this.content}} />
      */
      {
        "id": "RWeG2POs",
        "block": "[[[8,[39,0],null,[[\"@content\"],[[30,0,[\"content\"]]]],null]],[],false,[\"single-select\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      const content = this.subject.displayedContent();
      assert.strictEqual(content.length, 3, "it shows rows");
      assert.strictEqual(content[0].name, this.content.firstObject.name, "it has the correct name");
      assert.strictEqual(content[0].id, this.content.firstObject.id.toString(), "it has the correct value");
      assert.strictEqual(this.subject.header().value(), null, "it doesn't set a value from the content");
    });
    (0, _qunit.test)("value", async function (assert) {
      setDefaultState(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <SingleSelect
              @value={{this.value}}
              @content={{this.content}}
              @nameProperty={{this.nameProperty}}
              @valueProperty={{this.valueProperty}}
              @onChange={{this.onChange}}
            />
          
      */
      {
        "id": "H6yoBGDS",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@value\",\"@content\",\"@nameProperty\",\"@valueProperty\",\"@onChange\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],[30,0,[\"nameProperty\"]],[30,0,[\"valueProperty\"]],[30,0,[\"onChange\"]]]],null],[1,\"\\n    \"]],[],false,[\"single-select\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().value(this.content), "1", "it selects the correct content to display");
    });
    (0, _qunit.test)("options.filterable", async function (assert) {
      setDefaultState(this, {
        filterable: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <SingleSelect
              @value={{this.value}}
              @content={{this.content}}
              @nameProperty={{this.nameProperty}}
              @valueProperty={{this.valueProperty}}
              @onChange={{this.onChange}}
              @options={{hash
                filterable=this.filterable
              }}
            />
          
      */
      {
        "id": "lCrM4XIc",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@value\",\"@content\",\"@nameProperty\",\"@valueProperty\",\"@onChange\",\"@options\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],[30,0,[\"nameProperty\"]],[30,0,[\"valueProperty\"]],[30,0,[\"onChange\"]],[28,[37,1],null,[[\"filterable\"],[[30,0,[\"filterable\"]]]]]]],null],[1,\"\\n    \"]],[],false,[\"single-select\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      assert.ok(this.subject.filter().exists(), "it shows the filter");
      const filter = this.subject.displayedContent()[1].name;
      await this.subject.fillInFilter(filter);
      assert.strictEqual(this.subject.displayedContent()[0].name, filter, "it filters the list");
    });
    (0, _qunit.test)("options.limitMatches", async function (assert) {
      setDefaultState(this, {
        limitMatches: 1,
        filterable: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <SingleSelect
              @value={{this.value}}
              @content={{this.content}}
              @nameProperty={{this.nameProperty}}
              @valueProperty={{this.valueProperty}}
              @onChange={{this.onChange}}
              @options={{hash
                limitMatches=this.limitMatches
                filterable=this.filterable
              }}
            />
          
      */
      {
        "id": "YJJ3AxmM",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@value\",\"@content\",\"@nameProperty\",\"@valueProperty\",\"@onChange\",\"@options\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],[30,0,[\"nameProperty\"]],[30,0,[\"valueProperty\"]],[30,0,[\"onChange\"]],[28,[37,1],null,[[\"limitMatches\",\"filterable\"],[[30,0,[\"limitMatches\"]],[30,0,[\"filterable\"]]]]]]],null],[1,\"\\n    \"]],[],false,[\"single-select\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      await this.subject.fillInFilter("ba");
      assert.strictEqual(this.subject.displayedContent().length, 1, "it returns only 1 result");
    });
    (0, _qunit.test)("valueAttribute (deprecated)", async function (assert) {
      this.set("value", "normal");
      const content = [{
        name: "Smallest",
        value: "smallest"
      }, {
        name: "Smaller",
        value: "smaller"
      }, {
        name: "Normal",
        value: "normal"
      }, {
        name: "Larger",
        value: "larger"
      }, {
        name: "Largest",
        value: "largest"
      }];
      this.set("content", content);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <SingleSelect
              @value={{this.value}}
              @content={{this.content}}
              @valueAttribute="value"
            />
          
      */
      {
        "id": "uLxfd78P",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@value\",\"@content\",\"@valueAttribute\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],\"value\"]],null],[1,\"\\n    \"]],[],false,[\"single-select\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      assert.strictEqual(this.subject.selectedRow().value(), this.value);
    });
    (0, _qunit.test)("none:string", async function (assert) {
      _I18n.default.translations[_I18n.default.locale].js.test = {
        none: "(default)"
      };
      setDefaultState(this, {
        value: 1
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <SingleSelect
              @value={{this.value}}
              @content={{this.content}}
              @nameProperty={{this.nameProperty}}
              @valueProperty={{this.valueProperty}}
              @onChange={{this.onChange}}
              @options={{hash
                none="test.none"
              }}
            />
          
      */
      {
        "id": "DEq4EuJC",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@value\",\"@content\",\"@nameProperty\",\"@valueProperty\",\"@onChange\",\"@options\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],[30,0,[\"nameProperty\"]],[30,0,[\"valueProperty\"]],[30,0,[\"onChange\"]],[28,[37,1],null,[[\"none\"],[\"test.none\"]]]]],null],[1,\"\\n    \"]],[],false,[\"single-select\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      const noneRow = this.subject.rowByIndex(0);
      assert.strictEqual(noneRow.value(), null);
      assert.strictEqual(noneRow.name(), _I18n.default.t("test.none"));
    });
    (0, _qunit.test)("none:object", async function (assert) {
      setDefaultState(this, {
        none: {
          value: null,
          name: "(default)"
        }
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <SingleSelect
              @value={{this.value}}
              @content={{this.content}}
              @nameProperty={{this.nameProperty}}
              @valueProperty={{this.valueProperty}}
              @onChange={{this.onChange}}
              @options={{hash
                none=this.none
              }}
            />
          
      */
      {
        "id": "xEaZC/2j",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@value\",\"@content\",\"@nameProperty\",\"@valueProperty\",\"@onChange\",\"@options\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],[30,0,[\"nameProperty\"]],[30,0,[\"valueProperty\"]],[30,0,[\"onChange\"]],[28,[37,1],null,[[\"none\"],[[30,0,[\"none\"]]]]]]],null],[1,\"\\n    \"]],[],false,[\"single-select\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      const noneRow = this.subject.rowByIndex(0);
      assert.strictEqual(noneRow.value(), null);
      assert.strictEqual(noneRow.name(), "(default)");
    });
    (0, _qunit.test)("content is a basic array", async function (assert) {
      _I18n.default.translations[_I18n.default.locale].js.test = {
        none: "(default)"
      };
      setDefaultState(this, {
        nameProperty: null,
        valueProperty: null,
        value: "foo",
        content: ["foo", "bar", "baz"]
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <SingleSelect
              @value={{this.value}}
              @content={{this.content}}
              @nameProperty={{this.nameProperty}}
              @valueProperty={{this.valueProperty}}
              @onChange={{this.onChange}}
              @options={{hash
                none="test.none"
              }}
            />
          
      */
      {
        "id": "DEq4EuJC",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@value\",\"@content\",\"@nameProperty\",\"@valueProperty\",\"@onChange\",\"@options\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],[30,0,[\"nameProperty\"]],[30,0,[\"valueProperty\"]],[30,0,[\"onChange\"]],[28,[37,1],null,[[\"none\"],[\"test.none\"]]]]],null],[1,\"\\n    \"]],[],false,[\"single-select\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      const noneRow = this.subject.rowByIndex(0);
      assert.strictEqual(noneRow.value(), _I18n.default.t("test.none"));
      assert.strictEqual(noneRow.name(), _I18n.default.t("test.none"));
      assert.strictEqual(this.value, "foo");
      await this.subject.selectRowByIndex(0);
      assert.strictEqual(this.value, null);
    });
    (0, _qunit.test)("selected value can be 0", async function (assert) {
      setDefaultState(this, {
        value: 1,
        content: [{
          id: 0,
          name: "foo"
        }, {
          id: 1,
          name: "bar"
        }]
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <SingleSelect
              @value={{this.value}}
              @content={{this.content}}
              @nameProperty={{this.nameProperty}}
              @valueProperty={{this.valueProperty}}
              @onChange={{this.onChange}}
            />
          
      */
      {
        "id": "H6yoBGDS",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@value\",\"@content\",\"@nameProperty\",\"@valueProperty\",\"@onChange\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],[30,0,[\"nameProperty\"]],[30,0,[\"valueProperty\"]],[30,0,[\"onChange\"]]]],null],[1,\"\\n    \"]],[],false,[\"single-select\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().value(), "1");
      await this.subject.expand();
      await this.subject.selectRowByValue(0);
      assert.strictEqual(this.subject.header().value(), "0");
    });
    (0, _qunit.test)("prevents propagating click event on header", async function (assert) {
      this.setProperties({
        onClick: () => this.set("value", "foo"),
        content: DEFAULT_CONTENT,
        value: DEFAULT_VALUE
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <DButton @icon="times" @action={{this.onClick}}>
              <SingleSelect
                @value={{this.value}}
                @content={{this.content}}
                @options={{hash preventsClickPropagation=true}}
              />
            </DButton>
          
      */
      {
        "id": "oz7dkXvO",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@icon\",\"@action\"],[\"times\",[30,0,[\"onClick\"]]]],[[\"default\"],[[[[1,\"\\n        \"],[8,[39,1],null,[[\"@value\",\"@content\",\"@options\"],[[30,0,[\"value\"]],[30,0,[\"content\"]],[28,[37,2],null,[[\"preventsClickPropagation\"],[true]]]]],null],[1,\"\\n      \"]],[]]]]],[1,\"\\n    \"]],[],false,[\"d-button\",\"single-select\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.value, DEFAULT_VALUE);
      await this.subject.expand();
      assert.strictEqual(this.value, DEFAULT_VALUE);
    });
    (0, _qunit.test)("labelProperty", async function (assert) {
      this.setProperties({
        content: [{
          id: 1,
          name: "john",
          foo: "JACKSON"
        }],
        value: 1
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <SingleSelect
              @labelProperty="foo"
              @value={{this.value}}
              @content={{this.content}}
            />
          
      */
      {
        "id": "hY3y5wba",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@labelProperty\",\"@value\",\"@content\"],[\"foo\",[30,0,[\"value\"]],[30,0,[\"content\"]]]],null],[1,\"\\n    \"]],[],false,[\"single-select\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().label(), "JACKSON");
      await this.subject.expand();
      const row = this.subject.rowByValue(1);
      assert.strictEqual(row.label(), "JACKSON");
    });
    (0, _qunit.test)("titleProperty", async function (assert) {
      this.setProperties({
        content: [{
          id: 1,
          name: "john",
          foo: "JACKSON"
        }],
        value: 1
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <SingleSelect
              @titleProperty="foo"
              @value={{this.value}}
              @content={{this.content}}
            />
          
      */
      {
        "id": "wCvaEJPa",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@titleProperty\",\"@value\",\"@content\"],[\"foo\",[30,0,[\"value\"]],[30,0,[\"content\"]]]],null],[1,\"\\n    \"]],[],false,[\"single-select\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().title(), "JACKSON");
      await this.subject.expand();
      const row = this.subject.rowByValue(1);
      assert.strictEqual(row.title(), "JACKSON");
    });
    (0, _qunit.test)("langProperty", async function (assert) {
      this.setProperties({
        content: [{
          id: 1,
          name: "john",
          foo: "be"
        }],
        value: null
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SingleSelect @langProperty="foo" @value={{this.value}} @content={{this.content}} />
      */
      {
        "id": "aL4VxNa7",
        "block": "[[[8,[39,0],null,[[\"@langProperty\",\"@value\",\"@content\"],[\"foo\",[30,0,[\"value\"]],[30,0,[\"content\"]]]],null]],[],false,[\"single-select\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().el().querySelector(".selected-name").lang, "");
      await this.subject.expand();
      const row = this.subject.rowByValue(1);
      assert.strictEqual(row.el().lang, "be");
      await this.subject.selectRowByValue(1);
      assert.strictEqual(this.subject.header().el().querySelector(".selected-name").lang, "be");
    });
    (0, _qunit.test)("name", async function (assert) {
      this.setProperties({
        content: [{
          id: 1,
          name: "john"
        }],
        value: null
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SingleSelect @value={{this.value}} @content={{this.content}} />
      */
      {
        "id": "H9Jc7hWj",
        "block": "[[[8,[39,0],null,[[\"@value\",\"@content\"],[[30,0,[\"value\"]],[30,0,[\"content\"]]]],null]],[],false,[\"single-select\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().el().getAttribute("name"), _I18n.default.t("select_kit.select_to_filter"));
      await this.subject.expand();
      await this.subject.selectRowByValue(1);
      assert.strictEqual(this.subject.header().el().getAttribute("name"), _I18n.default.t("select_kit.filter_by", {
        name: this.content.firstObject.name
      }));
    });
  });
});
define("discourse/tests/integration/components/select-kit/tag-drop-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "I18n", "discourse/tests/helpers/create-pretender", "discourse/tests/helpers/select-kit-helper"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _I18n, _createPretender, _selectKitHelper) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"I18n",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/create-pretender",0,"discourse/tests/helpers/select-kit-helper"eaimeta@70e063a35619d71f

  function initTags(context) {
    const categories = context.site.categoriesList;
    const category = categories.findBy("id", 2); // top_tags

    context.setProperties({
      currentCategory: category,
      tagId: "jeff"
    });
  }

  (0, _qunit.module)("Integration | Component | select-kit/tag-drop", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.set("subject", (0, _selectKitHelper.default)());
      this.site.set("top_tags", ["jeff", "neil", "arpit", "rgis"]);

      _createPretender.default.get("/tags/filter/search", params => {
        if (params.queryParams.q === "dav") {
          return (0, _createPretender.response)({
            results: [{
              id: "David",
              name: "David",
              count: 2,
              pm_count: 0
            }]
          });
        }
      });
    });
    (0, _qunit.test)("default", async function (assert) {
      initTags(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <TagDrop
              @currentCategory={{this.currentCategory}}
              @tagId={{this.tagId}}
              @options={{hash
                tagId=this.tagId
              }}
            />
          
      */
      {
        "id": "2HvI7A1H",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@currentCategory\",\"@tagId\",\"@options\"],[[30,0,[\"currentCategory\"]],[30,0,[\"tagId\"]],[28,[37,1],null,[[\"tagId\"],[[30,0,[\"tagId\"]]]]]]],null],[1,\"\\n    \"]],[],false,[\"tag-drop\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      const content = this.subject.displayedContent();
      assert.strictEqual(content[0].name, _I18n.default.t("tagging.selector_no_tags"), "it has the translated label for no-tags");
      assert.strictEqual(content[1].name, _I18n.default.t("tagging.selector_all_tags"), "it has the correct label for all-tags");
      await this.subject.fillInFilter("dav");
      assert.strictEqual(this.subject.rows()[0].textContent.trim(), "David", "it has no tag count when filtering in a category context");
    });
    (0, _qunit.test)("default global (no category)", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TagDrop />
      */
      {
        "id": "vZA5+JXm",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"tag-drop\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      await this.subject.fillInFilter("dav");
      assert.strictEqual(this.subject.rows()[0].textContent.trim(), "David x2", "it has the tag count");
    });
  });
});
define("discourse/tests/integration/components/select-kit/topic-notifications-button-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "I18n", "discourse/models/topic", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/select-kit-helper"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _I18n, _topic, _qunitHelpers, _selectKitHelper) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"I18n",0,"discourse/models/topic",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/select-kit-helper"eaimeta@70e063a35619d71f

  const buildTopic = function (opts) {
    return _topic.default.create({
      id: 4563
    }).updateFromJson({
      title: "Qunit Test Topic",
      details: {
        notification_level: opts.level,
        notifications_reason_id: opts.reason || null
      },
      archetype: opts.archetype || "regular",
      category_id: opts.category_id || null,
      tags: opts.tags || []
    });
  };

  const originalTranslation = _I18n.default.translations.en.js.topic.notifications.tracking_pm.title;
  (0, _qunit.module)("Integration | Component | select-kit/topic-notifications-button", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.afterEach(function () {
      _I18n.default.translations.en.js.topic.notifications.tracking_pm.title = originalTranslation;
    });
    (0, _qunit.test)("the header has a localized title", async function (assert) {
      this.set("topic", buildTopic({
        level: 1
      }));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <TopicNotificationsButton
                @notificationLevel={{this.topic.details.notification_level}}
                @topic={{this.topic}}
              />
            
      */
      {
        "id": "jrT6pjm+",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@notificationLevel\",\"@topic\"],[[30,0,[\"topic\",\"details\",\"notification_level\"]],[30,0,[\"topic\"]]]],null],[1,\"\\n      \"]],[],false,[\"topic-notifications-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _selectKitHelper.default)().header().label(), "Normal", "it has the correct label");
      this.set("topic", buildTopic({
        level: 2
      }));
      assert.strictEqual((0, _selectKitHelper.default)().header().label(), "Tracking", "it correctly changes the label");
    });
    (0, _qunit.test)("the header has a localized title", async function (assert) {
      _I18n.default.translations.en.js.topic.notifications.tracking_pm.title = `${originalTranslation} PM`;
      this.set("topic", buildTopic({
        level: 2,
        archetype: "private_message"
      }));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <TopicNotificationsButton
                @notificationLevel={{this.topic.details.notification_level}}
                @topic={{this.topic}}
              />
            
      */
      {
        "id": "jrT6pjm+",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@notificationLevel\",\"@topic\"],[[30,0,[\"topic\",\"details\",\"notification_level\"]],[30,0,[\"topic\"]]]],null],[1,\"\\n      \"]],[],false,[\"topic-notifications-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _selectKitHelper.default)().header().label(), `${originalTranslation} PM`, "it has the correct label for PMs");
    });
    (0, _qunit.test)("notification reason text - user mailing list mode", async function (assert) {
      this.currentUser.set("mailing_list_mode", true);
      this.set("topic", buildTopic({
        level: 2
      }));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <TopicNotificationsButton
                @notificationLevel={{this.topic.details.notification_level}}
                @topic={{this.topic}}
              />
            
      */
      {
        "id": "jrT6pjm+",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@notificationLevel\",\"@topic\"],[[30,0,[\"topic\",\"details\",\"notification_level\"]],[30,0,[\"topic\"]]]],null],[1,\"\\n      \"]],[],false,[\"topic-notifications-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".topic-notifications-button .text").innerText, _I18n.default.t("topic.notifications.reasons.mailing_list_mode"), "mailing_list_mode enabled for the user shows unique text");
    });
    (0, _qunit.test)("notification reason text - bad notification reason", async function (assert) {
      this.set("topic", buildTopic({
        level: 2
      }));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <TopicNotificationsButton
                @notificationLevel={{this.topic.details.notification_level}}
                @topic={{this.topic}}
              />
            
      */
      {
        "id": "jrT6pjm+",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@notificationLevel\",\"@topic\"],[[30,0,[\"topic\",\"details\",\"notification_level\"]],[30,0,[\"topic\"]]]],null],[1,\"\\n      \"]],[],false,[\"topic-notifications-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      this.set("topic", buildTopic({
        level: 3,
        reason: 999
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".topic-notifications-button .text").innerText, _I18n.default.t("topic.notifications.reasons.3"), "fallback to regular level translation if reason does not exist");
    });
    (0, _qunit.test)("notification reason text - user tracking category", async function (assert) {
      this.currentUser.set("tracked_category_ids", [88]);
      this.set("topic", buildTopic({
        level: 2,
        reason: 8,
        category_id: 88
      }));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <TopicNotificationsButton
                @notificationLevel={{this.topic.details.notification_level}}
                @topic={{this.topic}}
              />
            
      */
      {
        "id": "jrT6pjm+",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@notificationLevel\",\"@topic\"],[[30,0,[\"topic\",\"details\",\"notification_level\"]],[30,0,[\"topic\"]]]],null],[1,\"\\n      \"]],[],false,[\"topic-notifications-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".topic-notifications-button .text").innerText, _I18n.default.t("topic.notifications.reasons.2_8"), "use 2_8 notification if user is still tracking category");
    });
    (0, _qunit.test)("notification reason text - user no longer tracking category", async function (assert) {
      this.currentUser.set("tracked_category_ids", []);
      this.set("topic", buildTopic({
        level: 2,
        reason: 8,
        category_id: 88
      }));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <TopicNotificationsButton
                @notificationLevel={{this.topic.details.notification_level}}
                @topic={{this.topic}}
              />
            
      */
      {
        "id": "jrT6pjm+",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@notificationLevel\",\"@topic\"],[[30,0,[\"topic\",\"details\",\"notification_level\"]],[30,0,[\"topic\"]]]],null],[1,\"\\n      \"]],[],false,[\"topic-notifications-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".topic-notifications-button .text").innerText, _I18n.default.t("topic.notifications.reasons.2_8_stale"), "use _stale notification if user is no longer tracking category");
    });
    (0, _qunit.test)("notification reason text - user watching category", async function (assert) {
      this.currentUser.set("watched_category_ids", [88]);
      this.set("topic", buildTopic({
        level: 3,
        reason: 6,
        category_id: 88
      }));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <TopicNotificationsButton
                @notificationLevel={{this.topic.details.notification_level}}
                @topic={{this.topic}}
              />
            
      */
      {
        "id": "jrT6pjm+",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@notificationLevel\",\"@topic\"],[[30,0,[\"topic\",\"details\",\"notification_level\"]],[30,0,[\"topic\"]]]],null],[1,\"\\n      \"]],[],false,[\"topic-notifications-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".topic-notifications-button .text").innerText, _I18n.default.t("topic.notifications.reasons.3_6"), "use 3_6 notification if user is still watching category");
    });
    (0, _qunit.test)("notification reason text - user no longer watching category", async function (assert) {
      this.currentUser.set("watched_category_ids", []);
      this.set("topic", buildTopic({
        level: 3,
        reason: 6,
        category_id: 88
      }));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <TopicNotificationsButton
                @notificationLevel={{this.topic.details.notification_level}}
                @topic={{this.topic}}
              />
            
      */
      {
        "id": "jrT6pjm+",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@notificationLevel\",\"@topic\"],[[30,0,[\"topic\",\"details\",\"notification_level\"]],[30,0,[\"topic\"]]]],null],[1,\"\\n      \"]],[],false,[\"topic-notifications-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".topic-notifications-button .text").innerText, _I18n.default.t("topic.notifications.reasons.3_6_stale"), "use _stale notification if user is no longer watching category");
    });
    (0, _qunit.test)("notification reason text - user watching tag", async function (assert) {
      this.currentUser.set("watched_tags", ["test"]);
      this.set("topic", buildTopic({
        level: 3,
        reason: 10,
        tags: ["test"]
      }));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <TopicNotificationsButton
                @notificationLevel={{this.topic.details.notification_level}}
                @topic={{this.topic}}
              />
            
      */
      {
        "id": "jrT6pjm+",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@notificationLevel\",\"@topic\"],[[30,0,[\"topic\",\"details\",\"notification_level\"]],[30,0,[\"topic\"]]]],null],[1,\"\\n      \"]],[],false,[\"topic-notifications-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".topic-notifications-button .text").innerText, _I18n.default.t("topic.notifications.reasons.3_10"), "use 3_10 notification if user is still watching tag");
    });
    (0, _qunit.test)("notification reason text - user no longer watching tag", async function (assert) {
      this.currentUser.set("watched_tags", []);
      this.set("topic", buildTopic({
        level: 3,
        reason: 10,
        tags: ["test"]
      }));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <TopicNotificationsButton
                @notificationLevel={{this.topic.details.notification_level}}
                @topic={{this.topic}}
              />
            
      */
      {
        "id": "jrT6pjm+",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@notificationLevel\",\"@topic\"],[[30,0,[\"topic\",\"details\",\"notification_level\"]],[30,0,[\"topic\"]]]],null],[1,\"\\n      \"]],[],false,[\"topic-notifications-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".topic-notifications-button .text").innerText, _I18n.default.t("topic.notifications.reasons.3_10_stale"), "use _stale notification if user is no longer watching tag");
    });
  });
});
define("discourse/tests/integration/components/select-kit/topic-notifications-options-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "I18n", "discourse/models/topic", "discourse/tests/helpers/select-kit-helper"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _I18n, _topic, _selectKitHelper) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"I18n",0,"discourse/models/topic",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/select-kit-helper"eaimeta@70e063a35619d71f

  const buildTopic = function (archetype) {
    return _topic.default.create({
      id: 4563
    }).updateFromJson({
      title: "Qunit Test Topic",
      details: {
        notification_level: 1
      },
      archetype
    });
  };

  function extractDescriptions(rows) {
    return [...rows].map(el => el.querySelector(".desc").textContent.trim());
  }

  function getTranslations() {
    let type = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "";
    return ["watching", "tracking", "regular", "muted"].map(key => {
      return _I18n.default.t(`topic.notifications.${key}${type}.description`);
    });
  }

  (0, _qunit.module)("Integration | Component | select-kit/topic-notifications-options", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("regular topic notification level descriptions", async function (assert) {
      this.set("topic", buildTopic("regular"));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <TopicNotificationsOptions
                @value={{this.topic.details.notification_level}}
                @topic={{this.topic}}
              />
            
      */
      {
        "id": "3gHHhhcN",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@value\",\"@topic\"],[[30,0,[\"topic\",\"details\",\"notification_level\"]],[30,0,[\"topic\"]]]],null],[1,\"\\n      \"]],[],false,[\"topic-notifications-options\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _selectKitHelper.default)().expand();
      const uiTexts = extractDescriptions((0, _selectKitHelper.default)().rows());
      const descriptions = getTranslations();
      assert.strictEqual(uiTexts.length, descriptions.length, "it has the correct copy");
      uiTexts.forEach((text, index) => {
        assert.strictEqual(text.trim(), descriptions[index].trim(), "it has the correct copy");
      });
    });
    (0, _qunit.test)("PM topic notification level descriptions", async function (assert) {
      this.set("topic", buildTopic("private_message"));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <TopicNotificationsOptions
                @value={{this.topic.details.notification_level}}
                @topic={{this.topic}}
              />
            
      */
      {
        "id": "3gHHhhcN",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@value\",\"@topic\"],[[30,0,[\"topic\",\"details\",\"notification_level\"]],[30,0,[\"topic\"]]]],null],[1,\"\\n      \"]],[],false,[\"topic-notifications-options\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _selectKitHelper.default)().expand();
      const uiTexts = extractDescriptions((0, _selectKitHelper.default)().rows());
      const descriptions = getTranslations("_pm");
      assert.strictEqual(uiTexts.length, descriptions.length, "it has the correct copy");
      uiTexts.forEach((text, index) => {
        assert.strictEqual(text.trim(), descriptions[index].trim(), "it has the correct copy");
      });
    });
  });
});
define("discourse/tests/integration/components/select-kit/user-chooser-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/select-kit-helper"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _selectKitHelper) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/select-kit-helper"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | select-kit/user-chooser", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.set("subject", (0, _selectKitHelper.default)());
    });
    (0, _qunit.test)("displays usernames", async function (assert) {
      this.set("value", ["bob", "martin"]);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserChooser @value={{this.value}} />
      */
      {
        "id": "aSChnMGA",
        "block": "[[[8,[39,0],null,[[\"@value\"],[[30,0,[\"value\"]]]],null]],[],false,[\"user-chooser\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().name(), "bob,martin");
    });
    (0, _qunit.test)("can remove a username", async function (assert) {
      this.set("value", ["bob", "martin"]);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserChooser @value={{this.value}} />
      */
      {
        "id": "aSChnMGA",
        "block": "[[[8,[39,0],null,[[\"@value\"],[[30,0,[\"value\"]]]],null]],[],false,[\"user-chooser\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      await this.subject.deselectItemByValue("bob");
      assert.strictEqual(this.subject.header().name(), "martin");
    });
  });
});
define("discourse/tests/integration/components/sidebar/section-link-test", ["@ember/template-factory", "qunit", "@ember/test-helpers", "discourse/tests/helpers/component-test", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _testHelpers, _componentTest, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"ember-cli-htmlbars",0,"@ember/test-helpers",0,"discourse/tests/helpers/component-test",0,"discourse/tests/helpers/qunit-helpers"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | sidebar | section-link", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("default class attribute for link", async function (assert) {
      const template = (0, _templateFactory.createTemplateFactory)(
      /*
        <Sidebar::SectionLink @linkName="test" @route="discovery.latest" />
      */
      {
        "id": "dKUq2gEE",
        "block": "[[[8,[39,0],null,[[\"@linkName\",\"@route\"],[\"test\",\"discovery.latest\"]],null]],[],false,[\"sidebar/section-link\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      });
      await (0, _testHelpers.render)(template);
      assert.strictEqual((0, _qunitHelpers.query)("a").className, "sidebar-section-link sidebar-section-link-test sidebar-row ember-view", "has the right class attribute for the link");
    });
    (0, _qunit.test)("custom class attribute for link", async function (assert) {
      const template = (0, _templateFactory.createTemplateFactory)(
      /*
        <Sidebar::SectionLink @linkName="test" @route="discovery.latest" @class="123 abc" />
      */
      {
        "id": "lzMUFzVT",
        "block": "[[[8,[39,0],null,[[\"@linkName\",\"@route\",\"@class\"],[\"test\",\"discovery.latest\",\"123 abc\"]],null]],[],false,[\"sidebar/section-link\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      });
      await (0, _testHelpers.render)(template);
      assert.strictEqual((0, _qunitHelpers.query)("a").className, "sidebar-section-link sidebar-section-link-test sidebar-row 123 abc ember-view", "has the right class attribute for the link");
    });
  });
});
define("discourse/tests/integration/components/simple-list-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | simple-list", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("adding a value", async function (assert) {
      this.set("values", "vinkas\nosama");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SimpleList @values={{this.values}} />
      */
      {
        "id": "DV/kKpDd",
        "block": "[[[8,[39,0],null,[[\"@values\"],[[30,0,[\"values\"]]]],null]],[],false,[\"simple-list\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".add-value-btn[disabled]"), "while loading the + button is disabled");
      await (0, _testHelpers.fillIn)(".add-value-input", "penar");
      await (0, _testHelpers.click)(".add-value-btn");
      assert.strictEqual((0, _qunitHelpers.count)(".values .value"), 3, "it adds the value to the list of values");
      assert.strictEqual((0, _qunitHelpers.query)(".values .value[data-index='2'] .value-input").value, "penar", "it sets the correct value for added item");
      await (0, _testHelpers.fillIn)(".add-value-input", "eviltrout");
      await (0, _testHelpers.triggerKeyEvent)(".add-value-input", "keydown", "Enter");
      assert.strictEqual((0, _qunitHelpers.count)(".values .value"), 4, "it adds the value when keying Enter");
    });
    (0, _qunit.test)("changing a value", async function (assert) {
      const done = assert.async();
      this.set("values", "vinkas\nosama");
      this.set("onChange", function (collection) {
        assert.deepEqual(collection, ["vinkas", "jarek"]);
        done();
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SimpleList @values={{this.values}} @onChange={{this.onChange}} />
      */
      {
        "id": "xkiPKCNi",
        "block": "[[[8,[39,0],null,[[\"@values\",\"@onChange\"],[[30,0,[\"values\"]],[30,0,[\"onChange\"]]]],null]],[],false,[\"simple-list\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.fillIn)(".values .value[data-index='1'] .value-input", "jarek");
      await (0, _testHelpers.blur)(".values .value[data-index='1'] .value-input");
      assert.strictEqual((0, _qunitHelpers.query)(".values .value[data-index='1'] .value-input").value, "jarek");
    });
    (0, _qunit.test)("removing a value", async function (assert) {
      this.set("values", "vinkas\nosama");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SimpleList @values={{this.values}} />
      */
      {
        "id": "DV/kKpDd",
        "block": "[[[8,[39,0],null,[[\"@values\"],[[30,0,[\"values\"]]]],null]],[],false,[\"simple-list\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".values .value[data-index='0'] .remove-value-btn");
      assert.strictEqual((0, _qunitHelpers.count)(".values .value"), 1, "it removes the value from the list of values");
      assert.strictEqual((0, _qunitHelpers.query)(".values .value[data-index='0'] .value-input").value, "osama", "it removes the correct value");
    });
    (0, _qunit.test)("delimiter support", async function (assert) {
      this.set("values", "vinkas|osama");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SimpleList @values={{this.values}} @inputDelimiter="|" />
      */
      {
        "id": "3pPle8Um",
        "block": "[[[8,[39,0],null,[[\"@values\",\"@inputDelimiter\"],[[30,0,[\"values\"]],\"|\"]],null]],[],false,[\"simple-list\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.fillIn)(".add-value-input", "eviltrout");
      await (0, _testHelpers.click)(".add-value-btn");
      assert.strictEqual((0, _qunitHelpers.count)(".values .value"), 3, "it adds the value to the list of values");
      assert.strictEqual((0, _qunitHelpers.query)(".values .value[data-index='2'] .value-input").value, "eviltrout", "it adds the correct value");
    });
  });
});
define("discourse/tests/integration/components/site-header-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/create-pretender"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _createPretender) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/tests/helpers/create-pretender",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | site-header", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.currentUser.set("unread_high_priority_notifications", 1);
      this.currentUser.set("read_first_notification", false);
    });
    (0, _qunit.test)("first notification mask", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SiteHeader />
      */
      {
        "id": "vy0bBJ2x",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"site-header\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".ring-backdrop"), 1, "there is the first notification mask"); // Click anywhere

      await (0, _testHelpers.click)("header.d-header");
      assert.ok(!(0, _qunitHelpers.exists)(".ring-backdrop"), "it hides the first notification mask");
    });
    (0, _qunit.test)("do not call authenticated endpoints as anonymous", async function (assert) {
      this.owner.unregister("service:current-user");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SiteHeader />
      */
      {
        "id": "vy0bBJ2x",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"site-header\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".ring-backdrop"), "there is no first notification mask for anonymous users");

      _createPretender.default.get("/notifications", () => {
        assert.ok(false, "it should not try to refresh notifications");
        return (0, _createPretender.response)(403, {});
      }); // Click anywhere


      await (0, _testHelpers.click)("header.d-header");
    });
    (0, _qunit.test)("displaying unread and reviewable notifications count when user's notifications and reviewables count are updated", async function (assert) {
      this.currentUser.set("all_unread_notifications_count", 1);
      this.currentUser.set("redesigned_user_menu_enabled", true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SiteHeader />
      */
      {
        "id": "vy0bBJ2x",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"site-header\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      let unreadBadge = (0, _qunitHelpers.query)(".header-dropdown-toggle.current-user .unread-notifications");
      assert.strictEqual(unreadBadge.textContent, "1");
      this.currentUser.set("all_unread_notifications_count", 5);
      await (0, _testHelpers.settled)();
      unreadBadge = (0, _qunitHelpers.query)(".header-dropdown-toggle.current-user .unread-notifications");
      assert.strictEqual(unreadBadge.textContent, "5");
      this.currentUser.set("unseen_reviewable_count", 3);
      await (0, _testHelpers.settled)();
      unreadBadge = (0, _qunitHelpers.query)(".header-dropdown-toggle.current-user .unread-notifications");
      assert.strictEqual(unreadBadge.textContent, "8");
    });
    (0, _qunit.test)("user avatar is highlighted when the user receives the first notification", async function (assert) {
      this.currentUser.set("all_unread_notifications_count", 1);
      this.currentUser.set("redesigned_user_menu_enabled", true);
      this.currentUser.set("read_first_notification", false);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SiteHeader />
      */
      {
        "id": "vy0bBJ2x",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"site-header\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".ring-first-notification"));
    });
    (0, _qunit.test)("user avatar is not highlighted when the user receives notifications beyond the first one", async function (assert) {
      this.currentUser.set("redesigned_user_menu_enabled", true);
      this.currentUser.set("all_unread_notifications_count", 1);
      this.currentUser.set("read_first_notification", true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SiteHeader />
      */
      {
        "id": "vy0bBJ2x",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"site-header\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".ring-first-notification"));
    });
    (0, _qunit.test)("hamburger menu icon shows pending reviewables count", async function (assert) {
      this.currentUser.set("reviewable_count", 1);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SiteHeader />
      */
      {
        "id": "vy0bBJ2x",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"site-header\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      let pendingReviewablesBadge = (0, _qunitHelpers.query)(".hamburger-dropdown .badge-notification");
      assert.strictEqual(pendingReviewablesBadge.textContent, "1");
    });
    (0, _qunit.test)("hamburger menu icon doesn't show pending reviewables count when revamped user menu is enabled", async function (assert) {
      this.currentUser.set("reviewable_count", 1);
      this.currentUser.set("redesigned_user_menu_enabled", true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SiteHeader />
      */
      {
        "id": "vy0bBJ2x",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"site-header\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".hamburger-dropdown .badge-notification"));
    });
    (0, _qunit.test)("clicking outside the revamped menu closes it", async function (assert) {
      this.currentUser.set("redesigned_user_menu_enabled", true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SiteHeader />
      */
      {
        "id": "vy0bBJ2x",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"site-header\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".header-dropdown-toggle.current-user");
      assert.ok((0, _qunitHelpers.exists)(".user-menu.revamped"));
      await (0, _testHelpers.click)("header.d-header");
      assert.ok(!(0, _qunitHelpers.exists)(".user-menu.revamped"));
    });
    (0, _qunit.test)("header's height is setting css property", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SiteHeader />
      */
      {
        "id": "vy0bBJ2x",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"site-header\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));

      function getProperty() {
        return getComputedStyle(document.body).getPropertyValue("--header-offset");
      }

      document.querySelector(".d-header").style.height = 90 + "px";
      await (0, _testHelpers.waitUntil)(() => getProperty() === "90px", {
        timeout: 100
      });
      assert.strictEqual(getProperty(), "90px");
      document.querySelector(".d-header").style.height = 60 + "px";
      await (0, _testHelpers.waitUntil)(() => getProperty() === "60px", {
        timeout: 100
      });
      assert.strictEqual(getProperty(), "60px");
    });
    (0, _qunit.test)("arrow up/down keys move focus between the tabs", async function (assert) {
      this.currentUser.set("redesigned_user_menu_enabled", true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SiteHeader />
      */
      {
        "id": "vy0bBJ2x",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"site-header\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".header-dropdown-toggle.current-user");
      let activeTab = (0, _qunitHelpers.query)(".menu-tabs-container .btn.active");
      assert.strictEqual(activeTab.id, "user-menu-button-all-notifications");
      await (0, _testHelpers.triggerKeyEvent)(document, "keydown", "ArrowDown");
      let focusedTab = document.activeElement;
      assert.strictEqual(focusedTab.id, "user-menu-button-replies", "pressing the down arrow key moves focus to the next tab towards the bottom");
      await (0, _testHelpers.triggerKeyEvent)(document, "keydown", "ArrowDown");
      await (0, _testHelpers.triggerKeyEvent)(document, "keydown", "ArrowDown");
      await (0, _testHelpers.triggerKeyEvent)(document, "keydown", "ArrowDown");
      await (0, _testHelpers.triggerKeyEvent)(document, "keydown", "ArrowDown");
      await (0, _testHelpers.triggerKeyEvent)(document, "keydown", "ArrowDown");
      await (0, _testHelpers.triggerKeyEvent)(document, "keydown", "ArrowDown");
      focusedTab = document.activeElement;
      assert.strictEqual(focusedTab.id, "user-menu-button-profile", "the down arrow key can move the focus to the bottom tabs");
      await (0, _testHelpers.triggerKeyEvent)(document, "keydown", "ArrowDown");
      focusedTab = document.activeElement;
      assert.strictEqual(focusedTab.id, "user-menu-button-all-notifications", "the focus moves back to the top after reaching the bottom");
      await (0, _testHelpers.triggerKeyEvent)(document, "keydown", "ArrowUp");
      focusedTab = document.activeElement;
      assert.strictEqual(focusedTab.id, "user-menu-button-profile", "the up arrow key moves the focus in the opposite direction");
    });
  });
});
define("discourse/tests/integration/components/site-setting-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | site-setting", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("displays host-list setting value", async function (assert) {
      this.set("setting", {
        setting: "blocked_onebox_domains",
        value: "a.com|b.com",
        type: "host_list"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SiteSetting @setting={{this.setting}} />
      */
      {
        "id": "cpfqOO/4",
        "block": "[[[8,[39,0],null,[[\"@setting\"],[[30,0,[\"setting\"]]]],null]],[],false,[\"site-setting\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".formatted-selection").innerText, "a.com, b.com");
    });
  });
});
define("discourse/tests/integration/components/slow-mode-info-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | slow-mode-info", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("doesn't render if the topic is closed", async function (assert) {
      this.set("topic", {
        slow_mode_seconds: 3600,
        closed: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SlowModeInfo @topic={{this.topic}} />
      */
      {
        "id": "yVC5T8NL",
        "block": "[[[8,[39,0],null,[[\"@topic\"],[[30,0,[\"topic\"]]]],null]],[],false,[\"slow-mode-info\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".slow-mode-heading"), "it doesn't render the notice");
    });
    (0, _qunit.test)("doesn't render if the slow mode is disabled", async function (assert) {
      this.set("topic", {
        slow_mode_seconds: 0,
        closed: false
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SlowModeInfo @topic={{this.topic}} />
      */
      {
        "id": "yVC5T8NL",
        "block": "[[[8,[39,0],null,[[\"@topic\"],[[30,0,[\"topic\"]]]],null]],[],false,[\"slow-mode-info\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".slow-mode-heading"), "it doesn't render the notice");
    });
    (0, _qunit.test)("renders if slow mode is enabled", async function (assert) {
      this.set("topic", {
        slow_mode_seconds: 3600,
        closed: false
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SlowModeInfo @topic={{this.topic}} />
      */
      {
        "id": "yVC5T8NL",
        "block": "[[[8,[39,0],null,[[\"@topic\"],[[30,0,[\"topic\"]]]],null]],[],false,[\"slow-mode-info\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".slow-mode-heading"), 1);
    });
    (0, _qunit.test)("staff and TL4 users can disable slow mode", async function (assert) {
      this.setProperties({
        topic: {
          slow_mode_seconds: 3600,
          closed: false
        },
        user: {
          canManageTopic: true
        }
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SlowModeInfo @topic={{this.topic}} @user={{this.user}} />
      */
      {
        "id": "R+B+ytRj",
        "block": "[[[8,[39,0],null,[[\"@topic\",\"@user\"],[[30,0,[\"topic\"]],[30,0,[\"user\"]]]],null]],[],false,[\"slow-mode-info\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".slow-mode-remove"), 1);
    });
    (0, _qunit.test)("regular users can't disable slow mode", async function (assert) {
      this.setProperties({
        topic: {
          slow_mode_seconds: 3600,
          closed: false
        },
        user: {
          canManageTopic: false
        }
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <SlowModeInfo @topic={{this.topic}} @user={{this.user}} />
      */
      {
        "id": "R+B+ytRj",
        "block": "[[[8,[39,0],null,[[\"@topic\",\"@user\"],[[30,0,[\"topic\"]],[30,0,[\"user\"]]]],null]],[],false,[\"slow-mode-info\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".slow-mode-remove"), "it doesn't let you disable slow mode");
    });
  });
});
define("discourse/tests/integration/components/software-update-prompt-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | software-update-prompt", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("software-update-prompt gets correct CSS class after messageBus message", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        {{software-update-prompt}}
      */
      {
        "id": "cZpPA05O",
        "block": "[[[1,[34,0]]],[],false,[\"software-update-prompt\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)("div.software-update-prompt"), "it does not have the class to show the prompt");
      await (0, _qunitHelpers.publishToMessageBus)("/global/asset-version", "somenewversion");
      assert.strictEqual((0, _qunitHelpers.count)("div.software-update-prompt.require-software-refresh"), 1, "it does have the class to show the prompt");
    });
  });
});
define("discourse/tests/integration/components/text-field-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "sinon", "I18n"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _sinon, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"sinon",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | text-field", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("renders correctly with no properties set", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TextField />
      */
      {
        "id": "C8+ONCNU",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"text-field\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("input[type=text]"));
    });
    (0, _qunit.test)("support a placeholder", async function (assert) {
      _sinon.default.stub(_I18n.default, "t").returnsArg(0);

      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TextField @placeholderKey="placeholder.i18n.key" />
      */
      {
        "id": "t5CwACpQ",
        "block": "[[[8,[39,0],null,[[\"@placeholderKey\"],[\"placeholder.i18n.key\"]],null]],[],false,[\"text-field\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("input[type=text]"));
      assert.strictEqual((0, _qunitHelpers.query)("input").placeholder, "placeholder.i18n.key");
    });
    (0, _qunit.test)("sets the dir attribute to ltr for Hebrew text", async function (assert) {
      this.siteSettings.support_mixed_text_direction = true;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TextField @value="     " />
      */
      {
        "id": "4+0DQwEA",
        "block": "[[[8,[39,0],null,[[\"@value\"],[\"     \"]],null]],[],false,[\"text-field\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("input").getAttribute("dir"), "rtl");
    });
    (0, _qunit.test)("sets the dir attribute to ltr for English text", async function (assert) {
      this.siteSettings.support_mixed_text_direction = true;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TextField @value="This is a ltr title" />
      */
      {
        "id": "lksI3vjL",
        "block": "[[[8,[39,0],null,[[\"@value\"],[\"This is a ltr title\"]],null]],[],false,[\"text-field\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("input").getAttribute("dir"), "ltr");
    });
    (0, _qunit.test)("supports onChange", async function (assert) {
      this.called = false;
      this.newValue = null;
      this.set("value", "hello");
      this.set("changed", v => {
        this.newValue = v;
        this.called = true;
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TextField class="tf-test" @value={{this.value}} @onChange={{this.changed}} />
      */
      {
        "id": "b+dkQ6MY",
        "block": "[[[8,[39,0],[[24,0,\"tf-test\"]],[[\"@value\",\"@onChange\"],[[30,0,[\"value\"]],[30,0,[\"changed\"]]]],null]],[],false,[\"text-field\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.fillIn)(".tf-test", "hello");
      assert.ok(!this.called);
      await (0, _testHelpers.fillIn)(".tf-test", "new text");
      assert.ok(this.called);
      assert.strictEqual(this.newValue, "new text");
    });
    (0, _qunit.test)("supports onChangeImmediate", async function (assert) {
      this.called = false;
      this.newValue = null;
      this.set("value", "old");
      this.set("changed", v => {
        this.newValue = v;
        this.called = true;
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TextField class="tf-test" @value={{this.value}} @onChangeImmediate={{this.changed}} />
      */
      {
        "id": "HovfV99r",
        "block": "[[[8,[39,0],[[24,0,\"tf-test\"]],[[\"@value\",\"@onChangeImmediate\"],[[30,0,[\"value\"]],[30,0,[\"changed\"]]]],null]],[],false,[\"text-field\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.fillIn)(".tf-test", "old");
      assert.ok(!this.called);
      await (0, _testHelpers.fillIn)(".tf-test", "no longer old");
      assert.ok(this.called);
      assert.strictEqual(this.newValue, "no longer old");
    });
  });
});
define("discourse/tests/integration/components/themes-list-item-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "I18n", "admin/models/theme"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _I18n, _theme) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"I18n",0,"admin/models/theme"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | themes-list-item", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("default theme", async function (assert) {
      this.set("theme", _theme.default.create({
        name: "Test",
        default: true
      }));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <ThemesListItem @theme={{this.theme}} />
      */
      {
        "id": "vdPm+DHN",
        "block": "[[[8,[39,0],null,[[\"@theme\"],[[30,0,[\"theme\"]]]],null]],[],false,[\"themes-list-item\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.expect(1);
      assert.strictEqual((0, _qunitHelpers.count)(".d-icon-check"), 1, "shows default theme icon");
    });
    (0, _qunit.test)("pending updates", async function (assert) {
      this.set("theme", _theme.default.create({
        name: "Test",
        remote_theme: {
          commits_behind: 6
        }
      }));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <ThemesListItem @theme={{this.theme}} />
      */
      {
        "id": "vdPm+DHN",
        "block": "[[[8,[39,0],null,[[\"@theme\"],[[30,0,[\"theme\"]]]],null]],[],false,[\"themes-list-item\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.expect(1);
      assert.strictEqual((0, _qunitHelpers.count)(".d-icon-sync"), 1, "shows pending update icon");
    });
    (0, _qunit.test)("broken theme", async function (assert) {
      this.set("theme", _theme.default.create({
        name: "Test",
        theme_fields: [{
          name: "scss",
          type_id: 1,
          error: "something"
        }]
      }));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <ThemesListItem @theme={{this.theme}} />
      */
      {
        "id": "vdPm+DHN",
        "block": "[[[8,[39,0],null,[[\"@theme\"],[[30,0,[\"theme\"]]]],null]],[],false,[\"themes-list-item\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.expect(1);
      assert.strictEqual((0, _qunitHelpers.count)(".d-icon-exclamation-circle"), 1, "shows broken theme icon");
    });
    (0, _qunit.test)("with children", async function (assert) {
      this.childrenList = [1, 2, 3, 4, 5].map(num => _theme.default.create({
        name: `Child ${num}`,
        component: true
      }));
      this.set("theme", _theme.default.create({
        name: "Test",
        childThemes: this.childrenList,
        default: true
      }));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <ThemesListItem @theme={{this.theme}} />
      */
      {
        "id": "vdPm+DHN",
        "block": "[[[8,[39,0],null,[[\"@theme\"],[[30,0,[\"theme\"]]]],null]],[],false,[\"themes-list-item\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.expect(2);
      assert.deepEqual((0, _qunitHelpers.query)(".components").innerText.trim().split(",").map(n => n.trim()).join(","), this.childrenList.splice(0, 4).map(theme => theme.get("name")).join(","), "lists the first 4 children");
      assert.deepEqual((0, _qunitHelpers.query)(".others-count").innerText.trim(), _I18n.default.t("admin.customize.theme.and_x_more", {
        count: 1
      }), "shows count of remaining children");
    });
  });
});
define("discourse/tests/integration/components/themes-list-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "admin/models/theme", "I18n"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _theme, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"admin/models/theme",0,"I18n"eaimeta@70e063a35619d71f

  function createThemes(itemsCount, customAttributesCallback) {
    return [...Array(itemsCount)].map((_, i) => {
      const attrs = {
        name: `Theme ${i + 1}`
      };

      if (customAttributesCallback) {
        Object.assign(attrs, customAttributesCallback(i + 1));
      }

      return _theme.default.create(attrs);
    });
  }

  (0, _qunit.module)("Integration | Component | themes-list", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("current tab is themes", async function (assert) {
      this.themes = createThemes(5);
      this.components = createThemes(5, n => {
        return {
          name: `Child ${n}`,
          component: true,
          parentThemes: [this.themes[n - 1]],
          parent_themes: [1, 2, 3, 4, 5]
        };
      });
      this.setProperties({
        themes: this.themes,
        components: this.components,
        currentTab: _theme.THEMES
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <ThemesList @themes={{this.themes}} @components={{this.components}} @currentTab={{this.currentTab}} />
      */
      {
        "id": "2JA4fMvD",
        "block": "[[[8,[39,0],null,[[\"@themes\",\"@components\",\"@currentTab\"],[[30,0,[\"themes\"]],[30,0,[\"components\"]],[30,0,[\"currentTab\"]]]],null]],[],false,[\"themes-list\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".themes-tab").classList.contains("active"), true, "themes tab is active");
      assert.strictEqual((0, _qunitHelpers.query)(".components-tab").classList.contains("active"), false, "components tab is not active");
      assert.notOk((0, _qunitHelpers.exists)(".inactive-indicator"), "there is no inactive themes separator when all themes are inactive");
      assert.strictEqual((0, _qunitHelpers.count)(".themes-list-item"), 5, "displays all themes");
      [2, 3].forEach(num => this.themes[num].set("user_selectable", true));
      this.themes[4].set("default", true);
      this.set("themes", this.themes);
      const names = [4, 2, 3, 0, 1].map(num => this.themes[num].get("name")); // default theme always on top, followed by user-selectable ones and then the rest

      assert.deepEqual(Array.from((0, _qunitHelpers.queryAll)(".themes-list-item .name")).map(node => node.innerText.trim()), names, "sorts themes correctly");
      assert.strictEqual((0, _qunitHelpers.queryAll)(".inactive-indicator").index(), 3, "the separator is in the right location");
      this.themes.forEach(theme => theme.set("user_selectable", true));
      this.set("themes", this.themes);
      assert.notOk((0, _qunitHelpers.exists)(".inactive-indicator"), "there is no inactive themes separator when all themes are user-selectable");
      this.set("themes", []);
      assert.strictEqual((0, _qunitHelpers.count)(".themes-list-item"), 1, "shows one entry with a message when there is nothing to display");
      assert.strictEqual((0, _qunitHelpers.query)(".themes-list-item span.empty").innerText.trim(), _I18n.default.t("admin.customize.theme.empty"), "displays the right message");
    });
    (0, _qunit.test)("current tab is components", async function (assert) {
      this.themes = createThemes(5);
      this.components = createThemes(5, n => {
        return {
          name: `Child ${n}`,
          component: true,
          parentThemes: [this.themes[n - 1]],
          parent_themes: [1, 2, 3, 4, 5]
        };
      });
      this.setProperties({
        themes: this.themes,
        components: this.components,
        currentTab: _theme.COMPONENTS
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <ThemesList @themes={{this.themes}} @components={{this.components}} @currentTab={{this.currentTab}} />
      */
      {
        "id": "2JA4fMvD",
        "block": "[[[8,[39,0],null,[[\"@themes\",\"@components\",\"@currentTab\"],[[30,0,[\"themes\"]],[30,0,[\"components\"]],[30,0,[\"currentTab\"]]]],null]],[],false,[\"themes-list\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".components-tab").classList.contains("active"), true, "components tab is active");
      assert.strictEqual((0, _qunitHelpers.query)(".themes-tab").classList.contains("active"), false, "themes tab is not active");
      assert.notOk((0, _qunitHelpers.exists)(".inactive-indicator"), "there is no separator");
      assert.strictEqual((0, _qunitHelpers.count)(".themes-list-item"), 5, "displays all components");
      this.set("components", []);
      assert.strictEqual((0, _qunitHelpers.count)(".themes-list-item"), 1, "shows one entry with a message when there is nothing to display");
      assert.strictEqual((0, _qunitHelpers.query)(".themes-list-item span.empty").innerText.trim(), _I18n.default.t("admin.customize.theme.empty"), "displays the right message");
    });
    (0, _qunit.test)("themes filter is not visible when there are less than 10 themes", async function (assert) {
      const themes = createThemes(9);
      this.setProperties({
        themes,
        currentTab: _theme.THEMES
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <ThemesList @themes={{this.themes}} components=[] @currentTab={{this.currentTab}} />
      */
      {
        "id": "VMckKCY9",
        "block": "[[[8,[39,0],[[24,\"components\",\"[]\"]],[[\"@themes\",\"@currentTab\"],[[30,0,[\"themes\"]],[30,0,[\"currentTab\"]]]],null]],[],false,[\"themes-list\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".themes-list-filter"), "filter input not shown when we have fewer than 10 themes");
    });
    (0, _qunit.test)("themes filter keeps themes whose names include the filter term", async function (assert) {
      const themes = ["osama", "OsAmaa", "osAMA 1234"].map(name => _theme.default.create({
        name: `Theme ${name}`
      })).concat(createThemes(7));
      this.setProperties({
        themes,
        currentTab: _theme.THEMES
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <ThemesList @themes={{this.themes}} components=[] @currentTab={{this.currentTab}} />
      */
      {
        "id": "VMckKCY9",
        "block": "[[[8,[39,0],[[24,\"components\",\"[]\"]],[[\"@themes\",\"@currentTab\"],[[30,0,[\"themes\"]],[30,0,[\"currentTab\"]]]],null]],[],false,[\"themes-list\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".themes-list-filter"));
      await (0, _testHelpers.fillIn)(".themes-list-filter .filter-input", "  oSAma ");
      assert.deepEqual(Array.from((0, _qunitHelpers.queryAll)(".themes-list-item .name")).map(node => node.textContent.trim()), ["Theme osama", "Theme OsAmaa", "Theme osAMA 1234"], "only themes whose names include the filter term are shown");
    });
    (0, _qunit.test)("switching between themes and components tabs keeps the filter visible only if both tabs have at least 10 items", async function (assert) {
      const themes = createThemes(10, n => {
        return {
          name: `Theme ${n}${n}`
        };
      });
      const components = createThemes(5, n => {
        return {
          name: `Component ${n}${n}`,
          component: true,
          parent_themes: [1],
          parentThemes: [1]
        };
      });
      this.setProperties({
        themes,
        components,
        currentTab: _theme.THEMES
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <ThemesList @themes={{this.themes}} @components={{this.components}} @currentTab={{this.currentTab}} />
      */
      {
        "id": "2JA4fMvD",
        "block": "[[[8,[39,0],null,[[\"@themes\",\"@components\",\"@currentTab\"],[[30,0,[\"themes\"]],[30,0,[\"components\"]],[30,0,[\"currentTab\"]]]],null]],[],false,[\"themes-list\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.fillIn)(".themes-list-filter .filter-input", "11");
      assert.strictEqual((0, _qunitHelpers.query)(".themes-list-container").textContent.trim(), "Theme 11", "only 1 theme is shown");
      await (0, _testHelpers.click)(".themes-list-header .components-tab");
      assert.ok(!(0, _qunitHelpers.exists)(".themes-list-filter"), "filter input/term do not persist when we switch to the other" + " tab because it has fewer than 10 items");
      assert.deepEqual(Array.from((0, _qunitHelpers.queryAll)(".themes-list-item .name")).map(node => node.textContent.trim()), ["Component 11", "Component 22", "Component 33", "Component 44", "Component 55"], "all components are shown");
      this.set("components", this.components.concat(createThemes(5, n => {
        n += 5;
        return {
          name: `Component ${n}${n}`,
          component: true,
          parent_themes: [1],
          parentThemes: [1]
        };
      })));
      assert.ok((0, _qunitHelpers.exists)(".themes-list-filter"), "filter is now shown for the components tab");
      await (0, _testHelpers.fillIn)(".themes-list-filter .filter-input", "66");
      assert.strictEqual((0, _qunitHelpers.query)(".themes-list-container").textContent.trim(), "Component 66", "only 1 component is shown");
      await (0, _testHelpers.click)(".themes-list-header .themes-tab");
      assert.strictEqual((0, _qunitHelpers.query)(".themes-list-container").textContent.trim(), "Theme 66", "filter term persisted between tabs because both have more than 10 items");
    });
  });
});
define("discourse/tests/integration/components/time-input-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/select-kit-helper"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _selectKitHelper) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/select-kit-helper"eaimeta@70e063a35619d71f

  function setTime(time) {
    this.setProperties(time);
  }

  (0, _qunit.module)("Integration | Component | time-input", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.set("subject", (0, _selectKitHelper.default)());
    });
    (0, _qunit.test)("default", async function (assert) {
      this.setProperties({
        hours: "14",
        minutes: "58"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TimeInput @hours={{this.hours}} @minutes={{this.minutes}} />
      */
      {
        "id": "7nVWMgGy",
        "block": "[[[8,[39,0],null,[[\"@hours\",\"@minutes\"],[[30,0,[\"hours\"]],[30,0,[\"minutes\"]]]],null]],[],false,[\"time-input\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.subject.header().name(), "14:58");
    });
    (0, _qunit.test)("prevents mutations", async function (assert) {
      this.setProperties({
        hours: "14",
        minutes: "58"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TimeInput @hours={{this.hours}} @minutes={{this.minutes}} />
      */
      {
        "id": "7nVWMgGy",
        "block": "[[[8,[39,0],null,[[\"@hours\",\"@minutes\"],[[30,0,[\"hours\"]],[30,0,[\"minutes\"]]]],null]],[],false,[\"time-input\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      await this.subject.selectRowByIndex(3);
      assert.strictEqual(this.subject.header().name(), "14:58");
    });
    (0, _qunit.test)("allows mutations through actions", async function (assert) {
      this.setProperties({
        hours: "14",
        minutes: "58"
      });
      this.set("onChange", setTime);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TimeInput @hours={{this.hours}} @minutes={{this.minutes}} @onChange={{this.onChange}} />
      */
      {
        "id": "mIio17vX",
        "block": "[[[8,[39,0],null,[[\"@hours\",\"@minutes\",\"@onChange\"],[[30,0,[\"hours\"]],[30,0,[\"minutes\"]],[30,0,[\"onChange\"]]]],null]],[],false,[\"time-input\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await this.subject.expand();
      await this.subject.selectRowByIndex(3);
      assert.strictEqual(this.subject.header().name(), "00:45");
    });
  });
});
define("discourse/tests/integration/components/time-shortcut-picker-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "I18n"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"I18n",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | time-shortcut-picker", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      const itsatrapStub = {
        bind: () => {},
        unbind: () => {}
      };
      this.set("itsatrap", itsatrapStub);
    });
    hooks.afterEach(function () {
      this.clock?.restore();
    });
    (0, _qunit.test)("shows default options", async function (assert) {
      this.siteSettings.suggest_weekends_in_date_pickers = true;
      const tuesday = "2100-06-08T08:00:00";
      this.clock = (0, _qunitHelpers.fakeTime)(tuesday, this.currentUser.timezone, true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TimeShortcutPicker @_itsatrap={{this.itsatrap}} />
      */
      {
        "id": "78YH5A6a",
        "block": "[[[8,[39,0],null,[[\"@_itsatrap\"],[[30,0,[\"itsatrap\"]]]],null]],[],false,[\"time-shortcut-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const expected = [_I18n.default.t("time_shortcut.later_today"), _I18n.default.t("time_shortcut.tomorrow"), _I18n.default.t("time_shortcut.later_this_week"), _I18n.default.t("time_shortcut.this_weekend"), _I18n.default.t("time_shortcut.start_of_next_business_week"), _I18n.default.t("time_shortcut.next_month"), _I18n.default.t("time_shortcut.custom"), _I18n.default.t("time_shortcut.none")];
      const options = Array.from((0, _qunitHelpers.queryAll)("div.tap-tile-grid div.tap-tile-title").map((_, div) => div.innerText.trim()));
      assert.deepEqual(options, expected);
    });
    (0, _qunit.test)("show 'Later This Week' if today is < Thursday", async function (assert) {
      const monday = "2100-06-07T08:00:00";
      this.clock = (0, _qunitHelpers.fakeTime)(monday, this.currentUser.timezone, true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TimeShortcutPicker @_itsatrap={{this.itsatrap}} />
      */
      {
        "id": "78YH5A6a",
        "block": "[[[8,[39,0],null,[[\"@_itsatrap\"],[[30,0,[\"itsatrap\"]]]],null]],[],false,[\"time-shortcut-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("#tap_tile_later_this_week"), "it has later this week");
    });
    (0, _qunit.test)("does not show 'Later This Week' if today is >= Thursday", async function (assert) {
      const thursday = "2100-06-10T08:00:00";
      this.clock = (0, _qunitHelpers.fakeTime)(thursday, this.currentUser.timezone, true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TimeShortcutPicker @_itsatrap={{this.itsatrap}} />
      */
      {
        "id": "78YH5A6a",
        "block": "[[[8,[39,0],null,[[\"@_itsatrap\"],[[30,0,[\"itsatrap\"]]]],null]],[],false,[\"time-shortcut-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.notOk((0, _qunitHelpers.exists)("#tap_tile_later_this_week"), "it does not have later this week");
    });
    (0, _qunit.test)("does not show 'Later Today' if 'Later Today' is tomorrow", async function (assert) {
      this.clock = (0, _qunitHelpers.fakeTime)("2100-12-11T22:00:00", // + 3 hours is tomorrow
      this.currentUser.timezone, true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TimeShortcutPicker @_itsatrap={{this.itsatrap}} />
      */
      {
        "id": "78YH5A6a",
        "block": "[[[8,[39,0],null,[[\"@_itsatrap\"],[[30,0,[\"itsatrap\"]]]],null]],[],false,[\"time-shortcut-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.notOk((0, _qunitHelpers.exists)("#tap_tile_later_today"), "it does not have later today");
    });
    (0, _qunit.test)("shows 'Later Today' if it is before 5pm", async function (assert) {
      this.clock = (0, _qunitHelpers.fakeTime)("2100-12-11T16:50:00", this.currentUser.timezone, true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TimeShortcutPicker @_itsatrap={{this.itsatrap}} />
      */
      {
        "id": "78YH5A6a",
        "block": "[[[8,[39,0],null,[[\"@_itsatrap\"],[[30,0,[\"itsatrap\"]]]],null]],[],false,[\"time-shortcut-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("#tap_tile_later_today"), "it does have later today");
    });
    (0, _qunit.test)("does not show 'Later Today' if it is after 5pm", async function (assert) {
      this.clock = (0, _qunitHelpers.fakeTime)("2100-12-11T17:00:00", this.currentUser.timezone, true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TimeShortcutPicker @_itsatrap={{this.itsatrap}} />
      */
      {
        "id": "78YH5A6a",
        "block": "[[[8,[39,0],null,[[\"@_itsatrap\"],[[30,0,[\"itsatrap\"]]]],null]],[],false,[\"time-shortcut-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.notOk((0, _qunitHelpers.exists)("#tap_tile_later_today"), "it does not have later today");
    });
    (0, _qunit.test)("default custom date time is in one hour from now", async function (assert) {
      this.clock = (0, _qunitHelpers.fakeTime)("2100-12-11T17:00:00", this.currentUser.timezone, true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TimeShortcutPicker @_itsatrap={{this.itsatrap}} />
      */
      {
        "id": "78YH5A6a",
        "block": "[[[8,[39,0],null,[[\"@_itsatrap\"],[[30,0,[\"itsatrap\"]]]],null]],[],false,[\"time-shortcut-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)("#tap_tile_custom");
      assert.strictEqual((0, _qunitHelpers.query)("#custom-date > input").value, "2100-12-11");
      assert.strictEqual((0, _qunitHelpers.query)("#custom-time").value, "18:00");
    });
    (0, _qunit.test)("shows 'Next Monday' instead of 'Monday' on Sundays", async function (assert) {
      const sunday = "2100-01-24T08:00:00";
      this.clock = (0, _qunitHelpers.fakeTime)(sunday, this.currentUser.timezone, true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TimeShortcutPicker @_itsatrap={{this.itsatrap}} />
      */
      {
        "id": "78YH5A6a",
        "block": "[[[8,[39,0],null,[[\"@_itsatrap\"],[[30,0,[\"itsatrap\"]]]],null]],[],false,[\"time-shortcut-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("#tap_tile_start_of_next_business_week .tap-tile-title").innerText, "Next Monday");
      assert.strictEqual((0, _qunitHelpers.query)("div#tap_tile_start_of_next_business_week div.tap-tile-date").innerText, "Feb 1, 8:00 am");
    });
    (0, _qunit.test)("shows 'Next Monday' instead of 'Monday' on Mondays", async function (assert) {
      const monday = "2100-01-25T08:00:00";
      this.clock = (0, _qunitHelpers.fakeTime)(monday, this.currentUser.timezone, true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TimeShortcutPicker @_itsatrap={{this.itsatrap}} />
      */
      {
        "id": "78YH5A6a",
        "block": "[[[8,[39,0],null,[[\"@_itsatrap\"],[[30,0,[\"itsatrap\"]]]],null]],[],false,[\"time-shortcut-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("#tap_tile_start_of_next_business_week .tap-tile-title").innerText, "Next Monday");
      assert.strictEqual((0, _qunitHelpers.query)("div#tap_tile_start_of_next_business_week div.tap-tile-date").innerText, "Feb 1, 8:00 am");
    });
    (0, _qunit.test)("the 'Next Month' option points to the first day of the next month", async function (assert) {
      this.clock = (0, _qunitHelpers.fakeTime)("2100-01-01T08:00:00", this.currentUser.timezone, true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <TimeShortcutPicker @_itsatrap={{this.itsatrap}} />
      */
      {
        "id": "78YH5A6a",
        "block": "[[[8,[39,0],null,[[\"@_itsatrap\"],[[30,0,[\"itsatrap\"]]]],null]],[],false,[\"time-shortcut-picker\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("div#tap_tile_next_month div.tap-tile-date").innerText, "Feb 1, 8:00 am");
    });
  });
});
define("discourse/tests/integration/components/topic-list-item-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/models/topic"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _topic) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/models/topic",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | topic-list-item", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("checkbox is rendered checked if topic is in selected array", async function (assert) {
      const topic = _topic.default.create({
        id: 24234
      });

      const topic2 = _topic.default.create({
        id: 24235
      });

      this.setProperties({
        topic,
        topic2,
        selected: [topic]
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <TopicListItem
              @topic={{this.topic}}
              @bulkSelectEnabled={{true}}
              @selected={{this.selected}}
            />
            <TopicListItem
              @topic={{this.topic2}}
              @bulkSelectEnabled={{true}}
              @selected={{this.selected}}
            />
          
      */
      {
        "id": "YDPcdESL",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@topic\",\"@bulkSelectEnabled\",\"@selected\"],[[30,0,[\"topic\"]],true,[30,0,[\"selected\"]]]],null],[1,\"\\n      \"],[8,[39,0],null,[[\"@topic\",\"@bulkSelectEnabled\",\"@selected\"],[[30,0,[\"topic2\"]],true,[30,0,[\"selected\"]]]],null],[1,\"\\n    \"]],[],false,[\"topic-list-item\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const checkboxes = (0, _qunitHelpers.queryAll)("input.bulk-select");
      assert.ok(checkboxes[0].checked);
      assert.ok(!checkboxes[1].checked);
    });
  });
});
define("discourse/tests/integration/components/topic-list-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/models/topic"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _topic) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/models/topic",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | topic-list", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("bulk select", async function (assert) {
      this.setProperties({
        topics: [_topic.default.create({
          id: 24234
        }), _topic.default.create({
          id: 24235
        })],
        selected: [],
        bulkSelectEnabled: false,
        autoAddTopicsToBulkSelect: false,

        toggleBulkSelect() {
          this.toggleProperty("bulkSelectEnabled");
        },

        updateAutoAddTopicsToBulkSelect(newVal) {
          this.set("autoAddTopicsToBulkSelect", newVal);
        }

      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <TopicList
              @canBulkSelect={{true}}
              @toggleBulkSelect={{this.toggleBulkSelect}}
              @bulkSelectEnabled={{this.bulkSelectEnabled}}
              @autoAddTopicsToBulkSelect={{this.autoAddTopicsToBulkSelect}}
              @updateAutoAddTopicsToBulkSelect={{this.updateAutoAddTopicsToBulkSelect}}
              @topics={{this.topics}}
              @selected={{this.selected}}
            />
          
      */
      {
        "id": "Vv9D7RB1",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@canBulkSelect\",\"@toggleBulkSelect\",\"@bulkSelectEnabled\",\"@autoAddTopicsToBulkSelect\",\"@updateAutoAddTopicsToBulkSelect\",\"@topics\",\"@selected\"],[true,[30,0,[\"toggleBulkSelect\"]],[30,0,[\"bulkSelectEnabled\"]],[30,0,[\"autoAddTopicsToBulkSelect\"]],[30,0,[\"updateAutoAddTopicsToBulkSelect\"]],[30,0,[\"topics\"]],[30,0,[\"selected\"]]]],null],[1,\"\\n    \"]],[],false,[\"topic-list\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(this.selected.length, 0, "defaults to 0");
      await (0, _testHelpers.click)("button.bulk-select");
      assert.ok(this.bulkSelectEnabled, "bulk select is enabled");
      await (0, _testHelpers.click)("button.bulk-select-all");
      assert.strictEqual(this.selected.length, 2, "clicking Select All selects all loaded topics");
      assert.ok(this.autoAddTopicsToBulkSelect, "clicking Select All turns on the autoAddTopicsToBulkSelect flag");
      await (0, _testHelpers.click)("button.bulk-clear-all");
      assert.strictEqual(this.selected.length, 0, "clicking Clear All deselects all topics");
      assert.ok(!this.autoAddTopicsToBulkSelect, "clicking Clear All turns off the autoAddTopicsToBulkSelect flag");
    });
  });
});
define("discourse/tests/integration/components/uppy-image-uploader-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | uppy-image-uploader", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("with image", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <UppyImageUploader @id="test-uppy-image-uploader" @imageUrl="/images/avatar.png" @placeholderUrl="/not/used.png" />
          
      */
      {
        "id": "LIXZQKeu",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@id\",\"@imageUrl\",\"@placeholderUrl\"],[\"test-uppy-image-uploader\",\"/images/avatar.png\",\"/not/used.png\"]],null],[1,\"\\n    \"]],[],false,[\"uppy-image-uploader\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".d-icon-far-image"), 1, "it displays the upload icon");
      assert.strictEqual((0, _qunitHelpers.count)(".d-icon-far-trash-alt"), 1, "it displays the trash icon");
      assert.ok(!(0, _qunitHelpers.exists)(".placeholder-overlay"), "it does not display the placeholder image");
      await (0, _testHelpers.click)(".image-uploader-lightbox-btn");
      assert.strictEqual(document.querySelectorAll(".mfp-container").length, 1, "it displays the image lightbox");
    });
    (0, _qunit.test)("without image", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UppyImageUploader @id="test-uppy-image-uploader" />
      */
      {
        "id": "tdqWAbYD",
        "block": "[[[8,[39,0],null,[[\"@id\"],[\"test-uppy-image-uploader\"]],null]],[],false,[\"uppy-image-uploader\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".d-icon-far-image"), 1, "it displays the upload icon");
      assert.ok(!(0, _qunitHelpers.exists)(".d-icon-far-trash-alt"), "it does not display trash icon");
      assert.ok(!(0, _qunitHelpers.exists)(".image-uploader-lightbox-btn"), "it does not display the button to open image lightbox");
    });
    (0, _qunit.test)("with placeholder", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UppyImageUploader @id="test-uppy-image-uploader" @placeholderUrl="/images/avatar.png" />
      */
      {
        "id": "nrd942jK",
        "block": "[[[8,[39,0],null,[[\"@id\",\"@placeholderUrl\"],[\"test-uppy-image-uploader\",\"/images/avatar.png\"]],null]],[],false,[\"uppy-image-uploader\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".d-icon-far-image"), 1, "it displays the upload icon");
      assert.ok(!(0, _qunitHelpers.exists)(".d-icon-far-trash-alt"), "it does not display trash icon");
      assert.ok(!(0, _qunitHelpers.exists)(".image-uploader-lightbox-btn"), "it does not display the button to open image lightbox");
      assert.strictEqual((0, _qunitHelpers.count)(".placeholder-overlay"), 1, "it displays the placeholder image");
    });
  });
});
define("discourse/tests/integration/components/user-avatar-flair-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/lib/avatar-flair"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _avatarFlair) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/lib/avatar-flair"eaimeta@70e063a35619d71f

  function setupSiteGroups(that) {
    that.site.groups = [{
      id: 1,
      name: "admins",
      flair_url: "fa-bars",
      flair_bg_color: "CC000A",
      flair_color: "FFFFFA"
    }, {
      id: 2,
      name: "staff",
      flair_url: "fa-bars",
      flair_bg_color: "CC0005",
      flair_color: "FFFFF5"
    }, {
      id: 3,
      name: "trust_level_1",
      flair_url: "fa-dice-one",
      flair_bg_color: "CC0001",
      flair_color: "FFFFF1"
    }, {
      id: 4,
      name: "trust_level_2",
      flair_url: "fa-dice-two",
      flair_bg_color: "CC0002",
      flair_color: "FFFFF2"
    }];
  }

  (0, _qunit.module)("Integration | Component | user-avatar-flair", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      (0, _avatarFlair.resetFlair)();
    });
    hooks.afterEach(function () {
      (0, _avatarFlair.resetFlair)();
    });
    (0, _qunit.test)("avatar flair for admin user", async function (assert) {
      this.set("args", {
        admin: true,
        moderator: false,
        trust_level: 2
      });
      setupSiteGroups(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserAvatarFlair @user={{this.args}} />
      */
      {
        "id": "4bXU+4/H",
        "block": "[[[8,[39,0],null,[[\"@user\"],[[30,0,[\"args\"]]]],null]],[],false,[\"user-avatar-flair\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".avatar-flair"), "it has the tag");
      assert.ok((0, _qunitHelpers.exists)("svg.d-icon-bars"), "it has the svg icon");
      assert.strictEqual((0, _qunitHelpers.query)(".avatar-flair").getAttribute("style"), "background-color: #CC000A; color: #FFFFFA; ", "it has styles");
    });
    (0, _qunit.test)("avatar flair for moderator user with fallback to staff", async function (assert) {
      this.set("args", {
        admin: false,
        moderator: true,
        trust_level: 2
      });
      setupSiteGroups(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserAvatarFlair @user={{this.args}} />
      */
      {
        "id": "4bXU+4/H",
        "block": "[[[8,[39,0],null,[[\"@user\"],[[30,0,[\"args\"]]]],null]],[],false,[\"user-avatar-flair\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".avatar-flair"), "it has the tag");
      assert.ok((0, _qunitHelpers.exists)("svg.d-icon-bars"), "it has the svg icon");
      assert.strictEqual((0, _qunitHelpers.query)(".avatar-flair").getAttribute("style"), "background-color: #CC0005; color: #FFFFF5; ", "it has styles");
    });
    (0, _qunit.test)("avatar flair for trust level", async function (assert) {
      this.set("args", {
        admin: false,
        moderator: false,
        trust_level: 2
      });
      setupSiteGroups(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserAvatarFlair @user={{this.args}} />
      */
      {
        "id": "4bXU+4/H",
        "block": "[[[8,[39,0],null,[[\"@user\"],[[30,0,[\"args\"]]]],null]],[],false,[\"user-avatar-flair\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".avatar-flair"), "it has the tag");
      assert.ok((0, _qunitHelpers.exists)("svg.d-icon-dice-two"), "it has the svg icon");
      assert.strictEqual((0, _qunitHelpers.query)(".avatar-flair").getAttribute("style"), "background-color: #CC0002; color: #FFFFF2; ", "it has styles");
    });
    (0, _qunit.test)("avatar flair for trust level with fallback", async function (assert) {
      this.set("args", {
        admin: false,
        moderator: false,
        trust_level: 3
      });
      setupSiteGroups(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserAvatarFlair @user={{this.args}} />
      */
      {
        "id": "4bXU+4/H",
        "block": "[[[8,[39,0],null,[[\"@user\"],[[30,0,[\"args\"]]]],null]],[],false,[\"user-avatar-flair\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".avatar-flair"), "it has the tag");
      assert.ok((0, _qunitHelpers.exists)("svg.d-icon-dice-two"), "it has the svg icon");
      assert.strictEqual((0, _qunitHelpers.query)(".avatar-flair").getAttribute("style"), "background-color: #CC0002; color: #FFFFF2; ", "it has styles");
    });
    (0, _qunit.test)("avatar flair for login-required site, before login", async function (assert) {
      this.set("args", {
        admin: false,
        moderator: false,
        trust_level: 3
      }); // Groups not serialized for anon on login_required

      this.site.groups = undefined;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserAvatarFlair @user={{this.args}} />
      */
      {
        "id": "4bXU+4/H",
        "block": "[[[8,[39,0],null,[[\"@user\"],[[30,0,[\"args\"]]]],null]],[],false,[\"user-avatar-flair\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".avatar-flair"), "it does not render a flair");
    });
    (0, _qunit.test)("avatar flair for primary group flair", async function (assert) {
      this.set("args", {
        admin: false,
        moderator: false,
        trust_level: 3,
        flair_name: "Band Geeks",
        flair_url: "fa-times",
        flair_bg_color: "123456",
        flair_color: "B0B0B0",
        primary_group_name: "Band Geeks"
      });
      setupSiteGroups(this);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserAvatarFlair @user={{this.args}} />
      */
      {
        "id": "4bXU+4/H",
        "block": "[[[8,[39,0],null,[[\"@user\"],[[30,0,[\"args\"]]]],null]],[],false,[\"user-avatar-flair\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".avatar-flair"), "it has the tag");
      assert.ok((0, _qunitHelpers.exists)("svg.d-icon-times"), "it has the svg icon");
      assert.strictEqual((0, _qunitHelpers.query)(".avatar-flair").getAttribute("style"), "background-color: #123456; color: #B0B0B0; ", "it has styles");
    });
    (0, _qunit.test)("user-avatar-flair for user with no flairs", async function (assert) {
      this.set("args", {
        admin: false,
        moderator: false,
        trust_level: 1
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserAvatarFlair @user={{this.args}} />
      */
      {
        "id": "4bXU+4/H",
        "block": "[[[8,[39,0],null,[[\"@user\"],[[30,0,[\"args\"]]]],null]],[],false,[\"user-avatar-flair\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".avatar-flair"), "it does not render a flair");
    });
  });
});
define("discourse/tests/integration/components/user-info-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/qunit-helpers"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | user-info", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("prioritized name", async function (assert) {
      this.siteSettings.prioritize_username_in_ux = false;
      this.currentUser.name = "Evil Trout";
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserInfo @user={{this.currentUser}} />
      */
      {
        "id": "4cLbCChU",
        "block": "[[[8,[39,0],null,[[\"@user\"],[[30,0,[\"currentUser\"]]]],null]],[],false,[\"user-info\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".name.bold").innerText.trim(), "Evil Trout");
      assert.strictEqual((0, _qunitHelpers.query)(".username.margin").innerText.trim(), "eviltrout");
    });
    (0, _qunit.test)("prioritized username", async function (assert) {
      this.siteSettings.prioritize_username_in_ux = true;
      this.currentUser.name = "Evil Trout";
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserInfo @user={{this.currentUser}} />
      */
      {
        "id": "4cLbCChU",
        "block": "[[[8,[39,0],null,[[\"@user\"],[[30,0,[\"currentUser\"]]]],null]],[],false,[\"user-info\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".username.bold").innerText.trim(), "eviltrout");
      assert.strictEqual((0, _qunitHelpers.query)(".name.margin").innerText.trim(), "Evil Trout");
    });
    (0, _qunit.test)("includeLink", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserInfo @user={{this.currentUser}} @includeLink={{this.includeLink}} />
      */
      {
        "id": "MDovxarH",
        "block": "[[[8,[39,0],null,[[\"@user\",\"@includeLink\"],[[30,0,[\"currentUser\"]],[30,0,[\"includeLink\"]]]],null]],[],false,[\"user-info\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      this.set("includeLink", true);
      assert.ok((0, _qunitHelpers.exists)(`.username a[href="/u/${this.currentUser.username}"]`));
      this.set("includeLink", false);
      assert.notOk((0, _qunitHelpers.exists)(`.username a[href="/u/${this.currentUser.username}"]`));
    });
    (0, _qunit.test)("includeAvatar", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserInfo @user={{this.currentUser}} @includeAvatar={{this.includeAvatar}} />
      */
      {
        "id": "IIO7uoTZ",
        "block": "[[[8,[39,0],null,[[\"@user\",\"@includeAvatar\"],[[30,0,[\"currentUser\"]],[30,0,[\"includeAvatar\"]]]],null]],[],false,[\"user-info\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      this.set("includeAvatar", true);
      assert.ok((0, _qunitHelpers.exists)(".user-image"));
      this.set("includeAvatar", false);
      assert.notOk((0, _qunitHelpers.exists)(".user-image"));
    });
    (0, _qunit.test)("shows status if enabled and user has status", async function (assert) {
      this.currentUser.name = "Evil Trout";
      this.currentUser.status = {
        emoji: "tooth",
        description: "off to dentist"
      };
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserInfo @user={{this.currentUser}} @showStatus={{true}} />
      */
      {
        "id": "G7bK/gLL",
        "block": "[[[8,[39,0],null,[[\"@user\",\"@showStatus\"],[[30,0,[\"currentUser\"]],true]],null]],[],false,[\"user-info\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".user-status-message"));
    });
    (0, _qunit.test)("doesn't show status if enabled but user doesn't have status", async function (assert) {
      this.currentUser.name = "Evil Trout";
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserInfo @user={{this.currentUser}} @showStatus={{true}} />
      */
      {
        "id": "G7bK/gLL",
        "block": "[[[8,[39,0],null,[[\"@user\",\"@showStatus\"],[[30,0,[\"currentUser\"]],true]],null]],[],false,[\"user-info\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.notOk((0, _qunitHelpers.exists)(".user-status-message"));
    });
    (0, _qunit.test)("doesn't show status if disabled", async function (assert) {
      this.currentUser.name = "Evil Trout";
      this.currentUser.status = {
        emoji: "tooth",
        description: "off to dentist"
      };
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserInfo @user={{this.currentUser}} @showStatus={{false}} />
      */
      {
        "id": "xXNZcFED",
        "block": "[[[8,[39,0],null,[[\"@user\",\"@showStatus\"],[[30,0,[\"currentUser\"]],false]],null]],[],false,[\"user-info\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.notOk((0, _qunitHelpers.exists)(".user-status-message"));
    });
    (0, _qunit.test)("doesn't show status by default", async function (assert) {
      this.currentUser.name = "Evil Trout";
      this.currentUser.status = {
        emoji: "tooth",
        description: "off to dentist"
      };
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserInfo @user={{this.currentUser}} />
      */
      {
        "id": "4cLbCChU",
        "block": "[[[8,[39,0],null,[[\"@user\"],[[30,0,[\"currentUser\"]]]],null]],[],false,[\"user-info\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.notOk((0, _qunitHelpers.exists)(".user-status-message"));
    });
  });
});
define("discourse/tests/integration/components/user-menu/bookmarks-list-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/tests/fixtures/concerns/notification-types", "discourse/tests/helpers/create-pretender", "I18n"], function (_templateFactory, _qunit, _componentTest, _qunitHelpers, _testHelpers, _notificationTypes, _createPretender, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/tests/fixtures/concerns/notification-types",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/create-pretender",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | user-menu | bookmarks-list", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    const template = (0, _templateFactory.createTemplateFactory)(
    /*
      <UserMenu::BookmarksList/>
    */
    {
      "id": "FwTmIh91",
      "block": "[[[8,[39,0],null,null,null]],[],false,[\"user-menu/bookmarks-list\"]]",
      "moduleName": "(unknown template module)",
      "isStrictMode": false
    });
    (0, _qunit.test)("renders notifications on top and bookmarks on bottom", async function (assert) {
      await (0, _testHelpers.render)(template);
      const items = (0, _qunitHelpers.queryAll)("ul li");
      assert.strictEqual(items.length, 2);
      assert.ok(items[0].classList.contains("notification"));
      assert.ok(items[0].classList.contains("unread"));
      assert.ok(items[0].classList.contains("bookmark-reminder"));
      assert.ok(items[1].classList.contains("bookmark"));
    });
    (0, _qunit.test)("show all link", async function (assert) {
      await (0, _testHelpers.render)(template);
      const link = (0, _qunitHelpers.query)(".panel-body-bottom .show-all");
      assert.ok(link.href.endsWith("/u/eviltrout/activity/bookmarks"), "links to the bookmarks page");
      assert.strictEqual(link.title, _I18n.default.t("user_menu.view_all_bookmarks"), "has a title");
    });
    (0, _qunit.test)("dismiss button", async function (assert) {
      this.currentUser.set("grouped_unread_notifications", {
        [_notificationTypes.NOTIFICATION_TYPES.bookmark_reminder]: 72
      });
      await (0, _testHelpers.render)(template);
      const dismiss = (0, _qunitHelpers.query)(".panel-body-bottom .notifications-dismiss");
      assert.ok(dismiss, "dismiss button is shown if the user has unread bookmark_reminder notifications");
      assert.strictEqual(dismiss.title, _I18n.default.t("user.dismiss_bookmarks_tooltip"), "dismiss button has a title");
      this.currentUser.set("grouped_unread_notifications", {});
      await (0, _testHelpers.settled)();
      assert.notOk((0, _qunitHelpers.exists)(".panel-body-bottom .notifications-dismiss"), "dismiss button is not shown if the user no unread bookmark_reminder notifications");
    });
    (0, _qunit.test)("empty state (aka blank page syndrome)", async function (assert) {
      _createPretender.default.get("/u/eviltrout/user-menu-bookmarks", () => {
        return (0, _createPretender.response)({
          notifications: [],
          bookmarks: []
        });
      });

      await (0, _testHelpers.render)(template);
      assert.strictEqual((0, _qunitHelpers.query)(".empty-state-title").textContent.trim(), _I18n.default.t("user.no_bookmarks_title"), "empty state title is shown");
      assert.strictEqual((0, _qunitHelpers.query)(".empty-state-body").textContent.trim(), _I18n.default.t("user.no_bookmarks_body", {
        icon: ""
      }).trim(), "empty state body is shown");
      assert.ok((0, _qunitHelpers.exists)(".empty-state-body svg.d-icon-bookmark"), "icon is correctly rendered in the empty state body");
    });
  });
});
define("discourse/tests/integration/components/user-menu/menu-item-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse-common/lib/object", "discourse/tests/fixtures/concerns/notification-types", "discourse/models/notification", "discourse/models/user-menu-reviewable", "discourse/lib/plugin-api", "discourse/lib/user-menu/notification-item", "discourse/lib/user-menu/message-item", "discourse/lib/user-menu/bookmark-item", "discourse/lib/user-menu/reviewable-item", "discourse/tests/fixtures/private-messages-fixtures", "I18n"], function (_templateFactory, _qunit, _componentTest, _qunitHelpers, _testHelpers, _object, _notificationTypes, _notification, _userMenuReviewable, _pluginApi, _notificationItem, _messageItem, _bookmarkItem, _reviewableItem, _privateMessagesFixtures, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse-common/lib/object",0,"discourse/tests/fixtures/concerns/notification-types",0,"discourse/models/notification",0,"discourse/models/user-menu-reviewable",0,"ember-cli-htmlbars",0,"discourse/lib/plugin-api",0,"discourse/lib/user-menu/notification-item",0,"discourse/lib/user-menu/message-item",0,"discourse/lib/user-menu/bookmark-item",0,"discourse/lib/user-menu/reviewable-item",0,"discourse/tests/fixtures/private-messages-fixtures",0,"I18n"eaimeta@70e063a35619d71f

  function getNotification(currentUser, siteSettings, site) {
    let overrides = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};

    const notification = _notification.default.create((0, _object.deepMerge)({
      id: 11,
      user_id: 1,
      notification_type: _notificationTypes.NOTIFICATION_TYPES.mentioned,
      read: false,
      high_priority: false,
      created_at: "2022-07-01T06:00:32.173Z",
      post_number: 113,
      topic_id: 449,
      fancy_title: "This is fancy title &lt;a&gt;!",
      slug: "this-is-fancy-title",
      data: {
        topic_title: "this is title before it becomes fancy <a>!",
        display_username: "osama",
        original_post_id: 1,
        original_post_type: 1,
        original_username: "velesin"
      }
    }, overrides));

    return new _notificationItem.default({
      notification,
      currentUser,
      siteSettings,
      site
    });
  }

  (0, _qunit.module)("Integration | Component | user-menu | menu-item | with notification items", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    const template = (0, _templateFactory.createTemplateFactory)(
    /*
      <UserMenu::MenuItem @item={{this.item}}/>
    */
    {
      "id": "WvRiPlsD",
      "block": "[[[8,[39,0],null,[[\"@item\"],[[30,0,[\"item\"]]]],null]],[],false,[\"user-menu/menu-item\"]]",
      "moduleName": "(unknown template module)",
      "isStrictMode": false
    });
    (0, _qunit.test)("pushes `read` to the classList if the notification is read and `unread` if it isn't", async function (assert) {
      this.set("item", getNotification(this.currentUser, this.siteSettings, this.site));
      this.item.notification.read = false;
      await (0, _testHelpers.render)(template);
      assert.notOk((0, _qunitHelpers.exists)("li.read"));
      assert.ok((0, _qunitHelpers.exists)("li.unread"));
      this.item.notification.read = true;
      await (0, _testHelpers.settled)();
      assert.ok((0, _qunitHelpers.exists)("li.read"), "the item re-renders when the read property is updated");
      assert.notOk((0, _qunitHelpers.exists)("li.unread"), "the item re-renders when the read property is updated");
    });
    (0, _qunit.test)("pushes the notification type name to the classList", async function (assert) {
      this.set("item", getNotification(this.currentUser, this.siteSettings, this.site));
      await (0, _testHelpers.render)(template);
      let item = (0, _qunitHelpers.query)("li");
      assert.ok(item.classList.contains("mentioned"));
      this.set("item", getNotification(this.currentUser, this.siteSettings, this.site, {
        notification_type: _notificationTypes.NOTIFICATION_TYPES.private_message
      }));
      await (0, _testHelpers.settled)();
      assert.ok((0, _qunitHelpers.exists)("li.private-message"), "replaces underscores in type name with dashes");
    });
    (0, _qunit.test)("pushes is-warning to the classList if the notification originates from a warning PM", async function (assert) {
      this.set("item", getNotification(this.currentUser, this.siteSettings, this.site, {
        is_warning: true
      }));
      await (0, _testHelpers.render)(template);
      assert.ok((0, _qunitHelpers.exists)("li.is-warning"));
    });
    (0, _qunit.test)("doesn't push is-warning to the classList if the notification doesn't originate from a warning PM", async function (assert) {
      this.set("item", getNotification(this.currentUser, this.siteSettings, this.site));
      await (0, _testHelpers.render)(template);
      assert.ok(!(0, _qunitHelpers.exists)("li.is-warning"));
      assert.ok((0, _qunitHelpers.exists)("li"));
    });
    (0, _qunit.test)("the item's href links to the topic that the notification originates from", async function (assert) {
      this.set("item", getNotification(this.currentUser, this.siteSettings, this.site));
      await (0, _testHelpers.render)(template);
      const link = (0, _qunitHelpers.query)("li a");
      assert.ok(link.href.endsWith("/t/this-is-fancy-title/449/113"));
    });
    (0, _qunit.test)("the item's href links to the group messages if the notification is for a group messages", async function (assert) {
      this.set("item", getNotification(this.currentUser, this.siteSettings, this.site, {
        topic_id: null,
        post_number: null,
        slug: null,
        data: {
          group_id: 33,
          group_name: "grouperss",
          username: "ossaama"
        }
      }));
      await (0, _testHelpers.render)(template);
      const link = (0, _qunitHelpers.query)("li a");
      assert.ok(link.href.endsWith("/u/ossaama/messages/grouperss"));
    });
    (0, _qunit.test)("the item's link has a title for accessibility", async function (assert) {
      this.set("item", getNotification(this.currentUser, this.siteSettings, this.site));
      await (0, _testHelpers.render)(template);
      const link = (0, _qunitHelpers.query)("li a");
      assert.strictEqual(link.title, _I18n.default.t("notifications.titles.mentioned"));
    });
    (0, _qunit.test)("has elements for label and description", async function (assert) {
      this.set("item", getNotification(this.currentUser, this.siteSettings, this.site));
      await (0, _testHelpers.render)(template);
      const label = (0, _qunitHelpers.query)("li a .item-label");
      const description = (0, _qunitHelpers.query)("li a .item-description");
      assert.strictEqual(label.textContent.trim(), "osama", "the label's content is the username by default");
      assert.strictEqual(description.textContent.trim(), "This is fancy title <a>!", "the description defaults to the fancy_title");
    });
    (0, _qunit.test)("the description falls back to topic_title from data if fancy_title is absent", async function (assert) {
      this.set("item", getNotification(this.currentUser, this.siteSettings, this.site, {
        fancy_title: null
      }));
      await (0, _testHelpers.render)(template);
      const description = (0, _qunitHelpers.query)("li a .item-description");
      assert.strictEqual(description.textContent.trim(), "this is title before it becomes fancy <a>!", "topic_title from data is rendered safely");
    });
    (0, _qunit.test)("fancy_title is emoji-unescaped", async function (assert) {
      this.set("item", getNotification(this.currentUser, this.siteSettings, this.site, {
        fancy_title: "title with emoji :phone:"
      }));
      await (0, _testHelpers.render)(template);
      assert.ok((0, _qunitHelpers.exists)("li a .item-description img.emoji"), "emojis are unescaped when fancy_title is used for description");
    });
    (0, _qunit.test)("topic_title from data is emoji-unescaped safely", async function (assert) {
      this.set("item", getNotification(this.currentUser, this.siteSettings, this.site, {
        fancy_title: null,
        data: {
          topic_title: "unsafe title with <a> unescaped emoji :phone:"
        }
      }));
      await (0, _testHelpers.render)(template);
      const description = (0, _qunitHelpers.query)("li a .item-description");
      assert.strictEqual(description.textContent.trim(), "unsafe title with <a> unescaped emoji", "topic_title is rendered safely");
      assert.ok((0, _qunitHelpers.exists)(".item-description img.emoji"), "emoji is rendered correctly");
    });
    (0, _qunit.test)("various aspects can be customized according to the notification's render director", async function (assert) {
      (0, _pluginApi.withPluginApi)("0.1", api => {
        api.registerNotificationTypeRenderer("linked", NotificationTypeBase => {
          return class extends NotificationTypeBase {
            get classNames() {
              return ["additional", "classes"];
            }

            get linkHref() {
              return "/somewhere/awesome";
            }

            get linkTitle() {
              return "hello world this is unsafe '\"<span>";
            }

            get icon() {
              return "wrench";
            }

            get label() {
              return "notification label 666 <span>";
            }

            get description() {
              return "notification description 123 <script>";
            }

            get labelClasses() {
              return ["label-wrapper-1"];
            }

            get descriptionClasses() {
              return ["description-class-1"];
            }

          };
        });
      });
      this.set("item", getNotification(this.currentUser, this.siteSettings, this.site, {
        notification_type: _notificationTypes.NOTIFICATION_TYPES.linked
      }));
      await (0, _testHelpers.render)(template);
      assert.ok((0, _qunitHelpers.exists)("li.additional.classes"), "extra classes are included on the item");
      const link = (0, _qunitHelpers.query)("li a");
      assert.ok(link.href.endsWith("/somewhere/awesome"), "link href is customized");
      assert.strictEqual(link.title, "hello world this is unsafe '\"<span>", "link title is customized and rendered safely");
      assert.ok((0, _qunitHelpers.exists)("svg.d-icon-wrench"), "icon is customized");
      const label = (0, _qunitHelpers.query)("li .item-label");
      assert.ok(label.classList.contains("label-wrapper-1"), "label wrapper has additional classes");
      assert.strictEqual(label.textContent.trim(), "notification label 666 <span>", "label content is customized");
      const description = (0, _qunitHelpers.query)(".item-description");
      assert.ok(description.classList.contains("description-class-1"), "description has additional classes");
      assert.strictEqual(description.textContent.trim(), "notification description 123 <script>", "description content is customized");
    });
    (0, _qunit.test)("description can be omitted", async function (assert) {
      (0, _pluginApi.withPluginApi)("0.1", api => {
        api.registerNotificationTypeRenderer("linked", NotificationTypeBase => {
          return class extends NotificationTypeBase {
            get description() {
              return null;
            }

            get label() {
              return "notification label";
            }

          };
        });
      });
      this.set("item", getNotification(this.currentUser, this.siteSettings, this.site, {
        notification_type: _notificationTypes.NOTIFICATION_TYPES.linked
      }));
      await (0, _testHelpers.render)(template);
      assert.notOk((0, _qunitHelpers.exists)(".item-description"), "description is not rendered");
      assert.ok((0, _qunitHelpers.query)("li").textContent.trim(), "notification label", "only label content is displayed");
    });
    (0, _qunit.test)("label can be omitted", async function (assert) {
      (0, _pluginApi.withPluginApi)("0.1", api => {
        api.registerNotificationTypeRenderer("linked", NotificationTypeBase => {
          return class extends NotificationTypeBase {
            get label() {
              return null;
            }

            get description() {
              return "notification description";
            }

          };
        });
      });
      this.set("item", getNotification(this.currentUser, this.siteSettings, this.site, {
        notification_type: _notificationTypes.NOTIFICATION_TYPES.linked
      }));
      await (0, _testHelpers.render)(template);
      assert.ok((0, _qunitHelpers.query)("li").textContent.trim(), "notification description", "only notification description is displayed");
      assert.notOk((0, _qunitHelpers.exists)(".item-label"), "label is not rendered");
    });
  });

  function getMessage() {
    let overrides = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    const message = (0, _object.deepMerge)((0, _object.cloneJSON)(_privateMessagesFixtures.default["/topics/private-messages/eviltrout.json"].topic_list.topics[0]), overrides);
    return new _messageItem.default({
      message
    });
  }

  (0, _qunit.module)("Integration | Component | user-menu | menu-item | with message items", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    const template = (0, _templateFactory.createTemplateFactory)(
    /*
      <UserMenu::MenuItem @item={{this.item}}/>
    */
    {
      "id": "WvRiPlsD",
      "block": "[[[8,[39,0],null,[[\"@item\"],[[30,0,[\"item\"]]]],null]],[],false,[\"user-menu/menu-item\"]]",
      "moduleName": "(unknown template module)",
      "isStrictMode": false
    });
    (0, _qunit.test)("item description is the fancy title of the message", async function (assert) {
      this.set("item", getMessage({
        fancy_title: "This is a <b>safe</b> title!"
      }));
      await (0, _testHelpers.render)(template);
      assert.strictEqual((0, _qunitHelpers.query)("li.message .item-description").textContent.trim(), "This is a safe title!");
      assert.strictEqual((0, _qunitHelpers.query)("li.message .item-description b").textContent.trim(), "safe", "fancy title is not escaped");
    });
  });

  function getBookmark() {
    let overrides = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    const bookmark = (0, _object.deepMerge)({
      id: 6,
      created_at: "2022-08-05T06:09:39.559Z",
      updated_at: "2022-08-05T06:11:27.246Z",
      name: "",
      reminder_at: "2022-08-05T06:10:42.223Z",
      reminder_at_ics_start: "20220805T061042Z",
      reminder_at_ics_end: "20220805T071042Z",
      pinned: false,
      title: "Test poll topic hello world",
      fancy_title: "Test poll topic hello world",
      excerpt: "poll",
      bookmarkable_id: 1009,
      bookmarkable_type: "Post",
      bookmarkable_url: "http://localhost:4200/t/this-bookmarkable-url/227/1",
      tags: [],
      tags_descriptions: {},
      truncated: true,
      topic_id: 227,
      linked_post_number: 1,
      deleted: false,
      hidden: false,
      category_id: 1,
      closed: false,
      archived: false,
      archetype: "regular",
      highest_post_number: 45,
      last_read_post_number: 31,
      bumped_at: "2022-04-21T15:14:37.359Z",
      slug: "test-poll-topic-hello-world",
      user: {
        id: 1,
        username: "somebody",
        name: "Mr. Somebody",
        avatar_template: "/letter_avatar_proxy/v4/letter/o/f05b48/{size}.png"
      }
    }, overrides);
    return new _bookmarkItem.default({
      bookmark
    });
  }

  (0, _qunit.module)("Integration | Component | user-menu | meun-item | with bookmark items", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    const template = (0, _templateFactory.createTemplateFactory)(
    /*
      <UserMenu::MenuItem @item={{this.item}}/>
    */
    {
      "id": "WvRiPlsD",
      "block": "[[[8,[39,0],null,[[\"@item\"],[[30,0,[\"item\"]]]],null]],[],false,[\"user-menu/menu-item\"]]",
      "moduleName": "(unknown template module)",
      "isStrictMode": false
    });
    (0, _qunit.test)("uses bookmarkable_url for the href", async function (assert) {
      this.set("item", getBookmark());
      await (0, _testHelpers.render)(template);
      assert.ok((0, _qunitHelpers.query)("li.bookmark a").href.endsWith("/t/this-bookmarkable-url/227/1"));
    });
    (0, _qunit.test)("item label is the bookmarked post author", async function (assert) {
      this.set("item", getBookmark({
        user: {
          username: "bookmarkPostAuthor"
        }
      }));
      await (0, _testHelpers.render)(template);
      assert.strictEqual((0, _qunitHelpers.query)("li.bookmark .item-label").textContent.trim(), "bookmarkPostAuthor");
    });
    (0, _qunit.test)("item description is the bookmark title", async function (assert) {
      this.set("item", getBookmark({
        title: "Custom bookmark title"
      }));
      await (0, _testHelpers.render)(template);
      assert.strictEqual((0, _qunitHelpers.query)("li.bookmark .item-description").textContent.trim(), "Custom bookmark title");
    });
  });

  function getReviewable(currentUser, siteSettings, site) {
    let overrides = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};

    const reviewable = _userMenuReviewable.default.create(Object.assign({
      flagger_username: "sayo2",
      id: 17,
      pending: false,
      post_number: 3,
      topic_fancy_title: "anything hello world",
      type: "Reviewable"
    }, overrides));

    return new _reviewableItem.default({
      reviewable,
      currentUser,
      siteSettings,
      site
    });
  }

  (0, _qunit.module)("Integration | Component | user-menu | menu-item | with reviewable items", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    const template = (0, _templateFactory.createTemplateFactory)(
    /*
      <UserMenu::MenuItem @item={{this.item}}/>
    */
    {
      "id": "WvRiPlsD",
      "block": "[[[8,[39,0],null,[[\"@item\"],[[30,0,[\"item\"]]]],null]],[],false,[\"user-menu/menu-item\"]]",
      "moduleName": "(unknown template module)",
      "isStrictMode": false
    });
    (0, _qunit.test)("doesn't push `reviewed` to the classList if the reviewable is pending", async function (assert) {
      this.set("item", getReviewable(this.currentUser, this.siteSettings, this.site, {
        pending: true
      }));
      await (0, _testHelpers.render)(template);
      assert.ok(!(0, _qunitHelpers.exists)("li.reviewed"));
      assert.ok((0, _qunitHelpers.exists)("li"));
    });
    (0, _qunit.test)("pushes `reviewed` to the classList if the reviewable isn't pending", async function (assert) {
      this.set("item", getReviewable(this.currentUser, this.siteSettings, this.site, {
        pending: false
      }));
      await (0, _testHelpers.render)(template);
      assert.ok((0, _qunitHelpers.exists)("li.reviewed"));
    });
    (0, _qunit.test)("has elements for label and description", async function (assert) {
      this.set("item", getReviewable(this.currentUser, this.siteSettings, this.site));
      await (0, _testHelpers.render)(template);
      const label = (0, _qunitHelpers.query)("li .item-label");
      const description = (0, _qunitHelpers.query)("li .item-description");
      assert.strictEqual(label.textContent.trim(), "sayo2", "the label is the flagger_username");
      assert.strictEqual(description.textContent.trim(), _I18n.default.t("user_menu.reviewable.default_item", {
        reviewable_id: this.item.reviewable.id
      }), "displays the description for the reviewable");
    });
    (0, _qunit.test)("the item's label is a placeholder that indicates deleted user if flagger_username is absent", async function (assert) {
      this.set("item", getReviewable(this.currentUser, this.siteSettings, this.site, {
        flagger_username: null
      }));
      await (0, _testHelpers.render)(template);
      const label = (0, _qunitHelpers.query)("li .item-label");
      assert.strictEqual(label.textContent.trim(), _I18n.default.t("user_menu.reviewable.deleted_user"));
    });
  });
});
define("discourse/tests/integration/components/user-menu/menu-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/tests/fixtures/concerns/notification-types", "discourse/tests/helpers/create-pretender"], function (_templateFactory, _qunit, _componentTest, _qunitHelpers, _testHelpers, _notificationTypes, _createPretender) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/tests/fixtures/concerns/notification-types",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/create-pretender"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | user-menu", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    const template = (0, _templateFactory.createTemplateFactory)(
    /*
      <UserMenu::Menu/>
    */
    {
      "id": "E3nbU4cz",
      "block": "[[[8,[39,0],null,null,null]],[],false,[\"user-menu/menu\"]]",
      "moduleName": "(unknown template module)",
      "isStrictMode": false
    });
    (0, _qunit.test)("default tab is all notifications", async function (assert) {
      await (0, _testHelpers.render)(template);
      const activeTab = (0, _qunitHelpers.query)(".top-tabs.tabs-list .btn.active");
      assert.strictEqual(activeTab.id, "user-menu-button-all-notifications");
      const notifications = (0, _qunitHelpers.queryAll)("#quick-access-all-notifications ul li");
      assert.ok(notifications[0].classList.contains("edited"));
      assert.ok(notifications[1].classList.contains("replied"));
      assert.ok(notifications[2].classList.contains("liked-consolidated"));
    });
    (0, _qunit.test)("notifications panel has a11y attributes", async function (assert) {
      await (0, _testHelpers.render)(template);
      const panel = (0, _qunitHelpers.query)("#quick-access-all-notifications");
      assert.strictEqual(panel.getAttribute("tabindex"), "-1");
      assert.strictEqual(panel.getAttribute("aria-labelledby"), "user-menu-button-all-notifications");
    });
    (0, _qunit.test)("active tab has a11y attributes that indicate it's active", async function (assert) {
      await (0, _testHelpers.render)(template);
      const activeTab = (0, _qunitHelpers.query)(".top-tabs.tabs-list .btn.active");
      assert.strictEqual(activeTab.getAttribute("tabindex"), "0");
      assert.strictEqual(activeTab.getAttribute("aria-selected"), "true");
    });
    (0, _qunit.test)("inactive tab has a11y attributes that indicate it's inactive", async function (assert) {
      await (0, _testHelpers.render)(template);
      const inactiveTab = (0, _qunitHelpers.query)(".top-tabs.tabs-list .btn:not(.active)");
      assert.strictEqual(inactiveTab.getAttribute("tabindex"), "-1");
      assert.strictEqual(inactiveTab.getAttribute("aria-selected"), "false");
    });
    (0, _qunit.test)("the menu has a group of tabs at the top", async function (assert) {
      await (0, _testHelpers.render)(template);
      const tabs = (0, _qunitHelpers.queryAll)(".top-tabs.tabs-list .btn");
      assert.strictEqual(tabs.length, 7);
      ["all-notifications", "replies", "mentions", "likes", "messages", "bookmarks"].forEach((tab, index) => {
        assert.strictEqual(tabs[index].id, `user-menu-button-${tab}`);
        assert.strictEqual(tabs[index].dataset.tabNumber, index.toString());
        assert.strictEqual(tabs[index].getAttribute("aria-controls"), `quick-access-${tab}`);
      });
    });
    (0, _qunit.test)("the menu has a group of tabs at the bottom", async function (assert) {
      await (0, _testHelpers.render)(template);
      const tabs = (0, _qunitHelpers.queryAll)(".bottom-tabs.tabs-list .btn");
      assert.strictEqual(tabs.length, 1);
      const profileTab = tabs[0];
      assert.strictEqual(profileTab.id, "user-menu-button-profile");
      assert.strictEqual(profileTab.dataset.tabNumber, "7");
      assert.strictEqual(profileTab.getAttribute("tabindex"), "-1");
    });
    (0, _qunit.test)("likes tab is hidden if current user's like notifications frequency is 'never'", async function (assert) {
      this.currentUser.set("likes_notifications_disabled", true);
      await (0, _testHelpers.render)(template);
      assert.ok(!(0, _qunitHelpers.exists)("#user-menu-button-likes"));
      const tabs = Array.from((0, _qunitHelpers.queryAll)(".tabs-list .btn")); // top and bottom tabs

      assert.strictEqual(tabs.length, 7);
      assert.deepEqual(tabs.map(t => t.dataset.tabNumber), ["0", "1", "2", "3", "4", "5", "6"], "data-tab-number of the tabs has no gaps when the likes tab is hidden");
    });
    (0, _qunit.test)("reviewables tab is shown if current user can review", async function (assert) {
      this.currentUser.set("can_review", true);
      await (0, _testHelpers.render)(template);
      const tab = (0, _qunitHelpers.query)("#user-menu-button-review-queue");
      assert.strictEqual(tab.dataset.tabNumber, "6");
      const tabs = Array.from((0, _qunitHelpers.queryAll)(".tabs-list .btn")); // top and bottom tabs

      assert.strictEqual(tabs.length, 9);
      assert.deepEqual(tabs.map(t => t.dataset.tabNumber), ["0", "1", "2", "3", "4", "5", "6", "7", "8"], "data-tab-number of the tabs has no gaps when the reviewables tab is show");
    });
    (0, _qunit.test)("messages tab isn't shown if current user isn't staff and enable_personal_messages setting is disabled", async function (assert) {
      this.currentUser.set("moderator", false);
      this.currentUser.set("admin", false);
      this.siteSettings.enable_personal_messages = false;
      await (0, _testHelpers.render)(template);
      assert.ok(!(0, _qunitHelpers.exists)("#user-menu-button-messages"));
      const tabs = Array.from((0, _qunitHelpers.queryAll)(".tabs-list .btn")); // top and bottom tabs

      assert.strictEqual(tabs.length, 7);
      assert.deepEqual(tabs.map(t => t.dataset.tabNumber), ["0", "1", "2", "3", "4", "5", "6"], "data-tab-number of the tabs has no gaps when the messages tab is hidden");
    });
    (0, _qunit.test)("messages tab is shown if current user is staff even if enable_personal_messages setting is disabled", async function (assert) {
      this.currentUser.set("moderator", true);
      this.currentUser.set("admin", false);
      this.siteSettings.enable_personal_messages = false;
      await (0, _testHelpers.render)(template);
      assert.ok((0, _qunitHelpers.exists)("#user-menu-button-messages"));
    });
    (0, _qunit.test)("reviewables count is shown on the reviewables tab", async function (assert) {
      this.currentUser.set("can_review", true);
      this.currentUser.set("reviewable_count", 4);
      await (0, _testHelpers.render)(template);
      const countBadge = (0, _qunitHelpers.query)("#user-menu-button-review-queue .badge-notification");
      assert.strictEqual(countBadge.textContent, "4");
      this.currentUser.set("reviewable_count", 0);
      await (0, _testHelpers.settled)();
      assert.ok(!(0, _qunitHelpers.exists)("#user-menu-button-review-queue .badge-notification"));
    });
    (0, _qunit.test)("changing tabs", async function (assert) {
      this.currentUser.set("can_review", true);
      await (0, _testHelpers.render)(template);
      let queryParams;

      _createPretender.default.get("/notifications", request => {
        queryParams = request.queryParams;
        let data;

        if (queryParams.filter_by_types === "mentioned") {
          data = [{
            id: 6,
            user_id: 1,
            notification_type: _notificationTypes.NOTIFICATION_TYPES.mentioned,
            read: true,
            high_priority: false,
            created_at: "2021-11-25T19:31:13.241Z",
            post_number: 6,
            topic_id: 10,
            fancy_title: "Greetings!",
            slug: "greetings",
            data: {
              topic_title: "Greetings!",
              original_post_id: 20,
              original_post_type: 1,
              original_username: "discobot",
              revision_number: null,
              display_username: "discobot"
            }
          }];
        } else if (queryParams.filter_by_types === "liked,liked_consolidated,reaction") {
          data = [{
            id: 60,
            user_id: 1,
            notification_type: _notificationTypes.NOTIFICATION_TYPES.liked,
            read: true,
            high_priority: false,
            created_at: "2021-11-25T19:31:13.241Z",
            post_number: 6,
            topic_id: 10,
            fancy_title: "Greetings!",
            slug: "greetings",
            data: {
              topic_title: "Greetings!",
              original_post_id: 20,
              original_post_type: 1,
              original_username: "discobot",
              revision_number: null,
              display_username: "discobot"
            }
          }, {
            id: 63,
            user_id: 1,
            notification_type: _notificationTypes.NOTIFICATION_TYPES.liked,
            read: true,
            high_priority: false,
            created_at: "2021-11-25T19:31:13.241Z",
            post_number: 6,
            topic_id: 10,
            fancy_title: "Greetings!",
            slug: "greetings",
            data: {
              topic_title: "Greetings!",
              original_post_id: 20,
              original_post_type: 1,
              original_username: "discobot",
              revision_number: null,
              display_username: "discobot"
            }
          }, {
            id: 20,
            user_id: 1,
            notification_type: _notificationTypes.NOTIFICATION_TYPES.liked_consolidated,
            read: true,
            high_priority: false,
            created_at: "2021-11-25T19:31:13.241Z",
            post_number: 6,
            topic_id: 10,
            fancy_title: "Greetings 123!",
            slug: "greetings 123",
            data: {
              topic_title: "Greetings 123!",
              original_post_id: 20,
              original_post_type: 1,
              original_username: "discobot",
              revision_number: null,
              display_username: "discobot"
            }
          }];
        } else {
          throw new Error(`unexpected notification type ${queryParams.filter_by_types}`);
        }

        return [200, {
          "Content-Type": "application/json"
        }, {
          notifications: data
        }];
      });

      await (0, _testHelpers.click)("#user-menu-button-mentions");
      assert.ok((0, _qunitHelpers.exists)("#quick-access-mentions.quick-access-panel"));
      assert.strictEqual(queryParams.filter_by_types, "mentioned", "request params has filter_by_types set to `mentioned`");
      assert.strictEqual(queryParams.silent, "true");
      let activeTabs = (0, _qunitHelpers.queryAll)(".top-tabs .btn.active");
      assert.strictEqual(activeTabs.length, 1);
      assert.strictEqual(activeTabs[0].id, "user-menu-button-mentions", "active tab is now the mentions tab");
      assert.strictEqual((0, _qunitHelpers.queryAll)("#quick-access-mentions ul li").length, 1);
      await (0, _testHelpers.click)("#user-menu-button-likes");
      assert.ok((0, _qunitHelpers.exists)("#quick-access-likes.quick-access-panel"));
      assert.strictEqual(queryParams.filter_by_types, "liked,liked_consolidated,reaction", "request params has filter_by_types set to `liked`, `liked_consolidated` and `reaction`");
      assert.strictEqual(queryParams.silent, "true");
      activeTabs = (0, _qunitHelpers.queryAll)(".top-tabs .btn.active");
      assert.strictEqual(activeTabs.length, 1);
      assert.strictEqual(activeTabs[0].id, "user-menu-button-likes", "active tab is now the likes tab");
      assert.strictEqual((0, _qunitHelpers.queryAll)("#quick-access-likes ul li").length, 3);
      await (0, _testHelpers.click)("#user-menu-button-review-queue");
      assert.ok((0, _qunitHelpers.exists)("#quick-access-review-queue.quick-access-panel"));
      activeTabs = (0, _qunitHelpers.queryAll)(".top-tabs .btn.active");
      assert.strictEqual(activeTabs.length, 1);
      assert.strictEqual(activeTabs[0].id, "user-menu-button-review-queue", "active tab is now the reviewables tab");
      assert.strictEqual((0, _qunitHelpers.queryAll)("#quick-access-review-queue ul li").length, 8);
    });
  });
});
define("discourse/tests/integration/components/user-menu/messages-list-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse/tests/fixtures/concerns/notification-types", "discourse/tests/helpers/create-pretender", "I18n"], function (_templateFactory, _qunit, _componentTest, _qunitHelpers, _testHelpers, _notificationTypes, _createPretender, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse/tests/fixtures/concerns/notification-types",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/create-pretender",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | user-menu | messages-list", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    const template = (0, _templateFactory.createTemplateFactory)(
    /*
      <UserMenu::MessagesList/>
    */
    {
      "id": "Na6BHOnm",
      "block": "[[[8,[39,0],null,null,null]],[],false,[\"user-menu/messages-list\"]]",
      "moduleName": "(unknown template module)",
      "isStrictMode": false
    });
    (0, _qunit.test)("renders notifications on top and messages on bottom", async function (assert) {
      await (0, _testHelpers.render)(template);
      const items = (0, _qunitHelpers.queryAll)("ul li");
      assert.strictEqual(items.length, 2);
      assert.ok(items[0].classList.contains("notification"));
      assert.ok(items[0].classList.contains("unread"));
      assert.ok(items[0].classList.contains("private-message"));
      assert.ok(items[1].classList.contains("message"));
    });
    (0, _qunit.test)("show all link", async function (assert) {
      await (0, _testHelpers.render)(template);
      const link = (0, _qunitHelpers.query)(".panel-body-bottom .show-all");
      assert.ok(link.href.endsWith("/u/eviltrout/messages"), "links to the user's messages page");
      assert.strictEqual(link.title, _I18n.default.t("user_menu.view_all_messages"), "has a title");
    });
    (0, _qunit.test)("dismiss button", async function (assert) {
      this.currentUser.set("grouped_unread_notifications", {
        [_notificationTypes.NOTIFICATION_TYPES.private_message]: 72
      });
      await (0, _testHelpers.render)(template);
      const dismiss = (0, _qunitHelpers.query)(".panel-body-bottom .notifications-dismiss");
      assert.ok(dismiss, "dismiss button is shown if the user has unread private_message notifications");
      assert.strictEqual(dismiss.title, _I18n.default.t("user.dismiss_messages_tooltip"), "dismiss button has a title");
      this.currentUser.set("grouped_unread_notifications", {});
      await (0, _testHelpers.settled)();
      assert.notOk((0, _qunitHelpers.exists)(".panel-body-bottom .notifications-dismiss"), "dismiss button is not shown if the user no unread private_message notifications");
    });
    (0, _qunit.test)("empty state (aka blank page syndrome)", async function (assert) {
      _createPretender.default.get("/u/eviltrout/user-menu-private-messages", () => {
        return (0, _createPretender.response)({
          notifications: [],
          topics: []
        });
      });

      await (0, _testHelpers.render)(template);
      assert.strictEqual((0, _qunitHelpers.query)(".empty-state-title").textContent.trim(), _I18n.default.t("user.no_messages_title"), "empty state title is shown");
      assert.ok((0, _qunitHelpers.exists)(".empty-state-body svg.d-icon-envelope"), "icon is correctly rendered in the empty state body");
      const emptyStateBodyLink = (0, _qunitHelpers.query)(".empty-state-body a");
      assert.ok(emptyStateBodyLink.href.endsWith("/about"), "link inside empty state body is rendered");
    });
  });
});
define("discourse/tests/integration/components/user-menu/notifications-list-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "discourse-common/lib/object", "discourse/tests/fixtures/notification-fixtures", "discourse/tests/helpers/create-pretender", "I18n"], function (_templateFactory, _qunit, _componentTest, _qunitHelpers, _testHelpers, _object, _notificationFixtures, _createPretender, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"discourse-common/lib/object",0,"discourse/tests/fixtures/notification-fixtures",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/create-pretender",0,"I18n"eaimeta@70e063a35619d71f

  function getNotificationsData() {
    return (0, _object.cloneJSON)(_notificationFixtures.default["/notifications"].notifications);
  }

  (0, _qunit.module)("Integration | Component | user-menu | notifications-list", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    let notificationsData = getNotificationsData();
    let queryParams = null;
    let markRead = false;
    let notificationsFetches = 0;
    hooks.beforeEach(() => {
      _createPretender.default.get("/notifications", request => {
        queryParams = request.queryParams;
        notificationsFetches++;
        return (0, _createPretender.response)({
          notifications: notificationsData
        });
      });

      _createPretender.default.put("/notifications/mark-read", () => {
        markRead = true;
        return (0, _createPretender.response)({
          success: true
        });
      });
    });
    hooks.afterEach(() => {
      notificationsData = getNotificationsData();
      queryParams = null;
      markRead = false;
      notificationsFetches = 0;
    });
    const template = (0, _templateFactory.createTemplateFactory)(
    /*
      <UserMenu::NotificationsList/>
    */
    {
      "id": "vUFSwouy",
      "block": "[[[8,[39,0],null,null,null]],[],false,[\"user-menu/notifications-list\"]]",
      "moduleName": "(unknown template module)",
      "isStrictMode": false
    });
    (0, _qunit.test)("empty state when there are no notifications", async function (assert) {
      notificationsData.clear();
      await (0, _testHelpers.render)(template);
      assert.ok((0, _qunitHelpers.exists)(".empty-state .empty-state-title"));
      assert.ok((0, _qunitHelpers.exists)(".empty-state .empty-state-body"));
    });
    (0, _qunit.test)("doesn't set filter_by_types in the params of the request that fetches the notifications", async function (assert) {
      await (0, _testHelpers.render)(template);
      assert.strictEqual(queryParams.filter_by_types, undefined, "filter_by_types param is absent");
    });
    (0, _qunit.test)("doesn't request the full notifications list in silent mode", async function (assert) {
      await (0, _testHelpers.render)(template);
      assert.strictEqual(queryParams.silent, undefined);
    });
    (0, _qunit.test)("displays a show all button that takes to the notifications page of the current user", async function (assert) {
      await (0, _testHelpers.render)(template);
      const showAllBtn = (0, _qunitHelpers.query)(".panel-body-bottom .btn.show-all");
      assert.ok(showAllBtn.href.endsWith("/u/eviltrout/notifications"), "it takes you to the notifications page");
      assert.strictEqual(showAllBtn.getAttribute("title"), _I18n.default.t("user_menu.view_all_notifications"), "title attribute is present");
    });
    (0, _qunit.test)("has a dismiss button if some notifications are not read", async function (assert) {
      notificationsData.forEach(notification => {
        notification.read = true;
      });
      notificationsData[0].read = false;
      await (0, _testHelpers.render)(template);
      const dismissButton = (0, _qunitHelpers.query)(".panel-body-bottom .btn.notifications-dismiss");
      assert.strictEqual(dismissButton.textContent.trim(), _I18n.default.t("user.dismiss"), "dismiss button has a label");
      assert.strictEqual(dismissButton.getAttribute("title"), _I18n.default.t("user.dismiss_notifications_tooltip"), "dismiss button has title attribute");
    });
    (0, _qunit.test)("doesn't have a dismiss button if all notifications are read", async function (assert) {
      notificationsData.forEach(notification => {
        notification.read = true;
      });
      await (0, _testHelpers.render)(template);
      assert.ok(!(0, _qunitHelpers.exists)(".panel-body-bottom .btn.notifications-dismiss"));
    });
    (0, _qunit.test)("dismiss button makes a request to the server and then refreshes the notifications list", async function (assert) {
      await (0, _testHelpers.render)(template);
      notificationsData = getNotificationsData();
      notificationsData.forEach(notification => {
        notification.read = true;
      });
      assert.strictEqual(notificationsFetches, 1);
      await (0, _testHelpers.click)(".panel-body-bottom .btn.notifications-dismiss");
      assert.ok(markRead, "request to the server is made");
      assert.strictEqual(notificationsFetches, 2, "notifications list is refreshed");
      assert.ok(!(0, _qunitHelpers.exists)(".panel-body-bottom .btn.notifications-dismiss"), "dismiss button is not shown");
    });
  });
});
define("discourse/tests/integration/components/user-menu/reviewables-list-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "discourse/tests/helpers/qunit-helpers", "@ember/test-helpers", "I18n"], function (_templateFactory, _qunit, _componentTest, _qunitHelpers, _testHelpers, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers",0,"ember-cli-htmlbars",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | user-menu | reviewables-list", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    const template = (0, _templateFactory.createTemplateFactory)(
    /*
      <UserMenu::ReviewablesList/>
    */
    {
      "id": "HLmHxg0l",
      "block": "[[[8,[39,0],null,null,null]],[],false,[\"user-menu/reviewables-list\"]]",
      "moduleName": "(unknown template module)",
      "isStrictMode": false
    });
    (0, _qunit.test)("has a 'show all' link", async function (assert) {
      await (0, _testHelpers.render)(template);
      const showAll = (0, _qunitHelpers.query)(".panel-body-bottom a.show-all");
      assert.ok(showAll.href.endsWith("/review"), "links to the /review page");
      assert.strictEqual(showAll.title, _I18n.default.t("user_menu.reviewable.view_all"), "the 'show all' link has a title");
    });
    (0, _qunit.test)("renders a list of reviewables", async function (assert) {
      await (0, _testHelpers.render)(template);
      const reviewables = (0, _qunitHelpers.queryAll)("ul li");
      assert.strictEqual(reviewables.length, 8);
    });
  });
});
define("discourse/tests/integration/components/user-selector-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  function paste(element, text) {
    let e = new Event("paste");
    e.clipboardData = {
      getData: () => text
    };
    element.dispatchEvent(e);
  }

  (0, _qunit.module)("Integration | Component | user-selector", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("pasting a list of usernames", async function (assert) {
      this.set("usernames", "evil,trout");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserSelector @usernames={{this.usernames}} class="test-selector" />
      */
      {
        "id": "0jJm8vOk",
        "block": "[[[8,[39,0],[[24,0,\"test-selector\"]],[[\"@usernames\"],[[30,0,[\"usernames\"]]]],null]],[],false,[\"user-selector\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      let element = (0, _qunitHelpers.query)(".test-selector");
      assert.strictEqual(this.get("usernames"), "evil,trout");
      paste(element, "zip,zap,zoom");
      assert.strictEqual(this.get("usernames"), "evil,trout,zip,zap,zoom");
      paste(element, "evil,abc,abc,abc");
      assert.strictEqual(this.get("usernames"), "evil,trout,zip,zap,zoom,abc");
      this.set("usernames", "");
      paste(element, "names with spaces");
      assert.strictEqual(this.get("usernames"), "names,with,spaces");
      this.set("usernames", null);
      paste(element, "@eviltrout,@codinghorror sam");
      assert.strictEqual(this.get("usernames"), "eviltrout,codinghorror,sam");
      this.set("usernames", null);
      paste(element, "eviltrout\nsam\ncodinghorror");
      assert.strictEqual(this.get("usernames"), "eviltrout,sam,codinghorror");
    });
    (0, _qunit.test)("excluding usernames", async function (assert) {
      this.set("usernames", "mark");
      this.set("excludedUsernames", ["jeff", "sam", "robin"]);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserSelector @usernames={{this.usernames}} @excludedUsernames={{this.excludedUsernames}} class="test-selector" />
      */
      {
        "id": "LOklS2bM",
        "block": "[[[8,[39,0],[[24,0,\"test-selector\"]],[[\"@usernames\",\"@excludedUsernames\"],[[30,0,[\"usernames\"]],[30,0,[\"excludedUsernames\"]]]],null]],[],false,[\"user-selector\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      let element = (0, _qunitHelpers.query)(".test-selector");
      paste(element, "roman,penar,jeff,robin");
      assert.strictEqual(this.get("usernames"), "mark,roman,penar");
    });
  });
});
define("discourse/tests/integration/components/user-status-message-test", ["@ember/template-factory", "qunit", "@ember/test-helpers", "discourse/tests/helpers/component-test", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _testHelpers, _componentTest, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"@ember/test-helpers",0,"discourse/tests/helpers/component-test",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/qunit-helpers"eaimeta@70e063a35619d71f

  async function mouseenter() {
    await (0, _testHelpers.triggerEvent)((0, _qunitHelpers.query)(".user-status-message"), "mouseenter");
  }

  (0, _qunit.module)("Integration | Component | user-status-message", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      this.currentUser.timezone = "UTC";
    });
    hooks.afterEach(function () {
      if (this.clock) {
        this.clock.restore();
      }
    });
    (0, _qunit.test)("it renders user status emoji", async function (assert) {
      this.set("status", {
        emoji: "tooth",
        description: "off to dentist"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserStatusMessage @status={{this.status}} />
      */
      {
        "id": "8ow1uxxQ",
        "block": "[[[8,[39,0],null,[[\"@status\"],[[30,0,[\"status\"]]]],null]],[],false,[\"user-status-message\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("img.emoji[alt='tooth']"), "the status emoji is shown");
    });
    (0, _qunit.test)("it doesn't render status description by default", async function (assert) {
      this.set("status", {
        emoji: "tooth",
        description: "off to dentist"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserStatusMessage @status={{this.status}} />
      */
      {
        "id": "8ow1uxxQ",
        "block": "[[[8,[39,0],null,[[\"@status\"],[[30,0,[\"status\"]]]],null]],[],false,[\"user-status-message\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.notOk((0, _qunitHelpers.exists)(".user-status-message-description"));
    });
    (0, _qunit.test)("it renders status description if enabled", async function (assert) {
      this.set("status", {
        emoji: "tooth",
        description: "off to dentist"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <UserStatusMessage
             @status={{this.status}}
             @showDescription=true/>
          
      */
      {
        "id": "38kbRG39",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@status\",\"@showDescription\"],[[30,0,[\"status\"]],\"true\"]],null],[1,\"\\n    \"]],[],false,[\"user-status-message\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.equal((0, _qunitHelpers.query)(".user-status-message-description").innerText.trim(), "off to dentist");
    });
    (0, _qunit.test)("it shows the until TIME on the tooltip if status will expire today", async function (assert) {
      this.clock = (0, _qunitHelpers.fakeTime)("2100-02-01T08:00:00.000Z", this.currentUser.timezone, true);
      this.set("status", {
        emoji: "tooth",
        description: "off to dentist",
        ends_at: "2100-02-01T12:30:00.000Z"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserStatusMessage @status={{this.status}} />
      */
      {
        "id": "8ow1uxxQ",
        "block": "[[[8,[39,0],null,[[\"@status\"],[[30,0,[\"status\"]]]],null]],[],false,[\"user-status-message\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await mouseenter();
      assert.equal(document.querySelector("[data-tippy-root] .user-status-tooltip-until").textContent.trim(), "Until: 12:30 PM");
    });
    (0, _qunit.test)("it shows the until DATE on the tooltip if status will expire tomorrow", async function (assert) {
      this.clock = (0, _qunitHelpers.fakeTime)("2100-02-01T08:00:00.000Z", this.currentUser.timezone, true);
      this.set("status", {
        emoji: "tooth",
        description: "off to dentist",
        ends_at: "2100-02-02T12:30:00.000Z"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserStatusMessage @status={{this.status}} />
      */
      {
        "id": "8ow1uxxQ",
        "block": "[[[8,[39,0],null,[[\"@status\"],[[30,0,[\"status\"]]]],null]],[],false,[\"user-status-message\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await mouseenter();
      assert.equal(document.querySelector("[data-tippy-root] .user-status-tooltip-until").textContent.trim(), "Until: Feb 2");
    });
    (0, _qunit.test)("it doesn't show until datetime on the tooltip if status doesn't have expiration date", async function (assert) {
      this.clock = (0, _qunitHelpers.fakeTime)("2100-02-01T08:00:00.000Z", this.currentUser.timezone, true);
      this.set("status", {
        emoji: "tooth",
        description: "off to dentist",
        ends_at: null
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserStatusMessage @status={{this.status}} />
      */
      {
        "id": "8ow1uxxQ",
        "block": "[[[8,[39,0],null,[[\"@status\"],[[30,0,[\"status\"]]]],null]],[],false,[\"user-status-message\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await mouseenter();
      assert.notOk(document.querySelector("[data-tippy-root] .user-status-tooltip-until"));
    });
    (0, _qunit.test)("it shows tooltip by default", async function (assert) {
      this.set("status", {
        emoji: "tooth",
        description: "off to dentist"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserStatusMessage @status={{this.status}} />
      */
      {
        "id": "8ow1uxxQ",
        "block": "[[[8,[39,0],null,[[\"@status\"],[[30,0,[\"status\"]]]],null]],[],false,[\"user-status-message\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await mouseenter();
      assert.ok(document.querySelector("[data-tippy-root] .user-status-message-tooltip"));
    });
    (0, _qunit.test)("it doesn't show tooltip if disabled", async function (assert) {
      this.set("status", {
        emoji: "tooth",
        description: "off to dentist"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <UserStatusMessage @status={{this.status}} @showTooltip={{false}} />
      */
      {
        "id": "2huBrwcV",
        "block": "[[[8,[39,0],null,[[\"@status\",\"@showTooltip\"],[[30,0,[\"status\"]],false]],null]],[],false,[\"user-status-message\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await mouseenter();
      assert.notOk(document.querySelector("[data-tippy-root] .user-status-message-tooltip"));
    });
  });
});
define("discourse/tests/integration/components/value-list-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/select-kit-helper"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _selectKitHelper) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/select-kit-helper"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | value-list", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("adding a value", async function (assert) {
      this.set("values", "vinkas\nosama");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <ValueList @values={{this.values}} />
      */
      {
        "id": "RurwWpNZ",
        "block": "[[[8,[39,0],null,[[\"@values\"],[[30,0,[\"values\"]]]],null]],[],false,[\"value-list\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _selectKitHelper.default)().expand();
      await (0, _selectKitHelper.default)().fillInFilter("eviltrout");
      await (0, _selectKitHelper.default)().keyboard("Enter");
      assert.strictEqual((0, _qunitHelpers.count)(".values .value"), 3, "it adds the value to the list of values");
      assert.strictEqual(this.values, "vinkas\nosama\neviltrout", "it adds the value to the list of values");
    });
    (0, _qunit.test)("changing a value", async function (assert) {
      this.set("values", "vinkas\nosama");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <ValueList @values={{this.values}} />
      */
      {
        "id": "RurwWpNZ",
        "block": "[[[8,[39,0],null,[[\"@values\"],[[30,0,[\"values\"]]]],null]],[],false,[\"value-list\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.fillIn)(".values .value[data-index='1'] .value-input", "jarek");
      await (0, _testHelpers.blur)(".values .value[data-index='1'] .value-input");
      assert.strictEqual((0, _qunitHelpers.query)(".values .value[data-index='1'] .value-input").value, "jarek");
      assert.deepEqual(this.values, "vinkas\njarek", "updates the value list");
    });
    (0, _qunit.test)("removing a value", async function (assert) {
      this.set("values", "vinkas\nosama");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <ValueList @values={{this.values}} />
      */
      {
        "id": "RurwWpNZ",
        "block": "[[[8,[39,0],null,[[\"@values\"],[[30,0,[\"values\"]]]],null]],[],false,[\"value-list\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".values .value[data-index='0'] .remove-value-btn");
      assert.strictEqual((0, _qunitHelpers.count)(".values .value"), 1, "it removes the value from the list of values");
      assert.strictEqual(this.values, "osama", "it removes the expected value");
      await (0, _selectKitHelper.default)().expand();
      assert.strictEqual((0, _qunitHelpers.query)(".select-kit-collection li.select-kit-row span.name").innerText, "vinkas", "it adds the removed value to choices");
    });
    (0, _qunit.test)("selecting a value", async function (assert) {
      this.setProperties({
        values: "vinkas\nosama",
        choices: ["maja", "michael"]
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <ValueList @values={{this.values}} @choices={{this.choices}} />
      */
      {
        "id": "QgFXYc7F",
        "block": "[[[8,[39,0],null,[[\"@values\",\"@choices\"],[[30,0,[\"values\"]],[30,0,[\"choices\"]]]],null]],[],false,[\"value-list\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _selectKitHelper.default)().expand();
      await (0, _selectKitHelper.default)().selectRowByValue("maja");
      assert.strictEqual((0, _qunitHelpers.count)(".values .value"), 3, "it adds the value to the list of values");
      assert.strictEqual(this.values, "vinkas\nosama\nmaja", "it adds the value to the list of values");
    });
    (0, _qunit.test)("array support", async function (assert) {
      this.set("values", ["vinkas", "osama"]);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <ValueList @values={{this.values}} @inputType="array" />
      */
      {
        "id": "T1+w4IHT",
        "block": "[[[8,[39,0],null,[[\"@values\",\"@inputType\"],[[30,0,[\"values\"]],\"array\"]],null]],[],false,[\"value-list\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      this.set("values", ["vinkas", "osama"]);
      await (0, _selectKitHelper.default)().expand();
      await (0, _selectKitHelper.default)().fillInFilter("eviltrout");
      await (0, _selectKitHelper.default)().selectRowByValue("eviltrout");
      assert.strictEqual((0, _qunitHelpers.count)(".values .value"), 3, "it adds the value to the list of values");
      assert.deepEqual(this.values, ["vinkas", "osama", "eviltrout"], "it adds the value to the list of values");
    });
    (0, _qunit.test)("delimiter support", async function (assert) {
      this.set("values", "vinkas|osama");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <ValueList @values={{this.values}} @inputDelimiter="|" />
      */
      {
        "id": "edQOafA9",
        "block": "[[[8,[39,0],null,[[\"@values\",\"@inputDelimiter\"],[[30,0,[\"values\"]],\"|\"]],null]],[],false,[\"value-list\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _selectKitHelper.default)().expand();
      await (0, _selectKitHelper.default)().fillInFilter("eviltrout");
      await (0, _selectKitHelper.default)().keyboard("Enter");
      assert.strictEqual((0, _qunitHelpers.count)(".values .value"), 3, "it adds the value to the list of values");
      assert.strictEqual(this.values, "vinkas|osama|eviltrout", "it adds the value to the list of values");
    });
  });
});
define("discourse/tests/integration/components/watched-word-uploader-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/create-pretender"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _createPretender) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/create-pretender"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | watched-word-uploader", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      _createPretender.default.post("/admin/customize/watched_words/upload.json", function () {
        return (0, _createPretender.response)(200, {});
      });
    });
    (0, _qunit.test)("sets the proper action key on uploads", async function (assert) {
      const done = assert.async();
      this.set("actionNameKey", "flag");
      this.set("doneUpload", function () {
        assert.strictEqual(Object.entries(this._uppyInstance.getState().files)[0][1].meta.action_key, "flag");
        done();
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <WatchedWordUploader
              @id="watched-word-uploader"
              @actionKey={{this.actionNameKey}}
              @done={{this.doneUpload}}
            />
          
      */
      {
        "id": "j3ztd7NS",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@id\",\"@actionKey\",\"@done\"],[\"watched-word-uploader\",[30,0,[\"actionNameKey\"]],[30,0,[\"doneUpload\"]]]],null],[1,\"\\n    \"]],[],false,[\"watched-word-uploader\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const words = (0, _qunitHelpers.createFile)("watched-words.txt");
      await this.container.lookup("service:app-events").trigger("upload-mixin:watched-word-uploader:add-files", words);
      await (0, _testHelpers.waitFor)(".bootbox span.d-button-label");
      await (0, _testHelpers.click)(".bootbox span.d-button-label");
    });
  });
});
define("discourse/tests/integration/components/widgets/actions-summary-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | Widget | actions-summary", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("post deleted", async function (assert) {
      this.set("args", {
        deleted_at: "2016-01-01",
        deletedByUsername: "eviltrout",
        deletedByAvatarTemplate: "/images/avatar.png"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="actions-summary" @args={{this.args}} />
      */
      {
        "id": "jqgLZw5y",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"actions-summary\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".post-action .d-icon-far-trash-alt"), 1, "it has the deleted icon");
      assert.strictEqual((0, _qunitHelpers.count)(".avatar[title=eviltrout]"), 1, "it has the deleted by avatar");
    });
  });
});
define("discourse/tests/integration/components/widgets/avatar-flair-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | Widget | avatar-flair", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("avatar flair with an icon", async function (assert) {
      this.set("args", {
        flair_url: "fa-bars",
        flair_bg_color: "CC0000",
        flair_color: "FFFFFF"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="avatar-flair" @args={{this.args}} />
      */
      {
        "id": "6cpl79SW",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"avatar-flair\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".avatar-flair"), "it has the tag");
      assert.ok((0, _qunitHelpers.exists)("svg.d-icon-bars"), "it has the svg icon");
      assert.strictEqual((0, _qunitHelpers.query)(".avatar-flair").getAttribute("style"), "background-color: #CC0000; color: #FFFFFF; ", "it has styles");
    });
    (0, _qunit.test)("avatar flair with an image", async function (assert) {
      this.set("args", {
        flair_url: "/images/avatar.png"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="avatar-flair" @args={{this.args}} />
      */
      {
        "id": "6cpl79SW",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"avatar-flair\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".avatar-flair"), "it has the tag");
      assert.ok(!(0, _qunitHelpers.exists)("svg"), "it does not have an svg icon");
    });
  });
});
define("discourse/tests/integration/components/widgets/button-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | Widget | button", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("icon only button", async function (assert) {
      this.set("args", {
        icon: "far-smile"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="button" @args={{this.args}} />
      */
      {
        "id": "skxYhalq",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"button\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("button.btn.btn-icon.no-text"), "it has all the classes");
      assert.ok((0, _qunitHelpers.exists)("button .d-icon.d-icon-far-smile"), "it has the icon");
    });
    (0, _qunit.test)("icon and text button", async function (assert) {
      this.set("args", {
        icon: "plus",
        label: "topic.create"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="button" @args={{this.args}} />
      */
      {
        "id": "skxYhalq",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"button\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("button.btn.btn-icon-text"), "it has all the classes");
      assert.ok((0, _qunitHelpers.exists)("button .d-icon.d-icon-plus"), "it has the icon");
      assert.ok((0, _qunitHelpers.exists)("button span.d-button-label"), "it has the label");
    });
    (0, _qunit.test)("emoji and text button", async function (assert) {
      this.set("args", {
        emoji: "mega",
        label: "topic.create"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="button" @args={{this.args}} />
      */
      {
        "id": "skxYhalq",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"button\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("button.widget-button"), "renders the widget");
      assert.ok((0, _qunitHelpers.exists)("button img.emoji"), "it renders the emoji");
      assert.ok((0, _qunitHelpers.exists)("button span.d-button-label"), "it renders the label");
    });
    (0, _qunit.test)("text only button", async function (assert) {
      this.set("args", {
        label: "topic.create"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="button" @args={{this.args}} />
      */
      {
        "id": "skxYhalq",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"button\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("button.btn.btn-text"), "it has all the classes");
      assert.ok((0, _qunitHelpers.exists)("button span.d-button-label"), "it has the label");
    });
    (0, _qunit.test)("translatedLabel", async function (assert) {
      this.set("args", {
        translatedLabel: "foo bar"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="button" @args={{this.args}} />
      */
      {
        "id": "skxYhalq",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"button\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("button span.d-button-label").innerText, "foo bar");
    });
    (0, _qunit.test)("translatedTitle", async function (assert) {
      this.set("args", {
        label: "topic.create",
        translatedTitle: "foo bar"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="button" @args={{this.args}} />
      */
      {
        "id": "skxYhalq",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"button\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("button").title, "foo bar");
    });
  });
});
define("discourse/tests/integration/components/widgets/default-notification-item-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/create-pretender", "@ember/object"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _createPretender, _object) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/create-pretender",0,"@ember/object"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | Widget | default-notification-item", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("sets notification as read on middle click", async function (assert) {
      this.set("args", _object.default.create({
        id: 3,
        user_id: 1,
        notification_type: 6,
        read: false,
        created_at: "2020-01-01T12:00:00.000Z",
        post_number: 1,
        topic_id: 10,
        fancy_title: "Greetings!",
        slug: "greetings",
        data: {
          topic_title: "Greetings!",
          original_post_id: 14,
          original_post_type: 1,
          original_username: "discobot",
          revision_number: null,
          display_username: "discobot"
        }
      }));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="default-notification-item" @args={{this.args}} />
      */
      {
        "id": "jR2JKwM3",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"default-notification-item\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      let requests = 0;

      _createPretender.default.put("/notifications/mark-read", request => {
        ++requests;
        assert.strictEqual(request.requestBody, `id=${this.args.id}`, "it sets correct request parameters");
        return (0, _createPretender.response)({
          success: true
        });
      });

      assert.ok(!(0, _qunitHelpers.exists)("li.read"));
      await (0, _testHelpers.triggerEvent)("li", "mouseup", {
        button: 1,
        which: 2
      });
      assert.strictEqual((0, _qunitHelpers.count)("li.read"), 1);
      assert.strictEqual(requests, 1);
    });
  });
});
define("discourse/tests/integration/components/widgets/hamburger-menu-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/lib/notification-levels"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _notificationLevels) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/lib/notification-levels"eaimeta@70e063a35619d71f

  const topCategoryIds = [2, 3, 1];
  let mutedCategoryIds = [];
  let unreadCategoryIds = [];
  let categoriesByCount = [];
  (0, _qunit.module)("Integration | Component | Widget | hamburger-menu", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("prioritize faq", async function (assert) {
      this.siteSettings.faq_url = "http://example.com/faq";
      this.currentUser.set("read_faq", false);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hamburger-menu" />
      */
      {
        "id": "OLGO+Tkv",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"hamburger-menu\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".faq-priority"));
      assert.ok(!(0, _qunitHelpers.exists)(".faq-link"));
    });
    (0, _qunit.test)("prioritize faq - user has read", async function (assert) {
      this.siteSettings.faq_url = "http://example.com/faq";
      this.currentUser.set("read_faq", true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hamburger-menu" />
      */
      {
        "id": "OLGO+Tkv",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"hamburger-menu\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".faq-priority"));
      assert.ok((0, _qunitHelpers.exists)(".faq-link"));
    });
    (0, _qunit.test)("staff menu - not staff", async function (assert) {
      this.currentUser.set("staff", false);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hamburger-menu" />
      */
      {
        "id": "OLGO+Tkv",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"hamburger-menu\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".admin-link"));
    });
    (0, _qunit.test)("staff menu - moderator", async function (assert) {
      this.currentUser.set("moderator", true);
      this.currentUser.set("can_review", true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hamburger-menu" />
      */
      {
        "id": "OLGO+Tkv",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"hamburger-menu\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".admin-link"));
      assert.ok((0, _qunitHelpers.exists)(".review"));
      assert.ok(!(0, _qunitHelpers.exists)(".settings-link"));
    });
    (0, _qunit.test)("staff menu - admin", async function (assert) {
      this.currentUser.setProperties({
        admin: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hamburger-menu" />
      */
      {
        "id": "OLGO+Tkv",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"hamburger-menu\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".settings-link"));
    });
    (0, _qunit.test)("logged in links", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hamburger-menu" />
      */
      {
        "id": "OLGO+Tkv",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"hamburger-menu\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".new-topics-link"));
      assert.ok((0, _qunitHelpers.exists)(".unread-topics-link"));
    });
    (0, _qunit.test)("general links", async function (assert) {
      this.owner.unregister("service:current-user");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hamburger-menu" />
      */
      {
        "id": "OLGO+Tkv",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"hamburger-menu\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)("li[class='']"));
      assert.ok((0, _qunitHelpers.exists)(".latest-topics-link"));
      assert.ok(!(0, _qunitHelpers.exists)(".new-topics-link"));
      assert.ok(!(0, _qunitHelpers.exists)(".unread-topics-link"));
      assert.ok((0, _qunitHelpers.exists)(".top-topics-link"));
      assert.ok((0, _qunitHelpers.exists)(".badge-link"));
      assert.ok((0, _qunitHelpers.exists)(".category-link"));
      assert.ok((0, _qunitHelpers.exists)(".about-link"));
      assert.ok((0, _qunitHelpers.exists)(".keyboard-shortcuts-link"));
    });
    let maxCategoriesToDisplay;
    (0, _qunit.test)("top categories - anonymous", async function (assert) {
      this.owner.unregister("service:current-user");
      this.siteSettings.header_dropdown_category_count = 8;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hamburger-menu" />
      */
      {
        "id": "OLGO+Tkv",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"hamburger-menu\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".category-link"), 8);
      assert.deepEqual([...(0, _qunitHelpers.queryAll)(".category-link .category-name")].map(el => el.innerText), this.site.get("categoriesByCount").slice(0, 8).map(c => c.name));
    });
    (0, _qunit.test)("top categories - allow_uncategorized_topics", async function (assert) {
      this.owner.unregister("service:current-user");
      this.siteSettings.allow_uncategorized_topics = false;
      this.siteSettings.header_dropdown_category_count = 8;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hamburger-menu" />
      */
      {
        "id": "OLGO+Tkv",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"hamburger-menu\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".category-link"), 8);
      assert.deepEqual([...(0, _qunitHelpers.queryAll)(".category-link .category-name")].map(el => el.innerText), this.site.get("categoriesByCount").filter(c => c.name !== "uncategorized").slice(0, 8).map(c => c.name));
    });
    (0, _qunit.test)("top categories", async function (assert) {
      this.siteSettings.header_dropdown_category_count = 8;
      maxCategoriesToDisplay = this.siteSettings.header_dropdown_category_count;
      categoriesByCount = this.site.get("categoriesByCount").slice();
      categoriesByCount.every(c => {
        if (!topCategoryIds.includes(c.id)) {
          if (mutedCategoryIds.length === 0) {
            mutedCategoryIds.push(c.id);
            c.set("notification_level", _notificationLevels.NotificationLevels.MUTED);
          } else if (unreadCategoryIds.length === 0) {
            unreadCategoryIds.push(c.id);

            for (let i = 0; i < 5; i++) {
              c.topicTrackingState.modifyState(123 + i, {
                category_id: c.id,
                last_read_post_number: 1,
                highest_post_number: 2,
                notification_level: _notificationLevels.NotificationLevels.TRACKING
              });
            }
          } else {
            unreadCategoryIds.splice(0, 0, c.id);

            for (let i = 0; i < 10; i++) {
              c.topicTrackingState.modifyState(321 + i, {
                category_id: c.id,
                last_read_post_number: null,
                created_in_new_period: true
              });
            }

            return false;
          }
        }

        return true;
      });
      this.currentUser.set("top_category_ids", topCategoryIds);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hamburger-menu" />
      */
      {
        "id": "OLGO+Tkv",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"hamburger-menu\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".category-link"), maxCategoriesToDisplay, "categories displayed limited by header_dropdown_category_count");
      categoriesByCount = categoriesByCount.filter(c => !mutedCategoryIds.includes(c.id));
      let ids = [...unreadCategoryIds, ...topCategoryIds, ...categoriesByCount.map(c => c.id)].uniq().slice(0, maxCategoriesToDisplay);
      assert.deepEqual([...(0, _qunitHelpers.queryAll)(".category-link .category-name")].map(el => el.innerText), ids.map(id => categoriesByCount.find(category => category.id === id).name), "top categories are in the correct order");
    });
    (0, _qunit.test)("badges link - disabled", async function (assert) {
      this.siteSettings.enable_badges = false;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hamburger-menu" />
      */
      {
        "id": "OLGO+Tkv",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"hamburger-menu\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".badge-link"));
    });
    (0, _qunit.test)("badges link", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hamburger-menu" />
      */
      {
        "id": "OLGO+Tkv",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"hamburger-menu\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".badge-link"));
    });
    (0, _qunit.test)("user directory link", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hamburger-menu" />
      */
      {
        "id": "OLGO+Tkv",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"hamburger-menu\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".user-directory-link"));
    });
    (0, _qunit.test)("user directory link - disabled", async function (assert) {
      this.siteSettings.enable_user_directory = false;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hamburger-menu" />
      */
      {
        "id": "OLGO+Tkv",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"hamburger-menu\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".user-directory-link"));
    });
  });
});
define("discourse/tests/integration/components/widgets/header-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | Widget | header", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("rendering basics", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="header" />
      */
      {
        "id": "xxS7nr2Q",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"header\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("header.d-header"));
      assert.ok((0, _qunitHelpers.exists)("#site-logo"));
    });
    (0, _qunit.test)("sign up / login buttons", async function (assert) {
      this.owner.unregister("service:current-user");
      this.set("args", {
        canSignUp: true
      });
      this.set("showCreateAccount", () => this.signupShown = true);
      this.set("showLogin", () => this.loginShown = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget
              @widget="header"
              @showCreateAccount={{this.showCreateAccount}}
              @showLogin={{this.showLogin}}
              @args={{this.args}}
            />
          
      */
      {
        "id": "UvSsb3tB",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@showCreateAccount\",\"@showLogin\",\"@args\"],[\"header\",[30,0,[\"showCreateAccount\"]],[30,0,[\"showLogin\"]],[30,0,[\"args\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("button.sign-up-button"));
      assert.ok((0, _qunitHelpers.exists)("button.login-button"));
      await (0, _testHelpers.click)("button.sign-up-button");
      assert.ok(this.signupShown);
      await (0, _testHelpers.click)("button.login-button");
      assert.ok(this.loginShown);
    });
    (0, _qunit.test)("anon when login required", async function (assert) {
      this.owner.unregister("service:current-user");
      this.set("args", {
        canSignUp: true
      });
      this.set("showCreateAccount", () => this.signupShown = true);
      this.set("showLogin", () => this.loginShown = true);
      this.siteSettings.login_required = true;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget
              @widget="header"
              @showCreateAccount={{this.showCreateAccount}}
              @showLogin={{this.showLogin}}
              @args={{this.args}}
            />
          
      */
      {
        "id": "UvSsb3tB",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@showCreateAccount\",\"@showLogin\",\"@args\"],[\"header\",[30,0,[\"showCreateAccount\"]],[30,0,[\"showLogin\"]],[30,0,[\"args\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("button.login-button"));
      assert.ok((0, _qunitHelpers.exists)("button.sign-up-button"));
      assert.ok(!(0, _qunitHelpers.exists)("#search-button"));
      assert.ok(!(0, _qunitHelpers.exists)("#toggle-hamburger-menu"));
    });
    (0, _qunit.test)("logged in when login required", async function (assert) {
      this.set("args", {
        canSignUp: true
      });
      this.set("showCreateAccount", () => this.signupShown = true);
      this.set("showLogin", () => this.loginShown = true);
      this.siteSettings.login_required = true;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget
              @widget="header"
              @showCreateAccount={{this.showCreateAccount}}
              @showLogin={{this.showLogin}}
              @args={{this.args}}
            />
          
      */
      {
        "id": "UvSsb3tB",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@showCreateAccount\",\"@showLogin\",\"@args\"],[\"header\",[30,0,[\"showCreateAccount\"]],[30,0,[\"showLogin\"]],[30,0,[\"args\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)("button.login-button"));
      assert.ok(!(0, _qunitHelpers.exists)("button.sign-up-button"));
      assert.ok((0, _qunitHelpers.exists)("#search-button"));
      assert.ok((0, _qunitHelpers.exists)("#toggle-hamburger-menu"));
      assert.ok((0, _qunitHelpers.exists)("#current-user"));
    });
  });
});
define("discourse/tests/integration/components/widgets/home-logo-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/models/session"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _session) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/models/session"eaimeta@70e063a35619d71f

  const bigLogo = "/images/d-logo-sketch.png?test";
  const smallLogo = "/images/d-logo-sketch-small.png?test";
  const mobileLogo = "/images/d-logo-sketch.png?mobile";
  const darkLogo = "/images/d-logo-sketch.png?dark";
  const title = "Cool Forum";
  const prefersDark = "(prefers-color-scheme: dark)";
  (0, _qunit.module)("Integration | Component | Widget | home-logo", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.afterEach(function () {
      _session.default.currentProp("darkModeAvailable", null);

      _session.default.currentProp("defaultColorSchemeIsDark", null);
    });
    (0, _qunit.test)("basics", async function (assert) {
      this.siteSettings.site_logo_url = bigLogo;
      this.siteSettings.site_logo_small_url = smallLogo;
      this.siteSettings.title = title;
      this.set("args", {
        minimized: false
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="home-logo" @args={{this.args}} />
      */
      {
        "id": "vV56YtJc",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"home-logo\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".title"), 1);
      assert.strictEqual((0, _qunitHelpers.count)("img#site-logo.logo-big"), 1);
      assert.strictEqual((0, _qunitHelpers.query)("#site-logo").getAttribute("src"), bigLogo);
      assert.strictEqual((0, _qunitHelpers.query)("#site-logo").getAttribute("alt"), title);
    });
    (0, _qunit.test)("basics - minimized", async function (assert) {
      this.siteSettings.site_logo_url = bigLogo;
      this.siteSettings.site_logo_small_url = smallLogo;
      this.siteSettings.title = title;
      this.set("args", {
        minimized: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="home-logo" @args={{this.args}} />
      */
      {
        "id": "vV56YtJc",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"home-logo\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)("img.logo-small"), 1);
      assert.strictEqual((0, _qunitHelpers.query)("img.logo-small").getAttribute("src"), smallLogo);
      assert.strictEqual((0, _qunitHelpers.query)("img.logo-small").getAttribute("alt"), title);
      assert.strictEqual((0, _qunitHelpers.query)("img.logo-small").getAttribute("width"), "36");
    });
    (0, _qunit.test)("no logo", async function (assert) {
      this.siteSettings.site_logo_url = "";
      this.siteSettings.site_logo_small_url = "";
      this.siteSettings.title = title;
      this.set("args", {
        minimized: false
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="home-logo" @args={{this.args}} />
      */
      {
        "id": "vV56YtJc",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"home-logo\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)("h1#site-text-logo.text-logo"), 1);
      assert.strictEqual((0, _qunitHelpers.query)("#site-text-logo").innerText, title);
    });
    (0, _qunit.test)("no logo - minimized", async function (assert) {
      this.siteSettings.site_logo_url = "";
      this.siteSettings.site_logo_small_url = "";
      this.siteSettings.title = title;
      this.set("args", {
        minimized: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="home-logo" @args={{this.args}} />
      */
      {
        "id": "vV56YtJc",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"home-logo\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".d-icon-home"), 1);
    });
    (0, _qunit.test)("mobile logo", async function (assert) {
      this.siteSettings.site_mobile_logo_url = mobileLogo;
      this.siteSettings.site_logo_small_url = smallLogo;
      this.site.mobileView = true;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="home-logo" @args={{this.args}} />
      */
      {
        "id": "vV56YtJc",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"home-logo\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)("img#site-logo.logo-mobile"), 1);
      assert.strictEqual((0, _qunitHelpers.query)("#site-logo").getAttribute("src"), mobileLogo);
    });
    (0, _qunit.test)("mobile without logo", async function (assert) {
      this.siteSettings.site_logo_url = bigLogo;
      this.site.mobileView = true;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="home-logo" @args={{this.args}} />
      */
      {
        "id": "vV56YtJc",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"home-logo\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)("img#site-logo.logo-big"), 1);
      assert.strictEqual((0, _qunitHelpers.query)("#site-logo").getAttribute("src"), bigLogo);
    });
    (0, _qunit.test)("logo with dark mode alternative", async function (assert) {
      this.siteSettings.site_logo_url = bigLogo;
      this.siteSettings.site_logo_dark_url = darkLogo;

      _session.default.currentProp("darkModeAvailable", true);

      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="home-logo" @args={{this.args}} />
      */
      {
        "id": "vV56YtJc",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"home-logo\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)("img#site-logo.logo-big"), 1);
      assert.strictEqual((0, _qunitHelpers.query)("#site-logo").getAttribute("src"), bigLogo);
      assert.strictEqual((0, _qunitHelpers.query)("picture source").getAttribute("media"), prefersDark, "includes dark mode media attribute");
      assert.strictEqual((0, _qunitHelpers.query)("picture source").getAttribute("srcset"), darkLogo, "includes dark mode alternative logo source");
    });
    (0, _qunit.test)("mobile logo with dark mode alternative", async function (assert) {
      this.siteSettings.site_logo_url = bigLogo;
      this.siteSettings.site_mobile_logo_url = mobileLogo;
      this.siteSettings.site_mobile_logo_dark_url = darkLogo;

      _session.default.currentProp("darkModeAvailable", true);

      this.site.mobileView = true;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="home-logo" @args={{this.args}} />
      */
      {
        "id": "vV56YtJc",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"home-logo\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("#site-logo").getAttribute("src"), mobileLogo);
      assert.strictEqual((0, _qunitHelpers.query)("picture source").getAttribute("media"), prefersDark, "includes dark mode media attribute");
      assert.strictEqual((0, _qunitHelpers.query)("picture source").getAttribute("srcset"), darkLogo, "includes dark mode alternative logo source");
    });
    (0, _qunit.test)("dark mode enabled but no dark logo set", async function (assert) {
      this.siteSettings.site_logo_url = bigLogo;
      this.siteSettings.site_logo_dark_url = "";

      _session.default.currentProp("darkModeAvailable", true);

      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="home-logo" @args={{this.args}} />
      */
      {
        "id": "vV56YtJc",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"home-logo\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)("img#site-logo.logo-big"), 1);
      assert.strictEqual((0, _qunitHelpers.query)("#site-logo").getAttribute("src"), bigLogo);
      assert.ok(!(0, _qunitHelpers.exists)("picture"), "does not include alternative logo");
    });
    (0, _qunit.test)("dark logo set but no dark mode", async function (assert) {
      this.siteSettings.site_logo_url = bigLogo;
      this.siteSettings.site_logo_dark_url = darkLogo;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="home-logo" @args={{this.args}} />
      */
      {
        "id": "vV56YtJc",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"home-logo\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)("img#site-logo.logo-big"), 1);
      assert.strictEqual((0, _qunitHelpers.query)("#site-logo").getAttribute("src"), bigLogo);
      assert.ok(!(0, _qunitHelpers.exists)("picture"), "does not include alternative logo");
    });
    (0, _qunit.test)("dark color scheme and dark logo set", async function (assert) {
      this.siteSettings.site_logo_url = bigLogo;
      this.siteSettings.site_logo_dark_url = darkLogo;

      _session.default.currentProp("defaultColorSchemeIsDark", true);

      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="home-logo" @args={{this.args}} />
      */
      {
        "id": "vV56YtJc",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"home-logo\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)("img#site-logo.logo-big"), 1);
      assert.strictEqual((0, _qunitHelpers.query)("#site-logo").getAttribute("src"), darkLogo, "uses dark logo");
      assert.ok(!(0, _qunitHelpers.exists)("picture"), "does not add dark mode alternative");
    });
    (0, _qunit.test)("dark color scheme and dark logo not set", async function (assert) {
      this.siteSettings.site_logo_url = bigLogo;
      this.siteSettings.site_logo_dark_url = "";

      _session.default.currentProp("defaultColorSchemeIsDark", true);

      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="home-logo" @args={{this.args}} />
      */
      {
        "id": "vV56YtJc",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"home-logo\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)("img#site-logo.logo-big"), 1);
      assert.strictEqual((0, _qunitHelpers.query)("#site-logo").getAttribute("src"), bigLogo, "uses regular logo on dark scheme if no dark logo");
    });
  });
});
define("discourse/tests/integration/components/widgets/post-links-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | Widget | post-links", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("duplicate links", async function (assert) {
      this.set("args", {
        id: 2,
        links: [{
          title: "Evil Trout Link",
          url: "http://eviltrout.com",
          reflection: true
        }, {
          title: "Evil Trout Link",
          url: "http://dupe.eviltrout.com",
          reflection: true
        }]
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post-links" @args={{this.args}} />
      */
      {
        "id": "rFGuyI7y",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post-links\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".post-links a.track-link"), 1, "it hides the dupe link");
    });
    (0, _qunit.test)("collapsed links", async function (assert) {
      this.set("args", {
        id: 1,
        links: [{
          title: "Link 1",
          url: "http://eviltrout.com?1",
          reflection: true
        }, {
          title: "Link 2",
          url: "http://eviltrout.com?2",
          reflection: true
        }, {
          title: "Link 3",
          url: "http://eviltrout.com?3",
          reflection: true
        }, {
          title: "Link 4",
          url: "http://eviltrout.com?4",
          reflection: true
        }, {
          title: "Link 5",
          url: "http://eviltrout.com?5",
          reflection: true
        }, {
          title: "Link 6",
          url: "http://eviltrout.com?6",
          reflection: true
        }, {
          title: "Link 7",
          url: "http://eviltrout.com?7",
          reflection: true
        }]
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post-links" @args={{this.args}} />
      */
      {
        "id": "rFGuyI7y",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post-links\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".expand-links"), 1, "collapsed by default");
      await (0, _testHelpers.click)("a.expand-links");
      assert.strictEqual((0, _qunitHelpers.count)(".post-links a.track-link"), 7);
    });
  });
});
define("discourse/tests/integration/components/widgets/post-menu-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/widgets/post-menu", "discourse/lib/plugin-api"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _postMenu, _pluginApi) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/widgets/post-menu",0,"discourse/lib/plugin-api"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | Widget | post-menu", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.afterEach(function () {
      (0, _postMenu.resetPostMenuExtraButtons)();
    });
    (0, _qunit.test)("add extra button", async function (assert) {
      this.set("args", {});
      (0, _pluginApi.withPluginApi)("0.14.0", api => {
        api.addPostMenuButton("coffee", () => {
          return {
            action: "drinkCoffee",
            icon: "coffee",
            className: "hot-coffee",
            title: "coffee.title",
            position: "first"
          };
        });
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post-menu" @args={{this.args}} />
      */
      {
        "id": "kqV2V8HN",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post-menu\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".actions .extra-buttons .hot-coffee"), 1, "It renders extra button");
    });
    (0, _qunit.test)("removes button based on callback", async function (assert) {
      this.set("args", {
        canCreatePost: true,
        canRemoveReply: true
      });
      (0, _pluginApi.withPluginApi)("0.14.0", api => {
        api.removePostMenuButton("reply", attrs => {
          return attrs.canRemoveReply;
        });
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post-menu" @args={{this.args}} />
      */
      {
        "id": "kqV2V8HN",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post-menu\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".actions .reply"), "it removes reply button");
    });
    (0, _qunit.test)("does not remove button", async function (assert) {
      this.set("args", {
        canCreatePost: true,
        canRemoveReply: false
      });
      (0, _pluginApi.withPluginApi)("0.14.0", api => {
        api.removePostMenuButton("reply", attrs => {
          return attrs.canRemoveReply;
        });
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post-menu" @args={{this.args}} />
      */
      {
        "id": "kqV2V8HN",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post-menu\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".actions .reply"), "it does not remove reply button");
    });
    (0, _qunit.test)("removes button", async function (assert) {
      this.set("args", {
        canCreatePost: true
      });
      (0, _pluginApi.withPluginApi)("0.14.0", api => {
        api.removePostMenuButton("reply");
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post-menu" @args={{this.args}} />
      */
      {
        "id": "kqV2V8HN",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post-menu\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".actions .reply"), "it removes reply button");
    });
  });
});
define("discourse/tests/integration/components/widgets/post-small-action-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | Widget | post-small-action", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("does not have delete/edit/recover buttons by default", async function (assert) {
      this.set("args", {
        id: 123
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post-small-action" @args={{this.args}} />
      */
      {
        "id": "bVYWJ3ih",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post-small-action\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".small-action-desc > .small-action-delete"));
      assert.ok(!(0, _qunitHelpers.exists)(".small-action-desc > .small-action-recover"));
      assert.ok(!(0, _qunitHelpers.exists)(".small-action-desc > .small-action-edit"));
    });
    (0, _qunit.test)("shows edit button if canEdit", async function (assert) {
      this.set("args", {
        id: 123,
        canEdit: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post-small-action" @args={{this.args}} />
      */
      {
        "id": "bVYWJ3ih",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post-small-action\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".small-action-desc > .small-action-edit"), "it adds the edit small action button");
    });
    (0, _qunit.test)("uses custom widget if actionDescriptionWidget", async function (assert) {
      this.set("args", {
        id: 123,
        actionDescriptionWidget: "button"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post-small-action" @args={{this.args}} />
      */
      {
        "id": "bVYWJ3ih",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post-small-action\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".small-action .widget-button"), "it adds the custom widget");
    });
    (0, _qunit.test)("does not show edit button if canRecover even if canEdit", async function (assert) {
      this.set("args", {
        id: 123,
        canEdit: true,
        canRecover: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post-small-action" @args={{this.args}} />
      */
      {
        "id": "bVYWJ3ih",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post-small-action\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".small-action-desc > .small-action-edit"), "it does not add the edit small action button");
      assert.ok((0, _qunitHelpers.exists)(".small-action-desc > .small-action-recover"), "it adds the recover small action button");
    });
    (0, _qunit.test)("shows delete button if canDelete", async function (assert) {
      this.set("args", {
        id: 123,
        canDelete: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post-small-action" @args={{this.args}} />
      */
      {
        "id": "bVYWJ3ih",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post-small-action\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".small-action-desc > .small-action-delete"), "it adds the delete small action button");
    });
    (0, _qunit.test)("shows undo button if canRecover", async function (assert) {
      this.set("args", {
        id: 123,
        canRecover: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post-small-action" @args={{this.args}} />
      */
      {
        "id": "bVYWJ3ih",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post-small-action\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".small-action-desc > .small-action-recover"), "it adds the recover small action button");
    });
  });
});
define("discourse/tests/integration/components/widgets/post-stream-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/models/post", "discourse/models/topic"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _post, _topic) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/models/post",0,"discourse/models/topic"eaimeta@70e063a35619d71f

  function postStreamTest(name, attrs) {
    (0, _qunit.test)(name, async function (assert) {
      const site = this.container.lookup("service:site");
      let posts = attrs.posts.call(this);
      posts.forEach(p => p.set("site", site));
      this.set("posts", posts);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post-stream" @args={{hash posts=this.posts}} />
      */
      {
        "id": "91XLjqrx",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post-stream\",[28,[37,1],null,[[\"posts\"],[[30,0,[\"posts\"]]]]]]],null]],[],false,[\"mount-widget\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      attrs.test.call(this, assert);
    });
  }

  (0, _qunit.module)("Integration | Component | Widget | post-stream", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    postStreamTest("basics", {
      posts() {
        const site = this.container.lookup("service:site");

        const topic = _topic.default.create();

        topic.set("details.created_by", {
          id: 123
        });
        return [_post.default.create({
          topic,
          id: 1,
          post_number: 1,
          user_id: 123,
          primary_group_name: "trout",
          avatar_template: "/images/avatar.png"
        }), _post.default.create({
          topic,
          id: 2,
          post_number: 2,
          post_type: site.get("post_types.moderator_action")
        }), _post.default.create({
          topic,
          id: 3,
          post_number: 3,
          hidden: true
        }), _post.default.create({
          topic,
          id: 4,
          post_number: 4,
          post_type: site.get("post_types.whisper")
        }), _post.default.create({
          topic,
          id: 5,
          post_number: 5,
          wiki: true,
          via_email: true
        }), _post.default.create({
          topic,
          id: 6,
          post_number: 6,
          via_email: true,
          is_auto_generated: true
        })];
      },

      test(assert) {
        assert.strictEqual((0, _qunitHelpers.count)(".post-stream"), 1);
        assert.strictEqual((0, _qunitHelpers.count)(".topic-post"), 6, "renders all posts"); // look for special class bindings

        assert.strictEqual((0, _qunitHelpers.count)(".topic-post:nth-of-type(1).topic-owner"), 1, "it applies the topic owner class");
        assert.strictEqual((0, _qunitHelpers.count)(".topic-post:nth-of-type(1).group-trout"), 1, "it applies the primary group class");
        assert.strictEqual((0, _qunitHelpers.count)(".topic-post:nth-of-type(1).regular"), 1, "it applies the regular class");
        assert.strictEqual((0, _qunitHelpers.count)(".topic-post:nth-of-type(2).moderator"), 1, "it applies the moderator class");
        assert.strictEqual((0, _qunitHelpers.count)(".topic-post:nth-of-type(3).post-hidden"), 1, "it applies the hidden class");
        assert.strictEqual((0, _qunitHelpers.count)(".topic-post:nth-of-type(4).whisper"), 1, "it applies the whisper class");
        assert.strictEqual((0, _qunitHelpers.count)(".topic-post:nth-of-type(5).wiki"), 1, "it applies the wiki class"); // it renders an article for the body with appropriate attributes

        assert.strictEqual((0, _qunitHelpers.count)("article#post_2"), 1);
        assert.strictEqual((0, _qunitHelpers.count)('article[data-user-id="123"]'), 1);
        assert.strictEqual((0, _qunitHelpers.count)('article[data-post-id="3"]'), 1);
        assert.strictEqual((0, _qunitHelpers.count)("article#post_5.via-email"), 1);
        assert.strictEqual((0, _qunitHelpers.count)("article#post_6.is-auto-generated"), 1);
        assert.strictEqual((0, _qunitHelpers.count)("article:nth-of-type(1) .main-avatar"), 1, "renders the main avatar");
      }

    });
    postStreamTest("deleted posts", {
      posts() {
        const topic = _topic.default.create();

        topic.set("details.created_by", {
          id: 123
        });
        return [_post.default.create({
          topic,
          id: 1,
          post_number: 1,
          deleted_at: new Date().toString()
        })];
      },

      test(assert) {
        assert.strictEqual((0, _qunitHelpers.count)(".topic-post.deleted"), 1, "it applies the deleted class");
        assert.strictEqual((0, _qunitHelpers.count)(".deleted-user-avatar"), 1, "it has the trash avatar");
      }

    });
  });
});
define("discourse/tests/integration/components/widgets/post-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "@ember/object", "I18n", "discourse/tests/helpers/create-store", "discourse/models/user"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _object, _I18n, _createStore, _user) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"@ember/object",0,"I18n",0,"discourse/tests/helpers/create-store",0,"discourse/models/user"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | Widget | post", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("basic elements", async function (assert) {
      this.set("args", {
        shareUrl: "/example",
        post_number: 1
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".names"), "includes poster name");
      assert.ok((0, _qunitHelpers.exists)("a.post-date"), "includes post date");
    });
    (0, _qunit.test)("post - links", async function (assert) {
      this.set("args", {
        cooked: "<a href='http://link1.example.com/'>first link</a> and <a href='http://link2.example.com/?some=query'>second link</a>",
        linkCounts: [{
          url: "http://link1.example.com/",
          clicks: 1,
          internal: true
        }, {
          url: "http://link2.example.com/",
          clicks: 2,
          internal: true
        }]
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post-contents" @args={{this.args}} />
      */
      {
        "id": "HI2wyUSC",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post-contents\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.queryAll)(".badge.clicks")[0].innerText, "1");
      assert.strictEqual((0, _qunitHelpers.queryAll)(".badge.clicks")[1].innerText, "2");
    });
    (0, _qunit.test)("post - onebox links", async function (assert) {
      this.set("args", {
        cooked: `
      <p><a href="https://example.com">Other URL</a></p>

      <aside class="onebox twitterstatus" data-onebox-src="https://twitter.com/codinghorror">
        <header class="source">
           <a href="https://twitter.com/codinghorror" target="_blank" rel="noopener">twitter.com</a>
        </header>
        <article class="onebox-body">
           <h4><a href="https://twitter.com/codinghorror" target="_blank" rel="noopener">Jeff Atwood</a></h4>
           <div class="twitter-screen-name"><a href="https://twitter.com/codinghorror" target="_blank" rel="noopener">@codinghorror</a></div>
        </article>
      </aside>`,
        linkCounts: [{
          url: "https://example.com",
          clicks: 1
        }, {
          url: "https://twitter.com/codinghorror",
          clicks: 2
        }]
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post-contents" @args={{this.args}} />
      */
      {
        "id": "HI2wyUSC",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post-contents\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".badge.clicks"), 2);
      assert.strictEqual((0, _qunitHelpers.queryAll)(".badge.clicks")[0].innerText, "1");
      assert.strictEqual((0, _qunitHelpers.queryAll)(".badge.clicks")[1].innerText, "2");
    });
    (0, _qunit.test)("wiki", async function (assert) {
      this.set("args", {
        wiki: true,
        version: 2,
        canViewEditHistory: true
      });
      this.set("showHistory", () => this.historyShown = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @showHistory={{this.showHistory}} />
          
      */
      {
        "id": "QrWh+wlj",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@showHistory\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"showHistory\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".post-info .wiki");
      assert.ok(this.historyShown, "clicking the wiki icon displays the post history");
    });
    (0, _qunit.test)("wiki without revision", async function (assert) {
      this.set("args", {
        wiki: true,
        version: 1,
        canViewEditHistory: true
      });
      this.set("editPost", () => this.editPostCalled = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @editPost={{this.editPost}} />
          
      */
      {
        "id": "oNjUqvz+",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@editPost\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"editPost\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".post-info .wiki");
      assert.ok(this.editPostCalled, "clicking wiki icon edits the post");
    });
    (0, _qunit.test)("via-email", async function (assert) {
      this.set("args", {
        via_email: true,
        canViewRawEmail: true
      });
      this.set("showRawEmail", () => this.rawEmailShown = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @showRawEmail={{this.showRawEmail}} />
          
      */
      {
        "id": "tW5ulO4b",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@showRawEmail\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"showRawEmail\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".post-info.via-email");
      assert.ok(this.rawEmailShown, "clicking the envelope shows the raw email");
    });
    (0, _qunit.test)("via-email without permission", async function (assert) {
      this.set("args", {
        via_email: true,
        canViewRawEmail: false
      });
      this.set("showRawEmail", () => this.rawEmailShown = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @showRawEmail={{this.showRawEmail}} />
          
      */
      {
        "id": "tW5ulO4b",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@showRawEmail\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"showRawEmail\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".post-info.via-email");
      assert.ok(!this.rawEmailShown, "clicking the envelope doesn't show the raw email");
    });
    (0, _qunit.test)("history", async function (assert) {
      this.set("args", {
        version: 3,
        canViewEditHistory: true
      });
      this.set("showHistory", () => this.historyShown = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @showHistory={{this.showHistory}} />
          
      */
      {
        "id": "QrWh+wlj",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@showHistory\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"showHistory\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".post-info.edits button");
      assert.ok(this.historyShown, "clicking the pencil shows the history");
    });
    (0, _qunit.test)("history without view permission", async function (assert) {
      this.set("args", {
        version: 3,
        canViewEditHistory: false
      });
      this.set("showHistory", () => this.historyShown = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @showHistory={{this.showHistory}} />
          
      */
      {
        "id": "QrWh+wlj",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@showHistory\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"showHistory\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".post-info.edits");
      assert.ok(!this.historyShown, `clicking the pencil doesn't show the history`);
    });
    (0, _qunit.test)("whisper", async function (assert) {
      this.set("args", {
        isWhisper: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".topic-post.whisper"), 1);
      assert.strictEqual((0, _qunitHelpers.count)(".post-info.whisper"), 1);
    });
    (0, _qunit.test)("like count button", async function (assert) {
      const store = (0, _createStore.default)();
      const topic = store.createRecord("topic", {
        id: 123
      });
      const post = store.createRecord("post", {
        id: 1,
        post_number: 1,
        topic,
        like_count: 3,
        actions_summary: [{
          id: 2,
          count: 1,
          hidden: false,
          can_act: true
        }]
      });
      this.set("post", post);
      this.set("args", {
        likeCount: 1
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @model={{this.post}} @args={{this.args}} />
      */
      {
        "id": "usUfVQji",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@model\",\"@args\"],[\"post\",[30,0,[\"post\"]],[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)("button.like-count"), 1);
      assert.ok(!(0, _qunitHelpers.exists)(".who-liked")); // toggle it on

      await (0, _testHelpers.click)("button.like-count");
      assert.strictEqual((0, _qunitHelpers.count)(".who-liked"), 1);
      assert.strictEqual((0, _qunitHelpers.count)(".who-liked a.trigger-user-card"), 1); // toggle it off

      await (0, _testHelpers.click)("button.like-count");
      assert.ok(!(0, _qunitHelpers.exists)(".who-liked"));
      assert.ok(!(0, _qunitHelpers.exists)(".who-liked a.trigger-user-card"));
    });
    (0, _qunit.test)(`like count with no likes`, async function (assert) {
      this.set("args", {
        likeCount: 0
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @model={{this.post}} @args={{this.args}} />
      */
      {
        "id": "usUfVQji",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@model\",\"@args\"],[\"post\",[30,0,[\"post\"]],[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)("button.like-count"));
    });
    (0, _qunit.test)("share button", async function (assert) {
      this.set("args", {
        shareUrl: "http://share-me.example.com"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".actions button.share"), "it renders a share button");
    });
    (0, _qunit.test)("liking", async function (assert) {
      const args = {
        showLike: true,
        canToggleLike: true,
        id: 5
      };
      this.set("args", args);
      this.set("toggleLike", () => {
        args.liked = !args.liked;
        args.likeCount = args.liked ? 1 : 0;
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post-menu" @args={{this.args}} @toggleLike={{this.toggleLike}} />
          
      */
      {
        "id": "+EK4ZDHi",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@toggleLike\"],[\"post-menu\",[30,0,[\"args\"]],[30,0,[\"toggleLike\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".actions button.like"));
      assert.ok(!(0, _qunitHelpers.exists)(".actions button.like-count"));
      await (0, _testHelpers.click)(".actions button.like");
      assert.ok(!(0, _qunitHelpers.exists)(".actions button.like"));
      assert.ok((0, _qunitHelpers.exists)(".actions button.has-like"));
      assert.strictEqual((0, _qunitHelpers.count)(".actions button.like-count"), 1);
      await (0, _testHelpers.click)(".actions button.has-like");
      assert.ok((0, _qunitHelpers.exists)(".actions button.like"));
      assert.ok(!(0, _qunitHelpers.exists)(".actions button.has-like"));
      assert.ok(!(0, _qunitHelpers.exists)(".actions button.like-count"));
    });
    (0, _qunit.test)("anon liking", async function (assert) {
      this.owner.unregister("service:current-user");
      const args = {
        showLike: true
      };
      this.set("args", args);
      this.set("showLogin", () => this.loginShown = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post-menu" @args={{this.args}} @showLogin={{this.showLogin}} />
          
      */
      {
        "id": "qvo6Eov8",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@showLogin\"],[\"post-menu\",[30,0,[\"args\"]],[30,0,[\"showLogin\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".actions button.like"));
      assert.ok(!(0, _qunitHelpers.exists)(".actions button.like-count"));
      assert.strictEqual((0, _qunitHelpers.query)("button.like").getAttribute("title"), _I18n.default.t("post.controls.like"), `shows the right button title for anonymous users`);
      await (0, _testHelpers.click)(".actions button.like");
      assert.ok(this.loginShown);
    });
    (0, _qunit.test)("edit button", async function (assert) {
      this.set("args", {
        canEdit: true
      });
      this.set("editPost", () => this.editPostCalled = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @editPost={{this.editPost}} />
          
      */
      {
        "id": "oNjUqvz+",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@editPost\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"editPost\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)("button.edit");
      assert.ok(this.editPostCalled, "it triggered the edit action");
    });
    (0, _qunit.test)(`edit button - can't edit`, async function (assert) {
      this.set("args", {
        canEdit: false
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)("button.edit"), "button is not displayed");
    });
    (0, _qunit.test)("recover button", async function (assert) {
      this.set("args", {
        canDelete: true
      });
      this.set("deletePost", () => this.deletePostCalled = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @deletePost={{this.deletePost}} />
          
      */
      {
        "id": "xaFS9qrk",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@deletePost\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"deletePost\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)("button.delete");
      assert.ok(this.deletePostCalled, "it triggered the delete action");
    });
    (0, _qunit.test)("delete topic button", async function (assert) {
      this.set("args", {
        canDeleteTopic: true
      });
      this.set("deletePost", () => this.deletePostCalled = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @deletePost={{this.deletePost}} />
          
      */
      {
        "id": "xaFS9qrk",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@deletePost\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"deletePost\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)("button.delete");
      assert.ok(this.deletePostCalled, "it triggered the delete action");
    });
    (0, _qunit.test)(`delete topic button - can't delete`, async function (assert) {
      this.set("args", {
        canDeleteTopic: false
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)("button.delete"), `button is not displayed`);
    });
    (0, _qunit.test)(`delete topic button - can't delete when topic author without permission`, async function (assert) {
      this.set("args", {
        canDeleteTopic: false,
        showFlagDelete: true,
        canFlag: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".show-more-actions");
      assert.strictEqual((0, _qunitHelpers.count)("button.create-flag"), 1, `button is displayed`);
      assert.strictEqual((0, _qunitHelpers.count)("button.delete"), 1, `button is displayed`);
      assert.strictEqual((0, _qunitHelpers.query)("button.delete").getAttribute("title"), _I18n.default.t("post.controls.delete_topic_disallowed"), `shows the right button title for users without permissions`);
    });
    (0, _qunit.test)("recover topic button", async function (assert) {
      this.set("args", {
        canRecoverTopic: true
      });
      this.set("recoverPost", () => this.recovered = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @recoverPost={{this.recoverPost}} />
          
      */
      {
        "id": "1w3RCucs",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@recoverPost\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"recoverPost\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)("button.recover");
      assert.ok(this.recovered);
    });
    (0, _qunit.test)(`recover topic button - can't recover`, async function (assert) {
      this.set("args", {
        canRecoverTopic: false
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)("button.recover"), `button is not displayed`);
    });
    (0, _qunit.test)("delete post button", async function (assert) {
      this.set("args", {
        canDelete: true,
        canFlag: true
      });
      this.set("deletePost", () => this.deletePostCalled = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @deletePost={{this.deletePost}} />
          
      */
      {
        "id": "xaFS9qrk",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@deletePost\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"deletePost\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".show-more-actions");
      await (0, _testHelpers.click)("button.delete");
      assert.ok(this.deletePostCalled, "it triggered the delete action");
    });
    (0, _qunit.test)(`delete post button - can't delete`, async function (assert) {
      this.set("args", {
        canDelete: false
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)("button.delete"), `button is not displayed`);
    });
    (0, _qunit.test)(`delete post button - can't delete, can't flag`, async function (assert) {
      this.set("args", {
        canDeleteTopic: false,
        showFlagDelete: false,
        canFlag: false
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)("button.delete"), `delete button is not displayed`);
      assert.ok(!(0, _qunitHelpers.exists)("button.create-flag"), `flag button is not displayed`);
    });
    (0, _qunit.test)("recover post button", async function (assert) {
      this.set("args", {
        canRecover: true
      });
      this.set("recoverPost", () => this.recovered = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @recoverPost={{this.recoverPost}} />
          
      */
      {
        "id": "1w3RCucs",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@recoverPost\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"recoverPost\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)("button.recover");
      assert.ok(this.recovered);
    });
    (0, _qunit.test)(`recover post button - can't recover`, async function (assert) {
      this.set("args", {
        canRecover: false
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)("button.recover"), `button is not displayed`);
    });
    (0, _qunit.test)(`flagging`, async function (assert) {
      this.set("args", {
        canFlag: true
      });
      this.set("showFlags", () => this.flagsShown = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @showFlags={{this.showFlags}} />
          
      */
      {
        "id": "ATOd7xfG",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@showFlags\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"showFlags\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)("button.create-flag"), 1);
      await (0, _testHelpers.click)("button.create-flag");
      assert.ok(this.flagsShown, "it triggered the action");
    });
    (0, _qunit.test)(`flagging: can't flag`, async function (assert) {
      this.set("args", {
        canFlag: false
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)("button.create-flag"));
    });
    (0, _qunit.test)(`flagging: can't flag when post is hidden`, async function (assert) {
      this.set("args", {
        canFlag: true,
        hidden: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)("button.create-flag"));
    });
    (0, _qunit.test)(`read indicator`, async function (assert) {
      this.set("args", {
        read: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".read-state.read"));
    });
    (0, _qunit.test)(`unread indicator`, async function (assert) {
      this.set("args", {
        read: false
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".read-state"));
    });
    (0, _qunit.test)("reply directly above (suppressed)", async function (assert) {
      this.set("args", {
        replyToUsername: "eviltrout",
        replyToAvatarTemplate: "/images/avatar.png",
        replyDirectlyAbove: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)("a.reply-to-tab"), "hides the tab");
      assert.ok(!(0, _qunitHelpers.exists)(".avoid-tab"), "doesn't have the avoid tab class");
    });
    (0, _qunit.test)("reply a few posts above (suppressed)", async function (assert) {
      this.set("args", {
        replyToUsername: "eviltrout",
        replyToAvatarTemplate: "/images/avatar.png",
        replyDirectlyAbove: false
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("a.reply-to-tab"), "shows the tab");
      assert.strictEqual((0, _qunitHelpers.count)(".avoid-tab"), 1, "has the avoid tab class");
    });
    (0, _qunit.test)("reply directly above", async function (assert) {
      this.set("args", {
        replyToUsername: "eviltrout",
        replyToAvatarTemplate: "/images/avatar.png",
        replyDirectlyAbove: true
      });
      this.siteSettings.suppress_reply_directly_above = false;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".avoid-tab"), 1, "has the avoid tab class");
      await (0, _testHelpers.click)("a.reply-to-tab");
      assert.strictEqual((0, _qunitHelpers.count)("section.embedded-posts.top .cooked"), 1);
      assert.strictEqual((0, _qunitHelpers.count)("section.embedded-posts .d-icon-arrow-up"), 1);
    });
    (0, _qunit.test)("cooked content hidden", async function (assert) {
      this.set("args", {
        cooked_hidden: true
      });
      this.set("expandHidden", () => this.unhidden = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @expandHidden={{this.expandHidden}} />
          
      */
      {
        "id": "sZTg5tZe",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@expandHidden\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"expandHidden\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".topic-body .expand-hidden");
      assert.ok(this.unhidden, "triggers the action");
    });
    (0, _qunit.test)("expand first post", async function (assert) {
      const store = (0, _createStore.default)();
      this.set("args", {
        expandablePost: true
      });
      this.set("post", store.createRecord("post", {
        id: 1234
      }));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @model={{this.post}} @args={{this.args}} />
      */
      {
        "id": "usUfVQji",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@model\",\"@args\"],[\"post\",[30,0,[\"post\"]],[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".topic-body .expand-post");
      assert.ok(!(0, _qunitHelpers.exists)(".expand-post"), "button is gone");
    });
    (0, _qunit.test)("can't bookmark", async function (assert) {
      this.set("args", {
        canBookmark: false
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)("button.bookmark"));
      assert.ok(!(0, _qunitHelpers.exists)("button.bookmarked"));
    });
    (0, _qunit.test)("bookmark", async function (assert) {
      const args = {
        canBookmark: true
      };
      this.set("args", args);
      this.set("toggleBookmark", () => args.bookmarked = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @toggleBookmark={{this.toggleBookmark}} />
          
      */
      {
        "id": "qdewaSCL",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@toggleBookmark\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"toggleBookmark\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".post-menu-area .bookmark"), 1);
      assert.ok(!(0, _qunitHelpers.exists)("button.bookmarked"));
    });
    (0, _qunit.test)("can't show admin menu when you can't manage", async function (assert) {
      this.set("args", {
        canManage: false
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".post-menu-area .show-post-admin-menu"));
    });
    (0, _qunit.test)("show admin menu", async function (assert) {
      this.set("args", {
        canManage: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".post-admin-menu"));
      await (0, _testHelpers.click)(".post-menu-area .show-post-admin-menu");
      assert.strictEqual((0, _qunitHelpers.count)(".post-admin-menu"), 1, "it shows the popup");
      await (0, _testHelpers.click)(".post-menu-area");
      assert.ok(!(0, _qunitHelpers.exists)(".post-admin-menu"), "clicking outside clears the popup");
    });
    (0, _qunit.test)("permanently delete topic", async function (assert) {
      this.set("args", {
        canManage: true,
        canPermanentlyDelete: true
      });
      this.set("permanentlyDeletePost", () => this.deleted = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} @permanentlyDeletePost={{this.permanentlyDeletePost}} />
      */
      {
        "id": "sfiHO7A/",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\",\"@permanentlyDeletePost\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"permanentlyDeletePost\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".post-menu-area .show-post-admin-menu");
      await (0, _testHelpers.click)(".post-admin-menu .permanently-delete");
      assert.ok(this.deleted);
      assert.ok(!(0, _qunitHelpers.exists)(".post-admin-menu"), "also hides the menu");
    });
    (0, _qunit.test)("permanently delete post", async function (assert) {
      this.set("args", {
        canManage: true,
        canPermanentlyDelete: true
      });
      this.set("permanentlyDeletePost", () => this.deleted = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @permanentlyDeletePost={{this.permanentlyDeletePost}} />
          
      */
      {
        "id": "6wJ5R+wn",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@permanentlyDeletePost\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"permanentlyDeletePost\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".post-menu-area .show-post-admin-menu");
      await (0, _testHelpers.click)(".post-admin-menu .permanently-delete");
      assert.ok(this.deleted);
      assert.ok(!(0, _qunitHelpers.exists)(".post-admin-menu"), "also hides the menu");
    });
    (0, _qunit.test)("toggle moderator post", async function (assert) {
      this.currentUser.set("moderator", true);
      this.set("args", {
        canManage: true
      });
      this.set("togglePostType", () => this.toggled = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @togglePostType={{this.togglePostType}} />
          
      */
      {
        "id": "+UHXrpt/",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@togglePostType\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"togglePostType\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".post-menu-area .show-post-admin-menu");
      await (0, _testHelpers.click)(".post-admin-menu .toggle-post-type");
      assert.ok(this.toggled);
      assert.ok(!(0, _qunitHelpers.exists)(".post-admin-menu"), "also hides the menu");
    });
    (0, _qunit.test)("toggle moderator post", async function (assert) {
      this.currentUser.set("moderator", true);
      this.set("args", {
        canManage: true
      });
      this.set("togglePostType", () => this.toggled = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @togglePostType={{this.togglePostType}} />
          
      */
      {
        "id": "+UHXrpt/",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@togglePostType\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"togglePostType\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".post-menu-area .show-post-admin-menu");
      await (0, _testHelpers.click)(".post-admin-menu .toggle-post-type");
      assert.ok(this.toggled);
      assert.ok(!(0, _qunitHelpers.exists)(".post-admin-menu"), "also hides the menu");
    });
    (0, _qunit.test)("rebake post", async function (assert) {
      this.set("args", {
        canManage: true
      });
      this.set("rebakePost", () => this.baked = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @rebakePost={{this.rebakePost}} />
          
      */
      {
        "id": "zIPi/s0H",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@rebakePost\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"rebakePost\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".post-menu-area .show-post-admin-menu");
      await (0, _testHelpers.click)(".post-admin-menu .rebuild-html");
      assert.ok(this.baked);
      assert.ok(!(0, _qunitHelpers.exists)(".post-admin-menu"), "also hides the menu");
    });
    (0, _qunit.test)("unhide post", async function (assert) {
      this.currentUser.admin = true;
      this.set("args", {
        canManage: true,
        hidden: true
      });
      this.set("unhidePost", () => this.unhidden = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @unhidePost={{this.unhidePost}} />
          
      */
      {
        "id": "41blkRCI",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@unhidePost\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"unhidePost\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".post-menu-area .show-post-admin-menu");
      await (0, _testHelpers.click)(".post-admin-menu .unhide-post");
      assert.ok(this.unhidden);
      assert.ok(!(0, _qunitHelpers.exists)(".post-admin-menu"), "also hides the menu");
    });
    (0, _qunit.test)("change owner", async function (assert) {
      this.currentUser.admin = true;
      this.set("args", {
        canManage: true
      });
      this.set("changePostOwner", () => this.owned = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @changePostOwner={{this.changePostOwner}} />
          
      */
      {
        "id": "fMjo3a4k",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@changePostOwner\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"changePostOwner\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".post-menu-area .show-post-admin-menu");
      await (0, _testHelpers.click)(".post-admin-menu .change-owner");
      assert.ok(this.owned);
      assert.ok(!(0, _qunitHelpers.exists)(".post-admin-menu"), "also hides the menu");
    });
    (0, _qunit.test)("reply", async function (assert) {
      this.set("args", {
        canCreatePost: true
      });
      this.set("replyToPost", () => this.replied = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <MountWidget @widget="post" @args={{this.args}} @replyToPost={{this.replyToPost}} />
          
      */
      {
        "id": "g2DZFEh2",
        "block": "[[[1,\"\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\",\"@replyToPost\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"replyToPost\"]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".post-controls .create");
      assert.ok(this.replied);
    });
    (0, _qunit.test)("reply - without permissions", async function (assert) {
      this.set("args", {
        canCreatePost: false
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".post-controls .create"));
    });
    (0, _qunit.test)("replies - no replies", async function (assert) {
      this.set("args", {
        replyCount: 0
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)("button.show-replies"));
    });
    (0, _qunit.test)("replies - multiple replies", async function (assert) {
      this.siteSettings.suppress_reply_directly_below = true;
      this.set("args", {
        replyCount: 2,
        replyDirectlyBelow: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)("button.show-replies"), 1);
    });
    (0, _qunit.test)("replies - one below, suppressed", async function (assert) {
      this.siteSettings.suppress_reply_directly_below = true;
      this.set("args", {
        replyCount: 1,
        replyDirectlyBelow: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)("button.show-replies"));
    });
    (0, _qunit.test)("replies - one below, not suppressed", async function (assert) {
      this.siteSettings.suppress_reply_directly_below = false;
      this.set("args", {
        id: 6654,
        replyCount: 1,
        replyDirectlyBelow: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)("button.show-replies");
      assert.strictEqual((0, _qunitHelpers.count)("section.embedded-posts.bottom .cooked"), 1);
      assert.strictEqual((0, _qunitHelpers.count)("section.embedded-posts .d-icon-arrow-down"), 1);
    });
    (0, _qunit.test)("topic map not shown", async function (assert) {
      this.set("args", {
        showTopicMap: false
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".topic-map"));
    });
    (0, _qunit.test)("topic map - few posts", async function (assert) {
      this.set("args", {
        showTopicMap: true,
        topicPostsCount: 2,
        participants: [{
          username: "eviltrout"
        }, {
          username: "codinghorror"
        }]
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)("li.avatars a.poster"), "shows no participants when collapsed");
      await (0, _testHelpers.click)("nav.buttons button");
      assert.strictEqual((0, _qunitHelpers.count)(".topic-map-expanded a.poster"), 2, "shows all when expanded");
    });
    (0, _qunit.test)("topic map - participants", async function (assert) {
      this.set("args", {
        showTopicMap: true,
        topicPostsCount: 10,
        participants: [{
          username: "eviltrout"
        }, {
          username: "codinghorror"
        }, {
          username: "sam"
        }, {
          username: "ZogStrIP"
        }],
        userFilters: ["sam", "codinghorror"]
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)("li.avatars a.poster"), 3, "limits to three participants");
      await (0, _testHelpers.click)("nav.buttons button");
      assert.ok(!(0, _qunitHelpers.exists)("li.avatars a.poster"));
      assert.strictEqual((0, _qunitHelpers.count)(".topic-map-expanded a.poster"), 4, "shows all when expanded");
      assert.strictEqual((0, _qunitHelpers.count)("a.poster.toggled"), 2, "two are toggled");
    });
    (0, _qunit.test)("topic map - links", async function (assert) {
      this.set("args", {
        showTopicMap: true,
        topicLinks: [{
          url: "http://link1.example.com",
          clicks: 0
        }, {
          url: "http://link2.example.com",
          clicks: 0
        }, {
          url: "http://link3.example.com",
          clicks: 0
        }, {
          url: "http://link4.example.com",
          clicks: 0
        }, {
          url: "http://link5.example.com",
          clicks: 0
        }, {
          url: "http://link6.example.com",
          clicks: 0
        }]
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".topic-map"), 1);
      assert.strictEqual((0, _qunitHelpers.count)(".map.map-collapsed"), 1);
      assert.ok(!(0, _qunitHelpers.exists)(".topic-map-expanded"));
      await (0, _testHelpers.click)("nav.buttons button");
      assert.ok(!(0, _qunitHelpers.exists)(".map.map-collapsed"));
      assert.strictEqual((0, _qunitHelpers.count)(".topic-map .d-icon-chevron-up"), 1);
      assert.strictEqual((0, _qunitHelpers.count)(".topic-map-expanded"), 1);
      assert.strictEqual((0, _qunitHelpers.count)(".topic-map-expanded .topic-link"), 5, "it limits the links displayed");
      await (0, _testHelpers.click)(".link-summary button");
      assert.strictEqual((0, _qunitHelpers.count)(".topic-map-expanded .topic-link"), 6, "all links now shown");
    });
    (0, _qunit.test)("topic map - no summary", async function (assert) {
      this.set("args", {
        showTopicMap: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".toggle-summary"));
    });
    (0, _qunit.test)("topic map - has summary", async function (assert) {
      this.set("args", {
        showTopicMap: true,
        hasTopicSummary: true
      });
      this.set("showSummary", () => this.summaryToggled = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} @showSummary={{this.showSummary}} />
      */
      {
        "id": "ylceejtb",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\",\"@showSummary\"],[\"post\",[30,0,[\"args\"]],[30,0,[\"showSummary\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".toggle-summary"), 1);
      await (0, _testHelpers.click)(".toggle-summary button");
      assert.ok(this.summaryToggled);
    });
    (0, _qunit.test)("pm map", async function (assert) {
      this.set("args", {
        showTopicMap: true,
        showPMMap: true,
        allowedGroups: [],
        allowedUsers: [_object.default.create({
          username: "eviltrout"
        })]
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".private-message-map"), 1);
      assert.strictEqual((0, _qunitHelpers.count)(".private-message-map .user"), 1);
    });
    (0, _qunit.test)("post notice - with username", async function (assert) {
      const twoDaysAgo = new Date();
      twoDaysAgo.setDate(twoDaysAgo.getDate() - 2);
      this.siteSettings.display_name_on_posts = false;
      this.siteSettings.prioritize_username_in_ux = true;
      this.siteSettings.old_post_notice_days = 14;
      this.set("args", {
        username: "codinghorror",
        name: "Jeff",
        created_at: new Date(),
        notice: {
          type: "returning_user",
          lastPostedAt: twoDaysAgo
        }
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".post-notice.returning-user:not(.old)").innerText.trim(), _I18n.default.t("post.notice.returning_user", {
        user: "codinghorror",
        time: "2 days ago"
      }));
    });
    (0, _qunit.test)("post notice - with name", async function (assert) {
      this.siteSettings.display_name_on_posts = true;
      this.siteSettings.prioritize_username_in_ux = false;
      this.siteSettings.old_post_notice_days = 14;
      this.set("args", {
        username: "codinghorror",
        name: "Jeff",
        created_at: new Date(2019, 0, 1),
        notice: {
          type: "new_user"
        }
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".post-notice.old.new-user").innerText.trim(), _I18n.default.t("post.notice.new_user", {
        user: "Jeff",
        time: "Jan '10"
      }));
    });
    (0, _qunit.test)("show group request in post", async function (assert) {
      this.set("args", {
        username: "foo",
        requestedGroupName: "testGroup"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const link = (0, _qunitHelpers.query)(".group-request a");
      assert.strictEqual(link.innerText.trim(), _I18n.default.t("groups.requests.handle"));
      assert.strictEqual(link.getAttribute("href"), "/g/testGroup/requests?filter=foo");
    });
    (0, _qunit.test)("shows user status if enabled in site settings", async function (assert) {
      this.siteSettings.enable_user_status = true;
      const status = {
        emoji: "tooth",
        description: "off to dentist"
      };

      const user = _user.default.create({
        status
      });

      this.set("args", {
        user
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".user-status-message"));
    });
    (0, _qunit.test)("doesn't show user status if disabled in site settings", async function (assert) {
      this.siteSettings.enable_user_status = false;
      const status = {
        emoji: "tooth",
        description: "off to dentist"
      };

      const user = _user.default.create({
        status
      });

      this.set("args", {
        user
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="post" @args={{this.args}} />
      */
      {
        "id": "npww/Zob",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"post\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.notOk((0, _qunitHelpers.exists)(".user-status-message"));
    });
  });
});
define("discourse/tests/integration/components/widgets/poster-name-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | Widget | poster-name", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("basic rendering", async function (assert) {
      this.set("args", {
        username: "eviltrout",
        usernameUrl: "/u/eviltrout",
        name: "Robin Ward",
        user_title: "Trout Master"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="poster-name" @args={{this.args}} />
      */
      {
        "id": "uDjVgLXf",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"poster-name\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".names"));
      assert.ok((0, _qunitHelpers.exists)("span.username"));
      assert.ok((0, _qunitHelpers.exists)('a[data-user-card="eviltrout"]'));
      assert.strictEqual((0, _qunitHelpers.query)(".username a").innerText, "eviltrout");
      assert.strictEqual((0, _qunitHelpers.query)(".full-name a").innerText, "Robin Ward");
      assert.strictEqual((0, _qunitHelpers.query)(".user-title").innerText, "Trout Master");
    });
    (0, _qunit.test)("extra classes and glyphs", async function (assert) {
      this.set("args", {
        username: "eviltrout",
        usernameUrl: "/u/eviltrout",
        staff: true,
        admin: true,
        moderator: true,
        new_user: true,
        primary_group_name: "fish"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="poster-name" @args={{this.args}} />
      */
      {
        "id": "uDjVgLXf",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"poster-name\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("span.staff"));
      assert.ok((0, _qunitHelpers.exists)("span.admin"));
      assert.ok((0, _qunitHelpers.exists)("span.moderator"));
      assert.ok((0, _qunitHelpers.exists)(".d-icon-shield-alt"));
      assert.ok((0, _qunitHelpers.exists)("span.new-user"));
      assert.ok((0, _qunitHelpers.exists)("span.fish"));
    });
    (0, _qunit.test)("disable display name on posts", async function (assert) {
      this.siteSettings.display_name_on_posts = false;
      this.set("args", {
        username: "eviltrout",
        name: "Robin Ward"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="poster-name" @args={{this.args}} />
      */
      {
        "id": "uDjVgLXf",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"poster-name\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".full-name"));
    });
    (0, _qunit.test)("doesn't render a name if it's similar to the username", async function (assert) {
      this.siteSettings.prioritize_username_in_ux = true;
      this.siteSettings.display_name_on_posts = true;
      this.set("args", {
        username: "eviltrout",
        name: "evil-trout"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="poster-name" @args={{this.args}} />
      */
      {
        "id": "uDjVgLXf",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"poster-name\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".second"));
    });
  });
});
define("discourse/tests/integration/components/widgets/quick-access-item-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  const CONTENT_DIV_SELECTOR = "li > a > div";
  (0, _qunit.module)("Integration | Component | Widget | quick-access-item", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("content attribute is escaped", async function (assert) {
      this.set("args", {
        content: "<b>bold</b>"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="quick-access-item" @args={{this.args}} />
      */
      {
        "id": "LsNQjyzg",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"quick-access-item\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const contentDiv = (0, _qunitHelpers.query)(CONTENT_DIV_SELECTOR);
      assert.strictEqual(contentDiv.innerText, "<b>bold</b>");
    });
    (0, _qunit.test)("escapedContent attribute is not escaped", async function (assert) {
      this.set("args", {
        escapedContent: "&quot;quote&quot;"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="quick-access-item" @args={{this.args}} />
      */
      {
        "id": "LsNQjyzg",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"quick-access-item\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const contentDiv = (0, _qunitHelpers.query)(CONTENT_DIV_SELECTOR);
      assert.strictEqual(contentDiv.innerText, '"quote"');
    });
  });
});
define("discourse/tests/integration/components/widgets/render-glimmer-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/qunit-helpers", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/widgets/widget", "@ember/component", "discourse/widgets/render-glimmer", "discourse-common/utils/decorators"], function (_templateFactory, _qunit, _qunitHelpers, _componentTest, _testHelpers, _widget, _component, _renderGlimmer, _decorators) {
  "use strict";

  var _class, _class2;

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"ember-cli-htmlbars",0,"discourse/widgets/hbs-compiler",0,"discourse/widgets/widget",0,"@ember/component",0,"discourse/widgets/render-glimmer",0,"discourse-common/utils/decorators"eaimeta@70e063a35619d71f

  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }

  let DemoWidget = (_class = (_class2 = class DemoWidget extends _widget.default {
    constructor() {
      super(...arguments);

      _defineProperty(this, "tagName", "div.my-widget");
    }

    buildKey() {
      return "abc";
    }

    defaultState() {
      return {
        actionTriggered: false
      };
    }

    html(attrs, state) {
      return [this.attach("button", {
        label: "rerender",
        className: "triggerRerender",
        action: "dummyAction"
      }), new _renderGlimmer.default(this, "div.glimmer-wrapper", (0, _templateFactory.createTemplateFactory)(
      /*
        <div class='glimmer-content'>
                    arg1={{@data.arg1}} dynamicArg={{@data.dynamicArg}}
                  </div>
                  <DemoComponent @arg1={{@data.arg1}} @dynamicArg={{@data.dynamicArg}} @action={{@data.actionForComponentToTrigger}} @widgetActionTriggered={{@data.widgetActionTriggered}}/>
      */
      {
        "id": "6WdsCsZ+",
        "block": "[[[10,0],[14,0,\"glimmer-content\"],[12],[1,\"\\n              arg1=\"],[1,[30,1,[\"arg1\"]]],[1,\" dynamicArg=\"],[1,[30,1,[\"dynamicArg\"]]],[1,\"\\n            \"],[13],[1,\"\\n            \"],[8,[39,0],null,[[\"@arg1\",\"@dynamicArg\",\"@action\",\"@widgetActionTriggered\"],[[30,1,[\"arg1\"]],[30,1,[\"dynamicArg\"]],[30,1,[\"actionForComponentToTrigger\"]],[30,1,[\"widgetActionTriggered\"]]]],null]],[\"@data\"],false,[\"demo-component\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }), { ...attrs,
        actionForComponentToTrigger: this.actionForComponentToTrigger,
        widgetActionTriggered: state.actionTriggered
      })];
    }

    dummyAction() {}

    actionForComponentToTrigger() {
      this.state.actionTriggered = true;
      DemoWidget.actionTriggered = true;
      this.scheduleRerender();
    }

  }, _defineProperty(_class2, "actionTriggered", false), _class2), (_applyDecoratedDescriptor(_class.prototype, "actionForComponentToTrigger", [_decorators.bind], Object.getOwnPropertyDescriptor(_class.prototype, "actionForComponentToTrigger"), _class.prototype)), _class);

  class DemoComponent extends _component.default {
    constructor() {
      super(...arguments);

      _defineProperty(this, "classNames", ["demo-component"]);

      _defineProperty(this, "layout", (0, _templateFactory.createTemplateFactory)(
      /*
        <DButton class="component-action-button" @label="component_action" @action={{@action}} /><p class='action-state'>{{@widgetActionTriggered}}</p>
      */
      {
        "id": "8exVb7WP",
        "block": "[[[8,[39,0],[[24,0,\"component-action-button\"]],[[\"@label\",\"@action\"],[\"component_action\",[30,1]]],null],[10,2],[14,0,\"action-state\"],[12],[1,[30,2]],[13]],[\"@action\",\"@widgetActionTriggered\"],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
    }

    init() {
      DemoComponent.eventLog.push("init");
      super.init(...arguments);
    }

    didInsertElement() {
      DemoComponent.eventLog.push("didInsertElement");
    }

    willDestroyElement() {
      DemoComponent.eventLog.push("willDestroyElement");
    }

    didReceiveAttrs() {
      DemoComponent.eventLog.push("didReceiveAttrs");
    }

    willDestroy() {
      DemoComponent.eventLog.push("willDestroy");
    }

  }

  _defineProperty(DemoComponent, "eventLog", []);

  class ToggleDemoWidget extends _widget.default {
    constructor() {
      super(...arguments);

      _defineProperty(this, "tagName", "div.my-widget");
    }

    buildKey() {
      return "abc";
    }

    defaultState() {
      return {
        showOne: true
      };
    }

    html(attrs, state) {
      const output = [this.attach("button", {
        label: "toggle",
        className: "toggleButton",
        action: "toggleComponent"
      })];

      if (state.showOne) {
        output.push(new _renderGlimmer.default(this, "div.glimmer-wrapper", (0, _templateFactory.createTemplateFactory)(
        /*
          One
        */
        {
          "id": "8jrIHcNy",
          "block": "[[[1,\"One\"]],[],false,[]]",
          "moduleName": "(unknown template module)",
          "isStrictMode": false
        }), {}));
      } else {
        output.push(new _renderGlimmer.default(this, "div.glimmer-wrapper", (0, _templateFactory.createTemplateFactory)(
        /*
          Two
        */
        {
          "id": "Ca2zT9Op",
          "block": "[[[1,\"Two\"]],[],false,[]]",
          "moduleName": "(unknown template module)",
          "isStrictMode": false
        }), {}));
      }

      return output;
    }

    toggleComponent() {
      this.state.showOne = !this.state.showOne;
    }

  }

  _defineProperty(ToggleDemoWidget, "actionTriggered", false);

  (0, _qunit.module)("Integration | Component | Widget | render-glimmer", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    hooks.beforeEach(function () {
      DemoComponent.eventLog = [];
      DemoWidget.actionTriggered = false;
      this.registry.register("widget:demo-widget", DemoWidget);
      this.registry.register("widget:toggle-demo-widget", ToggleDemoWidget);
      this.registry.register("component:demo-component", DemoComponent);
    });
    hooks.afterEach(function () {
      this.registry.unregister("widget:demo-widget");
      this.registry.unregister("widget:toggle-demo-widget");
      this.registry.unregister("component:demo-component");
    });
    (0, _qunit.test)("argument handling", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <Input class='dynamic-value-input' @type="text" @value={{this.dynamicValue}} />
              <MountWidget @widget="demo-widget" @args={{hash arg1="val1" dynamicArg=this.dynamicValue}} />
      */
      {
        "id": "oXd+xUT6",
        "block": "[[[1,\"\\n        \"],[8,[39,0],[[24,0,\"dynamic-value-input\"]],[[\"@type\",\"@value\"],[\"text\",[30,0,[\"dynamicValue\"]]]],null],[1,\"\\n        \"],[8,[39,1],null,[[\"@widget\",\"@args\"],[\"demo-widget\",[28,[37,2],null,[[\"arg1\",\"dynamicArg\"],[\"val1\",[30,0,[\"dynamicValue\"]]]]]]],null]],[],false,[\"input\",\"mount-widget\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.true((0, _qunitHelpers.exists)("div.my-widget"), "widget is rendered");
      assert.true((0, _qunitHelpers.exists)("div.glimmer-content"), "glimmer content is rendered");
      assert.strictEqual((0, _qunitHelpers.query)("div.glimmer-content").innerText, "arg1=val1 dynamicArg=", "arguments are passed through");
      await (0, _testHelpers.fillIn)("input.dynamic-value-input", "somedynamicvalue");
      assert.strictEqual((0, _qunitHelpers.query)("div.glimmer-content").innerText, "arg1=val1 dynamicArg=", "changed arguments do not change before rerender");
      await (0, _testHelpers.click)(".my-widget button");
      assert.strictEqual((0, _qunitHelpers.query)("div.glimmer-content").innerText, "arg1=val1 dynamicArg=somedynamicvalue", "changed arguments are applied after rerender");
    });
    (0, _qunit.test)("child component lifecycle", async function (assert) {
      assert.deepEqual(DemoComponent.eventLog, [], "component event log starts empty");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <Input class='dynamic-value-input' @type="text" @value={{this.dynamicValue}} />
              {{#unless (eq this.dynamicValue 'hidden')}}
                <MountWidget @widget="demo-widget" @args={{hash arg1="val1" dynamicArg=this.dynamicValue}} />
              {{/unless}}
      */
      {
        "id": "WB+KC1nV",
        "block": "[[[1,\"\\n        \"],[8,[39,0],[[24,0,\"dynamic-value-input\"]],[[\"@type\",\"@value\"],[\"text\",[30,0,[\"dynamicValue\"]]]],null],[1,\"\\n\"],[41,[51,[28,[37,2],[[30,0,[\"dynamicValue\"]],\"hidden\"],null]],[[[1,\"          \"],[8,[39,3],null,[[\"@widget\",\"@args\"],[\"demo-widget\",[28,[37,4],null,[[\"arg1\",\"dynamicArg\"],[\"val1\",[30,0,[\"dynamicValue\"]]]]]]],null],[1,\"\\n\"]],[]],null]],[],false,[\"input\",\"unless\",\"eq\",\"mount-widget\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.true((0, _qunitHelpers.exists)("div.my-widget"), "widget is rendered");
      assert.true((0, _qunitHelpers.exists)("div.glimmer-content"), "glimmer content is rendered");
      assert.true((0, _qunitHelpers.exists)("div.demo-component"), "demo component is rendered");
      assert.deepEqual(DemoComponent.eventLog, ["init", "didReceiveAttrs", "didInsertElement"], "component is initialized correctly");
      DemoComponent.eventLog = [];
      await (0, _testHelpers.fillIn)("input.dynamic-value-input", "somedynamicvalue");
      assert.deepEqual(DemoComponent.eventLog, [], "component is not notified of attr change before widget rerender");
      await (0, _testHelpers.click)(".my-widget button");
      assert.deepEqual(DemoComponent.eventLog, ["didReceiveAttrs"], "component is notified of attr change during widget rerender");
      DemoComponent.eventLog = [];
      await (0, _testHelpers.fillIn)("input.dynamic-value-input", "hidden");
      assert.deepEqual(DemoComponent.eventLog, ["willDestroyElement", "willDestroy"], "destroy hooks are run correctly");
      DemoComponent.eventLog = [];
      await (0, _testHelpers.fillIn)("input.dynamic-value-input", "visibleAgain");
      assert.deepEqual(DemoComponent.eventLog, ["init", "didReceiveAttrs", "didInsertElement"], "component can be reinitialized");
    });
    (0, _qunit.test)("trigger widget actions from component", async function (assert) {
      assert.false(DemoWidget.actionTriggered, "widget event has not been triggered yet");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <Input class='dynamic-value-input' @type="text" @value={{this.dynamicValue}} />
              {{#unless (eq this.dynamicValue 'hidden')}}
                <MountWidget @widget="demo-widget" @args={{hash arg1="val1" dynamicArg=this.dynamicValue}} />
              {{/unless}}
      */
      {
        "id": "WB+KC1nV",
        "block": "[[[1,\"\\n        \"],[8,[39,0],[[24,0,\"dynamic-value-input\"]],[[\"@type\",\"@value\"],[\"text\",[30,0,[\"dynamicValue\"]]]],null],[1,\"\\n\"],[41,[51,[28,[37,2],[[30,0,[\"dynamicValue\"]],\"hidden\"],null]],[[[1,\"          \"],[8,[39,3],null,[[\"@widget\",\"@args\"],[\"demo-widget\",[28,[37,4],null,[[\"arg1\",\"dynamicArg\"],[\"val1\",[30,0,[\"dynamicValue\"]]]]]]],null],[1,\"\\n\"]],[]],null]],[],false,[\"input\",\"unless\",\"eq\",\"mount-widget\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.true((0, _qunitHelpers.exists)("div.demo-component button"), "component button is rendered");
      await (0, _testHelpers.click)("div.demo-component button");
      assert.true(DemoWidget.actionTriggered, "widget event is triggered");
    });
    (0, _qunit.test)("modify widget state with component action", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="demo-widget" @args={{hash arg1="val1"}} />
      */
      {
        "id": "kIqlBGrU",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"demo-widget\",[28,[37,1],null,[[\"arg1\"],[\"val1\"]]]]],null]],[],false,[\"mount-widget\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.false(DemoWidget.actionTriggered, "widget event has not been triggered yet");
      assert.strictEqual((0, _qunitHelpers.query)(".action-state").innerText, "false", "eventTriggered is false in nested component");
      assert.true((0, _qunitHelpers.exists)("div.demo-component button"), "component button is rendered");
      await (0, _testHelpers.click)("div.demo-component button");
      assert.true(DemoWidget.actionTriggered, "widget event is triggered");
      assert.strictEqual((0, _qunitHelpers.query)(".action-state").innerText, "true", "eventTriggered is true in nested component");
    });
    (0, _qunit.test)("developer ergonomics", function (assert) {
      assert.throws(() => {
        // eslint-disable-next-line no-new
        new _renderGlimmer.default(this, "div", `<NotActuallyATemplate />`);
      }, /`template` should be a template compiled via `ember-cli-htmlbars`/, "it raises a useful error when passed a string instead of a template");
      assert.throws(() => {
        // eslint-disable-next-line no-new
        new _renderGlimmer.default(this, "div", function (attrs, state) {
          var _r = [];

          _r.push(using - the - wrong - compiler);

          return _r;
        });
      }, /`template` should be a template compiled via `ember-cli-htmlbars`/, "it raises a useful error when passed a widget-hbs-compiler template"); // eslint-disable-next-line no-new

      new _renderGlimmer.default(this, "div", (0, _templateFactory.createTemplateFactory)(
      /*
        <TheCorrectCompiler />
      */
      {
        "id": "eQUtPktT",
        "block": "[[[8,[39,0],null,null,null]],[],false,[\"the-correct-compiler\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.true(true, "it doesn't raise an error for correct params");
    });
    (0, _qunit.test)("multiple adjacent components", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="toggle-demo-widget" />
      */
      {
        "id": "KdLbw8Nq",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"toggle-demo-widget\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("div.glimmer-wrapper").innerText, "One");
      await (0, _testHelpers.click)(".toggleButton");
      assert.strictEqual((0, _qunitHelpers.query)("div.glimmer-wrapper").innerText, "Two");
      await (0, _testHelpers.click)(".toggleButton");
      assert.strictEqual((0, _qunitHelpers.query)("div.glimmer-wrapper").innerText, "One");
    });
  });
});
define("discourse/tests/integration/components/widgets/small-user-list-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | Widget | small-user-list", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("renders avatars and support for unknown", async function (assert) {
      this.set("args", {
        users: [{
          id: 456,
          username: "eviltrout"
        }, {
          id: 457,
          username: "someone",
          unknown: true
        }]
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="small-user-list" @args={{this.args}} />
      */
      {
        "id": "g13i/Sas",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"small-user-list\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)('[data-user-card="eviltrout"]'), 1);
      assert.ok(!(0, _qunitHelpers.exists)('[data-user-card="someone"]'));
      assert.ok((0, _qunitHelpers.exists)(".unknown"), "includes unknown user");
    });
  });
});
define("discourse/tests/integration/components/widgets/topic-admin-menu-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/models/category", "discourse/models/topic"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _category, _topic) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/models/category",0,"discourse/models/topic"eaimeta@70e063a35619d71f

  const createArgs = topic => {
    return {
      topic,
      openUpwards: "true",
      toggleMultiSelect: () => {},
      deleteTopic: () => {},
      recoverTopic: () => {},
      toggleClosed: () => {},
      toggleArchived: () => {},
      toggleVisibility: () => {},
      showTopicTimerModal: () => {},
      showFeatureTopic: () => {},
      showChangeTimestamp: () => {},
      resetBumpDate: () => {},
      convertToPublicTopic: () => {},
      convertToPrivateMessage: () => {}
    };
  };

  (0, _qunit.module)("Integration | Component | Widget | topic-admin-menu-button", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("topic-admin-menu-button is present for admin/moderators", async function (assert) {
      this.currentUser.setProperties({
        admin: true,
        moderator: true,
        id: 123
      });

      const topic = _topic.default.create({
        user_id: this.currentUser.id
      });

      topic.set("category_id", _category.default.create({
        read_restricted: true
      }).id);
      this.siteSettings.allow_featured_topic_on_user_profiles = true;
      this.set("args", createArgs(topic));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="topic-admin-menu-button" @args={{this.args}} />
      */
      {
        "id": "7YYIAZty",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"topic-admin-menu-button\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".toggle-admin-menu"), "admin wrench is present");
    });
    (0, _qunit.test)("topic-admin-menu-button hides for non-admin when there is no action", async function (assert) {
      this.currentUser.setProperties({
        admin: false,
        moderator: false,
        id: 123
      });

      const topic = _topic.default.create({
        user_id: this.currentUser.id
      });

      topic.set("category_id", _category.default.create({
        read_restricted: true
      }).id);
      this.siteSettings.allow_featured_topic_on_user_profiles = true;
      this.set("args", createArgs(topic));
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="topic-admin-menu-button" @args={{this.args}} />
      */
      {
        "id": "7YYIAZty",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"topic-admin-menu-button\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".toggle-admin-menu"), "admin wrench is not present");
    });
  });
});
define("discourse/tests/integration/components/widgets/topic-participant-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | Widget | topic-participant", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("one post", async function (assert) {
      this.set("args", {
        username: "test",
        avatar_template: "/images/avatar.png",
        post_count: 1
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="topic-participant" @args={{this.args}} />
      */
      {
        "id": "TT48blU+",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"topic-participant\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("a.poster.trigger-user-card"));
      assert.ok(!(0, _qunitHelpers.exists)("span.post-count"), "don't show count for only 1 post");
      assert.ok(!(0, _qunitHelpers.exists)(".avatar-flair"), "no avatar flair");
    });
    (0, _qunit.test)("many posts, a primary group with flair", async function (assert) {
      this.set("args", {
        username: "test",
        avatar_template: "/images/avatar.png",
        post_count: 2,
        primary_group_name: "devs",
        flair_name: "devs",
        flair_url: "/images/d-logo-sketch-small.png",
        flair_bg_color: "222"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="topic-participant" @args={{this.args}} />
      */
      {
        "id": "TT48blU+",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"topic-participant\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("a.poster.trigger-user-card"));
      assert.ok((0, _qunitHelpers.exists)("span.post-count"), "show count for many posts");
      assert.ok((0, _qunitHelpers.exists)(".group-devs a.poster"), "add class for the group outside the link");
      assert.ok((0, _qunitHelpers.exists)(".avatar-flair.avatar-flair-devs"), "show flair with group class");
    });
  });
});
define("discourse/tests/integration/components/widgets/topic-status-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "discourse/helpers/topic-status-icons", "discourse/tests/helpers/create-store"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _topicStatusIcons, _createStore) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/helpers/topic-status-icons",0,"discourse/tests/helpers/create-store"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | Widget | topic-status", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("basics", async function (assert) {
      const store = (0, _createStore.default)();
      this.set("args", {
        topic: store.createRecord("topic", {
          closed: true
        }),
        disableActions: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="topic-status" @args={{this.args}} />
      */
      {
        "id": "lfWlKgJ1",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"topic-status\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".topic-status .d-icon-lock"));
    });
    (0, _qunit.test)("extendability", async function (assert) {
      const store = (0, _createStore.default)();

      _topicStatusIcons.default.addObject(["has_accepted_answer", "far-check-square", "solved"]);

      this.set("args", {
        topic: store.createRecord("topic", {
          has_accepted_answer: true
        }),
        disableActions: true
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="topic-status" @args={{this.args}} />
      */
      {
        "id": "lfWlKgJ1",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"topic-status\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".topic-status .d-icon-far-check-square"));
    });
    (0, _qunit.test)("toggling pin status", async function (assert) {
      const store = (0, _createStore.default)();
      this.set("args", {
        topic: store.createRecord("topic", {
          closed: true,
          pinned: true
        })
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="topic-status" @args={{this.args}} />
      */
      {
        "id": "lfWlKgJ1",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"topic-status\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".topic-statuses .pinned"), "pinned icon is shown");
      assert.ok(!(0, _qunitHelpers.exists)(".topic-statuses .unpinned"), "unpinned icon is not shown");
      await (0, _testHelpers.click)(".topic-statuses .pin-toggle-button");
      assert.ok(!(0, _qunitHelpers.exists)(".topic-statuses .pinned"), "pinned icon is not shown");
      assert.ok((0, _qunitHelpers.exists)(".topic-statuses .unpinned"), "unpinned icon is shown");
      await (0, _testHelpers.click)(".topic-statuses .pin-toggle-button");
      assert.ok((0, _qunitHelpers.exists)(".topic-statuses .pinned"), "pinned icon is shown");
      assert.ok(!(0, _qunitHelpers.exists)(".topic-statuses .unpinned"), "unpinned icon is not shown");
    });
  });
});
define("discourse/tests/integration/components/widgets/user-menu-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "sinon", "discourse/lib/url", "I18n"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _sinon, _url, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"sinon",0,"discourse/lib/url",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | Widget | user-menu", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("basics", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="user-menu" />
      */
      {
        "id": "A4ltUYOJ",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"user-menu\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".user-menu"));
      assert.ok((0, _qunitHelpers.exists)(".user-preferences-link"));
      assert.ok((0, _qunitHelpers.exists)(".user-notifications-link"));
      assert.ok((0, _qunitHelpers.exists)(".user-bookmarks-link"));
      assert.ok((0, _qunitHelpers.exists)(".quick-access-panel"));
      assert.ok((0, _qunitHelpers.exists)(".notifications-dismiss"));
    });
    (0, _qunit.test)("notifications", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="user-menu" />
      */
      {
        "id": "A4ltUYOJ",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"user-menu\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const links = (0, _qunitHelpers.queryAll)(".quick-access-panel li a");
      assert.strictEqual(links.length, 6);
      assert.ok(links[1].href.includes("/t/a-slug/123"));
      assert.ok(links[2].href.includes("/u/eviltrout/notifications/likes-received?acting_username=aquaman"));
      assert.strictEqual(links[2].text, `aquaman ${_I18n.default.t("notifications.liked_consolidated_description", {
        count: 5
      })}`);
      assert.ok(links[3].href.includes("/u/test2/messages/group/test"));
      assert.ok(links[3].innerHTML.includes(_I18n.default.t("notifications.group_message_summary", {
        count: 5,
        group_name: "test"
      })));
      assert.ok(links[4].href.includes("/u/test1"));
      assert.ok(links[4].innerHTML.includes(_I18n.default.t("notifications.invitee_accepted", {
        username: "test1"
      })));
      assert.ok(links[5].href.includes("/g/test"));
      assert.ok(links[5].innerHTML.includes(_I18n.default.t("notifications.membership_request_accepted", {
        group_name: "test"
      })));

      const routeToStub = _sinon.default.stub(_url.default, "routeTo");

      await (0, _testHelpers.click)(".user-notifications-link");
      assert.ok(routeToStub.calledWith((0, _qunitHelpers.query)(".user-notifications-link").dataset.url), "a second click should redirect to the full notifications page");
    });
    (0, _qunit.test)("log out", async function (assert) {
      this.set("logout", () => this.loggedOut = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="user-menu" @logout={{this.logout}} />
      */
      {
        "id": "r/R0Vh3o",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@logout\"],[\"user-menu\",[30,0,[\"logout\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".user-preferences-link");
      assert.ok((0, _qunitHelpers.exists)(".logout"));
      await (0, _testHelpers.click)(".logout button");
      assert.ok(this.loggedOut);
    });
    (0, _qunit.test)("private messages - disabled", async function (assert) {
      this.siteSettings.enable_personal_messages = false;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="user-menu" />
      */
      {
        "id": "A4ltUYOJ",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"user-menu\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok(!(0, _qunitHelpers.exists)(".user-pms-link"));
    });
    (0, _qunit.test)("private messages - enabled", async function (assert) {
      this.siteSettings.enable_personal_messages = true;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="user-menu" />
      */
      {
        "id": "A4ltUYOJ",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"user-menu\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      const userPmsLink = (0, _qunitHelpers.query)(".user-pms-link").dataset.url;
      assert.ok(userPmsLink);
      await (0, _testHelpers.click)(".user-pms-link");
      const message = (0, _qunitHelpers.query)(".quick-access-panel li a");
      assert.ok(message);
      assert.ok(message.href.includes("/t/bug-can-not-render-emoji-properly/174/2"), "should link to the next unread post");
      assert.ok(message.innerHTML.includes("mixtape"), "should include the last poster's username");
      assert.ok(message.innerHTML.match(/<img.*class="emoji".*>/), "should correctly render emoji in message title");

      const routeToStub = _sinon.default.stub(_url.default, "routeTo");

      await (0, _testHelpers.click)(".user-pms-link");
      assert.ok(routeToStub.calledWith(userPmsLink), "a second click should redirect to the full private messages page");
    });
    (0, _qunit.test)("bookmarks", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="user-menu" />
      */
      {
        "id": "A4ltUYOJ",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"user-menu\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".user-bookmarks-link");
      const allBookmarks = (0, _qunitHelpers.queryAll)(".quick-access-panel li a");
      const bookmark = allBookmarks[0];
      assert.ok(bookmark.href.includes("/t/yelling-topic-title/119"), "the Post bookmark should have a link to the topic");
      assert.ok(bookmark.innerHTML.includes("someguy"), "should include the last poster's username");
      assert.ok(bookmark.innerHTML.match(/<img.*class="emoji".*>/), "should correctly render emoji in bookmark title");
      assert.ok(bookmark.innerHTML.includes("d-icon-bookmark"), "should use the correct icon based on no reminder_at present");

      const routeToStub = _sinon.default.stub(_url.default, "routeTo");

      await (0, _testHelpers.click)(".user-bookmarks-link");
      assert.ok(routeToStub.calledWith((0, _qunitHelpers.query)(".user-bookmarks-link").dataset.url), "a second click should redirect to the full bookmarks page");
      const nonPostBookmarkableBookmark = allBookmarks[1];
      assert.ok(nonPostBookmarkableBookmark.href.includes("chat/message/2437"), "bookmarkable_type that is not Post or Topic should use bookmarkable_url for the item link");
      assert.ok(nonPostBookmarkableBookmark.innerHTML.includes("d-icon-discourse-bookmark-clock"), "should use the correct icon based on reminder_at present");
    });
    (0, _qunit.test)("anonymous", async function (assert) {
      this.currentUser.setProperties({
        is_anonymous: false,
        trust_level: 3
      });
      this.siteSettings.allow_anonymous_posting = true;
      this.siteSettings.anonymous_posting_min_trust_level = 3;
      this.set("toggleAnonymous", () => this.anonymous = true);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <MountWidget @widget="user-menu" @toggleAnonymous={{this.toggleAnonymous}} />
            
      */
      {
        "id": "Il7QAkWn",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@widget\",\"@toggleAnonymous\"],[\"user-menu\",[30,0,[\"toggleAnonymous\"]]]],null],[1,\"\\n      \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".user-preferences-link");
      assert.ok((0, _qunitHelpers.exists)(".enable-anonymous"));
      await (0, _testHelpers.click)(".enable-anonymous");
      assert.ok(this.anonymous);
    });
    (0, _qunit.test)("anonymous - disabled", async function (assert) {
      this.siteSettings.allow_anonymous_posting = false;
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="user-menu" />
      */
      {
        "id": "A4ltUYOJ",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"user-menu\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".user-preferences-link");
      assert.ok(!(0, _qunitHelpers.exists)(".enable-anonymous"));
    });
    (0, _qunit.test)("anonymous - switch back", async function (assert) {
      this.currentUser.setProperties({
        is_anonymous: true
      });
      this.siteSettings.allow_anonymous_posting = true;
      this.set("toggleAnonymous", () => this.anonymous = false);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
              <MountWidget @widget="user-menu" @toggleAnonymous={{this.toggleAnonymous}} />
            
      */
      {
        "id": "Il7QAkWn",
        "block": "[[[1,\"\\n        \"],[8,[39,0],null,[[\"@widget\",\"@toggleAnonymous\"],[\"user-menu\",[30,0,[\"toggleAnonymous\"]]]],null],[1,\"\\n      \"]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await (0, _testHelpers.click)(".user-preferences-link");
      assert.ok((0, _qunitHelpers.exists)(".disable-anonymous"));
      await (0, _testHelpers.click)(".disable-anonymous");
      assert.notOk(this.anonymous);
    });
  });
});
define("discourse/tests/integration/components/widgets/widget-dropdown-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "I18n"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"I18n",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  const DEFAULT_CONTENT = {
    content: [{
      id: 1,
      label: "foo"
    }, {
      id: 2,
      translatedLabel: "FooBar"
    }, "separator", {
      id: 3,
      translatedLabel: "With icon",
      icon: "times"
    }, {
      id: 4,
      html: "<b>baz</b>"
    }, {
      id: 5,
      translatedLabel: "Disabled",
      disabled: true
    }],
    label: "foo"
  };

  async function clickRowById(id) {
    await (0, _testHelpers.click)(`#my-dropdown .widget-dropdown-item.item-${id}`);
  }

  function rowById(id) {
    return (0, _qunitHelpers.query)(`#my-dropdown .widget-dropdown-item.item-${id}`);
  }

  async function toggle() {
    await (0, _testHelpers.click)("#my-dropdown .widget-dropdown-header");
  }

  function headerLabel() {
    return (0, _qunitHelpers.query)("#my-dropdown .widget-dropdown-header .label").innerText.trim();
  }

  function header() {
    return (0, _qunitHelpers.query)("#my-dropdown .widget-dropdown-header");
  }

  function body() {
    return (0, _qunitHelpers.query)("#my-dropdown .widget-dropdown-body");
  }

  const TEMPLATE = (0, _templateFactory.createTemplateFactory)(
  /*
    
    <MountWidget
      @widget="widget-dropdown"
      @args={{hash
        id="my-dropdown"
        icon=this.icon
        label=this.label
        class=this.class
        translatedLabel=this.translatedLabel
        content=this.content
        options=this.options
      }}
    />
  
  */
  {
    "id": "23uchAQ9",
    "block": "[[[1,\"\\n  \"],[8,[39,0],null,[[\"@widget\",\"@args\"],[\"widget-dropdown\",[28,[37,1],null,[[\"id\",\"icon\",\"label\",\"class\",\"translatedLabel\",\"content\",\"options\"],[\"my-dropdown\",[30,0,[\"icon\"]],[30,0,[\"label\"]],[30,0,[\"class\"]],[30,0,[\"translatedLabel\"]],[30,0,[\"content\"]],[30,0,[\"options\"]]]]]]],null],[1,\"\\n\"]],[],false,[\"mount-widget\",\"hash\"]]",
    "moduleName": "(unknown template module)",
    "isStrictMode": false
  });
  (0, _qunit.module)("Integration | Component | Widget | widget-dropdown", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    let _translations = _I18n.default.translations;
    hooks.afterEach(function () {
      _I18n.default.translations = _translations;
    });
    (0, _qunit.test)("dropdown id", async function (assert) {
      this.setProperties(DEFAULT_CONTENT);
      await (0, _testHelpers.render)(TEMPLATE);
      assert.ok((0, _qunitHelpers.exists)("#my-dropdown"));
    });
    (0, _qunit.test)("label", async function (assert) {
      _I18n.default.translations = {
        en: {
          js: {
            foo: "FooBaz"
          }
        }
      };
      this.setProperties(DEFAULT_CONTENT);
      await (0, _testHelpers.render)(TEMPLATE);
      assert.strictEqual(headerLabel(), "FooBaz");
    });
    (0, _qunit.test)("translatedLabel", async function (assert) {
      _I18n.default.translations = {
        en: {
          js: {
            foo: "FooBaz"
          }
        }
      };
      this.setProperties(DEFAULT_CONTENT);
      this.set("translatedLabel", "BazFoo");
      await (0, _testHelpers.render)(TEMPLATE);
      assert.strictEqual(headerLabel(), this.translatedLabel);
    });
    (0, _qunit.test)("content", async function (assert) {
      this.setProperties(DEFAULT_CONTENT);
      await (0, _testHelpers.render)(TEMPLATE);
      await toggle();
      assert.strictEqual(rowById(1).dataset.id, "1", "it creates rows");
      assert.strictEqual(rowById(2).dataset.id, "2", "it creates rows");
      assert.strictEqual(rowById(3).dataset.id, "3", "it creates rows");
    });
    (0, _qunit.test)("onChange action", async function (assert) {
      this.setProperties(DEFAULT_CONTENT);
      this.set("onChange", item => (0, _qunitHelpers.query)("#test").innerText = item.id);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        
            <div id="test"></div>
      
            <MountWidget
              @widget="widget-dropdown"
              @args={{hash
                id="my-dropdown"
                label=this.label
                content=this.content
                onChange=this.onChange
              }}
            />
          
      */
      {
        "id": "pQKNRpvA",
        "block": "[[[1,\"\\n      \"],[10,0],[14,1,\"test\"],[12],[13],[1,\"\\n\\n      \"],[8,[39,0],null,[[\"@widget\",\"@args\"],[\"widget-dropdown\",[28,[37,1],null,[[\"id\",\"label\",\"content\",\"onChange\"],[\"my-dropdown\",[30,0,[\"label\"]],[30,0,[\"content\"]],[30,0,[\"onChange\"]]]]]]],null],[1,\"\\n    \"]],[],false,[\"mount-widget\",\"hash\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      await toggle();
      await clickRowById(2);
      assert.strictEqual((0, _qunitHelpers.query)("#test").innerText, "2", "it calls the onChange actions");
    });
    (0, _qunit.test)("can be opened and closed", async function (assert) {
      this.setProperties(DEFAULT_CONTENT);
      await (0, _testHelpers.render)(TEMPLATE);
      assert.ok((0, _qunitHelpers.exists)("#my-dropdown.closed"));
      assert.ok(!(0, _qunitHelpers.exists)("#my-dropdown .widget-dropdown-body"));
      await toggle();
      assert.strictEqual(rowById(2).innerText.trim(), "FooBar");
      assert.ok((0, _qunitHelpers.exists)("#my-dropdown.opened"));
      assert.ok((0, _qunitHelpers.exists)("#my-dropdown .widget-dropdown-body"));
      await toggle();
      assert.ok((0, _qunitHelpers.exists)("#my-dropdown.closed"));
      assert.ok(!(0, _qunitHelpers.exists)("#my-dropdown .widget-dropdown-body"));
    });
    (0, _qunit.test)("icon", async function (assert) {
      this.setProperties(DEFAULT_CONTENT);
      this.set("icon", "times");
      await (0, _testHelpers.render)(TEMPLATE);
      assert.ok((0, _qunitHelpers.exists)(header().querySelector(".d-icon-times")));
    });
    (0, _qunit.test)("class", async function (assert) {
      this.setProperties(DEFAULT_CONTENT);
      this.set("class", "activated");
      await (0, _testHelpers.render)(TEMPLATE);
      assert.ok((0, _qunitHelpers.exists)("#my-dropdown.activated"));
    });
    (0, _qunit.test)("content with translatedLabel", async function (assert) {
      this.setProperties(DEFAULT_CONTENT);
      await (0, _testHelpers.render)(TEMPLATE);
      await toggle();
      assert.strictEqual(rowById(2).innerText.trim(), "FooBar");
    });
    (0, _qunit.test)("content with label", async function (assert) {
      _I18n.default.translations = {
        en: {
          js: {
            foo: "FooBaz"
          }
        }
      };
      this.setProperties(DEFAULT_CONTENT);
      await (0, _testHelpers.render)(TEMPLATE);
      await toggle();
      assert.strictEqual(rowById(1).innerText.trim(), "FooBaz");
    });
    (0, _qunit.test)("content with icon", async function (assert) {
      this.setProperties(DEFAULT_CONTENT);
      await (0, _testHelpers.render)(TEMPLATE);
      await toggle();
      assert.ok((0, _qunitHelpers.exists)(rowById(3).querySelector(".d-icon-times")));
    });
    (0, _qunit.test)("content with html", async function (assert) {
      this.setProperties(DEFAULT_CONTENT);
      await (0, _testHelpers.render)(TEMPLATE);
      await toggle();
      assert.strictEqual(rowById(4).innerHTML.trim(), "<span><b>baz</b></span>");
    });
    (0, _qunit.test)("separator", async function (assert) {
      this.setProperties(DEFAULT_CONTENT);
      await (0, _testHelpers.render)(TEMPLATE);
      await toggle();
      assert.ok((0, _qunitHelpers.query)("#my-dropdown .widget-dropdown-item:nth-child(3)").classList.contains("separator"));
    });
    (0, _qunit.test)("hides widget if no content", async function (assert) {
      this.setProperties({
        content: null,
        label: "foo"
      });
      await (0, _testHelpers.render)(TEMPLATE);
      assert.notOk((0, _qunitHelpers.exists)("#my-dropdown .widget-dropdown-header"));
      assert.notOk((0, _qunitHelpers.exists)("#my-dropdown .widget-dropdown-body"));
    });
    (0, _qunit.test)("headerClass option", async function (assert) {
      this.setProperties(DEFAULT_CONTENT);
      this.set("options", {
        headerClass: "btn-small and-text"
      });
      await (0, _testHelpers.render)(TEMPLATE);
      assert.ok(header().classList.contains("widget-dropdown-header"));
      assert.ok(header().classList.contains("btn-small"));
      assert.ok(header().classList.contains("and-text"));
    });
    (0, _qunit.test)("bodyClass option", async function (assert) {
      this.setProperties(DEFAULT_CONTENT);
      this.set("options", {
        bodyClass: "gigantic and-yet-small"
      });
      await (0, _testHelpers.render)(TEMPLATE);
      await toggle();
      assert.ok(body().classList.contains("widget-dropdown-body"));
      assert.ok(body().classList.contains("gigantic"));
      assert.ok(body().classList.contains("and-yet-small"));
    });
    (0, _qunit.test)("caret option", async function (assert) {
      this.setProperties(DEFAULT_CONTENT);
      this.set("options", {
        caret: true
      });
      await (0, _testHelpers.render)(TEMPLATE);
      assert.ok((0, _qunitHelpers.exists)("#my-dropdown .widget-dropdown-header .d-icon-caret-down"));
    });
    (0, _qunit.test)("disabled widget", async function (assert) {
      this.setProperties(DEFAULT_CONTENT);
      this.set("options", {
        disabled: true
      });
      await (0, _testHelpers.render)(TEMPLATE);
      assert.ok((0, _qunitHelpers.exists)("#my-dropdown.disabled"));
      await toggle();
      assert.strictEqual(rowById(1), null, "it does not display options");
    });
    (0, _qunit.test)("disabled item", async function (assert) {
      this.setProperties(DEFAULT_CONTENT);
      await (0, _testHelpers.render)(TEMPLATE);
      await toggle();
      assert.ok((0, _qunitHelpers.exists)(".widget-dropdown-item.item-5.disabled"));
    });
  });
});
define("discourse/tests/integration/components/widgets/widget-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers", "I18n", "rsvp", "discourse/widgets/widget", "@ember/runloop", "discourse/lib/plugin-api"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers, _I18n, _rsvp, _widget, _runloop, _pluginApi) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse/widgets/hbs-compiler",0,"I18n",0,"rsvp",0,"discourse/widgets/widget",0,"@ember/runloop",0,"discourse/lib/plugin-api"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Component | Widget | base", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    let _translations = _I18n.default.translations;
    hooks.afterEach(function () {
      _I18n.default.translations = _translations;
    });
    (0, _qunit.test)("widget attributes are passed in via args", async function (assert) {
      (0, _widget.createWidget)("hello-test", {
        tagName: "div.test",
        template: function (attrs, state) {
          var _r = [];

          _r.push("Hello ");

          _r.push(attrs.name);

          return _r;
        }
      });
      this.set("args", {
        name: "Robin"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hello-test" @args={{this.args}} />
      */
      {
        "id": "sRhPJxlN",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"hello-test\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".test").innerText, "Hello Robin");
    });
    (0, _qunit.test)("widget services", async function (assert) {
      (0, _widget.createWidget)("service-test", {
        tagName: "div.base-url-test",
        services: ["router"],

        html() {
          return this.router.rootURL;
        }

      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="service-test" />
      */
      {
        "id": "FUQlMp9n",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"service-test\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".base-url-test").innerText, "/");
    });
    (0, _qunit.test)("hbs template - no tagName", async function (assert) {
      (0, _widget.createWidget)("hbs-test", {
        template: function (attrs, state) {
          var _r = [];
          var _a0 = [];

          _a0.push("Hello ");

          _a0.push(attrs.name);

          _r.push(virtualDom.h('div', {
            "className": "test",
            "attributes": {}
          }, _a0));

          return _r;
        }
      });
      this.set("args", {
        name: "Robin"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hbs-test" @args={{this.args}} />
      */
      {
        "id": "JbXoznCO",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"hbs-test\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("div.test").innerText, "Hello Robin");
    });
    (0, _qunit.test)("hbs template - with tagName", async function (assert) {
      (0, _widget.createWidget)("hbs-test", {
        tagName: "div.test",
        template: function (attrs, state) {
          var _r = [];

          _r.push("Hello ");

          _r.push(attrs.name);

          return _r;
        }
      });
      this.set("args", {
        name: "Robin"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hbs-test" @args={{this.args}} />
      */
      {
        "id": "JbXoznCO",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"hbs-test\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("div.test").innerText, "Hello Robin");
    });
    (0, _qunit.test)("hbs template - with data attributes", async function (assert) {
      (0, _widget.createWidget)("hbs-test", {
        template: function (attrs, state) {
          var _r = [];
          var _a0 = [];

          _r.push(virtualDom.h('div', {
            "className": "my-div",
            "attributes": {
              "data-my-test": "hello world"
            }
          }, _a0));

          return _r;
        }
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hbs-test" @args={{this.args}} />
      */
      {
        "id": "JbXoznCO",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"hbs-test\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("div.my-div").dataset.myTest, "hello world");
    });
    (0, _qunit.test)("buildClasses", async function (assert) {
      (0, _widget.createWidget)("classname-test", {
        tagName: "div.test",

        buildClasses(attrs) {
          return ["static", attrs.dynamic];
        }

      });
      this.set("args", {
        dynamic: "cool-class"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="classname-test" @args={{this.args}} />
      */
      {
        "id": "ytAvZRYn",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"classname-test\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".test.static.cool-class"), "it has all the classes");
    });
    (0, _qunit.test)("buildAttributes", async function (assert) {
      (0, _widget.createWidget)("attributes-test", {
        tagName: "div.test",

        buildAttributes(attrs) {
          return {
            "data-evil": "trout",
            "aria-label": attrs.label
          };
        }

      });
      this.set("args", {
        label: "accessibility"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="attributes-test" @args={{this.args}} />
      */
      {
        "id": "G/oINzC/",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"attributes-test\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)('.test[data-evil="trout"]'));
      assert.ok((0, _qunitHelpers.exists)('.test[aria-label="accessibility"]'));
    });
    (0, _qunit.test)("buildId", async function (assert) {
      (0, _widget.createWidget)("id-test", {
        buildId(attrs) {
          return `test-${attrs.id}`;
        }

      });
      this.set("args", {
        id: 1234
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="id-test" @args={{this.args}} />
      */
      {
        "id": "Gaamrcsb",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"id-test\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("#test-1234"));
    });
    (0, _qunit.test)("widget state", async function (assert) {
      (0, _widget.createWidget)("state-test", {
        tagName: "button.test",
        buildKey: () => `button-test`,
        template: function (attrs, state) {
          var _r = [];

          _r.push(state.clicks);

          _r.push(" clicks");

          return _r;
        },

        defaultState() {
          return {
            clicks: 0
          };
        },

        click() {
          this.state.clicks++;
        }

      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="state-test" />
      */
      {
        "id": "1YvRQ2H/",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"state-test\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("button.test"), "it renders the button");
      assert.strictEqual((0, _qunitHelpers.query)("button.test").innerText, "0 clicks");
      await (0, _testHelpers.click)((0, _qunitHelpers.query)("button"));
      assert.strictEqual((0, _qunitHelpers.query)("button.test").innerText, "1 clicks");
    });
    (0, _qunit.test)("widget update with promise", async function (assert) {
      (0, _widget.createWidget)("promise-test", {
        tagName: "button.test",
        buildKey: () => "promise-test",
        template: function (attrs, state) {
          var _r = [];

          _r.push("\n");

          if (state.name) {
            _r.push("          ");

            _r.push(state.name);

            _r.push("\n");
          } else {
            _r.push("          No name\n");
          }

          _r.push("      ");

          return _r;
        },

        click() {
          return new _rsvp.Promise(resolve => {
            (0, _runloop.next)(() => {
              this.state.name = "Robin";
              resolve();
            });
          });
        }

      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="promise-test" />
      */
      {
        "id": "qavvF4ow",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"promise-test\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("button.test").innerText.trim(), "No name");
      await (0, _testHelpers.click)((0, _qunitHelpers.query)("button"));
      assert.strictEqual((0, _qunitHelpers.query)("button.test").innerText.trim(), "Robin");
    });
    (0, _qunit.test)("widget attaching", async function (assert) {
      (0, _widget.createWidget)("test-embedded", {
        tagName: "div.embedded"
      });
      (0, _widget.createWidget)("attach-test", {
        tagName: "div.container",
        template: function (attrs, state) {
          var _r = [];

          _r.push(this.attach("test-embedded", attrs, undefined, undefined));

          return _r;
        }
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="attach-test" />
      */
      {
        "id": "Ki3FgVIs",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"attach-test\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".container"), "renders container");
      assert.ok((0, _qunitHelpers.exists)(".container .embedded"), "renders attached");
    });
    (0, _qunit.test)("magic attaching by name", async function (assert) {
      (0, _widget.createWidget)("test-embedded", {
        tagName: "div.embedded"
      });
      (0, _widget.createWidget)("attach-test", {
        tagName: "div.container",
        template: function (attrs, state) {
          var _r = [];

          _r.push(this.attach("test-embedded", attrs));

          return _r;
        }
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="attach-test" />
      */
      {
        "id": "Ki3FgVIs",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"attach-test\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".container"), "renders container");
      assert.ok((0, _qunitHelpers.exists)(".container .embedded"), "renders attached");
    });
    (0, _qunit.test)("custom attrs to a magic attached widget", async function (assert) {
      (0, _widget.createWidget)("testing", {
        tagName: "span.value",
        template: function (attrs, state) {
          var _r = [];

          _r.push(attrs.value);

          return _r;
        }
      });
      (0, _widget.createWidget)("attach-test", {
        tagName: "div.container",
        template: function (attrs, state) {
          var _r = [];

          _r.push(this.attach("testing", {
            "value": "hello" + " " + "world"
          }));

          return _r;
        }
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="attach-test" />
      */
      {
        "id": "Ki3FgVIs",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"attach-test\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".container"), "renders container");
      assert.strictEqual((0, _qunitHelpers.query)(".container .value").innerText, "hello world");
    });
    (0, _qunit.test)("using transformed values in a sub-expression", async function (assert) {
      (0, _widget.createWidget)("testing", {
        tagName: "span.value",
        template: function (attrs, state) {
          var _r = [];

          _r.push(attrs.value);

          return _r;
        }
      });
      (0, _widget.createWidget)("attach-test", {
        transform() {
          return {
            someValue: "world"
          };
        },

        tagName: "div.container",
        template: function (attrs, state) {
          var _r = [];

          _r.push(this.attach("testing", {
            "value": "hello" + " " + this.transformed.someValue
          }));

          return _r;
        }
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="attach-test" />
      */
      {
        "id": "Ki3FgVIs",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"attach-test\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.count)(".container"), "renders container");
      assert.strictEqual((0, _qunitHelpers.query)(".container .value").innerText, "hello world");
    });
    (0, _qunit.test)("handlebars d-icon", async function (assert) {
      (0, _widget.createWidget)("hbs-icon-test", {
        template: function (attrs, state) {
          var __h1 = __widget_helpers.iconNode;
          var _r = [];

          _r.push(__h1("arrow-down"));

          return _r;
        }
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hbs-icon-test" @args={{this.args}} />
      */
      {
        "id": "lcFZE16C",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"hbs-icon-test\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)(".d-icon-arrow-down"), 1);
    });
    (0, _qunit.test)("handlebars i18n", async function (assert) {
      (0, _widget.createWidget)("hbs-i18n-test", {
        template: function (attrs, state) {
          var _r = [];

          _r.push("\n        ");

          var _a0 = [];

          _a0.push(_I18n.default.t("hbs_test0"));

          _r.push(virtualDom.h('span', {
            "className": "string",
            "attributes": {}
          }, _a0));

          _r.push("\n        ");

          var _a1 = [];

          _a1.push(_I18n.default.t(attrs.key));

          _r.push(virtualDom.h('span', {
            "className": "var",
            "attributes": {}
          }, _a1));

          _r.push("\n        ");

          var _a2 = [];

          _a2.push("test");

          _r.push(virtualDom.h('a', {
            "attributes": {
              "href": "",
              "title": _I18n.default.t("hbs_test0")
            }
          }, _a2));

          _r.push("\n      ");

          return _r;
        }
      });
      _I18n.default.translations = {
        en: {
          js: {
            hbs_test0: "evil",
            hbs_test1: "trout"
          }
        }
      };
      this.set("args", {
        key: "hbs_test1"
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hbs-i18n-test" @args={{this.args}} />
      */
      {
        "id": "P852YK3x",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"hbs-i18n-test\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      })); // coming up

      assert.strictEqual((0, _qunitHelpers.query)("span.string").innerText, "evil");
      assert.strictEqual((0, _qunitHelpers.query)("span.var").innerText, "trout");
      assert.strictEqual((0, _qunitHelpers.query)("a").title, "evil");
    });
    (0, _qunit.test)("handlebars #each", async function (assert) {
      (0, _widget.createWidget)("hbs-each-test", {
        tagName: "ul",
        template: function (attrs, state) {
          var _r = [];

          _r.push("\n");

          if (attrs.items && attrs.items.length) {
            attrs.items.forEach(item => {
              _r.push("          ");

              var _a0 = [];

              _a0.push(item);

              _r.push(virtualDom.h('li', _a0));

              _r.push("\n");
            });
          }

          _r.push("      ");

          return _r;
        }
      });
      this.set("args", {
        items: ["one", "two", "three"]
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="hbs-each-test" @args={{this.args}} />
      */
      {
        "id": "ApfizCgi",
        "block": "[[[8,[39,0],null,[[\"@widget\",\"@args\"],[\"hbs-each-test\",[30,0,[\"args\"]]]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.count)("ul li"), 3);
      assert.strictEqual((0, _qunitHelpers.query)("ul li:nth-of-type(1)").innerText, "one");
    });
    (0, _qunit.test)("widget decorating", async function (assert) {
      (0, _widget.createWidget)("decorate-test", {
        tagName: "div.decorate",
        template: function (attrs, state) {
          var _r = [];

          _r.push("main content");

          return _r;
        }
      });
      (0, _pluginApi.withPluginApi)("0.1", api => {
        api.decorateWidget("decorate-test:before", dec => {
          return dec.h("b", "before");
        });
        api.decorateWidget("decorate-test:after", dec => {
          return dec.h("i", "after");
        });
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="decorate-test" />
      */
      {
        "id": "03jsUzlQ",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"decorate-test\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(".decorate"));
      assert.strictEqual((0, _qunitHelpers.query)(".decorate b").innerText, "before");
      assert.strictEqual((0, _qunitHelpers.query)(".decorate i").innerText, "after");
    });
    (0, _qunit.test)("widget settings", async function (assert) {
      (0, _widget.createWidget)("settings-test", {
        tagName: "div.settings",
        template: function (attrs, state) {
          var _r = [];

          _r.push("age is ");

          _r.push(this.settings.age);

          return _r;
        },
        settings: {
          age: 36
        }
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="settings-test" />
      */
      {
        "id": "A4z5v5X6",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"settings-test\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".settings").innerText, "age is 36");
    });
    (0, _qunit.test)("override settings", async function (assert) {
      (0, _widget.createWidget)("ov-settings-test", {
        tagName: "div.settings",
        template: function (attrs, state) {
          var _r = [];

          _r.push("age is ");

          _r.push(this.settings.age);

          return _r;
        },
        settings: {
          age: 36
        }
      });
      (0, _pluginApi.withPluginApi)("0.1", api => {
        api.changeWidgetSetting("ov-settings-test", "age", 37);
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="ov-settings-test" />
      */
      {
        "id": "Cu+yozQc",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"ov-settings-test\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)(".settings").innerText, "age is 37");
    });
    (0, _qunit.test)("get accessor", async function (assert) {
      (0, _widget.createWidget)("get-accessor-test", {
        tagName: "div.test",
        template: function (attrs, state) {
          var _r = [];

          _r.push("Hello ");

          _r.push(this.transformed.name);

          return _r;
        },

        transform() {
          return {
            name: this.get("currentUser.username")
          };
        }

      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="get-accessor-test" />
      */
      {
        "id": "yuLqmdOU",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"get-accessor-test\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual((0, _qunitHelpers.query)("div.test").innerText, "Hello eviltrout");
    });
    (0, _qunit.test)("tagName", async function (assert) {
      (0, _widget.createWidget)("test-override", {
        tagName: "div.not-override"
      });
      (0, _widget.createWidget)("tag-name-override-test", {
        template: function (attrs, state) {
          var _r = [];

          _r.push(this.attach("test-override", attrs, undefined, {
            "tagName": "section.override"
          }));

          return _r;
        }
      });
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <MountWidget @widget="tag-name-override-test" />
      */
      {
        "id": "CRwLjYHF",
        "block": "[[[8,[39,0],null,[[\"@widget\"],[\"tag-name-override-test\"]],null]],[],false,[\"mount-widget\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)("section.override"), "renders container with overridden tagName");
    });
  });
});
define("discourse/tests/integration/components/wizard-invite-list-test", [], function () {
  "use strict";

  0; //eaimeta@70e063a35619d71feaimeta@70e063a35619d71f
});
define("discourse/tests/integration/helpers/concat-class-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"ember-cli-htmlbars",0,"discourse/tests/helpers/qunit-helpers"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Helper | concat-class", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("One class given", async function () {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <button class={{concat-class "foo"}} />
      */
      {
        "id": "pVEJFBIF",
        "block": "[[[10,\"button\"],[15,0,[28,[37,0],[\"foo\"],null]],[12],[13]],[],false,[\"concat-class\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));

      _qunit.assert.equal((0, _qunitHelpers.query)("button").className, "foo");
    });
    (0, _qunit.test)("Multiple class given", async function () {
      this.set("bar", "bar");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <button class={{concat-class "foo" this.bar}} />
      */
      {
        "id": "tVobSzuW",
        "block": "[[[10,\"button\"],[15,0,[28,[37,0],[\"foo\",[30,0,[\"bar\"]]],null]],[12],[13]],[],false,[\"concat-class\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));

      _qunit.assert.equal((0, _qunitHelpers.query)("button").className, "foo bar");
    });
    (0, _qunit.test)("One undefined class given", async function () {
      this.set("bar", null);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <button class={{concat-class "foo" this.bar}} />
      */
      {
        "id": "tVobSzuW",
        "block": "[[[10,\"button\"],[15,0,[28,[37,0],[\"foo\",[30,0,[\"bar\"]]],null]],[12],[13]],[],false,[\"concat-class\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));

      _qunit.assert.equal((0, _qunitHelpers.query)("button").className, "foo");
    });
    (0, _qunit.test)("Only undefined class given", async function () {
      this.set("bar", null);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <button class={{concat-class null this.bar}} />
      */
      {
        "id": "kOCPvJFT",
        "block": "[[[10,\"button\"],[15,0,[28,[37,0],[null,[30,0,[\"bar\"]]],null]],[12],[13]],[],false,[\"concat-class\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));

      _qunit.assert.notOk((0, _qunitHelpers.query)("button").hasAttribute("class"));
    });
    (0, _qunit.test)("Helpers used", async function () {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <button class={{concat-class (if true "foo") (if true "bar")}} />
      */
      {
        "id": "We9IeulD",
        "block": "[[[10,\"button\"],[15,0,[28,[37,0],[[52,true,\"foo\"],[52,true,\"bar\"]],null]],[12],[13]],[],false,[\"concat-class\",\"if\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));

      _qunit.assert.equal((0, _qunitHelpers.query)("button").className, "foo bar");
    });
  });
});
define("discourse/tests/integration/helpers/emoji-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/test-helpers", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _testHelpers, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/test-helpers",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Integration | Helper | emoji", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("it renders", async function (assert) {
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        {{emoji "tada"}}
      */
      {
        "id": "EOWrirR7",
        "block": "[[[1,[28,[35,0],[\"tada\"],null]]],[],false,[\"emoji\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(`.emoji[title="tada"]`));
    });
    (0, _qunit.test)("it renders custom title", async function (assert) {
      const title = "custom title";
      this.set("title", title);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        {{emoji "tada" title=this.title}}
      */
      {
        "id": "1mNlOp02",
        "block": "[[[1,[28,[35,0],[\"tada\"],[[\"title\"],[[30,0,[\"title\"]]]]]]],[],false,[\"emoji\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(`.emoji[title="${title}"]`));
    });
  });
});
define("discourse/tests/unit/controllers/admin-customize-themes-show-test", ["admin/models/theme", "discourse/tests/helpers/qunit-helpers", "qunit"], function (_theme, _qunitHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"admin/models/theme",0,"discourse/tests/helpers/qunit-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Controller | admin-customize-themes-show", function () {
    (0, _qunit.test)("can display source url for remote themes", function (assert) {
      const repoUrl = "https://github.com/discourse/discourse-brand-header.git";

      const remoteTheme = _theme.default.create({
        id: 2,
        default: true,
        name: "default",
        remote_theme: {
          remote_url: repoUrl
        }
      });

      const controller = this.getController("admin-customize-themes-show", {
        model: remoteTheme
      });
      assert.deepEqual(controller.get("remoteThemeLink"), repoUrl, "returns theme's repo URL");
    });
    (0, _qunit.test)("can display source url for remote theme branches", function (assert) {
      const remoteTheme = _theme.default.create({
        id: 2,
        default: true,
        name: "default",
        remote_theme: {
          remote_url: "https://github.com/discourse/discourse-brand-header.git",
          branch: "beta"
        }
      });

      const controller = this.getController("admin-customize-themes-show", {
        model: remoteTheme
      });
      assert.deepEqual(controller.get("remoteThemeLink"), "https://github.com/discourse/discourse-brand-header/tree/beta", "returns theme's repo URL to branch");
    });
  });
});
define("discourse/tests/unit/controllers/admin-customize-themes-test", ["admin/models/theme", "discourse/tests/helpers/qunit-helpers", "qunit"], function (_theme, _qunitHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"admin/models/theme",0,"discourse/tests/helpers/qunit-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Controller | admin-customize-themes", function () {
    (0, _qunit.test)("can list themes correctly", function (assert) {
      const defaultTheme = _theme.default.create({
        id: 2,
        default: true,
        name: "default"
      });

      const userTheme = _theme.default.create({
        id: 3,
        user_selectable: true,
        name: "name"
      });

      const strayTheme1 = _theme.default.create({
        id: 4,
        name: "stray1"
      });

      const strayTheme2 = _theme.default.create({
        id: 5,
        name: "stray2"
      });

      const componentTheme = _theme.default.create({
        id: 6,
        name: "component",
        component: true
      });

      const controller = this.getController("admin-customize-themes", {
        model: [strayTheme2, strayTheme1, userTheme, defaultTheme, componentTheme]
      });
      assert.deepEqual(controller.get("fullThemes").map(t => t.get("name")), [strayTheme2, strayTheme1, userTheme, defaultTheme].map(t => t.get("name")), "returns a list of themes without components");
      assert.deepEqual(controller.get("childThemes").map(t => t.get("name")), [componentTheme].map(t => t.get("name")), "separate components from themes");
    });
  });
});
define("discourse/tests/unit/controllers/admin-user-badges-test", ["discourse/models/badge", "discourse/tests/helpers/qunit-helpers", "qunit"], function (_badge, _qunitHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/models/badge",0,"discourse/tests/helpers/qunit-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Controller | admin-user-badges", function () {
    (0, _qunit.test)("grantableBadges", function (assert) {
      const badgeFirst = _badge.default.create({
        id: 3,
        name: "A Badge",
        enabled: true,
        manually_grantable: true
      });

      const badgeMiddle = _badge.default.create({
        id: 1,
        name: "My Badge",
        enabled: true,
        manually_grantable: true
      });

      const badgeLast = _badge.default.create({
        id: 2,
        name: "Zoo Badge",
        enabled: true,
        manually_grantable: true
      });

      const badgeDisabled = _badge.default.create({
        id: 4,
        name: "Disabled Badge",
        enabled: false,
        manually_grantable: true
      });

      const badgeAutomatic = _badge.default.create({
        id: 5,
        name: "Automatic Badge",
        enabled: true,
        manually_grantable: false
      });

      const controller = this.getController("admin-user-badges", {
        model: [],
        badges: [badgeLast, badgeFirst, badgeMiddle, badgeDisabled, badgeAutomatic]
      });
      const sortedNames = [badgeFirst.name, badgeMiddle.name, badgeLast.name];
      const badgeNames = controller.get("grantableBadges").map(function (badge) {
        return badge.name;
      });
      assert.notOk(badgeNames.includes(badgeDisabled), "excludes disabled badges");
      assert.deepEqual(badgeNames, sortedNames, "sorts badges by name");
    });
  });
});
define("discourse/tests/unit/controllers/avatar-selector-test", ["@ember/object", "discourse/tests/helpers/qunit-helpers", "discourse/mapping-router", "qunit"], function (_object, _qunitHelpers, _mappingRouter, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"@ember/object",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/mapping-router",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Controller | avatar-selector", function (hooks) {
    hooks.beforeEach(function () {
      (0, _mappingRouter.registerRouter)(this.registry);
    });
    (0, _qunit.test)("avatarTemplate", function (assert) {
      const user = _object.default.create({
        avatar_template: "avatar",
        system_avatar_template: "system",
        gravatar_avatar_template: "gravatar",
        system_avatar_upload_id: 1,
        gravatar_avatar_upload_id: 2,
        custom_avatar_upload_id: 3
      });

      const avatarSelectorController = this.getController("avatar-selector", {
        user
      });
      user.set("avatar_template", "system");
      assert.strictEqual(avatarSelectorController.get("selectedUploadId"), 1, "we are using system by default");
      user.set("avatar_template", "gravatar");
      assert.strictEqual(avatarSelectorController.get("selectedUploadId"), 2, "we are using gravatar when set");
      user.set("avatar_template", "avatar");
      assert.strictEqual(avatarSelectorController.get("selectedUploadId"), 3, "we are using custom when set");
    });
  });
});
define("discourse/tests/unit/controllers/create-account-test", ["I18n", "discourse/tests/helpers/qunit-helpers", "qunit", "@ember/test-helpers"], function (_I18n, _qunitHelpers, _qunit, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"I18n",0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Controller | create-account", function () {
    (0, _qunit.test)("basicUsernameValidation", function (assert) {
      const testInvalidUsername = (username, expectedReason) => {
        const controller = this.getController("create-account");
        controller.set("accountUsername", username);
        let validation = controller.basicUsernameValidation(username);
        assert.ok(validation.failed, "username should be invalid: " + username);
        assert.strictEqual(validation.reason, expectedReason, "username validation reason: " + username + ", " + expectedReason);
      };

      testInvalidUsername("", null);
      testInvalidUsername("x", _I18n.default.t("user.username.too_short"));
      testInvalidUsername("123456789012345678901", _I18n.default.t("user.username.too_long"));
      const controller = this.getController("create-account", {
        accountUsername: "porkchops",
        prefilledUsername: "porkchops"
      });
      let validation = controller.basicUsernameValidation("porkchops");
      assert.ok(validation.ok, "Prefilled username is valid");
      assert.strictEqual(validation.reason, _I18n.default.t("user.username.prefilled"), "Prefilled username is valid");
    });
    (0, _qunit.test)("passwordValidation", async function (assert) {
      const controller = this.getController("create-account");
      controller.set("authProvider", "");
      controller.set("accountEmail", "pork@chops.com");
      controller.set("accountUsername", "porkchops");
      controller.set("prefilledUsername", "porkchops");
      controller.set("accountPassword", "b4fcdae11f9167");
      assert.strictEqual(controller.passwordValidation.ok, true, "Password is ok");
      assert.strictEqual(controller.passwordValidation.reason, _I18n.default.t("user.password.ok"), "Password is valid");

      const testInvalidPassword = (password, expectedReason) => {
        controller.set("accountPassword", password);
        assert.strictEqual(controller.passwordValidation.failed, true, "password should be invalid: " + password);
        assert.strictEqual(controller.passwordValidation.reason, expectedReason, "password validation reason: " + password + ", " + expectedReason);
      };

      testInvalidPassword("", null);
      testInvalidPassword("x", _I18n.default.t("user.password.too_short"));
      testInvalidPassword("porkchops", _I18n.default.t("user.password.same_as_username"));
      testInvalidPassword("pork@chops.com", _I18n.default.t("user.password.same_as_email")); // Wait for username check request to finish

      await (0, _testHelpers.settled)();
    });
    (0, _qunit.test)("authProviderDisplayName", function (assert) {
      const controller = this.getController("create-account");
      assert.strictEqual(controller.authProviderDisplayName("facebook"), _I18n.default.t("login.facebook.name"), "provider name is translated correctly");
      assert.strictEqual(controller.authProviderDisplayName("idontexist"), "idontexist", "provider name falls back if not found");
    });
  });
});
define("discourse/tests/unit/controllers/history-test", ["discourse/tests/helpers/qunit-helpers", "qunit"], function (_qunitHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Controller | history", function () {
    (0, _qunit.test)("displayEdit", async function (assert) {
      const HistoryController = this.getController("history");
      HistoryController.setProperties({
        model: {
          last_revision: 3,
          current_revision: 3,
          can_edit: false
        },
        topicController: {}
      });
      assert.strictEqual(HistoryController.get("displayEdit"), false, "it should not display edit button when user cannot edit the post");
      HistoryController.set("model.can_edit", true);
      assert.strictEqual(HistoryController.get("displayEdit"), true, "it should display edit button when user can edit the post");
      HistoryController.set("topicController", null);
      assert.strictEqual(HistoryController.get("displayEdit"), false, "it should not display edit button when there is not topic controller");
      HistoryController.set("topicController", {});
      HistoryController.set("model.current_revision", 2);
      assert.strictEqual(HistoryController.get("displayEdit"), false, "it should only display the edit button on the latest revision");
      const html = `<div class="revision-content">
    <p><img src="/uploads/default/original/1X/6b963ffc13cb0c053bbb90c92e99d4fe71b286ef.jpg" alt="" class="diff-del"><img/src=x onerror=alert(document.domain)>" width="276" height="183"></p>
  </div>
  <aside class="onebox allowlistedgeneric">
    <header class="source">
      <img src="/uploads/default/original/1X/1b0984d7ee08bce90572f46a1950e1ced436d028.png" class="site-icon" width="32" height="32">
      <a href="https://meta.discourse.org/t/discourse-version-2-5/125302">Discourse Meta  9 Aug 19</a>
    </header>
    <article class="onebox-body">
      <img src="/uploads/default/optimized/1X/ecc92a52ee7353e03d5c0d1ea6521ce4541d9c25_2_500x500.png" class="thumbnail onebox-avatar d-lazyload" width="500" height="500">
      <h3><a href="https://meta.discourse.org/t/discourse-version-2-5/125302" target="_blank">Discourse Version 2.5</a></h3>
      <div style="clear: both"></div>
    </article>
  </aside>
  <table background="javascript:alert(\"HACKEDXSS\")">
    <thead>
      <tr>
        <th>Column</th>
        <th style="text-align:left">Test</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td background="javascript:alert('HACKEDXSS')">Osama</td>
        <td style="text-align:right">Testing</td>
      </tr>
    </tbody>
  </table>`;
      const expectedOutput = `<div class="revision-content">
    <p><img src="/uploads/default/original/1X/6b963ffc13cb0c053bbb90c92e99d4fe71b286ef.jpg" alt class="diff-del">" width="276" height="183"&gt;</p>
  </div>
  <aside class="onebox allowlistedgeneric">
    <header class="source">
      <img src="/uploads/default/original/1X/1b0984d7ee08bce90572f46a1950e1ced436d028.png" class="site-icon" width="32" height="32">
      <a href="https://meta.discourse.org/t/discourse-version-2-5/125302">Discourse Meta  9 Aug 19</a>
    </header>
    <article class="onebox-body">
      <img src="/uploads/default/optimized/1X/ecc92a52ee7353e03d5c0d1ea6521ce4541d9c25_2_500x500.png" class="thumbnail onebox-avatar d-lazyload" width="500" height="500">
      <h3><a href="https://meta.discourse.org/t/discourse-version-2-5/125302" target="_blank">Discourse Version 2.5</a></h3>
      <div style="clear: both"></div>
    </article>
  </aside>
  <table>
    <thead>
      <tr>
        <th>Column</th>
        <th style="text-align:left">Test</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Osama</td>
        <td style="text-align:right">Testing</td>
      </tr>
    </tbody>
  </table>`;
      HistoryController.setProperties({
        viewMode: "side_by_side",
        model: {
          body_changes: {
            side_by_side: html
          }
        }
      });
      await HistoryController.bodyDiffChanged();
      const output = HistoryController.get("bodyDiff");
      assert.strictEqual(output, expectedOutput, "it keeps HTML safe and doesn't strip onebox tags");
    });
  });
});
define("discourse/tests/unit/controllers/preferences-account-test", ["discourse/tests/helpers/qunit-helpers", "qunit"], function (_qunitHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Controller | preferences/account", function () {
    (0, _qunit.test)("updating of associated accounts", function (assert) {
      const controller = this.getController("preferences/account", {
        siteSettings: {
          enable_google_oauth2_logins: true
        },
        model: {
          id: 70,
          second_factor_enabled: true,
          is_anonymous: true
        },
        currentUser: {
          id: 1234
        },
        site: {
          isMobileDevice: false
        }
      });
      assert.strictEqual(controller.get("canUpdateAssociatedAccounts"), false);
      controller.set("model.second_factor_enabled", false);
      assert.strictEqual(controller.get("canUpdateAssociatedAccounts"), false);
      controller.set("model.is_anonymous", false);
      assert.strictEqual(controller.get("canUpdateAssociatedAccounts"), false);
      controller.set("model.id", 1234);
      assert.strictEqual(controller.get("canUpdateAssociatedAccounts"), true);
    });
  });
});
define("discourse/tests/unit/controllers/preferences-profile-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "discourse/models/user", "discourse/models/site"], function (_qunitHelpers, _qunit, _user, _site) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"discourse/models/user",0,"discourse/models/site"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Controller | preferences/profile", function () {
    (0, _qunit.test)("prepare custom field data", function (assert) {
      const controller = this.getController("preferences/profile", {
        model: _user.default.create({
          id: 70,
          second_factor_enabled: true,
          is_anonymous: true,
          user_fields: {
            1: "2",
            2: null,
            3: []
          }
        }),
        currentUser: {
          id: 1234
        }
      });

      _site.default.currentProp("user_fields", [{
        position: 1,
        id: 1,
        editable: true
      }, {
        position: 2,
        id: 2,
        editable: true
      }, {
        position: 3,
        id: 3,
        editable: true
      }]); // Since there are no injections in unit tests


      controller.set("site", _site.default.current());
      controller.send("_updateUserFields");
      const fields = controller.model.user_fields;
      assert.strictEqual(fields[1], "2", "updates string value");
      assert.strictEqual(fields[2], null, "updates null");
      assert.strictEqual(fields[3], null, "updates empty array as null");
    });
  });
});
define("discourse/tests/unit/controllers/preferences-second-factor-test", ["discourse/tests/helpers/qunit-helpers", "qunit"], function (_qunitHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Controller | preferences/second-factor", function () {
    (0, _qunit.test)("displayOAuthWarning when OAuth login methods are enabled", function (assert) {
      const controller = this.getController("preferences/second-factor", {
        siteSettings: {
          enable_google_oauth2_logins: true
        }
      });
      assert.strictEqual(controller.get("displayOAuthWarning"), true);
    });
  });
});
define("discourse/tests/unit/controllers/reorder-categories-test", ["discourse/tests/helpers/create-store", "discourse/tests/helpers/qunit-helpers", "qunit"], function (_createStore, _qunitHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/create-store",0,"discourse/tests/helpers/qunit-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Controller | reorder-categories", function () {
    (0, _qunit.test)("reorder set unique position number", function (assert) {
      const store = (0, _createStore.default)();
      const categories = [];

      for (let i = 0; i < 3; ++i) {
        categories.push(store.createRecord("category", {
          id: i,
          position: 0
        }));
      }

      const controller = this.getController("reorder-categories", {
        site: {
          categories
        }
      });
      controller.reorder();
      controller.get("categoriesOrdered").forEach((category, index) => {
        assert.strictEqual(category.get("position"), index);
      });
    });
    (0, _qunit.test)("reorder places subcategories after their parent categories, while maintaining the relative order", function (assert) {
      const store = (0, _createStore.default)();
      const parent = store.createRecord("category", {
        id: 1,
        position: 1,
        slug: "parent"
      });
      const child1 = store.createRecord("category", {
        id: 2,
        position: 3,
        slug: "child1",
        parent_category_id: 1
      });
      const child2 = store.createRecord("category", {
        id: 3,
        position: 0,
        slug: "child2",
        parent_category_id: 1
      });
      const other = store.createRecord("category", {
        id: 4,
        position: 2,
        slug: "other"
      });
      const expectedOrderSlugs = ["parent", "child2", "child1", "other"];
      const controller = this.getController("reorder-categories", {
        site: {
          categories: [child2, parent, other, child1]
        }
      });
      controller.reorder();
      assert.deepEqual(controller.get("categoriesOrdered").mapBy("slug"), expectedOrderSlugs);
    });
    (0, _qunit.test)("changing the position number of a category should place it at given position", function (assert) {
      const store = (0, _createStore.default)();
      const elem1 = store.createRecord("category", {
        id: 1,
        position: 0,
        slug: "foo"
      });
      const elem2 = store.createRecord("category", {
        id: 2,
        position: 1,
        slug: "bar"
      });
      const elem3 = store.createRecord("category", {
        id: 3,
        position: 2,
        slug: "test"
      });
      const controller = this.getController("reorder-categories", {
        site: {
          categories: [elem1, elem2, elem3]
        }
      }); // Move category 'foo' from position 0 to position 2

      controller.send("change", elem1, {
        target: {
          value: "2"
        }
      });
      assert.deepEqual(controller.get("categoriesOrdered").mapBy("slug"), ["bar", "test", "foo"]);
    });
    (0, _qunit.test)("changing the position number of a category should place it at given position and respect children", function (assert) {
      const store = (0, _createStore.default)();
      const elem1 = store.createRecord("category", {
        id: 1,
        position: 0,
        slug: "foo"
      });
      const child1 = store.createRecord("category", {
        id: 4,
        position: 1,
        slug: "foochild",
        parent_category_id: 1
      });
      const elem2 = store.createRecord("category", {
        id: 2,
        position: 2,
        slug: "bar"
      });
      const elem3 = store.createRecord("category", {
        id: 3,
        position: 3,
        slug: "test"
      });
      const controller = this.getController("reorder-categories", {
        site: {
          categories: [elem1, child1, elem2, elem3]
        }
      });
      controller.send("change", elem1, {
        target: {
          value: 3
        }
      });
      assert.deepEqual(controller.get("categoriesOrdered").mapBy("slug"), ["bar", "test", "foo", "foochild"]);
    });
    (0, _qunit.test)("changing the position through click on arrow of a category should place it at given position and respect children", function (assert) {
      const store = (0, _createStore.default)();
      const child2 = store.createRecord("category", {
        id: 105,
        position: 2,
        slug: "foochildchild",
        parent_category_id: 104
      });
      const child1 = store.createRecord("category", {
        id: 104,
        position: 1,
        slug: "foochild",
        parent_category_id: 101,
        subcategories: [child2]
      });
      const elem1 = store.createRecord("category", {
        id: 101,
        position: 0,
        slug: "foo",
        subcategories: [child1]
      });
      const elem2 = store.createRecord("category", {
        id: 102,
        position: 3,
        slug: "bar"
      });
      const elem3 = store.createRecord("category", {
        id: 103,
        position: 4,
        slug: "test"
      });
      const controller = this.getController("reorder-categories", {
        site: {
          categories: [elem1, child1, child2, elem2, elem3]
        }
      });
      controller.reorder();
      controller.send("moveDown", elem1);
      assert.deepEqual(controller.get("categoriesOrdered").mapBy("slug"), ["bar", "foo", "foochild", "foochildchild", "test"]);
    });
  });
});
define("discourse/tests/unit/controllers/topic-test", ["@ember/object", "discourse/lib/posts-with-placeholders", "discourse/models/topic", "discourse/models/user", "discourse/tests/helpers/qunit-helpers", "@ember/runloop", "discourse/tests/helpers/create-pretender", "@ember/test-helpers", "qunit"], function (_object, _postsWithPlaceholders, _topic, _user, _qunitHelpers, _runloop, _createPretender, _testHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"@ember/object",0,"discourse/lib/posts-with-placeholders",0,"discourse/models/topic",0,"discourse/models/user",0,"discourse/tests/helpers/qunit-helpers",0,"@ember/runloop",0,"discourse/tests/helpers/create-pretender",0,"@ember/test-helpers",0,"qunit"eaimeta@70e063a35619d71f

  function topicWithStream(streamDetails) {
    let topic = _topic.default.create();

    topic.get("postStream").setProperties(streamDetails);
    return topic;
  }

  (0, _qunitHelpers.discourseModule)("Unit | Controller | topic", function (hooks) {
    hooks.beforeEach(function () {
      this.registry.injection("controller", "appEvents", "service:app-events");
    });
    hooks.afterEach(function () {
      this.registry.unregister("service:current-user");
      let topic = this.container.lookup("controller:topic");
      topic.setProperties({
        selectedPostIds: [],
        selectedPostUsername: null
      });
    });
    (0, _qunit.test)("editTopic", function (assert) {
      const model = _topic.default.create();

      const controller = this.getController("topic", {
        model
      });
      assert.notOk(controller.get("editingTopic"), "we are not editing by default");
      controller.set("model.details.can_edit", false);
      controller.send("editTopic");
      assert.notOk(controller.get("editingTopic"), "calling editTopic doesn't enable editing unless the user can edit");
      controller.set("model.details.can_edit", true);
      controller.send("editTopic");
      assert.ok(controller.get("editingTopic"), "calling editTopic enables editing if the user can edit");
      assert.strictEqual(controller.get("buffered.title"), model.get("title"));
      assert.strictEqual(controller.get("buffered.category_id"), model.get("category_id"));
      controller.send("cancelEditingTopic");
      assert.notOk(controller.get("editingTopic"), "cancelling edit mode reverts the property value");
    });
    (0, _qunit.test)("deleteTopic", function (assert) {
      const model = _topic.default.create();

      let destroyed = false;
      let modalDisplayed = false;

      model.destroy = async () => {
        destroyed = true;
      };

      const controller = this.getController("topic", {
        model,
        siteSettings: {
          min_topic_views_for_delete_confirm: 5
        },
        deleteTopicModal: () => {
          modalDisplayed = true;
        }
      });
      model.set("views", 10000);
      controller.send("deleteTopic");
      assert.notOk(destroyed, "don't destroy popular topic");
      assert.ok(modalDisplayed, "display confirmation modal for popular topic");
      model.set("views", 3);
      controller.send("deleteTopic");
      assert.ok(destroyed, "destroy not popular topic");
    });
    (0, _qunit.test)("toggleMultiSelect", async function (assert) {
      const model = _topic.default.create();

      const controller = this.getController("topic", {
        model
      });
      assert.notOk(controller.get("multiSelect"), "multi selection mode is disabled by default");
      controller.get("selectedPostIds").pushObject(1);
      assert.strictEqual(controller.get("selectedPostIds.length"), 1);
      controller.send("toggleMultiSelect");
      await (0, _testHelpers.settled)();
      assert.ok(controller.get("multiSelect"), "calling 'toggleMultiSelect' once enables multi selection mode");
      assert.strictEqual(controller.get("selectedPostIds.length"), 0, "toggling 'multiSelect' clears 'selectedPostIds'");
      controller.get("selectedPostIds").pushObject(2);
      assert.strictEqual(controller.get("selectedPostIds.length"), 1);
      controller.send("toggleMultiSelect");
      await (0, _testHelpers.settled)();
      assert.notOk(controller.get("multiSelect"), "calling 'toggleMultiSelect' twice disables multi selection mode");
      assert.strictEqual(controller.get("selectedPostIds.length"), 0, "toggling 'multiSelect' clears 'selectedPostIds'");
    });
    (0, _qunit.test)("selectedPosts", function (assert) {
      let model = topicWithStream({
        posts: [{
          id: 1
        }, {
          id: 2
        }, {
          id: 3
        }]
      });
      const controller = this.getController("topic", {
        model
      });
      controller.set("selectedPostIds", [1, 2, 42]);
      assert.strictEqual(controller.get("selectedPosts.length"), 2, "selectedPosts only contains already loaded posts");
      assert.notOk(controller.get("selectedPosts").some(p => p === undefined), "selectedPosts only contains valid post objects");
    });
    (0, _qunit.test)("selectedAllPosts", function (assert) {
      let model = topicWithStream({
        stream: [1, 2, 3]
      });
      const controller = this.getController("topic", {
        model
      });
      controller.set("selectedPostIds", [1, 2]);
      assert.notOk(controller.get("selectedAllPosts"), "not all posts are selected");
      controller.get("selectedPostIds").pushObject(3);
      assert.ok(controller.get("selectedAllPosts"), "all posts are selected");
      controller.get("selectedPostIds").pushObject(42);
      assert.ok(controller.get("selectedAllPosts"), "all posts (including filtered posts) are selected");
      model.setProperties({
        "postStream.isMegaTopic": true,
        posts_count: 1
      });
      assert.ok(controller.get("selectedAllPosts"), "it uses the topic's post count for megatopics");
    });
    (0, _qunit.test)("selectedPostsUsername", function (assert) {
      let model = topicWithStream({
        posts: [{
          id: 1,
          username: "gary"
        }, {
          id: 2,
          username: "gary"
        }, {
          id: 3,
          username: "lili"
        }],
        stream: [1, 2, 3]
      });
      const controller = this.getController("topic", {
        model
      });
      const selectedPostIds = controller.get("selectedPostIds");
      assert.strictEqual(controller.get("selectedPostsUsername"), undefined, "no username when no selected posts");
      selectedPostIds.pushObject(1);
      assert.strictEqual(controller.get("selectedPostsUsername"), "gary", "username of the selected posts");
      selectedPostIds.pushObject(2);
      assert.strictEqual(controller.get("selectedPostsUsername"), "gary", "username of all the selected posts when same user");
      selectedPostIds.pushObject(3);
      assert.strictEqual(controller.get("selectedPostsUsername"), undefined, "no username when more than 1 user");
      selectedPostIds.replace(2, 1, [42]);
      assert.strictEqual(controller.get("selectedPostsUsername"), undefined, "no username when not already loaded posts are selected");
    });
    (0, _qunit.test)("showSelectedPostsAtBottom", function (assert) {
      const site = _object.default.create({
        mobileView: false
      });

      const model = _topic.default.create({
        posts_count: 3
      });

      const controller = this.getController("topic", {
        model,
        site
      });
      assert.notOk(controller.get("showSelectedPostsAtBottom"), "false on desktop");
      site.set("mobileView", true);
      assert.notOk(controller.get("showSelectedPostsAtBottom"), "requires at least 3 posts on mobile");
      model.set("posts_count", 4);
      assert.ok(controller.get("showSelectedPostsAtBottom"), "true when mobile and more than 3 posts");
    });
    (0, _qunit.test)("canDeleteSelected", function (assert) {
      const currentUser = _user.default.create({
        admin: false
      });

      this.registry.register("service:current-user", currentUser, {
        instantiate: false
      });
      this.registry.injection("controller", "currentUser", "service:current-user");
      let model = topicWithStream({
        posts: [{
          id: 1,
          can_delete: false
        }, {
          id: 2,
          can_delete: true
        }, {
          id: 3,
          can_delete: true
        }],
        stream: [1, 2, 3]
      });
      const controller = this.getController("topic", {
        model
      });
      const selectedPostIds = controller.get("selectedPostIds");
      assert.notOk(controller.get("canDeleteSelected"), "false when no posts are selected");
      selectedPostIds.pushObject(1);
      assert.notOk(controller.get("canDeleteSelected"), "false when can't delete one of the selected posts");
      selectedPostIds.replace(0, 1, [2, 3]);
      assert.ok(controller.get("canDeleteSelected"), "true when all selected posts can be deleted");
      selectedPostIds.pushObject(1);
      assert.notOk(controller.get("canDeleteSelected"), "false when all posts are selected and user is staff");
      currentUser.set("admin", true);
      assert.ok(controller.get("canDeleteSelected"), "true when all posts are selected and user is staff");
    });
    (0, _qunit.test)("Can split/merge topic", function (assert) {
      let model = topicWithStream({
        posts: [{
          id: 1,
          post_number: 1,
          post_type: 1
        }, {
          id: 2,
          post_number: 2,
          post_type: 4
        }, {
          id: 3,
          post_number: 3,
          post_type: 1
        }],
        stream: [1, 2, 3]
      });
      model.set("details.can_move_posts", false);
      const controller = this.getController("topic", {
        model
      });
      const selectedPostIds = controller.get("selectedPostIds");
      assert.notOk(controller.get("canMergeTopic"), "can't merge topic when no posts are selected");
      selectedPostIds.pushObject(1);
      assert.notOk(controller.get("canMergeTopic"), "can't merge topic when can't move posts");
      model.set("details.can_move_posts", true);
      assert.ok(controller.get("canMergeTopic"), "can merge topic");
      selectedPostIds.removeObject(1);
      selectedPostIds.pushObject(2);
      assert.ok(controller.get("canMergeTopic"), "can merge topic when 1st post is not a regular post");
      selectedPostIds.pushObject(3);
      assert.ok(controller.get("canMergeTopic"), "can merge topic when all posts are selected");
    });
    (0, _qunit.test)("canChangeOwner", function (assert) {
      const currentUser = _user.default.create({
        admin: false
      });

      this.registry.register("service:current-user", currentUser, {
        instantiate: false
      });
      this.registry.injection("controller", "currentUser", "service:current-user");
      let model = topicWithStream({
        posts: [{
          id: 1,
          username: "gary"
        }, {
          id: 2,
          username: "lili"
        }],
        stream: [1, 2]
      });
      const controller = this.getController("topic", {
        model
      });
      const selectedPostIds = controller.get("selectedPostIds");
      assert.notOk(controller.get("canChangeOwner"), "false when no posts are selected");
      selectedPostIds.pushObject(1);
      assert.notOk(controller.get("canChangeOwner"), "false when not admin");
      currentUser.set("admin", true);
      assert.ok(controller.get("canChangeOwner"), "true when admin and one post is selected");
      selectedPostIds.pushObject(2);
      assert.notOk(controller.get("canChangeOwner"), "false when admin but more than 1 user");
    });
    (0, _qunit.test)("modCanChangeOwner", function (assert) {
      const currentUser = _user.default.create({
        moderator: false
      });

      this.registry.register("service:current-user", currentUser, {
        instantiate: false
      });
      this.registry.injection("controller", "currentUser", "service:current-user");
      let model = topicWithStream({
        posts: [{
          id: 1,
          username: "gary"
        }, {
          id: 2,
          username: "lili"
        }],
        stream: [1, 2]
      });
      const controller = this.getController("topic", {
        model,
        siteSettings: {
          moderators_change_post_ownership: true
        }
      });
      const selectedPostIds = controller.get("selectedPostIds");
      assert.notOk(controller.get("canChangeOwner"), "false when no posts are selected");
      selectedPostIds.pushObject(1);
      assert.notOk(controller.get("canChangeOwner"), "false when not moderator");
      currentUser.set("moderator", true);
      assert.ok(controller.get("canChangeOwner"), "true when moderator and one post is selected");
      selectedPostIds.pushObject(2);
      assert.notOk(controller.get("canChangeOwner"), "false when moderator but more than 1 user");
    });
    (0, _qunit.test)("canMergePosts", function (assert) {
      let model = topicWithStream({
        posts: [{
          id: 1,
          username: "gary",
          can_delete: true
        }, {
          id: 2,
          username: "lili",
          can_delete: true
        }, {
          id: 3,
          username: "gary",
          can_delete: false
        }, {
          id: 4,
          username: "gary",
          can_delete: true
        }],
        stream: [1, 2, 3]
      });
      const controller = this.getController("topic", {
        model
      });
      const selectedPostIds = controller.get("selectedPostIds");
      assert.notOk(controller.get("canMergePosts"), "false when no posts are selected");
      selectedPostIds.pushObject(1);
      assert.notOk(controller.get("canMergePosts"), "false when only one post is selected");
      selectedPostIds.pushObject(2);
      assert.notOk(controller.get("canMergePosts"), "false when selected posts are from different users");
      selectedPostIds.replace(1, 1, [3]);
      assert.notOk(controller.get("canMergePosts"), "false when selected posts can't be deleted");
      selectedPostIds.replace(1, 1, [4]);
      assert.ok(controller.get("canMergePosts"), "true when all selected posts are deletable and by the same user");
    });
    (0, _qunit.test)("Select/deselect all", function (assert) {
      let model = topicWithStream({
        stream: [1, 2, 3]
      });
      const controller = this.getController("topic", {
        model
      });
      assert.strictEqual(controller.get("selectedPostsCount"), 0, "no posts selected by default");
      controller.send("selectAll");
      assert.strictEqual(controller.get("selectedPostsCount"), 3, "calling 'selectAll' selects all posts");
      controller.send("deselectAll");
      assert.strictEqual(controller.get("selectedPostsCount"), 0, "calling 'deselectAll' deselects all posts");
    });
    (0, _qunit.test)("togglePostSelection", function (assert) {
      const controller = this.getController("topic");
      const selectedPostIds = controller.get("selectedPostIds");
      assert.strictEqual(selectedPostIds[0], undefined, "no posts selected by default");
      controller.send("togglePostSelection", {
        id: 1
      });
      assert.strictEqual(selectedPostIds[0], 1, "adds the selected post id if not already selected");
      controller.send("togglePostSelection", {
        id: 1
      });
      assert.strictEqual(selectedPostIds[0], undefined, "removes the selected post id if already selected");
    });
    (0, _qunit.test)("selectBelow", function (assert) {
      const site = _object.default.create({
        post_types: {
          small_action: 3,
          whisper: 4
        }
      });

      let model = topicWithStream({
        stream: [1, 2, 3, 4, 5, 6, 7, 8],
        posts: [{
          id: 5,
          cooked: "whisper post",
          post_type: 4
        }, {
          id: 6,
          cooked: "a small action",
          post_type: 3
        }, {
          id: 7,
          cooked: "",
          post_type: 4
        }]
      });
      const controller = this.getController("topic", {
        site,
        model
      });
      let selectedPostIds = controller.get("selectedPostIds");
      assert.strictEqual(selectedPostIds[0], undefined, "no posts selected by default");
      controller.send("selectBelow", {
        id: 3
      });
      assert.strictEqual(selectedPostIds[0], 3, "selected post #3");
      assert.strictEqual(selectedPostIds[1], 4, "also selected 1st post below post #3");
      assert.strictEqual(selectedPostIds[2], 5, "also selected 2nd post below post #3");
      assert.strictEqual(selectedPostIds[3], 8, "also selected 3rd post below post #3");
    });
    (0, _qunit.test)("selectReplies", async function (assert) {
      _createPretender.default.get("/posts/1/reply-ids.json", () => (0, _createPretender.response)([{
        id: 2,
        level: 1
      }]));

      let model = topicWithStream({
        posts: [{
          id: 1
        }, {
          id: 2
        }]
      });
      const controller = this.getController("topic", {
        model
      });
      controller.send("selectReplies", {
        id: 1
      });
      await (0, _testHelpers.settled)();
      assert.strictEqual(controller.get("selectedPostsCount"), 2, "It should select two, the post and its replies");
      controller.send("togglePostSelection", {
        id: 1
      });
      assert.strictEqual(controller.get("selectedPostsCount"), 1, "It should be selecting one only ");
      assert.strictEqual(controller.get("selectedPostIds")[0], 2, "It should be selecting the reply id ");
      controller.send("selectReplies", {
        id: 1
      });
      await (0, _testHelpers.settled)();
      assert.strictEqual(controller.get("selectedPostsCount"), 2, "It should be selecting two, even if reply was already selected");
    });
    (0, _qunit.test)("topVisibleChanged", function (assert) {
      let model = topicWithStream({
        posts: [{
          id: 1
        }]
      });
      const controller = this.getController("topic", {
        model
      });
      const placeholder = new _postsWithPlaceholders.Placeholder("post-placeholder");
      assert.strictEqual(controller.send("topVisibleChanged", {
        post: placeholder
      }), undefined, "it should work with a post-placeholder");
    });
    (0, _qunit.test)("deletePost - no modal is shown if post does not have replies", function (assert) {
      _createPretender.default.get("/posts/2/reply-ids.json", () => (0, _createPretender.response)([]));

      let destroyed;

      const post = _object.default.create({
        id: 2,
        post_number: 2,
        can_delete: true,
        reply_count: 3,
        destroy: async () => {
          destroyed = true;
        }
      });

      const currentUser = _object.default.create({
        moderator: true
      });

      this.registry.register("service:current-user", currentUser, {
        instantiate: false
      });
      this.registry.injection("controller", "currentUser", "service:current-user");
      let model = topicWithStream({
        stream: [2, 3, 4],
        posts: [post, {
          id: 3
        }, {
          id: 4
        }]
      });
      const controller = this.getController("topic", {
        model
      });
      const done = assert.async();
      controller.send("deletePost", post);
      (0, _runloop.next)(() => {
        assert.ok(destroyed, "post was destroyed");
        done();
      });
    });
  });
});
define("discourse/tests/unit/controllers/user-notifications-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "discourse/lib/show-modal", "sinon", "@ember/object", "discourse/models/user", "discourse/tests/helpers/create-pretender", "I18n"], function (_qunitHelpers, _qunit, showModal, _sinon, _object, _user, _createPretender, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"discourse/lib/show-modal",0,"sinon",0,"@ember/object",0,"discourse/models/user",0,"discourse/tests/helpers/create-pretender",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Controller | user-notifications", function () {
    (0, _qunit.test)("Mark read marks all models read when response is 200", async function (assert) {
      const model = [_object.default.create({
        read: false
      }), _object.default.create({
        read: false
      })];
      const controller = this.getController("user-notifications", {
        model
      });

      _createPretender.default.put("/notifications/mark-read", () => {
        return [200];
      });

      await controller.markRead();
      assert.strictEqual(model.every(_ref => {
        let {
          read
        } = _ref;
        return read === true;
      }), true);
    });
    (0, _qunit.test)("Mark read does not mark models read when response is not successful", async function (assert) {
      const model = [_object.default.create({
        read: false
      }), _object.default.create({
        read: true
      })];
      const controller = this.getController("user-notifications", {
        model
      });

      _createPretender.default.put("/notifications/mark-read", () => {
        return [500];
      });

      assert.rejects(controller.markRead());
      assert.deepEqual(model.map(_ref2 => {
        let {
          read
        } = _ref2;
        return read;
      }), [false, true], "models unmodified");
    });
    (0, _qunit.test)("Marks all notifications read when no high priority notifications", function (assert) {
      let markRead = false;

      const currentUser = _user.default.create({
        unread_high_priority_notifications: 0
      });

      const controller = this.getController("user-notifications", {
        model: [],
        currentUser
      });

      _sinon.default.stub(controller, "markRead").callsFake(() => {
        markRead = true;
      });

      controller.send("resetNew");
      assert.strictEqual(markRead, true);
    });
    (0, _qunit.test)("Shows modal when has high priority notifications", function (assert) {
      let capturedProperties;

      _sinon.default.stub(showModal, "default").withArgs("dismiss-notification-confirmation").returns({
        setProperties: properties => capturedProperties = properties
      });

      const currentUser = _user.default.create({
        unread_high_priority_notifications: 1
      });

      const controller = this.getController("user-notifications", {
        currentUser
      });

      const markReadFake = _sinon.default.fake();

      _sinon.default.stub(controller, "markRead").callsFake(markReadFake);

      controller.send("resetNew");
      assert.strictEqual(capturedProperties.confirmationMessage, _I18n.default.t("notifications.dismiss_confirmation.body.default", {
        count: 1
      }));
      capturedProperties.dismissNotifications();
      assert.strictEqual(markReadFake.callCount, 1);
    });
  });
});
define("discourse/tests/unit/ember/resolver-test", ["discourse-common/resolver", "qunit"], function (_resolver, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse-common/resolver",0,"qunit"eaimeta@70e063a35619d71f

  let originalTemplates;
  let resolver;

  function lookupTemplate(assert, name, expectedTemplate, message) {
    let parseName = resolver.parseName(name);
    let result = resolver.resolveTemplate(parseName);
    assert.strictEqual(result, expectedTemplate, message);
  }

  function setTemplates(lookupTemplateStrings) {
    lookupTemplateStrings.forEach(function (lookupTemplateString) {
      // eslint-disable-next-line no-undef
      Ember.TEMPLATES[lookupTemplateString] = lookupTemplateString;
    });
  }

  const DiscourseResolver = (0, _resolver.buildResolver)("discourse");
  (0, _qunit.module)("Unit | Ember | resolver", function (hooks) {
    hooks.beforeEach(function () {
      // eslint-disable-next-line no-undef
      originalTemplates = Ember.TEMPLATES; // eslint-disable-next-line no-undef

      Ember.TEMPLATES = {};
      resolver = DiscourseResolver.create({
        namespace: {
          modulePrefix: "discourse"
        }
      });
    });
    hooks.afterEach(function () {
      // eslint-disable-next-line no-undef
      Ember.TEMPLATES = originalTemplates;
    });
    (0, _qunit.test)("finds templates in top level dir", function (assert) {
      setTemplates(["foobar", "fooBar", "foo_bar", "foo.bar"]); // Default unmodified behavior

      lookupTemplate(assert, "template:foobar", "foobar", "by lowcased name"); // Default unmodified behavior

      lookupTemplate(assert, "template:fooBar", "fooBar", "by camel cased name"); // Default unmodified behavior

      lookupTemplate(assert, "template:foo_bar", "foo_bar", "by underscored name"); // Default unmodified behavior

      lookupTemplate(assert, "template:foo.bar", "foo.bar", "by dotted name");
    });
    (0, _qunit.test)("finds templates in first-level subdir", function (assert) {
      setTemplates(["foo/bar_baz"]); // Default unmodified behavior

      lookupTemplate(assert, "template:foo/bar_baz", "foo/bar_baz", "with subdir defined by slash"); // Convert dots to slash

      lookupTemplate(assert, "template:foo.bar_baz", "foo/bar_baz", "with subdir defined by dot"); // Convert dashes to slash

      lookupTemplate(assert, "template:foo-bar_baz", "foo/bar_baz", "with subdir defined by dash"); // Underscored with first segment as directory

      lookupTemplate(assert, "template:fooBarBaz", "foo/bar_baz", "with subdir defined by first camel case and the rest of camel cases converted to underscores"); // Already underscored with first segment as directory

      lookupTemplate(assert, "template:foo_bar_baz", "foo/bar_baz", "with subdir defined by first underscore");
    });
    (0, _qunit.test)("resolves precedence between overlapping top level dir and first level subdir templates", function (assert) {
      setTemplates(["fooBar", "foo_bar", "foo.bar", "foo/bar", "baz/qux"]); // Directories are prioritized when dotted

      lookupTemplate(assert, "template:foo.bar", "foo/bar", "preferring first level subdir for dotted name"); // Directories are prioritized when dashed

      lookupTemplate(assert, "template:foo-bar", "foo/bar", "preferring first level subdir for dotted name"); // Default unmodified before directories, except when dotted

      lookupTemplate(assert, "template:fooBar", "fooBar", "preferring top level dir for camel cased name"); // Default unmodified before directories, except when dotted

      lookupTemplate(assert, "template:foo_bar", "foo_bar", "preferring top level dir for underscored name"); // Use directory version if top-level isn't found

      lookupTemplate(assert, "template:baz-qux", "baz/qux", "fallback subdir for dashed name");
    });
    (0, _qunit.test)("finds templates in subdir deeper than one level", function (assert) {
      setTemplates(["foo/bar/baz/qux"]); // Default unmodified

      lookupTemplate(assert, "template:foo/bar/baz/qux", "foo/bar/baz/qux", "for subdirs defined by slashes"); // Converts dotted to slashed

      lookupTemplate(assert, "template:foo.bar.baz.qux", "foo/bar/baz/qux", "for subdirs defined by dots"); // Converts first camelized segment to slashed

      lookupTemplate(assert, "template:foo/bar/bazQux", "foo/bar/baz/qux", "for subdirs defined by slashes plus one camel case"); // Converts first underscore to slashed

      lookupTemplate(assert, "template:foo/bar/baz_qux", "foo/bar/baz/qux", "for subdirs defined by slashes plus one underscore"); // Only converts first camelized segment to slashed so this isn't matched

      lookupTemplate(assert, "template:fooBarBazQux", undefined, "but not for subdirs defined by more than one camel case"); // Only converts first underscored segment to slashed so this isn't matched

      lookupTemplate(assert, "template:foo_bar_baz_qux", undefined, "but not for subdirs defined by more than one underscore"); // Only converts dots to slashes OR first camelized segment. This has both so isn't matched.

      lookupTemplate(assert, "template:foo.bar.bazQux", undefined, "but not for subdirs defined by dots plus one camel case"); // Only converts dots to slashes OR first underscored segment. This has both so isn't matched.

      lookupTemplate(assert, "template:foo.bar.baz_qux", undefined, "but not for subdirs defined by dots plus one underscore");
    });
    (0, _qunit.test)("resolves mobile templates to 'mobile/' namespace", function (assert) {
      setTemplates(["mobile/foo", "bar", "mobile/bar", "baz"]);
      (0, _resolver.setResolverOption)("mobileView", true); // Default with mobile/ added

      lookupTemplate(assert, "template:foo", "mobile/foo", "finding mobile version even if normal one is not present"); // Default with mobile preferred

      lookupTemplate(assert, "template:bar", "mobile/bar", "preferring mobile version when both mobile and normal versions are present"); // Default when mobile not present

      lookupTemplate(assert, "template:baz", "baz", "falling back to a normal version when mobile version is not present");
    });
    (0, _qunit.test)("resolves plugin templates to 'javascripts/' namespace", function (assert) {
      setTemplates(["javascripts/foo", "bar", "javascripts/bar", "baz"]); // Default with javascripts/ added

      lookupTemplate(assert, "template:foo", "javascripts/foo", "finding plugin version even if normal one is not present"); // Default with javascripts/ added, takes precedence

      lookupTemplate(assert, "template:bar", "javascripts/bar", "preferring plugin version when both versions are present"); // Default when javascripts version not present

      lookupTemplate(assert, "template:baz", "baz", "falling back to a normal version when plugin version is not present");
    });
    (0, _qunit.test)("resolves plugin mobile templates to 'javascripts/mobile/' namespace", function (assert) {
      setTemplates(["javascripts/mobile/foo", "javascripts/mobile/bar", "javascripts/bar", "javascripts/mobile/baz", "mobile/baz"]);
      (0, _resolver.setResolverOption)("mobileView", true); // Default with javascripts/mobile/ added

      lookupTemplate(assert, "template:foo", "javascripts/mobile/foo", "finding plugin version even if normal one is not present"); // Default with javascripts/mobile added, takes precedence over non-mobile

      lookupTemplate(assert, "template:bar", "javascripts/mobile/bar", "preferring plugin mobile version when both non-mobile plugin version is also present"); // Default with javascripts/mobile when non-plugin mobile version is present

      lookupTemplate(assert, "template:baz", "javascripts/mobile/baz", "preferring plugin mobile version over non-plugin mobile version");
    });
    (0, _qunit.test)("resolves templates with 'admin' prefix", function (assert) {
      setTemplates(["admin/templates/foo", "adminBar", "admin_bar", "admin.bar", "admin/templates/bar", "admin/templates/dashboard_general", "admin-baz-qux", "javascripts/admin/plugin-template", "admin/templates/components/my-admin-component"]); // Switches prefix to admin/templates when camelized

      lookupTemplate(assert, "template:adminFoo", "admin/templates/foo", "when prefix is separated by camel case"); // Switches prefix to admin/templates when underscored

      lookupTemplate(assert, "template:admin_foo", "admin/templates/foo", "when prefix is separated by underscore"); // Switches prefix to admin/templates when dotted

      lookupTemplate(assert, "template:admin.foo", "admin/templates/foo", "when prefix is separated by dot"); // Doesn't match unseparated prefix

      lookupTemplate(assert, "template:adminfoo", undefined, "but not when prefix is not separated in any way"); // Prioritized the default match when camelized

      lookupTemplate(assert, "template:adminBar", "adminBar", "but not when template with the exact camel cased name exists"); // Prioritized the default match when underscored

      lookupTemplate(assert, "template:admin_bar", "admin_bar", "but not when template with the exact underscored name exists"); // Prioritized the default match when dotted

      lookupTemplate(assert, "template:admin.bar", "admin.bar", "but not when template with the exact dotted name exists");
      lookupTemplate(assert, "template:admin-dashboard-general", "admin/templates/dashboard_general", "finds namespaced and underscored version");
      lookupTemplate(assert, "template:admin-baz/qux", "admin-baz-qux", "also tries dasherized");
      lookupTemplate(assert, "template:admin-plugin/template", "javascripts/admin/plugin-template", "looks up templates in plugins");
      lookupTemplate(assert, "template:foo", undefined, "doesn't return admin templates for regular controllers");
      lookupTemplate(assert, "template:components/my-admin-component", "admin/templates/components/my-admin-component", "returns admin-defined component templates");
    });
    (0, _qunit.test)("resolves component templates with 'admin' prefix to 'admin/templates/' namespace", function (assert) {
      setTemplates(["admin/templates/components/foo", "components/bar", "admin/templates/components/bar"]); // Looks for components in admin/templates

      lookupTemplate(assert, "template:components/foo", "admin/templates/components/foo", "uses admin template component when no standard match"); // Prioritized non-admin component

      lookupTemplate(assert, "template:components/bar", "components/bar", "uses standard match when both exist");
    }); // We can probably remove this in the future since this behavior seems pretty
    // close to Ember's default behavior.
    // See https://guides.emberjs.com/release/routing/loading-and-error-substates/

    (0, _qunit.test)("resolves loading templates", function (assert) {
      setTemplates(["fooloading", "foo/loading", "foo_loading", "loading"]);
      lookupTemplate(assert, "template:fooloading", "fooloading", "exact match without separator");
      lookupTemplate(assert, "template:foo/loading", "foo/loading", "exact match with slash");
      lookupTemplate(assert, "template:foo_loading", "foo_loading", "exact match underscore");
      lookupTemplate(assert, "template:barloading", "loading", "fallback without separator");
      lookupTemplate(assert, "template:bar/loading", "loading", "fallback with slash");
      lookupTemplate(assert, "template:bar.loading", "loading", "fallback with dot");
      lookupTemplate(assert, "template:bar_loading", "loading", "fallback underscore"); // TODO: Maybe test precedence
    });
    (0, _qunit.test)("resolves connector templates", function (assert) {
      setTemplates(["javascripts/foo", "javascripts/connectors/foo-bar/baz_qux", "javascripts/connectors/foo-bar/camelCase"]);
      lookupTemplate(assert, "template:connectors/foo", "javascripts/foo", "looks up in javascripts/ namespace");
      lookupTemplate(assert, "template:connectors/components/foo", "javascripts/foo", "removes components segment");
      lookupTemplate(assert, "template:connectors/foo-bar/baz-qux", "javascripts/connectors/foo-bar/baz_qux", "underscores last segment");
      lookupTemplate(assert, "template:connectors/foo-bar/camelCase", "javascripts/connectors/foo-bar/camelCase", "handles camelcase file names");
      lookupTemplate(assert, resolver.normalize("template:connectors/foo-bar/camelCase"), "javascripts/connectors/foo-bar/camelCase", "handles camelcase file names when normalized");
    });
    (0, _qunit.test)("returns 'not_found' template when template name cannot be resolved", function (assert) {
      setTemplates(["not_found"]);
      lookupTemplate(assert, "template:foo/bar/baz", "not_found", "");
    });
    (0, _qunit.test)("resolves templates with 'wizard' prefix", function (assert) {
      setTemplates(["wizard/templates/foo", "wizard_bar", "wizard.bar", "wizard/templates/bar", "wizard/templates/dashboard_general", "wizard-baz-qux", "javascripts/wizard/plugin-template"]); // Switches prefix to wizard/templates when underscored

      lookupTemplate(assert, "template:wizard_foo", "wizard/templates/foo", "when prefix is separated by underscore"); // Switches prefix to wizard/templates when dotted

      lookupTemplate(assert, "template:wizard.foo", "wizard/templates/foo", "when prefix is separated by dot"); // Doesn't match unseparated prefix

      lookupTemplate(assert, "template:wizardfoo", undefined, "but not when prefix is not separated in any way"); // Prioritized the default match when underscored

      lookupTemplate(assert, "template:wizard_bar", "wizard_bar", "but not when template with the exact underscored name exists"); // Prioritized the default match when dotted

      lookupTemplate(assert, "template:wizard.bar", "wizard.bar", "but not when template with the exact dotted name exists");
      lookupTemplate(assert, "template:wizard-dashboard-general", "wizard/templates/dashboard_general", "finds namespaced and underscored version");
      lookupTemplate(assert, "template:wizard-baz/qux", "wizard-baz-qux", "also tries dasherized");
    });
    (0, _qunit.test)("resolves component templates with 'wizard' prefix to 'wizard/templates/' namespace", function (assert) {
      setTemplates(["wizard/templates/components/foo", "components/bar", "wizard/templates/components/bar"]); // Looks for components in wizard/templates

      lookupTemplate(assert, "template:components/foo", "wizard/templates/components/foo", "uses wizard template component when no standard match"); // Prioritized non-wizard component

      lookupTemplate(assert, "template:components/bar", "components/bar", "uses standard match when both exist");
    });
  });
});
define("discourse/tests/unit/lib/allow-lister-test", ["qunit", "pretty-text/allow-lister"], function (_qunit, _allowLister) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"pretty-text/allow-lister"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | allowLister", function () {
    (0, _qunit.test)("allowLister", function (assert) {
      const allowLister = new _allowLister.default();
      assert.ok(Object.keys(allowLister.getAllowList().tagList).length > 1, "should have some defaults");
      allowLister.disable("default");
      assert.ok(Object.keys(allowLister.getAllowList().tagList).length === 0, "should have no defaults if disabled");
      allowLister.allowListFeature("test", ["custom.foo", "custom.baz", "custom[data-*]", "custom[data-custom-*=foo]", "custom[rel=nofollow]"]);
      allowLister.allowListFeature("test", ["custom[rel=test]"]);
      allowLister.enable("test");
      assert.deepEqual(allowLister.getAllowList(), {
        tagList: {
          custom: []
        },
        attrList: {
          custom: {
            class: ["foo", "baz"],
            "data-*": ["*"],
            "data-custom-*": ["foo"],
            rel: ["nofollow", "test"]
          }
        }
      }, "Expecting a correct allow list");
      allowLister.disable("test");
      assert.deepEqual(allowLister.getAllowList(), {
        tagList: {},
        attrList: {}
      }, "Expecting an empty allow list");
    });
  });
});
define("discourse/tests/unit/lib/bookmark-test", ["qunit", "discourse/tests/helpers/qunit-helpers", "discourse/lib/bookmark"], function (_qunit, _qunitHelpers, _bookmark) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/lib/bookmark"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | bookmark", function (hooks) {
    hooks.beforeEach(function () {
      this.clock = (0, _qunitHelpers.fakeTime)("2020-04-11 08:00:00", "Australia/Brisbane");
    });
    hooks.afterEach(function () {
      this.clock.restore();
    });
    (0, _qunit.test)("formattedReminderTime works when the reminder time is tomorrow", function (assert) {
      let reminderAt = "2020-04-12 09:45:00";
      let reminderAtDate = moment.tz(reminderAt, "Australia/Brisbane").format("H:mm a");
      assert.strictEqual((0, _bookmark.formattedReminderTime)(reminderAt, "Australia/Brisbane"), "tomorrow at " + reminderAtDate);
    });
    (0, _qunit.test)("formattedReminderTime works when the reminder time is today", function (assert) {
      let reminderAt = "2020-04-11 09:45:00";
      let reminderAtDate = moment.tz(reminderAt, "Australia/Brisbane").format("H:mm a");
      assert.strictEqual((0, _bookmark.formattedReminderTime)(reminderAt, "Australia/Brisbane"), "today at " + reminderAtDate);
    });
    (0, _qunit.test)("formattedReminderTime works when the reminder time is in the future", function (assert) {
      let reminderAt = "2020-04-15 09:45:00";
      let reminderAtDate = moment.tz(reminderAt, "Australia/Brisbane").format("H:mm a");
      assert.strictEqual((0, _bookmark.formattedReminderTime)(reminderAt, "Australia/Brisbane"), "at Apr 15, 2020 " + reminderAtDate);
    });
  });
});
define("discourse/tests/unit/lib/category-badge-test", ["discourse/models/site", "discourse/helpers/category-link", "discourse/tests/helpers/create-store", "discourse/tests/helpers/qunit-helpers", "sinon", "qunit"], function (_site, _categoryLink, _createStore, _qunitHelpers, _sinon, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/models/site",0,"discourse/helpers/category-link",0,"discourse/tests/helpers/create-store",0,"discourse/tests/helpers/qunit-helpers",0,"sinon",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Utility | category-badge", function () {
    (0, _qunit.test)("categoryBadge without a category", function (assert) {
      assert.blank((0, _categoryLink.categoryBadgeHTML)(), "it returns no HTML");
    });
    (0, _qunit.test)("Regular categoryBadge", function (assert) {
      const store = (0, _createStore.default)();
      const category = store.createRecord("category", {
        name: "hello",
        id: 123,
        description_text: "cool description",
        color: "ff0",
        text_color: "f00"
      });
      const tag = $.parseHTML((0, _categoryLink.categoryBadgeHTML)(category))[0];
      assert.strictEqual(tag.tagName, "A", "it creates a `a` wrapper tag");
      assert.strictEqual(tag.className.trim(), "badge-wrapper", "it has the correct class");
      const label = tag.children[1];
      assert.strictEqual(label.title, "cool description", "it has the correct title");
      assert.strictEqual(label.children[0].innerText, "hello", "it has the category name");
    });
    (0, _qunit.test)("undefined color", function (assert) {
      const store = (0, _createStore.default)();
      const noColor = store.createRecord("category", {
        name: "hello",
        id: 123
      });
      const tag = $.parseHTML((0, _categoryLink.categoryBadgeHTML)(noColor))[0];
      assert.blank(tag.attributes["style"], "it has no color style because there are no colors");
    });
    (0, _qunit.test)("topic count", function (assert) {
      const store = (0, _createStore.default)();
      const category = store.createRecord("category", {
        name: "hello",
        id: 123
      });
      assert.ok(!(0, _categoryLink.categoryBadgeHTML)(category).includes("topic-count"), "it does not include topic count by default");
      assert.ok((0, _categoryLink.categoryBadgeHTML)(category, {
        topicCount: 20
      }).indexOf("topic-count") > 20, "is included when specified");
    });
    (0, _qunit.test)("allowUncategorized", function (assert) {
      const store = (0, _createStore.default)();
      const uncategorized = store.createRecord("category", {
        name: "uncategorized",
        id: 345
      });

      _sinon.default.stub(_site.default, "currentProp").withArgs("uncategorized_category_id").returns(345);

      assert.blank((0, _categoryLink.categoryBadgeHTML)(uncategorized), "it doesn't return HTML for uncategorized by default");
      assert.present((0, _categoryLink.categoryBadgeHTML)(uncategorized, {
        allowUncategorized: true
      }), "it returns HTML");
    });
    (0, _qunit.test)("category names are wrapped in dir-spans", function (assert) {
      this.siteSettings.support_mixed_text_direction = true;
      const store = (0, _createStore.default)();
      const rtlCategory = store.createRecord("category", {
        name: "  Ruby",
        id: 123,
        description_text: "cool description",
        color: "ff0",
        text_color: "f00"
      });
      const ltrCategory = store.createRecord("category", {
        name: "Programming in Ruby",
        id: 234
      });
      let tag = $.parseHTML((0, _categoryLink.categoryBadgeHTML)(rtlCategory))[0];
      let dirSpan = tag.children[1].children[0];
      assert.strictEqual(dirSpan.dir, "rtl");
      tag = $.parseHTML((0, _categoryLink.categoryBadgeHTML)(ltrCategory))[0];
      dirSpan = tag.children[1].children[0];
      assert.strictEqual(dirSpan.dir, "ltr");
    });
    (0, _qunit.test)("recursive", function (assert) {
      const store = (0, _createStore.default)();
      const foo = store.createRecord("category", {
        name: "foo",
        id: 1
      });
      const bar = store.createRecord("category", {
        name: "bar",
        id: 2,
        parent_category_id: foo.id
      });
      const baz = store.createRecord("category", {
        name: "baz",
        id: 3,
        parent_category_id: bar.id
      });
      this.siteSettings.max_category_nesting = 0;
      assert.ok((0, _categoryLink.categoryBadgeHTML)(baz, {
        recursive: true
      }).includes("baz"));
      assert.ok(!(0, _categoryLink.categoryBadgeHTML)(baz, {
        recursive: true
      }).includes("bar"));
      this.siteSettings.max_category_nesting = 1;
      assert.ok((0, _categoryLink.categoryBadgeHTML)(baz, {
        recursive: true
      }).includes("baz"));
      assert.ok(!(0, _categoryLink.categoryBadgeHTML)(baz, {
        recursive: true
      }).includes("bar"));
      this.siteSettings.max_category_nesting = 2;
      assert.ok((0, _categoryLink.categoryBadgeHTML)(baz, {
        recursive: true
      }).includes("baz"));
      assert.ok((0, _categoryLink.categoryBadgeHTML)(baz, {
        recursive: true
      }).includes("bar"));
      assert.ok(!(0, _categoryLink.categoryBadgeHTML)(baz, {
        recursive: true
      }).includes("foo"));
      this.siteSettings.max_category_nesting = 3;
      assert.ok((0, _categoryLink.categoryBadgeHTML)(baz, {
        recursive: true
      }).includes("baz"));
      assert.ok((0, _categoryLink.categoryBadgeHTML)(baz, {
        recursive: true
      }).includes("bar"));
      assert.ok((0, _categoryLink.categoryBadgeHTML)(baz, {
        recursive: true
      }).includes("foo"));
    });
  });
});
define("discourse/tests/unit/lib/click-track-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "discourse/lib/click-track", "discourse/lib/url", "discourse/models/user", "discourse-common/lib/later", "discourse/tests/helpers/create-pretender", "sinon", "discourse-common/lib/get-url"], function (_qunitHelpers, _qunit, _clickTrack, _url, _user, _later, _createPretender, _sinon, _getUrl) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"discourse/lib/click-track",0,"discourse/lib/url",0,"discourse/models/user",0,"discourse-common/lib/later",0,"discourse/tests/helpers/create-pretender",0,"sinon",0,"discourse-common/lib/get-url"eaimeta@70e063a35619d71f

  const track = _clickTrack.default.trackClick;

  function generateClickEventOn(selector) {
    return $.Event("click", {
      currentTarget: (0, _qunitHelpers.fixture)(selector)
    });
  }

  (0, _qunit.module)("Unit | Utility | click-track", function (hooks) {
    hooks.beforeEach(function () {
      (0, _qunitHelpers.logIn)();
      let win = {
        focus: function () {}
      };

      _sinon.default.stub(window, "open").returns(win);

      _sinon.default.stub(win, "focus");

      _sinon.default.stub(_url.default, "routeTo");

      _sinon.default.stub(_url.default, "redirectTo");

      sessionStorage.clear();
      (0, _qunitHelpers.fixture)().innerHTML = `<div id="topic" data-topic-id="1337">
        <article data-post-id="42" data-user-id="3141">
          <a href="http://www.google.com">google.com</a>
          <a class="lightbox back" href="http://www.google.fr">google.fr</a>
          <a id="with-badge" data-user-id="314" href="http://www.google.de">google.de<span class="badge">1</span></a>
          <a id="with-badge-but-not-mine" href="http://www.google.es">google.es<span class="badge">1</span></a>
          <div class="onebox-result">
            <a id="inside-onebox" href="http://www.google.co.uk">google.co.uk<span class="badge">1</span></a>
            <a id="inside-onebox-forced" class="track-link" href="http://www.google.at">google.at<span class="badge">1</span></a>
          </div>
          <a class="no-track-link" href="http://www.google.com.br">google.com.br</a>
          <a id="same-site" href="http://discuss.domain.com">forum</a>
          <a class="attachment" href="http://discuss.domain.com/uploads/default/1234/1532357280.txt">log.txt</a>
          <a class="hashtag" href="http://discuss.domain.com">#hashtag</a>
          <a class="mailto" href="mailto:foo@bar.com">email-me</a>
          <a class="a-without-href">no href</a>
          <aside class="quote">
            <a href="https://discuss.domain.com/t/welcome-to-meta-discourse-org/1/30">foo</a>
            <a href="https://google.com">bar</a>
          </aside>
          <a class="prefix-url" href="/forum/thing">prefix link</a>
          <a class="abs-prefix-url" href="${window.location.origin}/forum/thing">prefix link</a>
          <a class="diff-prefix-url" href="/thing">diff prefix link</a>
        </article>
      </div>`;
    });
    (0, _qunit.skip)("tracks internal URLs", async function (assert) {
      assert.expect(2);

      _sinon.default.stub(_url.default, "origin").returns("http://discuss.domain.com");

      const done = assert.async();

      _createPretender.default.post("/clicks/track", request => {
        assert.ok(request.requestBody, "url=http%3A%2F%2Fdiscuss.domain.com&post_id=42&topic_id=1337");
        done();
      });

      assert.notOk(track(generateClickEventOn("#same-site")));
    });
    (0, _qunit.test)("does not track elements with no href", async function (assert) {
      assert.ok(track(generateClickEventOn(".a-without-href")));
    });
    (0, _qunit.test)("does not track attachments", async function (assert) {
      _sinon.default.stub(_url.default, "origin").returns("http://discuss.domain.com");

      _createPretender.default.post("/clicks/track", () => assert.ok(false));

      assert.notOk(track(generateClickEventOn(".attachment")));
      assert.ok(_url.default.redirectTo.calledWith("http://discuss.domain.com/uploads/default/1234/1532357280.txt"));
    });
    (0, _qunit.test)("routes to internal urls", async function (assert) {
      (0, _getUrl.setPrefix)("/forum");

      _createPretender.default.post("/clicks/track", () => [200, {}, ""]);

      await track(generateClickEventOn(".prefix-url"), null, {
        returnPromise: true
      });
      assert.ok(_url.default.routeTo.calledWith("/forum/thing"));
    });
    (0, _qunit.test)("routes to absolute internal urls", async function (assert) {
      (0, _getUrl.setPrefix)("/forum");

      _createPretender.default.post("/clicks/track", () => [200, {}, ""]);

      await track(generateClickEventOn(".abs-prefix-url"), null, {
        returnPromise: true
      });
      assert.ok(_url.default.routeTo.calledWith(window.location.origin + "/forum/thing"));
    });
    (0, _qunit.test)("redirects to internal urls with a different prefix", async function (assert) {
      (0, _getUrl.setPrefix)("/forum");

      _sinon.default.stub(_url.default, "redirectAbsolute");

      _createPretender.default.post("/clicks/track", () => [200, {}, ""]);

      await track(generateClickEventOn(".diff-prefix-url"), null, {
        returnPromise: true
      });
      assert.ok(_url.default.redirectAbsolute.calledWith("/thing"));
    });
    (0, _qunit.skip)("tracks external URLs", async function (assert) {
      assert.expect(2);
      const done = assert.async();

      _createPretender.default.post("/clicks/track", request => {
        assert.ok(request.requestBody, "url=http%3A%2F%2Fwww.google.com&post_id=42&topic_id=1337");
        done();
      });

      assert.notOk(track(generateClickEventOn("a")));
    });
    (0, _qunit.skip)("tracks external URLs when opening in another window", async function (assert) {
      assert.expect(3);

      _user.default.currentProp("external_links_in_new_tab", true);

      const done = assert.async();

      _createPretender.default.post("/clicks/track", request => {
        assert.ok(request.requestBody, "url=http%3A%2F%2Fwww.google.com&post_id=42&topic_id=1337");
        done();
      });

      assert.notOk(track(generateClickEventOn("a")));
      assert.ok(window.open.calledWith("http://www.google.com", "_blank"));
    });
    (0, _qunit.test)("does not track clicks on lightboxes", async function (assert) {
      assert.notOk(track(generateClickEventOn(".lightbox")));
    });
    (0, _qunit.test)("does not track clicks when forcibly disabled", async function (assert) {
      assert.notOk(track(generateClickEventOn(".no-track-link")));
    });
    (0, _qunit.test)("does not track clicks on back buttons", async function (assert) {
      assert.notOk(track(generateClickEventOn(".back")));
    });
    (0, _qunit.test)("does not track right clicks inside quotes", async function (assert) {
      const event = generateClickEventOn(".quote a:first-child");
      event.which = 3;
      assert.ok(track(event));
    });
    (0, _qunit.test)("does not track clicks links in quotes", async function (assert) {
      _user.default.currentProp("external_links_in_new_tab", true);

      assert.notOk(track(generateClickEventOn(".quote a:last-child")));
      assert.ok(window.open.calledWith("https://google.com/", "_blank"));
    });
    (0, _qunit.test)("does not track clicks on category badges", async function (assert) {
      assert.notOk(track(generateClickEventOn(".hashtag")));
    });
    (0, _qunit.test)("does not track clicks on mailto", async function (assert) {
      assert.ok(track(generateClickEventOn(".mailto")));
    });
    (0, _qunit.test)("removes the href and put it as a data attribute", async function (assert) {
      _user.default.currentProp("external_links_in_new_tab", true);

      assert.notOk(track(generateClickEventOn("a")));
      let link = (0, _qunitHelpers.fixture)("a");
      assert.ok(link.classList.contains("no-href"));
      assert.strictEqual(link.dataset.href, "http://www.google.com/");
      assert.blank(link.getAttribute("href"));
      assert.ok(link.dataset.autoRoute);
      assert.ok(window.open.calledWith("http://www.google.com/", "_blank"));
    });
    (0, _qunit.test)("restores the href after a while", async function (assert) {
      assert.expect(2);
      assert.notOk(track(generateClickEventOn("a")));
      assert.timeout(75);
      const done = assert.async();
      (0, _later.default)(() => {
        assert.strictEqual((0, _qunitHelpers.fixture)("a").getAttribute("href"), "http://www.google.com");
        done();
      });
    });

    function badgeClickCount(assert, id, expected) {
      track(generateClickEventOn(`#${id}`));
      const badge = (0, _qunitHelpers.fixture)(`#${id}`).querySelector("span.badge");
      assert.strictEqual(parseInt(badge.innerHTML, 10), expected);
    }

    (0, _qunit.test)("does not update badge clicks on my own link", async function (assert) {
      _sinon.default.stub(_user.default, "currentProp").withArgs("id").returns(314);

      badgeClickCount(assert, "with-badge", 1);
    });
    (0, _qunit.test)("does not update badge clicks in my own post", async function (assert) {
      _sinon.default.stub(_user.default, "currentProp").withArgs("id").returns(3141);

      badgeClickCount(assert, "with-badge-but-not-mine", 1);
    });
    (0, _qunit.test)("updates badge counts correctly", async function (assert) {
      badgeClickCount(assert, "inside-onebox", 1);
      badgeClickCount(assert, "inside-onebox-forced", 2);
      badgeClickCount(assert, "with-badge", 2);
    });

    function testOpenInANewTab(description, clickEventModifier) {
      (0, _qunit.test)(description, async function (assert) {
        let clickEvent = generateClickEventOn("a");
        clickEventModifier(clickEvent);
        assert.ok(track(clickEvent));
        assert.notOk(clickEvent.defaultPrevented);
      });
    }

    testOpenInANewTab("it opens in a new tab when pressing shift", clickEvent => {
      clickEvent.shiftKey = true;
    });
    testOpenInANewTab("it opens in a new tab when pressing meta", clickEvent => {
      clickEvent.metaKey = true;
    });
    testOpenInANewTab("it opens in a new tab when pressing ctrl", clickEvent => {
      clickEvent.ctrlKey = true;
    });
    testOpenInANewTab("it opens in a new tab on middle click", clickEvent => {
      clickEvent.button = 2;
    });
  });
});
define("discourse/tests/unit/lib/computed-test", ["discourse/lib/computed", "@ember/object", "I18n", "discourse/tests/helpers/qunit-helpers", "discourse-common/lib/get-url", "sinon", "qunit"], function (_computed, _object, _I18n, _qunitHelpers, _getUrl, _sinon, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/lib/computed",0,"@ember/object",0,"I18n",0,"discourse/tests/helpers/qunit-helpers",0,"discourse-common/lib/get-url",0,"sinon",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Utility | computed", function (hooks) {
    hooks.beforeEach(function () {
      _sinon.default.stub(_I18n.default, "t").callsFake(function (scope) {
        return "%@ translated: " + scope;
      });
    });
    hooks.afterEach(function () {
      _I18n.default.t.restore();
    });
    (0, _qunit.test)("setting", function (assert) {
      let t = _object.default.extend({
        siteSettings: this.siteSettings,
        vehicle: (0, _computed.setting)("vehicle"),
        missingProp: (0, _computed.setting)("madeUpThing")
      }).create();

      this.siteSettings.vehicle = "airplane";
      assert.strictEqual(t.get("vehicle"), "airplane", "it has the value of the site setting");
      assert.ok(!t.get("missingProp"), "it is falsy when the site setting is not defined");
    });
    (0, _qunit.test)("propertyEqual", function (assert) {
      let t = _object.default.extend({
        same: (0, _computed.propertyEqual)("cookies", "biscuits")
      }).create({
        cookies: 10,
        biscuits: 10
      });

      assert.ok(t.get("same"), "it is true when the properties are the same");
      t.set("biscuits", 9);
      assert.ok(!t.get("same"), "it isn't true when one property is different");
    });
    (0, _qunit.test)("propertyNotEqual", function (assert) {
      let t = _object.default.extend({
        diff: (0, _computed.propertyNotEqual)("cookies", "biscuits")
      }).create({
        cookies: 10,
        biscuits: 10
      });

      assert.ok(!t.get("diff"), "it isn't true when the properties are the same");
      t.set("biscuits", 9);
      assert.ok(t.get("diff"), "it is true when one property is different");
    });
    (0, _qunit.test)("fmt", function (assert) {
      let t = _object.default.extend({
        exclaimyUsername: (0, _computed.fmt)("username", "!!! %@ !!!"),
        multiple: (0, _computed.fmt)("username", "mood", "%@ is %@")
      }).create({
        username: "eviltrout",
        mood: "happy"
      });

      assert.strictEqual(t.get("exclaimyUsername"), "!!! eviltrout !!!", "it inserts the string");
      assert.strictEqual(t.get("multiple"), "eviltrout is happy", "it inserts multiple strings");
      t.set("username", "codinghorror");
      assert.strictEqual(t.get("multiple"), "codinghorror is happy", "it supports changing properties");
      t.set("mood", "ecstatic");
      assert.strictEqual(t.get("multiple"), "codinghorror is ecstatic", "it supports changing another property");
    });
    (0, _qunit.test)("i18n", function (assert) {
      let t = _object.default.extend({
        exclaimyUsername: (0, _computed.i18n)("username", "!!! %@ !!!"),
        multiple: (0, _computed.i18n)("username", "mood", "%@ is %@")
      }).create({
        username: "eviltrout",
        mood: "happy"
      });

      assert.strictEqual(t.get("exclaimyUsername"), "%@ translated: !!! eviltrout !!!", "it inserts the string and then translates");
      assert.strictEqual(t.get("multiple"), "%@ translated: eviltrout is happy", "it inserts multiple strings and then translates");
      t.set("username", "codinghorror");
      assert.strictEqual(t.get("multiple"), "%@ translated: codinghorror is happy", "it supports changing properties");
      t.set("mood", "ecstatic");
      assert.strictEqual(t.get("multiple"), "%@ translated: codinghorror is ecstatic", "it supports changing another property");
    });
    (0, _qunit.test)("url", function (assert) {
      let t, testClass;
      testClass = _object.default.extend({
        userUrl: (0, _computed.url)("username", "/u/%@")
      });
      t = testClass.create({
        username: "eviltrout"
      });
      assert.strictEqual(t.get("userUrl"), "/u/eviltrout", "it supports urls without a prefix");
      (0, _getUrl.setPrefix)("/prefixed");
      t = testClass.create({
        username: "eviltrout"
      });
      assert.strictEqual(t.get("userUrl"), "/prefixed/u/eviltrout", "it supports urls with a prefix");
    });
    (0, _qunit.test)("htmlSafe", function (assert) {
      const cookies = "<p>cookies and <b>biscuits</b></p>";

      const t = _object.default.extend({
        desc: (0, _computed.htmlSafe)("cookies")
      }).create({
        cookies
      });

      assert.strictEqual(t.get("desc").string, cookies);
    });
  });
});
define("discourse/tests/unit/lib/dom-from-string-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "discourse-common/lib/dom-from-string"], function (_qunitHelpers, _qunit, _domFromString) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"discourse-common/lib/dom-from-string"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Utility | domFromString", function () {
    (0, _qunit.test)("constructing DOM node from a string", function (assert) {
      const node = (0, _domFromString.default)('<div class="foo">foo</div><div class="boo">boo</div>');
      assert.ok(node[0].classList.contains("foo"));
      assert.ok(node[1].classList.contains("boo"));
    });
  });
});
define("discourse/tests/unit/lib/download-calendar-test", ["qunit", "discourse/lib/download-calendar", "sinon"], function (_qunit, _downloadCalendar, _sinon) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/lib/download-calendar",0,"sinon"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | download-calendar", function (hooks) {
    hooks.beforeEach(function () {
      let win = {
        focus: function () {}
      };

      _sinon.default.stub(window, "open").returns(win);

      _sinon.default.stub(win, "focus");
    });
    (0, _qunit.test)("correct data for Ics", function (assert) {
      const data = (0, _downloadCalendar.generateIcsData)("event test", [{
        startsAt: "2021-10-12T15:00:00.000Z",
        endsAt: "2021-10-12T16:00:00.000Z"
      }]);
      assert.ok(data, `
BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Discourse//EN
BEGIN:VEVENT
UID:1634050800000_1634054400000
DTSTAMP:20213312T223320Z
DTSTART:20210012T150000Z
DTEND:20210012T160000Z
SUMMARY:event2
END:VEVENT
END:VCALENDAR
    `);
    });
    (0, _qunit.test)("correct url for Google", function (assert) {
      (0, _downloadCalendar.downloadGoogle)("event", [{
        startsAt: "2021-10-12T15:00:00.000Z",
        endsAt: "2021-10-12T16:00:00.000Z"
      }]);
      assert.ok(window.open.calledWith("https://www.google.com/calendar/event?action=TEMPLATE&text=event&dates=20211012T150000Z/20211012T160000Z", "_blank", "noopener", "noreferrer"));
    });
    (0, _qunit.test)("calculates end date when none given", function (assert) {
      let dates = (0, _downloadCalendar.formatDates)([{
        startsAt: "2021-10-12T15:00:00.000Z"
      }]);
      assert.deepEqual(dates, [{
        startsAt: "2021-10-12T15:00:00.000Z",
        endsAt: "2021-10-12T16:00:00Z"
      }], "endsAt is one hour after startsAt");
    });
  });
});
define("discourse/tests/unit/lib/emoji-test", ["discourse/tests/helpers/qunit-helpers", "pretty-text/emoji", "discourse/lib/text", "qunit", "pretty-text/emoji/version"], function (_qunitHelpers, _emoji, _text, _qunit, _version) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"pretty-text/emoji",0,"discourse/lib/text",0,"qunit",0,"pretty-text/emoji/version"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Utility | emoji", function () {
    (0, _qunit.test)("emojiUnescape", function (assert) {
      var _this = this;

      const testUnescape = function (input, expected, description) {
        let settings = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};
        const originalSettings = {};

        for (const [key, value] of Object.entries(settings)) {
          originalSettings[key] = _this.siteSettings[key];
          _this.siteSettings[key] = value;
        }

        assert.strictEqual((0, _text.emojiUnescape)(input), expected, description);

        for (const [key, value] of Object.entries(originalSettings)) {
          _this.siteSettings[key] = value;
        }
      };

      testUnescape("Not emoji :O) :frog) :smile)", "Not emoji :O) :frog) :smile)", "title without emoji");
      testUnescape("Not emoji :frog :smile", "Not emoji :frog :smile", "end colon is not optional");
      testUnescape("emoticons :)", `emoticons <img width=\"20\" height=\"20\" src='/images/emoji/google_classic/slight_smile.png?v=${_version.IMAGE_VERSION}' title='slight_smile' alt='slight_smile' class='emoji'>`, "emoticons are still supported");
      testUnescape("With emoji :O: :frog: :smile:", `With emoji <img width=\"20\" height=\"20\" src='/images/emoji/google_classic/o.png?v=${_version.IMAGE_VERSION}' title='O' alt='O' class='emoji'> <img width=\"20\" height=\"20\" src='/images/emoji/google_classic/frog.png?v=${_version.IMAGE_VERSION}' title='frog' alt='frog' class='emoji'> <img width=\"20\" height=\"20\" src='/images/emoji/google_classic/smile.png?v=${_version.IMAGE_VERSION}' title='smile' alt='smile' class='emoji'>`, "title with emoji");
      testUnescape("a:smile:a", "a:smile:a", "word characters not allowed next to emoji");
      testUnescape("(:frog:) :)", `(<img width=\"20\" height=\"20\" src='/images/emoji/google_classic/frog.png?v=${_version.IMAGE_VERSION}' title='frog' alt='frog' class='emoji'>) <img width=\"20\" height=\"20\" src='/images/emoji/google_classic/slight_smile.png?v=${_version.IMAGE_VERSION}' title='slight_smile' alt='slight_smile' class='emoji'>`, "non-word characters allowed next to emoji");
      testUnescape(":smile: hi", `<img width=\"20\" height=\"20\" src='/images/emoji/google_classic/smile.png?v=${_version.IMAGE_VERSION}' title='smile' alt='smile' class='emoji'> hi`, "start of line");
      testUnescape("hi :smile:", `hi <img width=\"20\" height=\"20\" src='/images/emoji/google_classic/smile.png?v=${_version.IMAGE_VERSION}' title='smile' alt='smile' class='emoji'>`, "end of line");
      testUnescape("hi :blonde_woman:t4:", `hi <img width=\"20\" height=\"20\" src='/images/emoji/google_classic/blonde_woman/4.png?v=${_version.IMAGE_VERSION}' title='blonde_woman:t4' alt='blonde_woman:t4' class='emoji'>`, "support for skin tones");
      testUnescape("hi :blonde_woman:t4: :blonde_man:t6:", `hi <img width=\"20\" height=\"20\" src='/images/emoji/google_classic/blonde_woman/4.png?v=${_version.IMAGE_VERSION}' title='blonde_woman:t4' alt='blonde_woman:t4' class='emoji'> <img width=\"20\" height=\"20\" src='/images/emoji/google_classic/blonde_man/6.png?v=${_version.IMAGE_VERSION}' title='blonde_man:t6' alt='blonde_man:t6' class='emoji'>`, "support for multiple skin tones");
      testUnescape("hi :blonde_man:t6", "hi :blonde_man:t6", "end colon not optional for skin tones");
      testUnescape("emoticons :)", "emoticons :)", "no emoticons when emojis are disabled", {
        enable_emoji: false
      });
      testUnescape("emoji :smile:", "emoji :smile:", "no emojis when emojis are disabled", {
        enable_emoji: false
      });
      testUnescape("emoticons :)", "emoticons :)", "no emoticons when emoji shortcuts are disabled", {
        enable_emoji_shortcuts: false
      });
      testUnescape("Hello  World", `Hello <img width=\"20\" height=\"20\" src='/images/emoji/google_classic/blush.png?v=${_version.IMAGE_VERSION}' title='blush' alt='blush' class='emoji'> World`, "emoji from Unicode emoji");
      testUnescape("HelloWorld", "HelloWorld", "keeps Unicode emoji when inline translation disabled", {
        enable_inline_emoji_translation: false
      });
      testUnescape("HelloWorld", `Hello<img width=\"20\" height=\"20\" src='/images/emoji/google_classic/blush.png?v=${_version.IMAGE_VERSION}' title='blush' alt='blush' class='emoji'>World`, "emoji from Unicode emoji when inline translation enabled", {
        enable_inline_emoji_translation: true
      });
      testUnescape("hi:smile:", "hi:smile:", "no emojis when inline translation disabled", {
        enable_inline_emoji_translation: false
      });
      testUnescape("hi:smile:", `hi<img width=\"20\" height=\"20\" src='/images/emoji/google_classic/smile.png?v=${_version.IMAGE_VERSION}' title='smile' alt='smile' class='emoji'>`, "emoji when inline translation enabled", {
        enable_inline_emoji_translation: true
      });
    });
    (0, _qunit.test)("Emoji search", function (assert) {
      // able to find an alias
      assert.strictEqual((0, _emoji.emojiSearch)("+1").length, 1); // able to find middle of line search

      assert.strictEqual((0, _emoji.emojiSearch)("check", {
        maxResults: 3
      }).length, 3); // appends diversity

      assert.deepEqual((0, _emoji.emojiSearch)("woman_artist", {
        diversity: 5
      }), ["woman_artist:t5"]);
      assert.deepEqual((0, _emoji.emojiSearch)("woman_artist", {
        diversity: 2
      }), ["woman_artist:t2"]); // no diversity appended for emojis that can't be diversified

      assert.deepEqual((0, _emoji.emojiSearch)("green_apple", {
        diversity: 3
      }), ["green_apple"]);
    });
    (0, _qunit.test)("search does not return duplicated results", function (assert) {
      const matches = (0, _emoji.emojiSearch)("bow").filter(emoji => emoji === "bowing_man");
      assert.deepEqual(matches, ["bowing_man"]);
    });
    (0, _qunit.test)("search does partial-match on emoji aliases", function (assert) {
      const matches = (0, _emoji.emojiSearch)("instru");
      assert.ok(matches.includes("woman_teacher"));
      assert.ok(matches.includes("violin"));
    });
  });
});
define("discourse/tests/unit/lib/formatter-test", ["discourse/lib/formatter", "discourse/tests/helpers/qunit-helpers", "qunit", "discourse-common/lib/dom-from-string"], function (_formatter, _qunitHelpers, _qunit, _domFromString) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/lib/formatter",0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"discourse-common/lib/dom-from-string"eaimeta@70e063a35619d71f

  function formatMins(mins) {
    let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    let dt = new Date(new Date() - mins * 60 * 1000);
    return (0, _formatter.relativeAge)(dt, {
      format: opts.format || "tiny",
      leaveAgo: opts.leaveAgo
    });
  }

  function formatHours(hours, opts) {
    return formatMins(hours * 60, opts);
  }

  function formatDays(days, opts) {
    return formatHours(days * 24, opts);
  }

  function shortDate(days) {
    return moment().subtract(days, "days").format("MMM D");
  }

  function shortDateTester(format) {
    return function (days) {
      return moment().subtract(days, "days").format(format);
    };
  }

  function strip(html) {
    return (0, _domFromString.default)(html)[0].innerText;
  }

  (0, _qunitHelpers.discourseModule)("Unit | Utility | formatter", function (hooks) {
    hooks.beforeEach(function () {
      this.clock = (0, _qunitHelpers.fakeTime)("2012-12-31 12:00");
    });
    hooks.afterEach(function () {
      this.clock.restore();
    });
    (0, _qunit.test)("formatting medium length dates", function (assert) {
      let shortDateYear = shortDateTester("MMM D, 'YY");
      assert.strictEqual(strip(formatMins(1.4, {
        format: "medium",
        leaveAgo: true
      })), "1 min ago");
      assert.strictEqual(strip(formatMins(2, {
        format: "medium",
        leaveAgo: true
      })), "2 mins ago");
      assert.strictEqual(strip(formatMins(55, {
        format: "medium",
        leaveAgo: true
      })), "55 mins ago");
      assert.strictEqual(strip(formatMins(56, {
        format: "medium",
        leaveAgo: true
      })), "1 hour ago");
      assert.strictEqual(strip(formatHours(4, {
        format: "medium",
        leaveAgo: true
      })), "4 hours ago");
      assert.strictEqual(strip(formatHours(22, {
        format: "medium",
        leaveAgo: true
      })), "22 hours ago");
      assert.strictEqual(strip(formatHours(23, {
        format: "medium",
        leaveAgo: true
      })), "23 hours ago");
      assert.strictEqual(strip(formatHours(23.5, {
        format: "medium",
        leaveAgo: true
      })), "1 day ago");
      assert.strictEqual(strip(formatDays(4.85, {
        format: "medium",
        leaveAgo: true
      })), "4 days ago");
      assert.strictEqual(strip(formatMins(0, {
        format: "medium"
      })), "just now");
      assert.strictEqual(strip(formatMins(1.4, {
        format: "medium"
      })), "1 min");
      assert.strictEqual(strip(formatMins(2, {
        format: "medium"
      })), "2 mins");
      assert.strictEqual(strip(formatMins(55, {
        format: "medium"
      })), "55 mins");
      assert.strictEqual(strip(formatMins(56, {
        format: "medium"
      })), "1 hour");
      assert.strictEqual(strip(formatHours(4, {
        format: "medium"
      })), "4 hours");
      assert.strictEqual(strip(formatHours(22, {
        format: "medium"
      })), "22 hours");
      assert.strictEqual(strip(formatHours(23, {
        format: "medium"
      })), "23 hours");
      assert.strictEqual(strip(formatHours(23.5, {
        format: "medium"
      })), "1 day");
      assert.strictEqual(strip(formatDays(4.85, {
        format: "medium"
      })), "4 days");
      assert.strictEqual(strip(formatDays(6, {
        format: "medium"
      })), shortDate(6));
      assert.strictEqual(strip(formatDays(100, {
        format: "medium"
      })), shortDate(100)); // eg: Jan 23

      assert.strictEqual(strip(formatDays(500, {
        format: "medium"
      })), shortDateYear(500));
      assert.strictEqual((0, _domFromString.default)(formatDays(0, {
        format: "medium"
      }))[0].title, (0, _formatter.longDate)(new Date()));
      assert.ok((0, _domFromString.default)(formatDays(0, {
        format: "medium"
      }))[0].classList.contains("date"));
      this.clock.restore();
      this.clock = (0, _qunitHelpers.fakeTime)("2012-01-09 12:00");
      assert.strictEqual(strip(formatDays(8, {
        format: "medium"
      })), shortDate(8));
      assert.strictEqual(strip(formatDays(10, {
        format: "medium"
      })), shortDateYear(10));
    });
    (0, _qunit.test)("formatting tiny dates", function (assert) {
      let shortDateYear = shortDateTester("MMM 'YY");
      assert.strictEqual(formatMins(0), "1m");
      assert.strictEqual(formatMins(1), "1m");
      assert.strictEqual(formatMins(2), "2m");
      assert.strictEqual(formatMins(60), "1h");
      assert.strictEqual(formatHours(4), "4h");
      assert.strictEqual(formatHours(23), "23h");
      assert.strictEqual(formatHours(23.5), "1d");
      assert.strictEqual(formatDays(1), "1d");
      assert.strictEqual(formatDays(14), "14d");
      assert.strictEqual(formatDays(15), shortDate(15));
      assert.strictEqual(formatDays(92), shortDate(92));
      assert.strictEqual(formatDays(364), shortDate(364));
      assert.strictEqual(formatDays(365), shortDate(365));
      assert.strictEqual(formatDays(366), shortDateYear(366)); // leap year

      assert.strictEqual(formatDays(500), shortDateYear(500));
      assert.strictEqual(formatDays(365 * 2 + 1), shortDateYear(365 * 2 + 1)); // one leap year

      assert.strictEqual(formatMins(-1), "1m");
      assert.strictEqual(formatMins(-2), "2m");
      assert.strictEqual(formatMins(-60), "1h");
      assert.strictEqual(formatHours(-4), "4h");
      assert.strictEqual(formatHours(-23), "23h");
      assert.strictEqual(formatHours(-23.5), "1d");
      assert.strictEqual(formatDays(-1), "1d");
      assert.strictEqual(formatDays(-14), "14d");
      assert.strictEqual(formatDays(-15), shortDateYear(-15));
      assert.strictEqual(formatDays(-92), shortDateYear(-92));
      assert.strictEqual(formatDays(-364), shortDateYear(-364));
      assert.strictEqual(formatDays(-365), shortDateYear(-365));
      assert.strictEqual(formatDays(-366), shortDateYear(-366)); // leap year

      assert.strictEqual(formatDays(-500), shortDateYear(-500));
      assert.strictEqual(formatDays(-365 * 2 - 1), shortDateYear(-365 * 2 - 1)); // one leap year

      let originalValue = this.siteSettings.relative_date_duration;
      this.siteSettings.relative_date_duration = 7;
      assert.strictEqual(formatDays(7), "7d");
      assert.strictEqual(formatDays(8), shortDate(8));
      this.siteSettings.relative_date_duration = 1;
      assert.strictEqual(formatDays(1), "1d");
      assert.strictEqual(formatDays(2), shortDate(2));
      this.siteSettings.relative_date_duration = 0;
      assert.strictEqual(formatMins(0), "1m");
      assert.strictEqual(formatMins(1), "1m");
      assert.strictEqual(formatMins(2), "2m");
      assert.strictEqual(formatMins(60), "1h");
      assert.strictEqual(formatDays(1), shortDate(1));
      assert.strictEqual(formatDays(2), shortDate(2));
      assert.strictEqual(formatDays(366), shortDateYear(366));
      this.siteSettings.relative_date_duration = null;
      assert.strictEqual(formatDays(1), "1d");
      assert.strictEqual(formatDays(14), "14d");
      assert.strictEqual(formatDays(15), shortDate(15));
      this.siteSettings.relative_date_duration = 14;
      this.clock.restore();
      this.clock = (0, _qunitHelpers.fakeTime)("2012-01-12 12:00");
      assert.strictEqual(formatDays(11), "11d");
      assert.strictEqual(formatDays(14), "14d");
      assert.strictEqual(formatDays(15), shortDateYear(15));
      assert.strictEqual(formatDays(366), shortDateYear(366));
      this.clock.restore();
      this.clock = (0, _qunitHelpers.fakeTime)("2012-01-20 12:00");
      assert.strictEqual(formatDays(14), "14d");
      assert.strictEqual(formatDays(15), shortDate(15));
      assert.strictEqual(formatDays(20), shortDateYear(20));
      this.siteSettings.relative_date_duration = originalValue;
    });
    (0, _qunit.test)("autoUpdatingRelativeAge", function (assert) {
      let d = moment().subtract(1, "day").toDate();
      let elem = (0, _domFromString.default)((0, _formatter.autoUpdatingRelativeAge)(d))[0];
      assert.strictEqual(elem.dataset.format, "tiny");
      assert.strictEqual(elem.dataset.time, d.getTime().toString());
      assert.strictEqual(elem.title, "");
      elem = (0, _domFromString.default)((0, _formatter.autoUpdatingRelativeAge)(d, {
        title: true
      }))[0];
      assert.strictEqual(elem.title, (0, _formatter.longDate)(d));
      elem = (0, _domFromString.default)((0, _formatter.autoUpdatingRelativeAge)(d, {
        format: "medium",
        title: true,
        leaveAgo: true
      }))[0];
      assert.strictEqual(elem.dataset.format, "medium-with-ago");
      assert.strictEqual(elem.dataset.time, d.getTime().toString());
      assert.strictEqual(elem.title, (0, _formatter.longDate)(d));
      assert.strictEqual(elem.innerHTML, "1 day ago");
      elem = (0, _domFromString.default)((0, _formatter.autoUpdatingRelativeAge)(d, {
        format: "medium"
      }))[0];
      assert.strictEqual(elem.dataset.format, "medium");
      assert.strictEqual(elem.dataset.time, d.getTime().toString());
      assert.strictEqual(elem.title, "");
      assert.strictEqual(elem.innerHTML, "1 day");
    });
    (0, _qunit.test)("updateRelativeAge", function (assert) {
      let d = new Date();
      let elem = (0, _domFromString.default)((0, _formatter.autoUpdatingRelativeAge)(d))[0];
      elem.dataset.time = d.getTime() - 2 * 60 * 1000;
      (0, _formatter.updateRelativeAge)(elem);
      assert.strictEqual(elem.innerHTML, "2m");
      d = new Date();
      elem = (0, _domFromString.default)((0, _formatter.autoUpdatingRelativeAge)(d, {
        format: "medium",
        leaveAgo: true
      }))[0];
      elem.dataset.time = d.getTime() - 2 * 60 * 1000;
      (0, _formatter.updateRelativeAge)(elem);
      assert.strictEqual(elem.innerHTML, "2 mins ago");
    });
    (0, _qunit.test)("number", function (assert) {
      assert.strictEqual((0, _formatter.number)(123), "123", "it returns a string version of the number");
      assert.strictEqual((0, _formatter.number)("123"), "123", "it works with a string command");
      assert.strictEqual((0, _formatter.number)(NaN), "0", "it returns 0 for NaN");
      assert.strictEqual((0, _formatter.number)(3333), "3.3k", "it abbreviates thousands");
      assert.strictEqual((0, _formatter.number)(2499999), "2.5M", "it abbreviates millions");
      assert.strictEqual((0, _formatter.number)("2499999.5"), "2.5M", "it abbreviates millions");
      assert.strictEqual((0, _formatter.number)(1000000), "1.0M", "it abbreviates a million");
      assert.strictEqual((0, _formatter.number)(999999), "999k", "it abbreviates hundreds of thousands");
      assert.strictEqual((0, _formatter.number)(18.2), "18", "it returns a float number rounded to an integer as a string");
      assert.strictEqual((0, _formatter.number)(18.6), "19", "it returns a float number rounded to an integer as a string");
      assert.strictEqual((0, _formatter.number)("12.3"), "12", "it returns a string float rounded to an integer as a string");
      assert.strictEqual((0, _formatter.number)("12.6"), "13", "it returns a string float rounded to an integer as a string");
    });
    (0, _qunit.test)("durationTiny", function (assert) {
      assert.strictEqual((0, _formatter.durationTiny)(), "&mdash;", "undefined is a dash");
      assert.strictEqual((0, _formatter.durationTiny)(null), "&mdash;", "null is a dash");
      assert.strictEqual((0, _formatter.durationTiny)(0), "< 1m", "0 seconds shows as < 1m");
      assert.strictEqual((0, _formatter.durationTiny)(59), "< 1m", "59 seconds shows as < 1m");
      assert.strictEqual((0, _formatter.durationTiny)(60), "1m", "60 seconds shows as 1m");
      assert.strictEqual((0, _formatter.durationTiny)(90), "2m", "90 seconds shows as 2m");
      assert.strictEqual((0, _formatter.durationTiny)(120), "2m", "120 seconds shows as 2m");
      assert.strictEqual((0, _formatter.durationTiny)(60 * 45), "1h", "45 minutes shows as 1h");
      assert.strictEqual((0, _formatter.durationTiny)(60 * 60), "1h", "60 minutes shows as 1h");
      assert.strictEqual((0, _formatter.durationTiny)(60 * 90), "2h", "90 minutes shows as 2h");
      assert.strictEqual((0, _formatter.durationTiny)(3600 * 23), "23h", "23 hours shows as 23h");
      assert.strictEqual((0, _formatter.durationTiny)(3600 * 24 - 29), "1d", "23 hours 31 mins shows as 1d");
      assert.strictEqual((0, _formatter.durationTiny)(3600 * 24 * 89), "89d", "89 days shows as 89d");
      assert.strictEqual((0, _formatter.durationTiny)(60 * (525600 - 1)), "12mon", "364 days shows as 12mon");
      assert.strictEqual((0, _formatter.durationTiny)(60 * 525600), "1y", "365 days shows as 1y");
      assert.strictEqual((0, _formatter.durationTiny)(86400 * 456), "1y", "456 days shows as 1y");
      assert.strictEqual((0, _formatter.durationTiny)(86400 * 457), "> 1y", "457 days shows as > 1y");
      assert.strictEqual((0, _formatter.durationTiny)(86400 * 638), "> 1y", "638 days shows as > 1y");
      assert.strictEqual((0, _formatter.durationTiny)(86400 * 639), "2y", "639 days shows as 2y");
      assert.strictEqual((0, _formatter.durationTiny)(86400 * 821), "2y", "821 days shows as 2y");
      assert.strictEqual((0, _formatter.durationTiny)(86400 * 822), "> 2y", "822 days shows as > 2y");
    });
    (0, _qunit.test)("duration (medium format)", function (assert) {
      assert.strictEqual((0, _formatter.duration)(undefined, {
        format: "medium"
      }), "&mdash;", "undefined is a dash");
      assert.strictEqual((0, _formatter.duration)(null, {
        format: "medium"
      }), "&mdash;", "null is a dash");
      assert.strictEqual((0, _formatter.duration)(0, {
        format: "medium"
      }), "less than 1 min", "0 seconds shows as less than 1 min");
      assert.strictEqual((0, _formatter.duration)(59, {
        format: "medium"
      }), "less than 1 min", "59 seconds shows as less than 1 min");
      assert.strictEqual((0, _formatter.duration)(60, {
        format: "medium"
      }), "1 min", "60 seconds shows as 1 min");
      assert.strictEqual((0, _formatter.duration)(90, {
        format: "medium"
      }), "2 mins", "90 seconds shows as 2 mins");
      assert.strictEqual((0, _formatter.duration)(120, {
        format: "medium"
      }), "2 mins", "120 seconds shows as 2 mins");
      assert.strictEqual((0, _formatter.duration)(60 * 45, {
        format: "medium"
      }), "about 1 hour", "45 minutes shows as about 1 hour");
      assert.strictEqual((0, _formatter.duration)(60 * 60, {
        format: "medium"
      }), "about 1 hour", "60 minutes shows as about 1 hour");
      assert.strictEqual((0, _formatter.duration)(60 * 90, {
        format: "medium"
      }), "about 2 hours", "90 minutes shows as about 2 hours");
      assert.strictEqual((0, _formatter.duration)(3600 * 23, {
        format: "medium"
      }), "about 23 hours", "23 hours shows as about 23 hours");
      assert.strictEqual((0, _formatter.duration)(3600 * 24 - 29, {
        format: "medium"
      }), "1 day", "23 hours 31 mins shows as 1 day");
      assert.strictEqual((0, _formatter.duration)(3600 * 24 * 89, {
        format: "medium"
      }), "89 days", "89 days shows as 89 days");
      assert.strictEqual((0, _formatter.duration)(60 * (525600 - 1), {
        format: "medium"
      }), "12 months", "364 days shows as 12 months");
      assert.strictEqual((0, _formatter.duration)(60 * 525600, {
        format: "medium"
      }), "about 1 year", "365 days shows as about 1 year");
      assert.strictEqual((0, _formatter.duration)(86400 * 456, {
        format: "medium"
      }), "about 1 year", "456 days shows as about 1 year");
      assert.strictEqual((0, _formatter.duration)(86400 * 457, {
        format: "medium"
      }), "over 1 year", "457 days shows as over 1 year");
      assert.strictEqual((0, _formatter.duration)(86400 * 638, {
        format: "medium"
      }), "over 1 year", "638 days shows as over 1 year");
      assert.strictEqual((0, _formatter.duration)(86400 * 639, {
        format: "medium"
      }), "almost 2 years", "639 days shows as almost 2 years");
      assert.strictEqual((0, _formatter.duration)(86400 * 821, {
        format: "medium"
      }), "about 2 years", "821 days shows as about 2 years");
      assert.strictEqual((0, _formatter.duration)(86400 * 822, {
        format: "medium"
      }), "over 2 years", "822 days shows as over 2 years");
    });
  });
  (0, _qunitHelpers.discourseModule)("Unit | Utility | formatter | until", function (hooks) {
    hooks.afterEach(function () {
      if (this.clock) {
        this.clock.restore();
      }
    });
    (0, _qunit.test)("shows time if until moment is today", function (assert) {
      const timezone = "UTC";
      this.clock = (0, _qunitHelpers.fakeTime)("2100-01-01 12:00:00.000Z", timezone);
      const result = (0, _formatter.until)("2100-01-01 13:00:00.000Z", timezone, "en");
      assert.equal(result, "Until: 1:00 PM");
    });
    (0, _qunit.test)("shows date if until moment is tomorrow", function (assert) {
      const timezone = "UTC";
      this.clock = (0, _qunitHelpers.fakeTime)("2100-01-01 12:00:00.000Z", timezone);
      const result = (0, _formatter.until)("2100-01-02 12:00:00.000Z", timezone, "en");
      assert.equal(result, "Until: Jan 2");
    });
    (0, _qunit.test)("shows until moment in user's timezone", function (assert) {
      const timezone = "Asia/Tbilisi";
      const untilUTC = "13:00";
      const untilTbilisi = "5:00 PM";
      this.clock = (0, _qunitHelpers.fakeTime)("2100-01-01 12:00:00.000Z", timezone);
      const result = (0, _formatter.until)(`2100-01-01 ${untilUTC}:00.000Z`, timezone, "en");
      assert.equal(result, `Until: ${untilTbilisi}`);
    });
  });
});
define("discourse/tests/unit/lib/get-url-test", ["discourse-common/lib/get-url", "qunit"], function (_getUrl, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse-common/lib/get-url",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | get-url", function () {
    (0, _qunit.test)("isAbsoluteURL", function (assert) {
      (0, _getUrl.setupURL)(null, "https://example.com", "/forum");
      assert.ok((0, _getUrl.isAbsoluteURL)("https://example.com/test/thing"));
      assert.ok(!(0, _getUrl.isAbsoluteURL)("http://example.com/test/thing"));
      assert.ok(!(0, _getUrl.isAbsoluteURL)("https://discourse.org/test/thing"));
    });
    (0, _qunit.test)("getAbsoluteURL", function (assert) {
      (0, _getUrl.setupURL)(null, "https://example.com", null);
      assert.strictEqual((0, _getUrl.getAbsoluteURL)("/cool/path"), "https://example.com/cool/path");
      (0, _getUrl.setupURL)(null, "https://example.com/forum", "/forum");
      assert.strictEqual((0, _getUrl.getAbsoluteURL)("/cool/path"), "https://example.com/forum/cool/path");
      assert.strictEqual((0, _getUrl.getAbsoluteURL)("/forum/cool/path"), "https://example.com/forum/cool/path");
    });
    (0, _qunit.test)("withoutPrefix", function (assert) {
      (0, _getUrl.setPrefix)("/eviltrout");
      assert.strictEqual((0, _getUrl.withoutPrefix)("/eviltrout/hello"), "/hello");
      assert.strictEqual((0, _getUrl.withoutPrefix)("/eviltrout/"), "/");
      assert.strictEqual((0, _getUrl.withoutPrefix)("/eviltrout"), "");
      (0, _getUrl.setPrefix)("");
      assert.strictEqual((0, _getUrl.withoutPrefix)("/eviltrout/hello"), "/eviltrout/hello");
      assert.strictEqual((0, _getUrl.withoutPrefix)("/eviltrout"), "/eviltrout");
      assert.strictEqual((0, _getUrl.withoutPrefix)("/"), "/");
      (0, _getUrl.setPrefix)(null);
      assert.strictEqual((0, _getUrl.withoutPrefix)("/eviltrout/hello"), "/eviltrout/hello");
      assert.strictEqual((0, _getUrl.withoutPrefix)("/eviltrout"), "/eviltrout");
      assert.strictEqual((0, _getUrl.withoutPrefix)("/"), "/");
      (0, _getUrl.setPrefix)("/f");
      assert.strictEqual((0, _getUrl.withoutPrefix)("/faq"), "/faq");
      assert.strictEqual((0, _getUrl.withoutPrefix)("/f/faq"), "/faq");
      assert.strictEqual((0, _getUrl.withoutPrefix)("/f"), "");
    });
    (0, _qunit.test)("withoutPrefix called multiple times on the same path", function (assert) {
      (0, _getUrl.setPrefix)("/eviltrout");
      assert.strictEqual((0, _getUrl.withoutPrefix)((0, _getUrl.withoutPrefix)("/eviltrout/hello")), "/hello");
      assert.strictEqual((0, _getUrl.withoutPrefix)((0, _getUrl.withoutPrefix)("/eviltrout/")), "/");
      assert.strictEqual((0, _getUrl.withoutPrefix)((0, _getUrl.withoutPrefix)("/eviltrout")), "");
      (0, _getUrl.setPrefix)("");
      assert.strictEqual((0, _getUrl.withoutPrefix)((0, _getUrl.withoutPrefix)("/eviltrout/hello")), "/eviltrout/hello");
      assert.strictEqual((0, _getUrl.withoutPrefix)((0, _getUrl.withoutPrefix)("/eviltrout")), "/eviltrout");
      assert.strictEqual((0, _getUrl.withoutPrefix)((0, _getUrl.withoutPrefix)("/")), "/");
      (0, _getUrl.setPrefix)(null);
      assert.strictEqual((0, _getUrl.withoutPrefix)((0, _getUrl.withoutPrefix)("/eviltrout/hello")), "/eviltrout/hello");
      assert.strictEqual((0, _getUrl.withoutPrefix)((0, _getUrl.withoutPrefix)("/eviltrout")), "/eviltrout");
      assert.strictEqual((0, _getUrl.withoutPrefix)((0, _getUrl.withoutPrefix)("/")), "/");
      (0, _getUrl.setPrefix)("/f");
      assert.strictEqual((0, _getUrl.withoutPrefix)((0, _getUrl.withoutPrefix)("/f/t/falco-says-hello")), "/t/falco-says-hello");
      assert.strictEqual((0, _getUrl.withoutPrefix)((0, _getUrl.withoutPrefix)("/f/tag/fast-chain-food")), "/tag/fast-chain-food");
      assert.strictEqual((0, _getUrl.withoutPrefix)((0, _getUrl.withoutPrefix)("/f/u/falco/summary")), "/u/falco/summary");
    });
    (0, _qunit.test)("getURL with empty paths", function (assert) {
      (0, _getUrl.setupURL)(null, "https://example.com", "/");
      assert.strictEqual((0, _getUrl.default)("/"), "/");
      assert.strictEqual((0, _getUrl.default)(""), "");
      (0, _getUrl.setupURL)(null, "https://example.com", "");
      assert.strictEqual((0, _getUrl.default)("/"), "/");
      assert.strictEqual((0, _getUrl.default)(""), "");
      (0, _getUrl.setupURL)(null, "https://example.com", undefined);
      assert.strictEqual((0, _getUrl.default)("/"), "/");
      assert.strictEqual((0, _getUrl.default)(""), "");
    });
    (0, _qunit.test)("getURL on subfolder install", function (assert) {
      (0, _getUrl.setupURL)(null, "", "/forum");
      assert.strictEqual((0, _getUrl.default)("/"), "/forum/", "root url has subfolder");
      assert.strictEqual((0, _getUrl.default)("/u/neil"), "/forum/u/neil", "relative url has subfolder");
      assert.strictEqual((0, _getUrl.default)("/u/forumadmin"), "/forum/u/forumadmin", "relative url has subfolder even if username contains subfolder");
      assert.strictEqual((0, _getUrl.default)(""), "/forum", "relative url has subfolder without trailing slash");
      assert.strictEqual((0, _getUrl.default)("/svg-sprite/forum.example.com/svg-sprite.js"), "/forum/svg-sprite/forum.example.com/svg-sprite.js", "works when the url has the prefix in the middle");
      assert.strictEqual((0, _getUrl.default)("/forum/t/123"), "/forum/t/123", "does not prefix if the URL is already prefixed");
      (0, _getUrl.setPrefix)("/f");
      assert.strictEqual((0, _getUrl.default)("/faq"), "/f/faq", "relative path has subfolder even if it starts with the prefix without trailing slash");
      assert.strictEqual((0, _getUrl.default)("/f/faq"), "/f/faq", "does not prefix if the URL is already prefixed");
    });
    (0, _qunit.test)("getURLWithCDN on subfolder install with S3", function (assert) {
      (0, _getUrl.setupURL)(null, "", "/forum");
      (0, _getUrl.setupS3CDN)("//test.s3-us-west-1.amazonaws.com/site", "https://awesome.cdn/site");
      let url = "//test.s3-us-west-1.amazonaws.com/site/forum/awesome.png";
      let expected = "https://awesome.cdn/site/forum/awesome.png";
      assert.strictEqual((0, _getUrl.getURLWithCDN)(url), expected, "at correct path");
    });
  });
});
define("discourse/tests/unit/lib/highlight-search-test", ["discourse/lib/highlight-search", "qunit", "discourse/tests/helpers/qunit-helpers"], function (_highlightSearch, _qunit, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/lib/highlight-search",0,"qunit",0,"discourse/tests/helpers/qunit-helpers"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | highlight-search", function () {
    (0, _qunit.test)("highlighting text", function (assert) {
      (0, _qunitHelpers.fixture)().innerHTML = `
      <p>This is some text to highlight</p>
      `;
      (0, _highlightSearch.default)((0, _qunitHelpers.fixture)(), "some text");
      const terms = [(0, _qunitHelpers.fixture)(`.${_highlightSearch.CLASS_NAME}`).textContent];
      assert.strictEqual(terms.join(" "), "some text", "it should highlight the terms correctly");
    });
    (0, _qunit.test)("highlighting unicode text", function (assert) {
      (0, _qunitHelpers.fixture)().innerHTML = `
      <p>This is some  &  text to highlight</p>
      `;
      (0, _highlightSearch.default)((0, _qunitHelpers.fixture)(), " & ");
      const terms = [(0, _qunitHelpers.fixture)(`.${_highlightSearch.CLASS_NAME}`).textContent];
      assert.strictEqual(terms.join(" "), " & ", "it should highlight the terms correctly");
    });
  });
});
define("discourse/tests/unit/lib/i18n-test", ["qunit", "I18n"], function (_qunit, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | i18n", function (hooks) {
    hooks.beforeEach(function () {
      this._locale = _I18n.default.locale;
      this._fallbackLocale = _I18n.default.fallbackLocale;
      this._translations = _I18n.default.translations;
      this._extras = _I18n.default.extras;
      this._pluralizationRules = Object.assign({}, _I18n.default.pluralizationRules);
      _I18n.default.locale = "fr";
      _I18n.default.translations = {
        fr_FOO: {
          js: {
            topic: {
              reply: {
                title: "Foo"
              }
            }
          }
        },
        fr: {
          js: {
            hello: "Bonjour",
            topic: {
              reply: {
                title: "Rpondre"
              },
              share: {
                title: "Partager"
              }
            },
            character_count: {
              zero: "{{count}} ZERO",
              one: "{{count}} ONE",
              two: "{{count}} TWO",
              few: "{{count}} FEW",
              many: "{{count}} MANY",
              other: "{{count}} OTHER"
            },
            days: {
              other: "%{count} jours"
            }
          }
        },
        en: {
          js: {
            hello: {
              world: "Hello World!",
              universe: ""
            },
            topic: {
              reply: {
                help: "begin composing a reply to this topic"
              }
            },
            word_count: {
              one: "1 word",
              other: "{{count}} words"
            },
            days: {
              one: "%{count} day",
              other: "%{count} days"
            },
            dollar_sign: "Hi {{description}}"
          }
        }
      }; // fake pluralization rules

      _I18n.default.pluralizationRules = Object.assign({}, _I18n.default.pluralizationRules);

      _I18n.default.pluralizationRules.fr = function (n) {
        if (n === 0) {
          return "zero";
        }

        if (n === 1) {
          return "one";
        }

        if (n === 2) {
          return "two";
        }

        if (n >= 3 && n <= 9) {
          return "few";
        }

        if (n >= 10 && n <= 99) {
          return "many";
        }

        return "other";
      };
    });
    hooks.afterEach(function () {
      _I18n.default.locale = this._locale;
      _I18n.default.fallbackLocale = this._fallbackLocale;
      _I18n.default.translations = this._translations;
      _I18n.default.extras = this._extras;
      _I18n.default.pluralizationRules = this._pluralizationRules;
    });
    (0, _qunit.test)("defaults", function (assert) {
      assert.strictEqual(_I18n.default.defaultLocale, "en", "it has English as default locale");
      assert.ok(_I18n.default.pluralizationRules["en"], "it has English pluralizer");
    });
    (0, _qunit.test)("translations", function (assert) {
      assert.strictEqual(_I18n.default.t("topic.reply.title"), "Rpondre", "uses locale translations when they exist");
      assert.strictEqual(_I18n.default.t("topic.reply.help"), "begin composing a reply to this topic", "fallbacks to English translations");
      assert.strictEqual(_I18n.default.t("hello.world"), "Hello World!", "doesn't break if a key is overridden in a locale");
      assert.strictEqual(_I18n.default.t("hello.universe"), "", "allows empty strings");
    });
    (0, _qunit.test)("extra translations", function (assert) {
      _I18n.default.locale = "pl_PL";
      _I18n.default.extras = {
        en: {
          admin: {
            dashboard: {
              title: "Dashboard",
              backup_count: {
                one: "%{count} backup",
                other: "%{count} backups"
              }
            },
            web_hooks: {
              events: {
                incoming: {
                  one: "There is a new event.",
                  other: "There are %{count} new events."
                }
              }
            }
          }
        },
        pl_PL: {
          admin: {
            dashboard: {
              title: "Raporty"
            },
            web_hooks: {
              events: {
                incoming: {
                  one: "Istnieje nowe wydarzenie",
                  few: "Istniej %{count} nowe wydarzenia.",
                  many: "Istnieje %{count} nowych wydarze.",
                  other: "Istnieje %{count} nowych wydarze."
                }
              }
            }
          }
        }
      };

      _I18n.default.pluralizationRules.pl_PL = function (n) {
        if (n === 1) {
          return "one";
        }

        if (n % 10 >= 2 && n % 10 <= 4) {
          return "few";
        }

        if (n % 10 === 0) {
          return "many";
        }

        return "other";
      };

      assert.strictEqual(_I18n.default.t("admin.dashboard.title"), "Raporty", "it uses extra translations when they exists");
      assert.strictEqual(_I18n.default.t("admin.web_hooks.events.incoming", {
        count: 2
      }), "Istniej 2 nowe wydarzenia.", "it uses pluralized extra translation when it exists");
      assert.strictEqual(_I18n.default.t("admin.dashboard.backup_count", {
        count: 2
      }), "2 backups", "it falls back to English and uses extra translations when they exists");
    });
    (0, _qunit.test)("pluralizations", function (assert) {
      assert.strictEqual(_I18n.default.t("character_count", {
        count: 0
      }), "0 ZERO");
      assert.strictEqual(_I18n.default.t("character_count", {
        count: 1
      }), "1 ONE");
      assert.strictEqual(_I18n.default.t("character_count", {
        count: 2
      }), "2 TWO");
      assert.strictEqual(_I18n.default.t("character_count", {
        count: 3
      }), "3 FEW");
      assert.strictEqual(_I18n.default.t("character_count", {
        count: 10
      }), "10 MANY");
      assert.strictEqual(_I18n.default.t("character_count", {
        count: 100
      }), "100 OTHER");
      assert.strictEqual(_I18n.default.t("word_count", {
        count: 0
      }), "0 words");
      assert.strictEqual(_I18n.default.t("word_count", {
        count: 1
      }), "1 word");
      assert.strictEqual(_I18n.default.t("word_count", {
        count: 2
      }), "2 words");
      assert.strictEqual(_I18n.default.t("word_count", {
        count: 3
      }), "3 words");
      assert.strictEqual(_I18n.default.t("word_count", {
        count: 10
      }), "10 words");
      assert.strictEqual(_I18n.default.t("word_count", {
        count: 100
      }), "100 words");
    });
    (0, _qunit.test)("adds the count to the missing translation strings", function (assert) {
      assert.strictEqual(_I18n.default.t("invalid_i18n_string", {
        count: 1
      }), `[fr.invalid_i18n_string count=1]`);
      assert.strictEqual(_I18n.default.t("character_count", {
        count: "0"
      }), `[fr.character_count count="0"]`);
      assert.strictEqual(_I18n.default.t("character_count", {
        count: null
      }), `[fr.character_count count=null]`);
      assert.strictEqual(_I18n.default.t("character_count", {
        count: undefined
      }), `[fr.character_count count=undefined]`);
      assert.strictEqual(_I18n.default.t("character_count"), "[fr.character_count]");
    });
    (0, _qunit.test)("fallback", function (assert) {
      assert.strictEqual(_I18n.default.t("days", {
        count: 1
      }), "1 day", "uses fallback locale for missing plural key");
      assert.strictEqual(_I18n.default.t("days", {
        count: 200
      }), "200 jours", "uses existing French plural key");
      _I18n.default.locale = "fr_FOO";
      _I18n.default.fallbackLocale = "fr";
      assert.strictEqual(_I18n.default.t("topic.reply.title"), "Foo", "uses locale translations when they exist");
      assert.strictEqual(_I18n.default.t("topic.share.title"), "Partager", "falls back to fallbackLocale translations when they exist");
      assert.strictEqual(_I18n.default.t("topic.reply.help"), "begin composing a reply to this topic", "falls back to English translations");
    });
    (0, _qunit.test)("Dollar signs are properly escaped", function (assert) {
      assert.strictEqual(_I18n.default.t("dollar_sign", {
        description: "$& $&"
      }), "Hi $& $&");
    });
    (0, _qunit.test)("Customized missing translation string", function (assert) {
      assert.strictEqual(_I18n.default.t("emoji_picker.customtest", {
        translatedFallback: "customtest"
      }), "customtest");
    });
  });
});
define("discourse/tests/unit/lib/icon-library-test", ["discourse-common/lib/icon-library", "qunit"], function (_iconLibrary, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse-common/lib/icon-library",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | icon-library", function () {
    (0, _qunit.test)("return icon markup", function (assert) {
      assert.ok((0, _iconLibrary.iconHTML)("bars").includes('use href="#bars"'));
      const nodeIcon = (0, _iconLibrary.iconNode)("bars");
      assert.strictEqual(nodeIcon.tagName, "svg");
      assert.strictEqual(nodeIcon.properties.attributes.class, "fa d-icon d-icon-bars svg-icon svg-node");
    });
    (0, _qunit.test)("convert icon names", function (assert) {
      const fa5Icon = (0, _iconLibrary.convertIconClass)("fab fa-facebook");
      assert.ok((0, _iconLibrary.iconHTML)(fa5Icon).includes("fab-facebook"), "FA 5 syntax");
      const iconC = (0, _iconLibrary.convertIconClass)("  fab fa-facebook  ");
      assert.ok(!(0, _iconLibrary.iconHTML)(iconC).includes("  "), "trims whitespace");
    });
    (0, _qunit.test)("escape icon names, classes, titles and aria-label", function (assert) {
      let html = (0, _iconLibrary.iconHTML)("'<img src='x'>", {
        translatedTitle: "'<script src='y'>",
        label: "<iframe src='z'>",
        class: "'<link href='w'>",
        "aria-label": "<script>alert(1)"
      });
      assert.ok(html.includes("&#x27;&lt;img src=&#x27;x&#x27;&gt;"));
      assert.ok(html.includes("&#x27;&lt;script src=&#x27;y&#x27;&gt;"));
      assert.ok(html.includes("&lt;iframe src=&#x27;z&#x27;&gt;"));
      assert.ok(html.includes("&#x27;&lt;link href=&#x27;w&#x27;&gt;"));
      html = (0, _iconLibrary.iconHTML)("'<img src='x'>", {
        "aria-label": "<script>alert(1)"
      });
      assert.ok(html.includes("aria-label='&lt;script&gt;alert(1)'"));
    });
  });
});
define("discourse/tests/unit/lib/key-value-store-test", ["qunit", "discourse/lib/key-value-store"], function (_qunit, _keyValueStore) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/lib/key-value-store"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | key-value-store", function () {
    (0, _qunit.test)("is able to get the result back from the store", function (assert) {
      const store = new _keyValueStore.default("example");
      store.set({
        key: "bob",
        value: "uncle"
      });
      assert.strictEqual(store.get("bob"), "uncle");
    });
    (0, _qunit.test)("is able remove items from the store", function (assert) {
      const store = new _keyValueStore.default("example");
      store.set({
        key: "bob",
        value: "uncle"
      });
      store.remove("bob");
      assert.strictEqual(store.get("bob"), undefined);
    });
    (0, _qunit.test)("is able to remove multiple items at once from the store", function (assert) {
      const store = new _keyValueStore.default("example");
      store.set({
        key: "bob",
        value: "uncle"
      });
      store.set({
        key: "jane",
        value: "sister"
      });
      store.set({
        key: "clark",
        value: "brother"
      });
      store.removeKeys((key, value) => {
        return key.includes("bob") || value === "brother";
      });
      assert.strictEqual(store.get("bob"), undefined);
      assert.strictEqual(store.get("jane"), "sister");
      assert.strictEqual(store.get("clark"), undefined);
    });
    (0, _qunit.test)("is able to nuke the store", function (assert) {
      const store = new _keyValueStore.default("example");
      store.set({
        key: "bob1",
        value: "uncle"
      });
      store.abandonLocal();
      localStorage.a = 1;
      assert.strictEqual(store.get("bob1"), undefined);
      assert.strictEqual(localStorage.a, "1");
    });
    (0, _qunit.test)("is API-compatible with `localStorage`", function (assert) {
      const store = new _keyValueStore.default("example");
      store.setItem("bob", "uncle");
      assert.strictEqual(store.getItem("bob"), "uncle");
      store.removeItem("bob");
      assert.strictEqual(store.getItem("bob"), undefined);
    });
  });
});
define("discourse/tests/unit/lib/keyboard-shortcuts-test", ["qunit", "discourse/lib/url", "discourse/lib/keyboard-shortcuts", "sinon"], function (_qunit, _url, _keyboardShortcuts, _sinon) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/lib/url",0,"discourse/lib/keyboard-shortcuts",0,"sinon"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | keyboard-shortcuts", function (hooks) {
    hooks.beforeEach(function () {
      _sinon.default.stub(_url.default, "routeTo");
    });
    (0, _qunit.test)("selectDown calls _moveSelection with 1", function (assert) {
      let stub = _sinon.default.stub(_keyboardShortcuts.default, "_moveSelection");

      _keyboardShortcuts.default.selectDown();

      assert.ok(stub.calledWith(1), "_moveSelection is called with 1");
    });
    (0, _qunit.test)("selectUp calls _moveSelection with -1", function (assert) {
      let stub = _sinon.default.stub(_keyboardShortcuts.default, "_moveSelection");

      _keyboardShortcuts.default.selectUp();

      assert.ok(stub.calledWith(-1), "_moveSelection is called with -1");
    });
    (0, _qunit.test)("goBack calls history.back", function (assert) {
      let called = false;

      _sinon.default.stub(history, "back").callsFake(function () {
        called = true;
      });

      _keyboardShortcuts.default.goBack();

      assert.ok(called, "history.back is called");
    });
    (0, _qunit.test)("nextSection calls _changeSection with 1", function (assert) {
      let spy = _sinon.default.spy(_keyboardShortcuts.default, "_changeSection");

      _keyboardShortcuts.default.nextSection();

      assert.ok(spy.calledWith(1), "_changeSection is called with 1");
    });
    (0, _qunit.test)("prevSection calls _changeSection with -1", function (assert) {
      let spy = _sinon.default.spy(_keyboardShortcuts.default, "_changeSection");

      _keyboardShortcuts.default.prevSection();

      assert.ok(spy.calledWith(-1), "_changeSection is called with -1");
    });
  });
});
define("discourse/tests/unit/lib/link-lookup-test", ["discourse/lib/link-lookup", "qunit", "discourse/models/post"], function (_linkLookup, _qunit, _post) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/lib/link-lookup",0,"qunit",0,"discourse/models/post"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | link-lookup", function (hooks) {
    hooks.beforeEach(function () {
      this.post = _post.default.create();
      this.linkLookup = new _linkLookup.default({
        "en.wikipedia.org/wiki/handheld_game_console": {
          post_number: 1
        }
      });
    });
    (0, _qunit.test)("works with https", function (assert) {
      assert.ok(this.linkLookup.check(this.post, "https://en.wikipedia.org/wiki/handheld_game_console")[0]);
    });
    (0, _qunit.test)("works with http", function (assert) {
      assert.ok(this.linkLookup.check(this.post, "http://en.wikipedia.org/wiki/handheld_game_console")[0]);
    });
    (0, _qunit.test)("works with trailing slash", function (assert) {
      assert.ok(this.linkLookup.check(this.post, "https://en.wikipedia.org/wiki/handheld_game_console/")[0]);
    });
    (0, _qunit.test)("works with uppercase characters", function (assert) {
      assert.ok(this.linkLookup.check(this.post, "https://en.wikipedia.org/wiki/Handheld_game_console")[0]);
    });
  });
});
define("discourse/tests/unit/lib/link-mentions-test", ["discourse/lib/link-mentions", "qunit", "discourse/tests/helpers/create-pretender", "discourse-common/lib/dom-from-string"], function (_linkMentions, _qunit, _createPretender, _domFromString) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/lib/link-mentions",0,"qunit",0,"discourse/tests/helpers/create-pretender",0,"discourse-common/lib/dom-from-string"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | link-mentions", function () {
    (0, _qunit.test)("linkSeenMentions replaces users and groups", async function (assert) {
      _createPretender.default.get("/u/is_local_username", () => (0, _createPretender.response)({
        valid: ["valid_user"],
        valid_groups: ["valid_group"],
        mentionable_groups: [{
          name: "mentionable_group",
          user_count: 1
        }],
        cannot_see: [],
        max_users_notified_per_group_mention: 100
      }));

      await (0, _linkMentions.fetchUnseenMentions)(["valid_user", "mentionable_group", "valid_group", "invalid"]);
      const root = (0, _domFromString.default)(`
      <div>
        <span class="mention">@invalid</span>
        <span class="mention">@valid_user</span>
        <span class="mention">@valid_group</span>
        <span class="mention">@mentionable_group</span>
      </div>
    `)[0];
      await (0, _linkMentions.linkSeenMentions)(root);
      assert.strictEqual(root.querySelector("a").innerText, "@valid_user");
      assert.strictEqual(root.querySelectorAll("a")[1].innerText, "@valid_group");
      assert.strictEqual(root.querySelector("a.notify").innerText, "@mentionable_group");
      assert.strictEqual(root.querySelector("span.mention").innerHTML, "@invalid");
    });
  });
});
define("discourse/tests/unit/lib/load-script-test", ["discourse/lib/load-script", "qunit", "discourse/lib/public-js-versions"], function (_loadScript, _qunit, _publicJsVersions) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/lib/load-script",0,"qunit",0,"discourse/lib/public-js-versions"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | load-script", function () {
    (0, _qunit.test)("works when a value is not present", function (assert) {
      assert.strictEqual((0, _loadScript.cacheBuster)("/javascripts/my-script.js"), "/javascripts/my-script.js");
      assert.strictEqual((0, _loadScript.cacheBuster)("/javascripts/my-project/script.js"), "/javascripts/my-project/script.js");
    });
    (0, _qunit.test)("generates URLs with version number in the query params", function (assert) {
      assert.strictEqual((0, _loadScript.cacheBuster)("/javascripts/pikaday.js"), `/javascripts/${_publicJsVersions.PUBLIC_JS_VERSIONS["pikaday.js"]}`);
      assert.strictEqual((0, _loadScript.cacheBuster)("/javascripts/ace/ace.js"), `/javascripts/${_publicJsVersions.PUBLIC_JS_VERSIONS["ace/ace.js"]}`);
    });
    (0, _qunit.test)("lookups are case-insensitive", assert => {
      assert.strictEqual((0, _loadScript.cacheBuster)("/javascripts/Chart.min.js"), `/javascripts/${_publicJsVersions.PUBLIC_JS_VERSIONS["chart.min.js"]}`);
      assert.strictEqual((0, _loadScript.cacheBuster)("/javascripts/chart.min.js"), `/javascripts/${_publicJsVersions.PUBLIC_JS_VERSIONS["chart.min.js"]}`);
    });
  });
});
define("discourse/tests/unit/lib/notification-types/bookmark-reminder-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "discourse/tests/fixtures/concerns/notification-types", "discourse-common/lib/object", "discourse/tests/helpers/notification-types-helper", "@ember/template", "discourse/models/notification", "I18n"], function (_qunitHelpers, _qunit, _notificationTypes, _object, _notificationTypesHelper, _template, _notification, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"discourse/tests/fixtures/concerns/notification-types",0,"discourse-common/lib/object",0,"discourse/tests/helpers/notification-types-helper",0,"@ember/template",0,"discourse/models/notification",0,"I18n"eaimeta@70e063a35619d71f

  function getNotification() {
    let overrides = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    return _notification.default.create((0, _object.deepMerge)({
      id: 11,
      user_id: 1,
      notification_type: _notificationTypes.NOTIFICATION_TYPES.bookmark_reminder,
      read: false,
      high_priority: true,
      created_at: "2022-07-01T06:00:32.173Z",
      post_number: 113,
      topic_id: 449,
      fancy_title: "This is fancy title &lt;a&gt;!",
      slug: "this-is-fancy-title",
      data: {
        title: "this is unsafe bookmark title <a>!",
        display_username: "osama",
        bookmark_name: null,
        bookmarkable_url: "/t/sometopic/3232"
      }
    }, overrides));
  }

  (0, _qunitHelpers.discourseModule)("Unit | Notification Types | bookmark-reminder", function () {
    (0, _qunit.test)("linkTitle", function (assert) {
      const notification = getNotification({
        data: {
          bookmark_name: "My awesome bookmark"
        }
      });
      const director = (0, _notificationTypesHelper.createRenderDirector)(notification, "bookmark_reminder", this.siteSettings);
      assert.strictEqual(director.linkTitle, _I18n.default.t("notifications.titles.bookmark_reminder_with_name", {
        name: "My awesome bookmark"
      }), "content includes the bookmark name when the bookmark has a name");
      delete notification.data.bookmark_name;
      assert.strictEqual(director.linkTitle, "bookmark reminder", "derived from the notification name when there's no bookmark name");
    });
    (0, _qunit.test)("description", function (assert) {
      const notification = getNotification({
        fancy_title: "my fancy title!",
        data: {
          topic_title: null,
          title: "custom bookmark title"
        }
      });
      const director = (0, _notificationTypesHelper.createRenderDirector)(notification, "bookmark_reminder", this.siteSettings);
      assert.deepEqual(director.description, (0, _template.htmlSafe)("my fancy title!"), "description is the fancy title by default");
      delete notification.fancy_title;
      assert.strictEqual(director.description, "custom bookmark title", "description falls back to the bookmark title if there's no fancy title");
    });
    (0, _qunit.test)("linkHref", function (assert) {
      let notification = getNotification();
      let director = (0, _notificationTypesHelper.createRenderDirector)(notification, "bookmark_reminder", this.siteSettings);
      assert.strictEqual(director.linkHref, "/t/this-is-fancy-title/449/113", "is a link to the topic that the bookmark belongs to");
      notification = getNotification({
        post_number: null,
        topic_id: null,
        fancy_title: null,
        slug: null,
        data: {
          title: "bookmark from some plugin",
          display_username: "osama",
          bookmark_name: "",
          bookmarkable_url: "/link/to/somewhere",
          bookmarkable_id: 4324
        }
      });
      director = (0, _notificationTypesHelper.createRenderDirector)(notification, "bookmark_reminder", this.siteSettings);
      assert.strictEqual(director.linkHref, "/link/to/somewhere", "falls back to bookmarkable_url");
    });
  });
});
define("discourse/tests/unit/lib/notification-types/granted-badge-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "discourse/tests/fixtures/concerns/notification-types", "discourse-common/lib/object", "discourse/tests/helpers/notification-types-helper", "discourse/models/notification", "I18n"], function (_qunitHelpers, _qunit, _notificationTypes, _object, _notificationTypesHelper, _notification, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"discourse/tests/fixtures/concerns/notification-types",0,"discourse-common/lib/object",0,"discourse/tests/helpers/notification-types-helper",0,"discourse/models/notification",0,"I18n"eaimeta@70e063a35619d71f

  function getNotification() {
    let overrides = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    return _notification.default.create((0, _object.deepMerge)({
      id: 11,
      user_id: 1,
      notification_type: _notificationTypes.NOTIFICATION_TYPES.granted_badge,
      read: false,
      high_priority: false,
      created_at: "2022-07-01T06:00:32.173Z",
      data: {
        badge_id: 44,
        badge_slug: "badge-15-slug",
        badge_name: "Badge 15",
        username: "gg.player"
      }
    }, overrides));
  }

  (0, _qunitHelpers.discourseModule)("Unit | Notification Types | granted-badge", function () {
    (0, _qunit.test)("linkHref", function (assert) {
      const notification = getNotification();
      const director = (0, _notificationTypesHelper.createRenderDirector)(notification, "granted_badge", this.siteSettings);
      assert.strictEqual(director.linkHref, "/badges/44/badge-15-slug?username=gg.player", "links to the badge page and filters by the username");
    });
    (0, _qunit.test)("description", async function (assert) {
      const notification = getNotification();
      const director = (0, _notificationTypesHelper.createRenderDirector)(notification, "granted_badge", this.siteSettings);
      assert.strictEqual(director.description, _I18n.default.t("notifications.granted_badge", {
        description: "Badge 15"
      }), "contains the right content");
    });
  });
});
define("discourse/tests/unit/lib/notification-types/group-mentioned-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "discourse/tests/fixtures/concerns/notification-types", "discourse-common/lib/object", "discourse/tests/helpers/notification-types-helper", "discourse/models/notification"], function (_qunitHelpers, _qunit, _notificationTypes, _object, _notificationTypesHelper, _notification) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"discourse/tests/fixtures/concerns/notification-types",0,"discourse-common/lib/object",0,"discourse/tests/helpers/notification-types-helper",0,"discourse/models/notification"eaimeta@70e063a35619d71f

  function getNotification() {
    let overrides = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    return _notification.default.create((0, _object.deepMerge)({
      id: 11,
      user_id: 1,
      notification_type: _notificationTypes.NOTIFICATION_TYPES.group_mentioned,
      read: false,
      high_priority: false,
      created_at: "2022-07-01T06:00:32.173Z",
      post_number: 113,
      topic_id: 449,
      fancy_title: "This is fancy title &lt;a&gt;!",
      slug: "this-is-fancy-title",
      data: {
        topic_title: "this is title before it becomes fancy <a>!",
        original_post_id: 112,
        original_post_type: 1,
        original_username: "kolary",
        display_username: "osama",
        group_id: 333,
        group_name: "hikers"
      }
    }, overrides));
  }

  (0, _qunitHelpers.discourseModule)("Unit | Notification Types | group-mentioned", function () {
    (0, _qunit.test)("label", function (assert) {
      const notification = getNotification();
      const director = (0, _notificationTypesHelper.createRenderDirector)(notification, "group_mentioned", this.siteSettings);
      assert.strictEqual(director.label, "osama @hikers", "contains the user who mentioned and the mentioned group");
    });
  });
});
define("discourse/tests/unit/lib/notification-types/group-message-summary-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "discourse/tests/fixtures/concerns/notification-types", "discourse-common/lib/object", "discourse/tests/helpers/notification-types-helper", "discourse/models/notification", "I18n"], function (_qunitHelpers, _qunit, _notificationTypes, _object, _notificationTypesHelper, _notification, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"discourse/tests/fixtures/concerns/notification-types",0,"discourse-common/lib/object",0,"discourse/tests/helpers/notification-types-helper",0,"discourse/models/notification",0,"I18n"eaimeta@70e063a35619d71f

  function getNotification() {
    let overrides = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    return _notification.default.create((0, _object.deepMerge)({
      id: 11,
      user_id: 1,
      notification_type: _notificationTypes.NOTIFICATION_TYPES.group_message_summary,
      read: false,
      high_priority: false,
      created_at: "2022-07-01T06:00:32.173Z",
      data: {
        group_id: 321,
        group_name: "drummers",
        inbox_count: 13,
        username: "drummers.boss"
      }
    }, overrides));
  }

  (0, _qunitHelpers.discourseModule)("Unit | Notification Types | group-message-summary", function () {
    (0, _qunit.test)("description", function (assert) {
      const notification = getNotification();
      const director = (0, _notificationTypesHelper.createRenderDirector)(notification, "group_message_summary", this.siteSettings);
      assert.strictEqual(director.description, _I18n.default.t("notifications.group_message_summary", {
        group_name: "drummers",
        count: 13
      }), "displays the right content");
    });
    (0, _qunit.test)("linkHref", function (assert) {
      const notification = getNotification();
      const director = (0, _notificationTypesHelper.createRenderDirector)(notification, "group_message_summary", this.siteSettings);
      assert.strictEqual(director.linkHref, "/u/drummers.boss/messages/group/drummers", "links to the group inbox in the user profile");
    });
  });
});
define("discourse/tests/unit/lib/notification-types/liked-consolidated-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "discourse/tests/fixtures/concerns/notification-types", "discourse-common/lib/object", "discourse/tests/helpers/notification-types-helper", "discourse/models/notification", "I18n"], function (_qunitHelpers, _qunit, _notificationTypes, _object, _notificationTypesHelper, _notification, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"discourse/tests/fixtures/concerns/notification-types",0,"discourse-common/lib/object",0,"discourse/tests/helpers/notification-types-helper",0,"discourse/models/notification",0,"I18n"eaimeta@70e063a35619d71f

  function getNotification() {
    let overrides = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    return _notification.default.create((0, _object.deepMerge)({
      id: 11,
      user_id: 1,
      notification_type: _notificationTypes.NOTIFICATION_TYPES.liked_consolidated,
      read: false,
      high_priority: false,
      created_at: "2022-07-01T06:00:32.173Z",
      data: {
        topic_title: "this is some topic and it's irrelevant",
        original_post_id: 3294,
        original_post_type: 1,
        original_username: "liker439",
        display_username: "liker439",
        username: "liker439",
        count: 44
      }
    }, overrides));
  }

  (0, _qunitHelpers.discourseModule)("Unit | Notification Types | liked-consolidated", function () {
    (0, _qunit.test)("linkHref", function (assert) {
      const notification = getNotification();
      const director = (0, _notificationTypesHelper.createRenderDirector)(notification, "liked_consolidated", this.siteSettings);
      assert.strictEqual(director.linkHref, "/u/eviltrout/notifications/likes-received?acting_username=liker439", "links to the likes received page of the user");
    });
    (0, _qunit.test)("description", function (assert) {
      const notification = getNotification();
      const director = (0, _notificationTypesHelper.createRenderDirector)(notification, "liked_consolidated", this.siteSettings);
      assert.strictEqual(director.description, _I18n.default.t("notifications.liked_consolidated_description", {
        count: 44
      }), "displays the right content");
    });
  });
});
define("discourse/tests/unit/lib/notification-types/liked-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "discourse/tests/fixtures/concerns/notification-types", "discourse-common/lib/object", "discourse/tests/helpers/notification-types-helper", "discourse/models/notification", "I18n"], function (_qunitHelpers, _qunit, _notificationTypes, _object, _notificationTypesHelper, _notification, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"discourse/tests/fixtures/concerns/notification-types",0,"discourse-common/lib/object",0,"discourse/tests/helpers/notification-types-helper",0,"discourse/models/notification",0,"I18n"eaimeta@70e063a35619d71f

  function getNotification() {
    let overrides = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    return _notification.default.create((0, _object.deepMerge)({
      id: 11,
      user_id: 1,
      notification_type: _notificationTypes.NOTIFICATION_TYPES.liked,
      read: false,
      high_priority: false,
      created_at: "2022-07-01T06:00:32.173Z",
      post_number: 113,
      topic_id: 449,
      fancy_title: "This is fancy title &lt;a&gt;!",
      slug: "this-is-fancy-title",
      data: {
        topic_title: "this is title before it becomes fancy <a>!",
        username: "osama",
        display_username: "osama",
        username2: "shrek",
        count: 2
      }
    }, overrides));
  }

  (0, _qunitHelpers.discourseModule)("Unit | Notification Types | liked", function () {
    (0, _qunit.test)("label", function (assert) {
      const notification = getNotification();
      const director = (0, _notificationTypesHelper.createRenderDirector)(notification, "liked", this.siteSettings);
      notification.data.count = 2;
      assert.strictEqual(director.label, _I18n.default.t("notifications.liked_by_2_users", {
        username: "osama",
        username2: "shrek"
      }), "concatenates both usernames with comma when count is 2");
      notification.data.count = 3;
      assert.strictEqual(director.label, _I18n.default.t("notifications.liked_by_multiple_users", {
        username: "osama",
        username2: "shrek",
        count: 1
      }), "concatenates 2 usernames with comma and displays the remaining count when count larger than 2");
      notification.data.count = 1;
      delete notification.data.username2;
      assert.strictEqual(director.label, "osama", "displays the liker's username when the count is 1");
    });
  });
});
define("discourse/tests/unit/lib/oneboxer-test", ["pretty-text/oneboxer-cache", "qunit", "discourse/lib/ajax", "pretty-text/oneboxer"], function (_oneboxerCache, _qunit, _ajax, _oneboxer) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"pretty-text/oneboxer-cache",0,"qunit",0,"discourse/lib/ajax",0,"pretty-text/oneboxer"eaimeta@70e063a35619d71f

  function loadOnebox(element) {
    return (0, _oneboxer.load)({
      elem: element,
      refresh: false,
      ajax: _ajax.ajax,
      synchronous: true,
      categoryId: 1,
      topicId: 1
    });
  }

  (0, _qunit.module)("Unit | Utility | oneboxer", function () {
    (0, _qunit.test)("load - failed onebox", async function (assert) {
      let element = document.createElement("A");
      element.setAttribute("href", "http://somebadurl.com");
      await loadOnebox(element);
      assert.strictEqual(_oneboxerCache.failedCache["http://somebadurl.com"], true, "stores the url as failed in a cache");
      assert.strictEqual(loadOnebox(element), undefined, "it returns early for a failed cache");
    });
    (0, _qunit.test)("load - successful onebox", async function (assert) {
      let element = document.createElement("A");
      element.setAttribute("href", "http://somegoodurl.com");
      await loadOnebox(element);
      assert.ok(_oneboxerCache.localCache["http://somegoodurl.com"].outerHTML.includes("Yet another collaboration tool"), "stores the html of the onebox in a local cache");
      assert.ok(loadOnebox(element).includes("Yet another collaboration tool"), "it returns the html from the cache");
    });
  });
});
define("discourse/tests/unit/lib/parse-bbcode-tag-test", ["qunit", "pretty-text/engines/discourse-markdown/bbcode-block"], function (_qunit, _bbcodeBlock) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"pretty-text/engines/discourse-markdown/bbcode-block"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | parseBBCodeTag", function () {
    (0, _qunit.test)("block with multiple quoted attributes", function (assert) {
      const parsed = (0, _bbcodeBlock.parseBBCodeTag)('[test one="foo" two="bar bar"]', 0, 30);
      assert.strictEqual(parsed.tag, "test");
      assert.strictEqual(parsed.attrs.one, "foo");
      assert.strictEqual(parsed.attrs.two, "bar bar");
    });
  });
});
define("discourse/tests/unit/lib/preload-store-test", ["qunit", "discourse/lib/preload-store", "rsvp"], function (_qunit, _preloadStore, _rsvp) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/lib/preload-store",0,"rsvp"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | preload-store", function (hooks) {
    hooks.beforeEach(function () {
      _preloadStore.default.store("bane", "evil");
    });
    (0, _qunit.test)("get", function (assert) {
      assert.blank(_preloadStore.default.get("joker"), "returns blank for a missing key");
      assert.strictEqual(_preloadStore.default.get("bane"), "evil", "returns the value for that key");
    });
    (0, _qunit.test)("remove", function (assert) {
      _preloadStore.default.remove("bane");

      assert.blank(_preloadStore.default.get("bane"), "removes the value if the key exists");
    });
    (0, _qunit.test)("getAndRemove returns a promise that resolves to null", async function (assert) {
      assert.blank(await _preloadStore.default.getAndRemove("joker"));
    });
    (0, _qunit.test)("getAndRemove returns a promise that resolves to the result of the finder", async function (assert) {
      const finder = () => "batdance";

      const result = await _preloadStore.default.getAndRemove("joker", finder);
      assert.strictEqual(result, "batdance");
    });
    (0, _qunit.test)("getAndRemove returns a promise that resolves to the result of the finder's promise", async function (assert) {
      const finder = async () => "hahahah";

      const result = await _preloadStore.default.getAndRemove("joker", finder);
      assert.strictEqual(result, "hahahah");
    });
    (0, _qunit.test)("returns a promise that rejects with the result of the finder's rejected promise", async function (assert) {
      const finder = () => _rsvp.Promise.reject("error");

      await _preloadStore.default.getAndRemove("joker", finder).catch(result => {
        assert.strictEqual(result, "error");
      });
    });
    (0, _qunit.test)("returns a promise that resolves to 'evil'", async function (assert) {
      const result = await _preloadStore.default.getAndRemove("bane");
      assert.strictEqual(result, "evil");
    });
    (0, _qunit.test)("returns falsy values without calling finder", async function (assert) {
      _preloadStore.default.store("falsy", false);

      const result = await _preloadStore.default.getAndRemove("falsy", () => assert.ok(false));
      assert.strictEqual(result, false);
    });
  });
});
define("discourse/tests/unit/lib/pretty-text-test", ["pretty-text/pretty-text", "pretty-text/inline-oneboxer", "qunit", "discourse/models/post", "discourse/lib/quote", "discourse-common/lib/object", "pretty-text/engines/discourse-markdown-it", "pretty-text/emoji", "pretty-text/emoji/version"], function (_prettyText, _inlineOneboxer, _qunit, _post, _quote, _object, _discourseMarkdownIt, _emoji, _version) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"pretty-text/pretty-text",0,"pretty-text/inline-oneboxer",0,"qunit",0,"discourse/models/post",0,"discourse/lib/quote",0,"discourse-common/lib/object",0,"pretty-text/engines/discourse-markdown-it",0,"pretty-text/emoji",0,"pretty-text/emoji/version"eaimeta@70e063a35619d71f

  const rawOpts = {
    siteSettings: {
      enable_emoji: true,
      enable_emoji_shortcuts: true,
      enable_mentions: true,
      emoji_set: "google_classic",
      external_emoji_url: "",
      highlighted_languages: "json|ruby|javascript",
      default_code_lang: "auto",
      enable_markdown_linkify: true,
      markdown_linkify_tlds: "com",
      display_name_on_posts: false,
      prioritize_username_in_ux: true
    },
    getURL: url => url
  };
  const defaultOpts = (0, _prettyText.buildOptions)(rawOpts);

  _qunit.default.assert.cooked = function (input, expected, message) {
    const actual = new _prettyText.default(defaultOpts).cook(input);
    this.pushResult({
      result: actual === expected.replace(/\/>/g, ">"),
      actual,
      expected,
      message
    });
  };

  _qunit.default.assert.cookedOptions = function (input, opts, expected, message) {
    const merged = (0, _object.deepMerge)({}, rawOpts, opts);
    const actual = new _prettyText.default((0, _prettyText.buildOptions)(merged)).cook(input);
    this.pushResult({
      result: actual === expected,
      actual,
      expected,
      message
    });
  };

  _qunit.default.assert.cookedPara = function (input, expected, message) {
    _qunit.default.assert.cooked(input, `<p>${expected}</p>`, message);
  };

  (0, _qunit.module)("Unit | Utility | pretty-text", function () {
    (0, _qunit.test)("buildOptions", function (assert) {
      assert.ok((0, _prettyText.buildOptions)({
        siteSettings: {
          enable_emoji: true
        }
      }).discourse.features.emoji, "emoji enabled");
      assert.ok(!(0, _prettyText.buildOptions)({
        siteSettings: {
          enable_emoji: false
        }
      }).discourse.features.emoji, "emoji disabled");
    });
    (0, _qunit.test)("basic cooking", function (assert) {
      assert.cooked("hello", "<p>hello</p>", "surrounds text with paragraphs");
      assert.cooked("**evil**", "<p><strong>evil</strong></p>", "it bolds text.");
      assert.cooked("__bold__", "<p><strong>bold</strong></p>", "it bolds text.");
      assert.cooked("*trout*", "<p><em>trout</em></p>", "it italicizes text.");
      assert.cooked("_trout_", "<p><em>trout</em></p>", "it italicizes text.");
      assert.cooked("***hello***", "<p><em><strong>hello</strong></em></p>", "it can do bold and italics at once.");
      assert.cooked("word_with_underscores", "<p>word_with_underscores</p>", "it doesn't do intraword italics");
      assert.cooked("common/_special_font_face.html.erb", "<p>common/_special_font_face.html.erb</p>", "it doesn't intraword with a slash");
      assert.cooked("hello \\*evil\\*", "<p>hello *evil*</p>", "it supports escaping of asterisks");
      assert.cooked("hello \\_evil\\_", "<p>hello _evil_</p>", "it supports escaping of italics");
      assert.cooked("brussels sprouts are *awful*.", "<p>brussels sprouts are <em>awful</em>.</p>", "it doesn't swallow periods.");
    });
    (0, _qunit.test)("Nested bold and italics", function (assert) {
      assert.cooked("*this is italic **with some bold** inside*", "<p><em>this is italic <strong>with some bold</strong> inside</em></p>", "it handles nested bold in italics");
    });
    (0, _qunit.test)("Traditional Line Breaks", function (assert) {
      const input = "1\n2\n3";
      assert.cooked(input, "<p>1<br>\n2<br>\n3</p>", "automatically handles trivial newlines");
      assert.cookedOptions(input, {
        siteSettings: {
          traditional_markdown_linebreaks: true
        }
      }, "<p>1\n2\n3</p>");
    });
    (0, _qunit.test)("Unbalanced underscores", function (assert) {
      assert.cooked("[evil_trout][1] hello_\n\n[1]: http://eviltrout.com", '<p><a href="http://eviltrout.com">evil_trout</a> hello_</p>');
    });
    (0, _qunit.test)("Line Breaks", function (assert) {
      assert.cooked("[] first choice\n[] second choice", "<p>[] first choice<br>\n[] second choice</p>", "it handles new lines correctly with [] options"); // note this is a change from previous engine but is correct
      // we have an html block and behavior is defined per common mark
      // spec
      // ole engine would wrap trout in a <p>

      assert.cooked("<blockquote>evil</blockquote>\ntrout", "<blockquote>evil</blockquote>\ntrout", "it doesn't insert <br> after blockquotes");
      assert.cooked("leading<blockquote>evil</blockquote>\ntrout", "<p>leading<blockquote>evil</blockquote><br>\ntrout</p>", "it doesn't insert <br> after blockquotes with leading text");
    });
    (0, _qunit.test)("Paragraphs for HTML", function (assert) {
      assert.cooked("<div>hello world</div>", "<div>hello world</div>", "it doesn't surround <div> with paragraphs");
      assert.cooked("<p>hello world</p>", "<p>hello world</p>", "it doesn't surround <p> with paragraphs");
      assert.cooked("<i>hello world</i>", "<p><i>hello world</i></p>", "it surrounds inline <i> html tags with paragraphs");
      assert.cooked("<b>hello world</b>", "<p><b>hello world</b></p>", "it surrounds inline <b> html tags with paragraphs");
    });
    (0, _qunit.test)("Links", function (assert) {
      assert.cooked("EvilTrout: http://eviltrout.com", '<p>EvilTrout: <a href="http://eviltrout.com">http://eviltrout.com</a></p>', "autolinks a URL");
      const link = "http://www.youtube.com/watch?v=1MrpeBRkM5A";
      assert.cooked(`Youtube: ${link}`, `<p>Youtube: <a href="${link}" class="inline-onebox-loading">${link}</a></p>`, "allows links to contain query params");

      try {
        (0, _inlineOneboxer.applyCachedInlineOnebox)(link, {});
        assert.cooked(`Youtube: ${link}`, `<p>Youtube: <a href="${link}">${link}</a></p>`);
      } finally {
        (0, _inlineOneboxer.deleteCachedInlineOnebox)(link);
      }

      assert.cooked("Derpy: http://derp.com?__test=1", `<p>Derpy: <a href="http://derp.com?__test=1" class="inline-onebox-loading">http://derp.com?__test=1</a></p>`, "works with double underscores in urls");
      assert.cooked("Atwood: www.codinghorror.com", '<p>Atwood: <a href="http://www.codinghorror.com">www.codinghorror.com</a></p>', "autolinks something that begins with www");
      assert.cooked("Atwood: http://www.codinghorror.com", '<p>Atwood: <a href="http://www.codinghorror.com">http://www.codinghorror.com</a></p>', "autolinks a URL with http://www");
      assert.cooked("EvilTrout: http://eviltrout.com hello", '<p>EvilTrout: <a href="http://eviltrout.com">http://eviltrout.com</a> hello</p>', "autolinks with trailing text");
      assert.cooked("here is [an example](http://twitter.com)", '<p>here is <a href="http://twitter.com">an example</a></p>', "supports markdown style links");
      assert.cooked("Batman: http://en.wikipedia.org/wiki/The_Dark_Knight_(film)", `<p>Batman: <a href="http://en.wikipedia.org/wiki/The_Dark_Knight_(film)" class="inline-onebox-loading">http://en.wikipedia.org/wiki/The_Dark_Knight_(film)</a></p>`, "autolinks a URL with parentheses (like Wikipedia)");
      assert.cooked("Here's a tweet:\nhttps://twitter.com/evil_trout/status/345954894420787200", '<p>Here\'s a tweet:<br>\n<a href="https://twitter.com/evil_trout/status/345954894420787200" class="onebox" target="_blank">https://twitter.com/evil_trout/status/345954894420787200</a></p>', "It doesn't strip the new line.");
      assert.cooked("1. View @eviltrout's profile here: http://meta.discourse.org/u/eviltrout/activity<br/>next line.", `<ol>\n<li>View <span class="mention">@eviltrout</span>\'s profile here: <a href="http://meta.discourse.org/u/eviltrout/activity" class="inline-onebox-loading">http://meta.discourse.org/u/eviltrout/activity</a><br>next line.</li>\n</ol>`, "allows autolinking within a list without inserting a paragraph.");
      assert.cooked("[3]: http://eviltrout.com", "", "It doesn't autolink markdown link references");
      assert.cooked("[]: http://eviltrout.com", '<p>[]: <a href="http://eviltrout.com">http://eviltrout.com</a></p>', "It doesn't accept empty link references");
      assert.cooked("[b]label[/b]: description", '<p><span class="bbcode-b">label</span>: description</p>', "It doesn't accept BBCode as link references");
      assert.cooked("http://discourse.org and http://discourse.org/another_url and http://www.imdb.com/name/nm2225369", '<p><a href="http://discourse.org">http://discourse.org</a> and ' + `<a href="http://discourse.org/another_url" class="inline-onebox-loading">http://discourse.org/another_url</a> and ` + `<a href="http://www.imdb.com/name/nm2225369" class="inline-onebox-loading">http://www.imdb.com/name/nm2225369</a></p>`, "allows multiple links on one line");
      assert.cooked("* [Evil Trout][1]\n\n[1]: http://eviltrout.com", '<ul>\n<li><a href="http://eviltrout.com">Evil Trout</a></li>\n</ul>', "allows markdown link references in a list");
      assert.cooked("User [MOD]: Hello!", "<p>User [MOD]: Hello!</p>", "It does not consider references that are obviously not URLs");
      assert.cooked("<small>http://eviltrout.com</small>", '<p><small><a href="http://eviltrout.com">http://eviltrout.com</a></small></p>', "Links within HTML tags");
      assert.cooked("[http://google.com ... wat](http://discourse.org)", '<p><a href="http://discourse.org">http://google.com ... wat</a></p>', "it supports links within links");
      assert.cooked("[http://google.com](http://discourse.org)", '<p><a href="http://discourse.org">http://google.com</a></p>', "it supports markdown links where the name and link match");
      assert.cooked('[Link](http://www.example.com) (with an outer "description")', '<p><a href="http://www.example.com">Link</a> (with an outer &quot;description&quot;)</p>', "it doesn't consume closing parens as part of the url");
      assert.cooked("A link inside parentheses (http://www.example.com)", '<p>A link inside parentheses (<a href="http://www.example.com">http://www.example.com</a>)</p>', "it auto-links a url within parentheses");
      assert.cooked("[ul][1]\n\n[1]: http://eviltrout.com", '<p><a href="http://eviltrout.com">ul</a></p>', "it can use `ul` as a link name");
    });
    (0, _qunit.test)("simple quotes", function (assert) {
      assert.cooked("> nice!", "<blockquote>\n<p>nice!</p>\n</blockquote>", "it supports simple quotes");
      assert.cooked(" > nice!", "<blockquote>\n<p>nice!</p>\n</blockquote>", "it allows quotes with preceding spaces");
      assert.cooked("> level 1\n> > level 2", "<blockquote>\n<p>level 1</p>\n<blockquote>\n<p>level 2</p>\n</blockquote>\n</blockquote>", "it allows nesting of blockquotes");
      assert.cooked("> level 1\n>  > level 2", "<blockquote>\n<p>level 1</p>\n<blockquote>\n<p>level 2</p>\n</blockquote>\n</blockquote>", "it allows nesting of blockquotes with spaces");
      assert.cooked("- hello\n\n  > world\n  > eviltrout", `<ul>
<li>
<p>hello</p>
<blockquote>
<p>world<br>
eviltrout</p>
</blockquote>
</li>
</ul>`, "it allows quotes within a list.");
      assert.cooked("- <p>eviltrout</p>", "<ul>\n<li>\n<p>eviltrout</p></li>\n</ul>", "it allows paragraphs within a list.");
      assert.cooked("  > indent 1\n  > indent 2", "<blockquote>\n<p>indent 1<br>\nindent 2</p>\n</blockquote>", "allow multiple spaces to indent");
    });
    (0, _qunit.test)("Quotes", function (assert) {
      assert.cookedOptions('[quote="eviltrout, post: 1"]\na quote\n\nsecond line\n\nthird line\n[/quote]', {
        topicId: 2
      }, `<aside class=\"quote no-group\" data-username=\"eviltrout\" data-post=\"1\">
<div class=\"title\">
<div class=\"quote-controls\"></div>
 eviltrout:</div>
<blockquote>
<p>a quote</p>
<p>second line</p>
<p>third line</p>
</blockquote>
</aside>`, "works with multiple lines");
      assert.cookedOptions('[quote="bob, post:1"]\nmy quote\n[/quote]', {
        topicId: 2,
        lookupAvatar: function () {}
      }, `<aside class=\"quote no-group\" data-username=\"bob\" data-post=\"1\">
<div class=\"title\">
<div class=\"quote-controls\"></div>
 bob:</div>
<blockquote>
<p>my quote</p>
</blockquote>
</aside>`, "includes no avatar if none is found");
      assert.cooked(`[quote]\na\n\n[quote]\nb\n[/quote]\n[/quote]`, `<aside class=\"quote no-group\">
<blockquote>
<p>a</p>
<aside class=\"quote no-group\">
<blockquote>
<p>b</p>
</blockquote>
</aside>
</blockquote>
</aside>`, "handles nested quotes properly");
      assert.cookedOptions(`[quote="bob, post:1, topic:1"]\ntest quote\n[/quote]`, {
        lookupPrimaryUserGroupByPostNumber: () => "aUserGroup"
      }, `<aside class="quote group-aUserGroup" data-username="bob" data-post="1" data-topic="1">
<div class="title">
<div class="quote-controls"></div>
 bob:</div>
<blockquote>
<p>test quote</p>
</blockquote>
</aside>`, "quote has group class");
    });
    (0, _qunit.test)("Mentions", function (assert) {
      assert.cooked("Hello @sam", '<p>Hello <span class="mention">@sam</span></p>', "translates mentions to links");
      assert.cooked("[@codinghorror](https://twitter.com/codinghorror)", '<p><a href="https://twitter.com/codinghorror">@codinghorror</a></p>', "it doesn't do mentions within links");
      assert.cooked("[@codinghorror](https://twitter.com/codinghorror)", '<p><a href="https://twitter.com/codinghorror">@codinghorror</a></p>', "it doesn't do link mentions within links");
      assert.cooked("Hello @EvilTrout", '<p>Hello <span class="mention">@EvilTrout</span></p>', "adds a mention class");
      assert.cooked("robin@email.host", "<p>robin@email.host</p>", "won't add mention class to an email address");
      assert.cooked("hanzo55@yahoo.com", '<p><a href="mailto:hanzo55@yahoo.com">hanzo55@yahoo.com</a></p>', "won't be affected by email addresses that have a number before the @ symbol");
      assert.cooked("@EvilTrout yo", '<p><span class="mention">@EvilTrout</span> yo</p>', "it handles mentions at the beginning of a string");
      assert.cooked("yo\n@EvilTrout", '<p>yo<br>\n<span class="mention">@EvilTrout</span></p>', "it handles mentions at the beginning of a new line");
      assert.cooked("`evil` @EvilTrout `trout`", '<p><code>evil</code> <span class="mention">@EvilTrout</span> <code>trout</code></p>', "deals correctly with multiple <code> blocks");
      assert.cooked("```\na @test\n```", '<pre><code class="lang-auto">a @test\n</code></pre>', "should not do mentions within a code block.");
      assert.cooked("> foo bar baz @eviltrout", '<blockquote>\n<p>foo bar baz <span class="mention">@eviltrout</span></p>\n</blockquote>', "handles mentions in simple quotes");
      assert.cooked("> foo bar baz @eviltrout ohmagerd\nlook at this", '<blockquote>\n<p>foo bar baz <span class="mention">@eviltrout</span> ohmagerd<br>\nlook at this</p>\n</blockquote>', "does mentions properly with trailing text within a simple quote");
      assert.cooked("`code` is okay before @mention", '<p><code>code</code> is okay before <span class="mention">@mention</span></p>', "Does not mention in an inline code block");
      assert.cooked("@mention is okay before `code`", '<p><span class="mention">@mention</span> is okay before <code>code</code></p>', "Does not mention in an inline code block");
      assert.cooked("don't `@mention`", "<p>don't <code>@mention</code></p>", "Does not mention in an inline code block");
      assert.cooked("Yes `@this` should be code @eviltrout", '<p>Yes <code>@this</code> should be code <span class="mention">@eviltrout</span></p>', "Does not mention in an inline code block");
      assert.cooked("@eviltrout and `@eviltrout`", '<p><span class="mention">@eviltrout</span> and <code>@eviltrout</code></p>', "you can have a mention in an inline code block following a real mention.");
      assert.cooked("1. this is  a list\n\n2. this is an @eviltrout mention\n", '<ol>\n<li>\n<p>this is  a list</p>\n</li>\n<li>\n<p>this is an <span class="mention">@eviltrout</span> mention</p>\n</li>\n</ol>', "it mentions properly in a list.");
      assert.cooked("Hello @foo/@bar", '<p>Hello <span class="mention">@foo</span>/<span class="mention">@bar</span></p>', "handles mentions separated by a slash.");
      assert.cooked("<small>a @sam c</small>", '<p><small>a <span class="mention">@sam</span> c</small></p>', "it allows mentions within HTML tags");
      assert.cooked("@_sam @1sam @ab-cd.123_ABC-xYz @sam1", '<p><span class="mention">@_sam</span> <span class="mention">@1sam</span> <span class="mention">@ab-cd.123_ABC-xYz</span> <span class="mention">@sam1</span></p>', "it detects mentions of valid usernames");
      assert.cooked("@.sam @-sam @sam. @sam_ @sam-", '<p>@.sam @-sam <span class="mention">@sam</span>. <span class="mention">@sam</span>_ <span class="mention">@sam</span>-</p>', "it does not detect mentions of invalid usernames");
      assert.cookedOptions("Hello @", {
        siteSettings: {
          unicode_usernames: false
        }
      }, "<p>Hello @</p>", "it does not detect mentions of Unicode usernames");
    });
    (0, _qunit.test)("Mentions - Unicode usernames enabled", function (assert) {
      assert.cookedOptions("Hello @", {
        siteSettings: {
          unicode_usernames: true
        }
      }, '<p>Hello <span class="mention">@</span></p>', "it detects mentions of Unicode usernames");
      assert.cookedOptions("@ @_ @1 @-._- @1", {
        siteSettings: {
          unicode_usernames: true
        }
      }, '<p><span class="mention">@</span> <span class="mention">@_</span> <span class="mention">@1</span> <span class="mention">@-._-</span> <span class="mention">@1</span></p>', "it detects mentions of valid Unicode usernames");
      assert.cookedOptions("@. @- @. @_ @-", {
        siteSettings: {
          unicode_usernames: true
        }
      }, '<p>@. @- <span class="mention">@</span>. <span class="mention">@</span>_ <span class="mention">@</span>-</p>', "it does not detect mentions of invalid Unicode usernames");
    });
    (0, _qunit.test)("Mentions - disabled", function (assert) {
      assert.cookedOptions("@eviltrout", {
        siteSettings: {
          enable_mentions: false
        }
      }, "<p>@eviltrout</p>");
    });
    (0, _qunit.test)("Category hashtags", function (assert) {
      const alwaysTrue = {
        categoryHashtagLookup: function () {
          return ["http://test.discourse.org/category-hashtag", "category-hashtag"];
        }
      };
      assert.cookedOptions("Check out #category-hashtag", alwaysTrue, '<p>Check out <a class="hashtag" href="http://test.discourse.org/category-hashtag">#<span>category-hashtag</span></a></p>', "it translates category hashtag into links");
      assert.cooked("Check out #category-hashtag", '<p>Check out <span class="hashtag">#category-hashtag</span></p>', "it does not translate category hashtag into links if it is not a valid category hashtag");
      assert.cookedOptions("[#category-hashtag](http://www.test.com)", alwaysTrue, '<p><a href="http://www.test.com">#category-hashtag</a></p>', "it does not translate category hashtag within links");
      assert.cooked("```\n# #category-hashtag\n```", '<pre><code class="lang-auto"># #category-hashtag\n</code></pre>', "it does not translate category hashtags to links in code blocks");
      assert.cooked("># #category-hashtag\n", '<blockquote>\n<h1><span class="hashtag">#category-hashtag</span></h1>\n</blockquote>', "it handles category hashtags in simple quotes");
      assert.cooked("# #category-hashtag", '<h1><a name="category-hashtag-1" class="anchor" href="#category-hashtag-1"></a><span class="hashtag">#category-hashtag</span></h1>', "it works within ATX-style headers");
      assert.cooked("don't `#category-hashtag`", "<p>don't <code>#category-hashtag</code></p>", "it does not mention in an inline code block");
      assert.cooked("<small>#category-hashtag</small>", '<p><small><span class="hashtag">#category-hashtag</span></small></p>', "it works between HTML tags");
      assert.cooked("Checkout #d", '<p>Checkout <span class="hashtag">#d</span></p>', "it works for non-english characters");
    });
    (0, _qunit.test)("Heading", function (assert) {
      assert.cooked("**Bold**\n----------", '<h2><a name="bold-1" class="anchor" href="#bold-1"></a><strong>Bold</strong></h2>', "It will bold the heading");
    });
    (0, _qunit.test)("Heading anchors are valid", function (assert) {
      assert.cooked("# One\n\n# 1\n\n# $$", '<h1><a name="one-1" class="anchor" href="#one-1"></a>One</h1>\n' + '<h1><a name="h-1-2" class="anchor" href="#h-1-2"></a>1</h1>\n' + '<h1><a name="h-3" class="anchor" href="#h-3"></a>$$</h1>', "It will bold the heading");
    });
    (0, _qunit.test)("bold and italics", function (assert) {
      assert.cooked('a "**hello**"', "<p>a &quot;<strong>hello</strong>&quot;</p>", "bolds in quotes");
      assert.cooked("(**hello**)", "<p>(<strong>hello</strong>)</p>", "bolds in parens");
      assert.cooked("**hello**\nworld", "<p><strong>hello</strong><br>\nworld</p>", "allows newline after bold");
      assert.cooked("**hello**\n**world**", "<p><strong>hello</strong><br>\n<strong>world</strong></p>", "newline between two bolds");
      assert.cooked("** hello**", "<p>** hello**</p>", "does not bold on a space boundary");
      assert.cooked("**hello **", "<p>**hello **</p>", "does not bold on a space boundary");
      assert.cooked("**hello**", "<p><strong>hello</strong></p>", "allows bolded chinese");
    });
    (0, _qunit.test)("Escaping", function (assert) {
      assert.cooked("*\\*laughs\\**", "<p><em>*laughs*</em></p>", "allows escaping strong");
      assert.cooked("*\\_laughs\\_*", "<p><em>_laughs_</em></p>", "allows escaping em");
    });
    (0, _qunit.test)("New Lines", function (assert) {
      // historically we would not continue inline em or b across lines,
      // however commonmark gives us no switch to do so and we would be very non compliant.
      // turning softbreaks into a newline is just a renderer option, not a parser switch.
      assert.cooked("_abc\ndef_", "<p><em>abc<br>\ndef</em></p>", "it does allow inlines to span new lines");
      assert.cooked("_abc\n\ndef_", "<p>_abc</p>\n<p>def_</p>", "it does not allow inlines to span new paragraphs");
    });
    (0, _qunit.test)("Oneboxing", function (assert) {
      function matches(input, regexp) {
        return new _prettyText.default(defaultOpts).cook(input).match(regexp);
      }

      assert.ok(!matches("- http://www.textfiles.com/bbs/MINDVOX/FORUMS/ethics\n\n- http://drupal.org", /class="onebox"/), "doesn't onebox a link within a list");
      assert.ok(matches("http://test.com", /class="onebox"/), "adds a onebox class to a link on its own line");
      assert.ok(matches("http://test.com\nhttp://test2.com", /onebox[\s\S]+onebox/m), "supports multiple links");
      assert.ok(!matches("http://test.com bob", /onebox/), "doesn't onebox links that have trailing text");
      assert.ok(!matches("[Tom Cruise](http://www.tomcruise.com/)", "onebox"), "Markdown links with labels are not oneboxed");
      assert.ok(!matches("[http://www.tomcruise.com/](http://www.tomcruise.com/)", "onebox"), "Markdown links where the label is the same as the url but link is explicit");
      assert.cooked("http://en.wikipedia.org/wiki/Homicide:_Life_on_the_Street", '<p><a href="http://en.wikipedia.org/wiki/Homicide:_Life_on_the_Street" class="onebox"' + ' target="_blank">http://en.wikipedia.org/wiki/Homicide:_Life_on_the_Street</a></p>', "works with links that have underscores in them");
    });
    (0, _qunit.test)("links with full urls", function (assert) {
      assert.cooked("[http://eviltrout.com][1] is a url\n\n[1]: http://eviltrout.com", '<p><a href="http://eviltrout.com">http://eviltrout.com</a> is a url</p>', "it supports links that are full URLs");
    });
    (0, _qunit.test)("Code Blocks", function (assert) {
      assert.cooked("<pre>\nhello\n</pre>\n", "<pre>\nhello\n</pre>", "pre blocks don't include extra lines");
      assert.cooked("```\na\nb\nc\n\nd\n```", '<pre><code class="lang-auto">a\nb\nc\n\nd\n</code></pre>', "it treats new lines properly");
      assert.cooked("```\ntest\n```", '<pre><code class="lang-auto">test\n</code></pre>', "it supports basic code blocks");
      assert.cooked("```json\n{hello: 'world'}\n```\ntrailing", "<pre><code class=\"lang-json\">{hello: 'world'}\n</code></pre>\n<p>trailing</p>", "It does not truncate text after a code block.");
      assert.cooked("```json\nline 1\n\nline 2\n\n\nline3\n```", '<pre><code class="lang-json">line 1\n\nline 2\n\n\nline3\n</code></pre>', "it maintains new lines inside a code block.");
      assert.cooked("hello\nworld\n```json\nline 1\n\nline 2\n\n\nline3\n```", '<p>hello<br>\nworld</p>\n<pre><code class="lang-json">line 1\n\nline 2\n\n\nline3\n</code></pre>', "it maintains new lines inside a code block with leading content.");
      assert.cooked("```ruby\n<header>hello</header>\n```", '<pre><code class="lang-ruby">&lt;header&gt;hello&lt;/header&gt;\n</code></pre>', "it escapes code in the code block");
      assert.cooked("```text\ntext\n```", '<pre><code class="lang-nohighlight">text\n</code></pre>', "handles text by adding nohighlight");
      assert.cooked("```ruby\n# cool\n```", '<pre><code class="lang-ruby"># cool\n</code></pre>', "it supports changing the language");
      assert.cooked("    ```\n    hello\n    ```", "<pre><code>```\nhello\n```\n</code></pre>", "only detect ``` at the beginning of lines");
      assert.cooked("```ruby\ndef self.parse(text)\n\n  text\nend\n```", '<pre><code class="lang-ruby">def self.parse(text)\n\n  text\nend\n</code></pre>', "it allows leading spaces on lines in a code block.");
      assert.cooked("```ruby\nhello `eviltrout`\n```", '<pre><code class="lang-ruby">hello `eviltrout`\n</code></pre>', "it allows code with backticks in it");
      assert.cooked("```eviltrout\nhello\n```", '<pre data-code-wrap="eviltrout"><code class="lang-nohighlight">hello\n</code></pre>', "it converts to custom block unknown code names");
      assert.cooked('```\n[quote="sam, post:1, topic:9441, full:true"]This is `<not>` a bug.[/quote]\n```', '<pre><code class="lang-auto">[quote=&quot;sam, post:1, topic:9441, full:true&quot;]This is `&lt;not&gt;` a bug.[/quote]\n</code></pre>', "it allows code with backticks in it");
      assert.cooked("    hello\n<blockquote>test</blockquote>", "<pre><code>hello\n</code></pre>\n<blockquote>test</blockquote>", "it allows an indented code block to by followed by a `<blockquote>`");
      assert.cooked("``` foo bar ```", "<p><code>foo bar</code></p>", "it tolerates misuse of code block tags as inline code");
      assert.cooked("```\nline1\n```\n```\nline2\n\nline3\n```", '<pre><code class="lang-auto">line1\n</code></pre>\n<pre><code class="lang-auto">line2\n\nline3\n</code></pre>', "it does not consume next block's trailing newlines");
      assert.cooked("    <pre>test</pre>", "<pre><code>&lt;pre&gt;test&lt;/pre&gt;\n</code></pre>", "it does not parse other block types in markdown code blocks");
      assert.cooked("    [quote]test[/quote]", "<pre><code>[quote]test[/quote]\n</code></pre>", "it does not parse other block types in markdown code blocks");
      assert.cooked("## a\nb\n```\nc\n```", '<h2><a name="a-1" class="anchor" href="#a-1"></a>a</h2>\n<p>b</p>\n<pre><code class="lang-auto">c\n</code></pre>', "it handles headings with code blocks after them.");
    });
    (0, _qunit.test)("URLs in BBCode tags", function (assert) {
      assert.cooked("[img]http://eviltrout.com/eviltrout.png[/img][img]http://samsaffron.com/samsaffron.png[/img]", '<p><img src="http://eviltrout.com/eviltrout.png" alt/><img src="http://samsaffron.com/samsaffron.png" alt/></p>', "images are properly parsed");
      assert.cooked("[url]http://discourse.org[/url]", '<p><a href="http://discourse.org" data-bbcode="true">http://discourse.org</a></p>', "links are properly parsed");
      assert.cooked("[url=http://discourse.org]discourse[/url]", '<p><a href="http://discourse.org" data-bbcode="true">discourse</a></p>', "named links are properly parsed");
    });
    (0, _qunit.test)("images", function (assert) {
      assert.cooked("[![folksy logo](http://folksy.com/images/folksy-colour.png)](http://folksy.com/)", '<p><a href="http://folksy.com/"><img src="http://folksy.com/images/folksy-colour.png" alt="folksy logo"/></a></p>', "It allows images with links around them");
      assert.cooked('<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==" alt="Red dot">', '<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==" alt="Red dot"></p>', "It allows data images");
    });
    (0, _qunit.test)("attachment", function (assert) {
      assert.cooked("[test.pdf|attachment](upload://o8iobpLcW3WSFvVH7YQmyGlKmGM.pdf)", `<p><a class="attachment" href="/404" data-orig-href="upload://o8iobpLcW3WSFvVH7YQmyGlKmGM.pdf">test.pdf</a></p>`, "It returns the correct attachment link HTML");
    });
    (0, _qunit.test)("attachment - mapped url - secure media disabled", function (assert) {
      function lookupUploadUrls() {
        let cache = {};
        cache["upload://o8iobpLcW3WSFvVH7YQmyGlKmGM.pdf"] = {
          short_url: "upload://o8iobpLcW3WSFvVH7YQmyGlKmGM.pdf",
          url: "/secure-media-uploads/original/3X/c/b/o8iobpLcW3WSFvVH7YQmyGlKmGM.pdf",
          short_path: "/uploads/short-url/blah"
        };
        return cache;
      }

      assert.cookedOptions("[test.pdf|attachment](upload://o8iobpLcW3WSFvVH7YQmyGlKmGM.pdf)", {
        siteSettings: {
          secure_media: false
        },
        lookupUploadUrls
      }, `<p><a class="attachment" href="/uploads/short-url/blah">test.pdf</a></p>`, "It returns the correct attachment link HTML when the URL is mapped without secure media");
    });
    (0, _qunit.test)("attachment - mapped url - secure media enabled", function (assert) {
      function lookupUploadUrls() {
        let cache = {};
        cache["upload://o8iobpLcW3WSFvVH7YQmyGlKmGM.pdf"] = {
          short_url: "upload://o8iobpLcW3WSFvVH7YQmyGlKmGM.pdf",
          url: "/secure-media-uploads/original/3X/c/b/o8iobpLcW3WSFvVH7YQmyGlKmGM.pdf",
          short_path: "/uploads/short-url/blah"
        };
        return cache;
      }

      assert.cookedOptions("[test.pdf|attachment](upload://o8iobpLcW3WSFvVH7YQmyGlKmGM.pdf)", {
        siteSettings: {
          secure_media: true
        },
        lookupUploadUrls
      }, `<p><a class="attachment" href="/secure-media-uploads/original/3X/c/b/o8iobpLcW3WSFvVH7YQmyGlKmGM.pdf">test.pdf</a></p>`, "It returns the correct attachment link HTML when the URL is mapped with secure media");
    });
    (0, _qunit.test)("video", function (assert) {
      assert.cooked("![baby shark|video](upload://eyPnj7UzkU0AkGkx2dx8G4YM1Jx.mp4)", `<p><div class="video-container">
    <video width="100%" height="100%" preload="metadata" controls>
      <source src="/404" data-orig-src="upload://eyPnj7UzkU0AkGkx2dx8G4YM1Jx.mp4">
      <a href="/404">/404</a>
    </video>
  </div></p>`, "It returns the correct video player HTML");
    });
    (0, _qunit.test)("video - mapped url - secure media enabled", function (assert) {
      function lookupUploadUrls() {
        let cache = {};
        cache["upload://eyPnj7UzkU0AkGkx2dx8G4YM1Jx.mp4"] = {
          short_url: "upload://eyPnj7UzkU0AkGkx2dx8G4YM1Jx.mp4",
          url: "/secure-media-uploads/original/3X/c/b/test.mp4",
          short_path: "/uploads/short-url/blah"
        };
        return cache;
      }

      assert.cookedOptions("![baby shark|video](upload://eyPnj7UzkU0AkGkx2dx8G4YM1Jx.mp4)", {
        siteSettings: {
          secure_media: true
        },
        lookupUploadUrls
      }, `<p><div class="video-container">
    <video width="100%" height="100%" preload="metadata" controls>
      <source src="/secure-media-uploads/original/3X/c/b/test.mp4">
      <a href="/secure-media-uploads/original/3X/c/b/test.mp4">/secure-media-uploads/original/3X/c/b/test.mp4</a>
    </video>
  </div></p>`, "It returns the correct video HTML when the URL is mapped with secure media, removing data-orig-src");
    });
    (0, _qunit.test)("audio", function (assert) {
      assert.cooked("![young americans|audio](upload://eyPnj7UzkU0AkGkx2dx8G4YM1Jx.mp3)", `<p><audio preload="metadata" controls>
    <source src="/404" data-orig-src="upload://eyPnj7UzkU0AkGkx2dx8G4YM1Jx.mp3">
    <a href="/404">/404</a>
  </audio></p>`, "It returns the correct audio player HTML");
    });
    (0, _qunit.test)("audio - mapped url - secure media enabled", function (assert) {
      function lookupUploadUrls() {
        let cache = {};
        cache["upload://eyPnj7UzkU0AkGkx2dx8G4YM1Jx.mp3"] = {
          short_url: "upload://eyPnj7UzkU0AkGkx2dx8G4YM1Jx.mp3",
          url: "/secure-media-uploads/original/3X/c/b/test.mp3",
          short_path: "/uploads/short-url/blah"
        };
        return cache;
      }

      assert.cookedOptions("![baby shark|audio](upload://eyPnj7UzkU0AkGkx2dx8G4YM1Jx.mp3)", {
        siteSettings: {
          secure_media: true
        },
        lookupUploadUrls
      }, `<p><audio preload="metadata" controls>
    <source src="/secure-media-uploads/original/3X/c/b/test.mp3">
    <a href="/secure-media-uploads/original/3X/c/b/test.mp3">/secure-media-uploads/original/3X/c/b/test.mp3</a>
  </audio></p>`, "It returns the correct audio HTML when the URL is mapped with secure media, removing data-orig-src");
    });
    (0, _qunit.test)("censoring", function (assert) {
      assert.cookedOptions("Pleased to meet you, but pleeeease call me later, xyz123", {
        censoredRegexp: [{
          "(xyz*|plee+ase)": {
            case_sensitive: false
          }
        }]
      }, "<p>Pleased to meet you, but  call me later, 123</p>", "supports censoring"); // More tests in pretty_text_spec.rb
    });
    (0, _qunit.test)("code blocks/spans hoisting", function (assert) {
      assert.cooked("```\n\n    some code\n```", '<pre><code class="lang-auto">\n    some code\n</code></pre>', "it works when nesting standard markdown code blocks within a fenced code block");
      assert.cooked("`$&`", "<p><code>$&amp;</code></p>", "it works even when hoisting special replacement patterns");
    });
    (0, _qunit.test)("basic bbcode", function (assert) {
      assert.cookedPara("[b]strong[/b]", '<span class="bbcode-b">strong</span>', "bolds text");
      assert.cookedPara("[i]emphasis[/i]", '<span class="bbcode-i">emphasis</span>', "italics text");
      assert.cookedPara("[u]underlined[/u]", '<span class="bbcode-u">underlined</span>', "underlines text");
      assert.cookedPara("[s]strikethrough[/s]", '<span class="bbcode-s">strikethrough</span>', "strikes-through text");
      assert.cookedPara("[img]http://eviltrout.com/eviltrout.png[/img]", '<img src="http://eviltrout.com/eviltrout.png" alt>', "links images");
      assert.cookedPara("[email]eviltrout@mailinator.com[/email]", '<a href="mailto:eviltrout@mailinator.com" data-bbcode="true">eviltrout@mailinator.com</a>', "supports [email] without a title");
      assert.cookedPara("[b]evil [i]trout[/i][/b]", '<span class="bbcode-b">evil <span class="bbcode-i">trout</span></span>', "allows embedding of tags");
      assert.cookedPara("[EMAIL]eviltrout@mailinator.com[/EMAIL]", '<a href="mailto:eviltrout@mailinator.com" data-bbcode="true">eviltrout@mailinator.com</a>', "supports upper case bbcode");
      assert.cookedPara("[b]strong [b]stronger[/b][/b]", '<span class="bbcode-b">strong <span class="bbcode-b">stronger</span></span>', "accepts nested bbcode tags");
    });
    (0, _qunit.test)("urls", function (assert) {
      assert.cookedPara("[url]not a url[/url]", "not a url", "supports [url] that isn't a url");
      assert.cookedPara("[url]abc.com[/url]", '<a href="http://abc.com">abc.com</a>', "it magically links using linkify");
      assert.cookedPara("[url]http://bettercallsaul.com[/url]", '<a href="http://bettercallsaul.com" data-bbcode="true">http://bettercallsaul.com</a>', "supports [url] without parameter");
      assert.cookedPara("[url=http://example.com]example[/url]", '<a href="http://example.com" data-bbcode="true">example</a>', "supports [url] with given href");
      assert.cookedPara("[url=http://www.example.com][img]http://example.com/logo.png[/img][/url]", '<a href="http://www.example.com" data-bbcode="true"><img src="http://example.com/logo.png" alt></a>', "supports [url] with an embedded [img]");
    });
    (0, _qunit.test)("invalid bbcode", function (assert) {
      assert.cooked("[code]I am not closed\n\nThis text exists.", "<p>[code]I am not closed</p>\n<p>This text exists.</p>", "does not raise an error with an open bbcode tag.");
    });
    (0, _qunit.test)("code", function (assert) {
      assert.cooked("[code]\nx++\n[/code]", '<pre><code class="lang-auto">x++</code></pre>', "makes code into pre");
      assert.cooked("[code]\nx++\ny++\nz++\n[/code]", '<pre><code class="lang-auto">x++\ny++\nz++</code></pre>', "makes code into pre");
      assert.cooked("[code]\nabc\n#def\n[/code]", '<pre><code class="lang-auto">abc\n#def</code></pre>', "it handles headings in a [code] block");
      assert.cooked("[code]\n   s\n[/code]", '<pre><code class="lang-auto">   s</code></pre>', "it doesn't trim leading whitespace");
    });
    (0, _qunit.test)("tags with arguments", function (assert) {
      assert.cookedPara("[url=http://bettercallsaul.com]better call![/url]", '<a href="http://bettercallsaul.com" data-bbcode="true">better call!</a>', "supports [url] with a title");
      assert.cookedPara("[email=eviltrout@mailinator.com]evil trout[/email]", '<a href="mailto:eviltrout@mailinator.com" data-bbcode="true">evil trout</a>', "supports [email] with a title");
      assert.cookedPara("[u][i]abc[/i][/u]", '<span class="bbcode-u"><span class="bbcode-i">abc</span></span>', "can nest tags");
      assert.cookedPara("[b]first[/b] [b]second[/b]", '<span class="bbcode-b">first</span> <span class="bbcode-b">second</span>', "can bold two things on the same line");
    });
    (0, _qunit.test)("quotes", function (assert) {
      const post = _post.default.create({
        cooked: "<p><b>lorem</b> ipsum</p>",
        username: "eviltrout",
        post_number: 1,
        topic_id: 2
      });

      function formatQuote(val, expected, text, opts) {
        assert.strictEqual((0, _quote.buildQuote)(post, val, opts), expected, text);
      }

      formatQuote(undefined, "", "empty string for undefined content");
      formatQuote(null, "", "empty string for null content");
      formatQuote("", "", "empty string for empty string content");
      formatQuote("lorem", '[quote="eviltrout, post:1, topic:2"]\nlorem\n[/quote]\n\n', "correctly formats quotes");
      formatQuote("  lorem \t  ", '[quote="eviltrout, post:1, topic:2"]\nlorem\n[/quote]\n\n', "trims white spaces before & after the quoted contents");
      formatQuote("lorem ipsum", '[quote="eviltrout, post:1, topic:2, full:true"]\nlorem ipsum\n[/quote]\n\n', "marks quotes as full if the `full` option is passed", {
        full: true
      });
      formatQuote("**lorem** ipsum", '[quote="eviltrout, post:1, topic:2"]\n**lorem** ipsum\n[/quote]\n\n', "keeps BBCode formatting");
      assert.cooked("[quote]\ntest\n[/quote]", '<aside class="quote no-group">\n<blockquote>\n<p>test</p>\n</blockquote>\n</aside>', "it supports quotes without params");
      assert.cooked("[quote]\n*test*\n[/quote]", '<aside class="quote no-group">\n<blockquote>\n<p><em>test</em></p>\n</blockquote>\n</aside>', "it doesn't insert a new line for italics");
      assert.cooked("[quote=,script='a'><script>alert('test');//':a]\n[/quote]", '<aside class="quote no-group">\n<blockquote></blockquote>\n</aside>', "It will not create a script tag within an attribute");
    });
    (0, _qunit.test)("quoting a quote", function (assert) {
      const post = _post.default.create({
        cooked: new _prettyText.default(defaultOpts).cook('[quote="sam, post:1, topic:1, full:true"]\nhello\n[/quote]\n*Test*'),
        username: "eviltrout",
        post_number: 1,
        topic_id: 2
      });

      const quote = (0, _quote.buildQuote)(post, '[quote="sam, post:1, topic:1, full:true"]\nhello\n[/quote]');
      assert.strictEqual(quote, '[quote="eviltrout, post:1, topic:2"]\n[quote="sam, post:1, topic:1, full:true"]\nhello\n[/quote]\n[/quote]\n\n', "allows quoting a quote");
    });
    (0, _qunit.test)("quote formatting", function (assert) {
      assert.cooked('[quote="EvilTrout, post:123, topic:456, full:true"]\n[sam]\n[/quote]', `<aside class=\"quote no-group\" data-username=\"EvilTrout\" data-post=\"123\" data-topic=\"456\" data-full=\"true\">
<div class=\"title\">
<div class=\"quote-controls\"></div>
 EvilTrout:</div>
<blockquote>
<p>[sam]</p>
</blockquote>
</aside>`, "it allows quotes with [] inside");
      assert.cooked('[quote="eviltrout, post:1, topic:1"]\nabc\n[/quote]', `<aside class=\"quote no-group\" data-username=\"eviltrout\" data-post=\"1\" data-topic=\"1\">
<div class=\"title\">
<div class=\"quote-controls\"></div>
 eviltrout:</div>
<blockquote>
<p>abc</p>
</blockquote>
</aside>`, "renders quotes properly");
      assert.cooked('[quote="eviltrout, post:1, topic:1"]\nabc\n[/quote]\nhello', `<aside class=\"quote no-group\" data-username=\"eviltrout\" data-post=\"1\" data-topic=\"1\">
<div class=\"title\">
<div class=\"quote-controls\"></div>
 eviltrout:</div>
<blockquote>
<p>abc</p>
</blockquote>
</aside>
<p>hello</p>`, "handles new lines properly");
      assert.cooked('[quote="Alice, post:1, topic:1"]\n[quote="Bob, post:2, topic:1"]\n[/quote]\n[/quote]', `<aside class=\"quote no-group\" data-username=\"Alice\" data-post=\"1\" data-topic=\"1\">
<div class=\"title\">
<div class=\"quote-controls\"></div>
 Alice:</div>
<blockquote>
<aside class=\"quote no-group\" data-username=\"Bob\" data-post=\"2\" data-topic=\"1\">
<div class=\"title\">
<div class=\"quote-controls\"></div>
 Bob:</div>
<blockquote></blockquote>
</aside>
</blockquote>
</aside>`, "quotes can be nested");
      assert.cooked('[quote="Alice, post:1, topic:1"]\n[quote="Bob, post:2, topic:1"]\n[/quote]', `<p>[quote=&quot;Alice, post:1, topic:1&quot;]</p>
<aside class=\"quote no-group\" data-username=\"Bob\" data-post=\"2\" data-topic=\"1\">
<div class=\"title\">
<div class=\"quote-controls\"></div>
 Bob:</div>
<blockquote></blockquote>
</aside>`, "handles mismatched nested quote tags (non greedy)");
      assert.cooked("[quote=\"Alice, post:1, topic:1\"]\n```javascript\nvar foo ='foo';\nvar bar = 'bar';\n```\n[/quote]", `<aside class=\"quote no-group\" data-username=\"Alice\" data-post=\"1\" data-topic=\"1\">
<div class=\"title\">
<div class=\"quote-controls\"></div>
 Alice:</div>
<blockquote>
<pre><code class=\"lang-javascript\">var foo ='foo';
var bar = 'bar';
</code></pre>
</blockquote>
</aside>`, "quotes can have code blocks without leading newline");
      assert.cooked("[quote=\"Alice, post:1, topic:1\"]\n\n```javascript\nvar foo ='foo';\nvar bar = 'bar';\n```\n[/quote]", `<aside class=\"quote no-group\" data-username=\"Alice\" data-post=\"1\" data-topic=\"1\">
<div class=\"title\">
<div class=\"quote-controls\"></div>
 Alice:</div>
<blockquote>
<pre><code class=\"lang-javascript\">var foo ='foo';
var bar = 'bar';
</code></pre>
</blockquote>
</aside>`, "quotes can have code blocks with leading newline");
    });
    (0, _qunit.test)("quotes with trailing formatting", function (assert) {
      const result = new _prettyText.default(defaultOpts).cook('[quote="EvilTrout, post:123, topic:456, full:true"]\nhello\n[/quote]\n*Test*');
      assert.strictEqual(result, `<aside class=\"quote no-group\" data-username=\"EvilTrout\" data-post=\"123\" data-topic=\"456\" data-full=\"true\">
<div class=\"title\">
<div class=\"quote-controls\"></div>
 EvilTrout:</div>
<blockquote>
<p>hello</p>
</blockquote>
</aside>
<p><em>Test</em></p>`, "it allows trailing formatting");
    });
    (0, _qunit.test)("enable/disable features", function (assert) {
      assert.cookedOptions("|a|\n--\n|a|", {
        features: {
          table: false
        }
      }, "");
      assert.cooked("|a|\n--\n|a|", `<div class="md-table">
<table>
<thead>
<tr>
<th>a</th>
</tr>
</thead>
<tbody>
<tr>
<td>a</td>
</tr>
</tbody>
</table>
</div>`);
    });
    (0, _qunit.test)("customizing markdown-it rules", function (assert) {
      assert.cookedOptions("**bold**", {
        markdownItRules: []
      }, "<p>**bold**</p>", "does not apply bold markdown when rule is not enabled");
      assert.cookedOptions("**bold**", {
        markdownItRules: ["emphasis"]
      }, "<p><strong>bold</strong></p>", "applies bold markdown when rule is enabled");
    });
    (0, _qunit.test)("features override", function (assert) {
      assert.cookedOptions(":grin: @sam", {
        featuresOverride: []
      }, "<p>:grin: @sam</p>", "does not cook emojis when Discourse markdown engines are disabled");
      assert.cookedOptions(":grin: @sam", {
        featuresOverride: ["emoji"]
      }, `<p><img src="/images/emoji/google_classic/grin.png?v=${_version.IMAGE_VERSION}" title=":grin:" class="emoji" alt=":grin:" loading="lazy" width="20" height="20"> @sam</p>`, "cooks emojis when only the emoji markdown engine is enabled");
      assert.cookedOptions(":grin: @sam", {
        featuresOverride: ["mentions", "text-post-process"]
      }, `<p>:grin: <span class="mention">@sam</span></p>`, "cooks mentions when only the mentions markdown engine is enabled");
    });
    (0, _qunit.test)("emoji", function (assert) {
      assert.cooked(":smile:", `<p><img src="/images/emoji/google_classic/smile.png?v=${_version.IMAGE_VERSION}" title=":smile:" class="emoji only-emoji" alt=":smile:" loading="lazy" width="20" height="20"></p>`);
      assert.cooked(":(", `<p><img src="/images/emoji/google_classic/frowning.png?v=${_version.IMAGE_VERSION}" title=":frowning:" class="emoji only-emoji" alt=":frowning:" loading="lazy" width="20" height="20"></p>`);
      assert.cooked("8-)", `<p><img src="/images/emoji/google_classic/sunglasses.png?v=${_version.IMAGE_VERSION}" title=":sunglasses:" class="emoji only-emoji" alt=":sunglasses:" loading="lazy" width="20" height="20"></p>`);
    });
    (0, _qunit.test)("emoji - enable_inline_emoji_translation", function (assert) {
      assert.cookedOptions("test:smile:test", {
        siteSettings: {
          enable_inline_emoji_translation: false
        }
      }, `<p>test:smile:test</p>`);
      assert.cookedOptions("test:smile:test", {
        siteSettings: {
          enable_inline_emoji_translation: true
        }
      }, `<p>test<img src="/images/emoji/google_classic/smile.png?v=${_version.IMAGE_VERSION}" title=":smile:" class="emoji" alt=":smile:" loading="lazy" width="20" height="20">test</p>`);
    });
    (0, _qunit.test)("emoji - emojiSet", function (assert) {
      assert.cookedOptions(":smile:", {
        siteSettings: {
          emoji_set: "twitter"
        }
      }, `<p><img src="/images/emoji/twitter/smile.png?v=${_version.IMAGE_VERSION}" title=":smile:" class="emoji only-emoji" alt=":smile:" loading="lazy" width="20" height="20"></p>`);
    });
    (0, _qunit.test)("emoji - emojiCDN", function (assert) {
      assert.cookedOptions(":smile:", {
        siteSettings: {
          emoji_set: "twitter",
          external_emoji_url: "https://emoji.hosting.service"
        }
      }, `<p><img src="https://emoji.hosting.service/twitter/smile.png?v=${_version.IMAGE_VERSION}" title=":smile:" class="emoji only-emoji" alt=":smile:" loading="lazy" width="20" height="20"></p>`);
    });
    (0, _qunit.test)("emoji - registerEmoji", function (assert) {
      (0, _emoji.registerEmoji)("foo", "/images/d-logo-sketch.png");
      assert.cookedOptions(":foo:", {}, `<p><img src="/images/d-logo-sketch.png?v=${_version.IMAGE_VERSION}" title=":foo:" class="emoji emoji-custom only-emoji" alt=":foo:" loading="lazy" width="20" height="20"></p>`);
      (0, _emoji.registerEmoji)("bar", "/images/avatar.png", "baz");
      assert.cookedOptions(":bar:", {}, `<p><img src="/images/avatar.png?v=${_version.IMAGE_VERSION}" title=":bar:" class="emoji emoji-custom only-emoji" alt=":bar:" loading="lazy" width="20" height="20"></p>`);
    });
    (0, _qunit.test)("extractDataAttribute", function (assert) {
      assert.deepEqual((0, _discourseMarkdownIt.extractDataAttribute)("foo="), ["data-foo", ""]);
      assert.deepEqual((0, _discourseMarkdownIt.extractDataAttribute)("foo=bar"), ["data-foo", "bar"]);
      assert.notOk((0, _discourseMarkdownIt.extractDataAttribute)("foo?=bar"));
      assert.notOk((0, _discourseMarkdownIt.extractDataAttribute)("https://discourse.org/?q=hello"));
    });
    (0, _qunit.test)("video - display placeholder when previewing", function (assert) {
      assert.cookedOptions(`![baby shark|video](upload://eyPnj7UzkU0AkGkx2dx8G4YM1Jx.mp4)`, {
        previewing: true
      }, `<p><div class=\"onebox-placeholder-container\">
        <span class=\"placeholder-icon video\"></span>
      </div></p>`);
    });
    (0, _qunit.test)("typographer arrows", function (assert) {
      const enabledTypographer = {
        siteSettings: {
          enable_markdown_typographer: true
        }
      }; // Replace arrows

      assert.cookedOptions("--> <--", enabledTypographer, "<p> \u2192 \u2190 </p>");
      assert.cookedOptions("a -> b", enabledTypographer, "<p>a \u2192 b</p>");
      assert.cookedOptions("a <- b", enabledTypographer, "<p>a \u2190 b</p>");
      assert.cookedOptions("a --> b", enabledTypographer, "<p>a \u2192 b</p>");
      assert.cookedOptions("-->", enabledTypographer, "<p> \u2192 </p>");
      assert.cookedOptions("<--", enabledTypographer, "<p> \u2190 </p>"); // Don't replace arrows

      assert.cookedOptions("<!-- an html comment -->", enabledTypographer, "");
      assert.cookedOptions("(<--not an arrow)", enabledTypographer, "<p>(&lt;not an arrow)</p>");
      assert.cookedOptions("<-->", enabledTypographer, "<p>&lt;&gt;</p>");
      assert.cookedOptions("asd-->", enabledTypographer, "<p>asd&gt;</p>");
      assert.cookedOptions(" asd--> ", enabledTypographer, "<p>asd&gt;</p>");
      assert.cookedOptions(" asd-->", enabledTypographer, "<p>asd&gt;</p>");
      assert.cookedOptions("-->asd", enabledTypographer, "<p>&gt;asd</p>");
      assert.cookedOptions(" -->asd ", enabledTypographer, "<p>&gt;asd</p>");
      assert.cookedOptions(" -->asd", enabledTypographer, "<p>&gt;asd</p>");
    });
    (0, _qunit.test)("default typographic replacements", function (assert) {
      const enabledTypographer = {
        siteSettings: {
          enable_markdown_typographer: true
        }
      };
      assert.cookedOptions("(bad)", enabledTypographer, "<p>(bad)</p>");
      assert.cookedOptions("+-5", enabledTypographer, "<p>5</p>");
      assert.cookedOptions("test.. test... test..... test?..... test!....", enabledTypographer, "<p>test test test test?.. test!..</p>");
      assert.cookedOptions("!!!!!! ???? ,,", enabledTypographer, "<p>!!! ??? ,</p>");
      assert.cookedOptions("!!!!!! ???? ,,", enabledTypographer, "<p>!!! ??? ,</p>");
      assert.cookedOptions("(tm) (TM)", enabledTypographer, "<p> </p>");
      assert.cookedOptions("(pa) (PA)", enabledTypographer, "<p> </p>");
    });
    (0, _qunit.test)("default typographic replacements - dashes", function (assert) {
      const enabledTypographer = {
        siteSettings: {
          enable_markdown_typographer: true
        }
      };
      assert.cookedOptions("---markdownit --- super---", enabledTypographer, "<p>markdownit  super</p>");
      assert.cookedOptions("markdownit---awesome", enabledTypographer, "<p>markdownitawesome</p>");
      assert.cookedOptions("abc ----", enabledTypographer, "<p>abc ----</p>");
      assert.cookedOptions("--markdownit -- super--", enabledTypographer, "<p>markdownit  super</p>");
      assert.cookedOptions("markdownit--awesome", enabledTypographer, "<p>markdownitawesome</p>");
      assert.cookedOptions("1---2---3", enabledTypographer, "<p>123</p>");
      assert.cookedOptions("1--2--3", enabledTypographer, "<p>123</p>");
      assert.cookedOptions("<p>1   3</p>", enabledTypographer, "<p>1   3</p>");
    });
    (0, _qunit.test)("disabled typographic replacements", function (assert) {
      const enabledTypographer = {
        siteSettings: {
          enable_markdown_typographer: true
        }
      };
      assert.cookedOptions("(c) (C)", enabledTypographer, "<p>(c) (C)</p>");
      assert.cookedOptions("(r) (R)", enabledTypographer, "<p>(r) (R)</p>");
      assert.cookedOptions("(p) (P)", enabledTypographer, "<p>(p) (P)</p>");
    });
    (0, _qunit.test)("watched words replace", function (assert) {
      const opts = {
        watchedWordsReplace: {
          "(?:\\W|^)(fun)(?=\\W|$)": {
            replacement: "times",
            case_sensitive: false
          }
        }
      };
      assert.cookedOptions("test fun funny", opts, "<p>test times funny</p>");
      assert.cookedOptions("constructor", opts, "<p>constructor</p>");
    });
    (0, _qunit.test)("watched words link", function (assert) {
      const opts = {
        watchedWordsLink: {
          "(?:\\W|^)(fun)(?=\\W|$)": {
            replacement: "https://discourse.org",
            case_sensitive: false
          }
        }
      };
      assert.cookedOptions("test fun funny", opts, '<p>test <a href="https://discourse.org">fun</a> funny</p>');
    });
    (0, _qunit.test)("watched words replace with bad regex", function (assert) {
      const maxMatches = 100; // same limit as MD watched-words-replace plugin

      const opts = {
        siteSettings: {
          watched_words_regular_expressions: true
        },
        watchedWordsReplace: {
          "(\\bu?\\b)": {
            replacement: "you",
            case_sensitive: false
          }
        }
      };
      assert.cookedOptions("one", opts, `<p>${"you".repeat(maxMatches)}one</p>`, "does not loop infinitely");
    });
  });
});
define("discourse/tests/unit/lib/reviewable-types/queued-post-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "discourse/tests/helpers/reviewable-types-helper", "@ember/template", "discourse/lib/text", "discourse/models/user-menu-reviewable", "I18n"], function (_qunitHelpers, _qunit, _reviewableTypesHelper, _template, _text, _userMenuReviewable, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"discourse/tests/helpers/reviewable-types-helper",0,"@ember/template",0,"discourse/lib/text",0,"discourse/models/user-menu-reviewable",0,"I18n"eaimeta@70e063a35619d71f

  function getReviewable() {
    let overrides = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    return _userMenuReviewable.default.create(Object.assign({
      flagger_username: "sayo2",
      id: 17,
      pending: false,
      topic_fancy_title: "anything hello world",
      type: "ReviewableQueuedPost"
    }, overrides));
  }

  (0, _qunitHelpers.discourseModule)("Unit | Reviewable Items | queued-post", function () {
    (0, _qunit.test)("description", function (assert) {
      const reviewable = getReviewable({
        topic_fancy_title: "This is safe title &lt;a&gt; :heart:"
      });
      const director = (0, _reviewableTypesHelper.createRenderDirector)(reviewable, "ReviewableQueuedPost", this.siteSettings);
      assert.deepEqual(director.description, (0, _template.htmlSafe)(_I18n.default.t("user_menu.reviewable.new_post_in_topic", {
        title: `This is safe title &lt;a&gt; ${(0, _text.emojiUnescape)(":heart:")}`
      })), "contains the fancy title without escaping because it's already safe");
      delete reviewable.topic_fancy_title;
      reviewable.payload_title = "This is unsafe title <a> :heart:";
      assert.deepEqual(director.description, (0, _template.htmlSafe)(_I18n.default.t("user_menu.reviewable.new_post_in_topic", {
        title: `This is unsafe title &lt;a&gt; ${(0, _text.emojiUnescape)(":heart:")}`
      })), "contains the payload title escaped and correctly unescapes emojis");
    });
  });
});
define("discourse/tests/unit/lib/sanitizer-test", ["pretty-text/pretty-text", "qunit", "pretty-text/sanitizer", "pretty-text/allow-lister"], function (_prettyText, _qunit, _sanitizer, _allowLister) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"pretty-text/pretty-text",0,"qunit",0,"pretty-text/sanitizer",0,"pretty-text/allow-lister"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | sanitizer", function () {
    (0, _qunit.test)("sanitize", function (assert) {
      const pt = new _prettyText.default((0, _prettyText.buildOptions)({
        siteSettings: {
          allowed_iframes: "https://www.google.com/maps/embed?|https://www.openstreetmap.org/export/embed.html?"
        }
      }));

      const cooked = (input, expected, text) => assert.strictEqual(pt.cook(input), expected.replace(/\/>/g, ">"), text);

      assert.strictEqual(pt.sanitize('<i class="fa-bug fa-spin">bug</i>'), "<i>bug</i>");
      assert.strictEqual(pt.sanitize("<div><script>alert('hi');</script></div>"), "<div></div>");
      assert.strictEqual(pt.sanitize("<div><p class=\"funky\" wrong='1'>hello</p></div>"), "<div><p>hello</p></div>");
      assert.strictEqual(pt.sanitize("<3 <3"), "&lt;3 &lt;3");
      assert.strictEqual(pt.sanitize("<_<"), "&lt;_&lt;");
      cooked("hello<script>alert(42)</script>", "<p>hello</p>", "it sanitizes while cooking");
      cooked("<a href='http://disneyland.disney.go.com/'>disney</a> <a href='http://reddit.com'>reddit</a>", '<p><a href="http://disneyland.disney.go.com/">disney</a> <a href="http://reddit.com">reddit</a></p>', "we can embed proper links");
      cooked("<center>hello</center>", "hello", "it does not allow centering");
      cooked("<blockquote>a\n</blockquote>\n", "<blockquote>a\n</blockquote>", "it does not double sanitize");
      cooked('<iframe src="http://discourse.org" width="100" height="42"></iframe>', "", "it does not allow most iframes");
      cooked('<iframe src="https://www.google.com/maps/embed?pb=!1m10!1m8!1m3!1d2624.9983685732213!2d2.29432085!3d48.85824149999999!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sen!2s!4v1385737436368" width="100" height="42"></iframe>', '<iframe src="https://www.google.com/maps/embed?pb=!1m10!1m8!1m3!1d2624.9983685732213!2d2.29432085!3d48.85824149999999!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sen!2s!4v1385737436368" width="100" height="42"></iframe>', "it allows iframe to google maps");
      cooked('<iframe width="425" height="350" frameborder="0" marginheight="0" marginwidth="0" src="https://www.openstreetmap.org/export/embed.html?bbox=22.49454975128174%2C51.220338322410775%2C22.523088455200195%2C51.23345342732931&amp;layer=mapnik"></iframe>', '<iframe width="425" height="350" frameborder="0" marginheight="0" marginwidth="0" src="https://www.openstreetmap.org/export/embed.html?bbox=22.49454975128174%2C51.220338322410775%2C22.523088455200195%2C51.23345342732931&amp;layer=mapnik"></iframe>', "it allows iframe to OpenStreetMap");
      assert.strictEqual(pt.sanitize("<textarea>hullo</textarea>"), "hullo");
      assert.strictEqual(pt.sanitize("<button>press me!</button>"), "press me!");
      assert.strictEqual(pt.sanitize("<canvas>draw me!</canvas>"), "draw me!");
      assert.strictEqual(pt.sanitize("<progress>hello"), "hello");
      cooked("[the answer](javascript:alert(42))", "<p>[the answer](javascript:alert(42))</p>", "it prevents XSS");
      cooked('<i class="fa fa-bug fa-spin" style="font-size:600%"></i>\n<!-- -->', "<p><i></i></p>", "it doesn't circumvent XSS with comments");
      cooked('<span class="-bbcode-s fa fa-spin">a</span>', "<p><span>a</span></p>", "it sanitizes spans");
      cooked('<span class="fa fa-spin -bbcode-s">a</span>', "<p><span>a</span></p>", "it sanitizes spans");
      cooked('<span class="bbcode-s">a</span>', '<p><span class="bbcode-s">a</span></p>', "it sanitizes spans");
      cooked("<kbd>Ctrl</kbd>+<kbd>C</kbd>", "<p><kbd>Ctrl</kbd>+<kbd>C</kbd></p>");
      cooked("it has been <strike>1 day</strike> 0 days since our last test failure", "<p>it has been <strike>1 day</strike> 0 days since our last test failure</p>");
      cooked(`it has been <s>1 day</s> 0 days since our last test failure`, `<p>it has been <s>1 day</s> 0 days since our last test failure</p>`);
      cooked(`<div align="center">hello</div>`, `<div align="center">hello</div>`);
      cooked(`1 + 1 is <del>3</del> <ins>2</ins>`, `<p>1 + 1 is <del>3</del> <ins>2</ins></p>`);
      cooked(`<abbr title="JavaScript">JS</abbr>`, `<p><abbr title="JavaScript">JS</abbr></p>`);
      cooked(`<dl><dt>Forum</dt><dd>Software</dd></dl>`, `<dl><dt>Forum</dt><dd>Software</dd></dl>`);
      cooked(`<sup>high</sup> <sub>low</sub> <big>HUGE</big>`, `<p><sup>high</sup> <sub>low</sub> <big>HUGE</big></p>`);
      cooked(`<div dir="rtl">RTL text</div>`, `<div dir="rtl">RTL text</div>`);
      cooked(`<div data-value="<something>" data-html-value="<something>"></div>`, `<div data-value="&lt;something&gt;"></div>`);
    });
    (0, _qunit.test)("ids on headings", function (assert) {
      const pt = new _prettyText.default((0, _prettyText.buildOptions)({
        siteSettings: {}
      }));
      assert.strictEqual(pt.sanitize("<h3>Test Heading</h3>"), "<h3>Test Heading</h3>");
      assert.strictEqual(pt.sanitize(`<h1 id="heading--test">Test Heading</h1>`), `<h1 id="heading--test">Test Heading</h1>`);
      assert.strictEqual(pt.sanitize(`<h2 id="heading--cool">Test Heading</h2>`), `<h2 id="heading--cool">Test Heading</h2>`);
      assert.strictEqual(pt.sanitize(`<h3 id="heading--dashed-name">Test Heading</h3>`), `<h3 id="heading--dashed-name">Test Heading</h3>`);
      assert.strictEqual(pt.sanitize(`<h4 id="heading--underscored_name">Test Heading</h4>`), `<h4 id="heading--underscored_name">Test Heading</h4>`);
      assert.strictEqual(pt.sanitize(`<h5 id="heading--trout">Test Heading</h5>`), `<h5 id="heading--trout">Test Heading</h5>`);
      assert.strictEqual(pt.sanitize(`<h6 id="heading--discourse">Test Heading</h6>`), `<h6 id="heading--discourse">Test Heading</h6>`);
    });
    (0, _qunit.test)("autoplay videos must be muted", function (assert) {
      let pt = new _prettyText.default((0, _prettyText.buildOptions)({
        siteSettings: {}
      }));
      assert.ok(pt.sanitize(`<p>Hey</p><video autoplay src="http://example.com/music.mp4"/>`).match(/muted/));
      assert.ok(pt.sanitize(`<p>Hey</p><video autoplay><source src="http://example.com/music.mp4" type="audio/mpeg"></video>`).match(/muted/));
      assert.ok(pt.sanitize(`<p>Hey</p><video autoplay muted><source src="http://example.com/music.mp4" type="audio/mpeg"></video>`).match(/muted/));
      assert.notOk(pt.sanitize(`<p>Hey</p><video><source src="http://example.com/music.mp4" type="audio/mpeg"></video>`).match(/muted/));
    });
    (0, _qunit.test)("poorly formed ids on headings", function (assert) {
      let pt = new _prettyText.default((0, _prettyText.buildOptions)({
        siteSettings: {}
      }));
      assert.strictEqual(pt.sanitize(`<h1 id="evil-trout">Test Heading</h1>`), `<h1>Test Heading</h1>`);
      assert.strictEqual(pt.sanitize(`<h1 id="heading--">Test Heading</h1>`), `<h1>Test Heading</h1>`);
      assert.strictEqual(pt.sanitize(`<h1 id="heading--with space">Test Heading</h1>`), `<h1>Test Heading</h1>`);
      assert.strictEqual(pt.sanitize(`<h1 id="heading--with*char">Test Heading</h1>`), `<h1>Test Heading</h1>`);
      assert.strictEqual(pt.sanitize(`<h1 id="heading--">Test Heading</h1>`), `<h1>Test Heading</h1>`);
      assert.strictEqual(pt.sanitize(`<h1 id="test-heading--cool">Test Heading</h1>`), `<h1>Test Heading</h1>`);
    });
    (0, _qunit.test)("urlAllowed", function (assert) {
      const allowed = (url, msg) => assert.strictEqual((0, _sanitizer.hrefAllowed)(url), url, msg);

      allowed("/foo/bar.html", "allows relative urls");
      allowed("http://eviltrout.com/evil/trout", "allows full urls");
      allowed("https://eviltrout.com/evil/trout", "allows https urls");
      allowed("//eviltrout.com/evil/trout", "allows protocol relative urls");
      assert.strictEqual((0, _sanitizer.hrefAllowed)("http://google.com/test'onmouseover=alert('XSS!');//.swf"), "http://google.com/test%27onmouseover=alert(%27XSS!%27);//.swf", "escape single quotes");
    });
    (0, _qunit.test)("correctly sanitizes complex data attributes rules", function (assert) {
      const allowLister = new _allowLister.default();
      allowLister.allowListFeature("test", ["pre[data-*]", "code[data-custom-*=foo]", "div[data-cat-*]"]);
      allowLister.enable("test");
      assert.strictEqual((0, _sanitizer.sanitize)("<b data-foo=*></b>", allowLister), "<b></b>");
      assert.strictEqual((0, _sanitizer.sanitize)("<b data-foo=1></b>", allowLister), "<b></b>");
      assert.strictEqual((0, _sanitizer.sanitize)("<b data-=1></b>", allowLister), "<b></b>");
      assert.strictEqual((0, _sanitizer.sanitize)("<b data=1></b>", allowLister), "<b></b>");
      assert.strictEqual((0, _sanitizer.sanitize)("<b data></b>", allowLister), "<b></b>");
      assert.strictEqual((0, _sanitizer.sanitize)("<b data=*></b>", allowLister), "<b></b>");
      assert.strictEqual((0, _sanitizer.sanitize)("<pre data-foo=1></pre>", allowLister), '<pre data-foo="1"></pre>');
      assert.strictEqual((0, _sanitizer.sanitize)("<pre data-foo-bar=1></pre>", allowLister), '<pre data-foo-bar="1"></pre>');
      assert.strictEqual((0, _sanitizer.sanitize)("<code data-foo=foo></code>", allowLister), "<code></code>");
      assert.strictEqual((0, _sanitizer.sanitize)("<code data-custom-=foo></code>", allowLister), "<code></code>");
      assert.strictEqual((0, _sanitizer.sanitize)("<code data-custom-*=foo></code>", allowLister), "<code></code>");
      assert.strictEqual((0, _sanitizer.sanitize)("<code data-custom-bar=foo></code>", allowLister), '<code data-custom-bar="foo"></code>');
      assert.strictEqual((0, _sanitizer.sanitize)("<code data-custom-bar=1></code>", allowLister), "<code></code>");
      assert.strictEqual((0, _sanitizer.sanitize)("<div data-cat=1></div>", allowLister), '<div data-cat="1"></div>');
      assert.strictEqual((0, _sanitizer.sanitize)("<div data-cat-dog=1></div>", allowLister), '<div data-cat-dog="1"></div>');
    });
  });
});
define("discourse/tests/unit/lib/search-test", ["qunit", "discourse/lib/search", "I18n"], function (_qunit, _search, _I18n) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/lib/search",0,"I18n"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | search", function () {
    (0, _qunit.test)("unescapesEmojisInBlurbs", async function (assert) {
      const source = {
        posts: [{
          id: 160,
          username: "pmusaraj",
          avatar_template: "/user_avatar/localhost/pmusaraj/{size}/3_2.png",
          created_at: "2019-07-22T03:47:04.864Z",
          like_count: 1,
          blurb: ":thinking: This here is a test of emojis in search blurbs.",
          post_number: 1,
          topic_id: 41
        }],
        topics: [],
        users: [],
        categories: [],
        tags: [],
        groups: [],
        grouped_search_result: false
      };
      const results = await (0, _search.translateResults)(source);
      const blurb = results.posts[0].get("blurb");
      assert.ok(blurb.includes("thinking.png"));
      assert.ok(blurb.startsWith('<img width="20" height="20" src'));
      assert.ok(!blurb.includes(":thinking:"));
    });
    (0, _qunit.test)("searchContextDescription", function (assert) {
      assert.strictEqual((0, _search.searchContextDescription)("topic"), _I18n.default.t("search.context.topic"));
      assert.strictEqual((0, _search.searchContextDescription)("user", "silvio.dante"), _I18n.default.t("search.context.user", {
        username: "silvio.dante"
      }));
      assert.strictEqual((0, _search.searchContextDescription)("category", "staff"), _I18n.default.t("search.context.category", {
        category: "staff"
      }));
      assert.strictEqual((0, _search.searchContextDescription)("tag", "important"), _I18n.default.t("search.context.tag", {
        tag: "important"
      }));
      assert.strictEqual((0, _search.searchContextDescription)("private_messages"), _I18n.default.t("search.context.private_messages"));
      assert.strictEqual((0, _search.searchContextDescription)("bad_type"), undefined);
    });
  });
});
define("discourse/tests/unit/lib/sharing-test", ["qunit", "discourse/lib/sharing"], function (_qunit, _sharing) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/lib/sharing"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | sharing", function (hooks) {
    hooks.beforeEach(function () {
      _sharing.default._reset();
    });
    hooks.afterEach(function () {
      _sharing.default._reset();
    });
    (0, _qunit.test)("addSource", function (assert) {
      const sharingSettings = "facebook|twitter";
      assert.blank(_sharing.default.activeSources(sharingSettings));

      _sharing.default.addSource({
        id: "facebook"
      });

      assert.strictEqual(_sharing.default.activeSources(sharingSettings).length, 1);
    });
    (0, _qunit.test)("addSharingId", function (assert) {
      const sharingSettings = "";
      assert.blank(_sharing.default.activeSources(sharingSettings));

      _sharing.default.addSource({
        id: "new-source"
      });

      assert.blank(_sharing.default.activeSources(sharingSettings), "it doesnt activate a source not in settings");

      _sharing.default.addSharingId("new-source");

      assert.strictEqual(_sharing.default.activeSources(sharingSettings).length, 1, "it adds sharing id to existing sharing settings");
      const privateContext = true;

      _sharing.default.addSource({
        id: "another-source"
      });

      _sharing.default.addSharingId("another-source");

      assert.strictEqual(_sharing.default.activeSources(sharingSettings, privateContext).length, 0, "it does not add a regular source to sources in a private context");

      _sharing.default.addSource({
        id: "a-private-friendly-source",
        showInPrivateContext: true
      });

      _sharing.default.addSharingId("a-private-friendly-source");

      assert.strictEqual(_sharing.default.activeSources(sharingSettings, privateContext).length, 1, "it does not add a regular source to sources in a private context");
    });
  });
});
define("discourse/tests/unit/lib/suffix-trie-test", ["qunit", "discourse-common/lib/suffix-trie"], function (_qunit, _suffixTrie) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse-common/lib/suffix-trie"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | SuffixTrie", function () {
    (0, _qunit.test)("SuffixTrie", function (assert) {
      const t = new _suffixTrie.default("/");
      t.add("a/b/c/d");
      t.add("b/a/c/d");
      t.add("c/b/a/d");
      t.add("d/c/b/a");
      t.add("a/b/c/d/");
      t.add("/a/b/c/d/"); // Simple lookups

      assert.deepEqual(t.withSuffix("d"), ["a/b/c/d", "b/a/c/d", "c/b/a/d"]);
      assert.deepEqual(t.withSuffix("c/d"), ["a/b/c/d", "b/a/c/d"]);
      assert.deepEqual(t.withSuffix("b/c/d"), ["a/b/c/d"]);
      assert.deepEqual(t.withSuffix("a/b/c/d"), ["a/b/c/d"]);
      assert.deepEqual(t.withSuffix("b/a"), ["d/c/b/a"]); // With leading/trailing delimiters

      assert.deepEqual(t.withSuffix("c/d/"), ["a/b/c/d/", "/a/b/c/d/"]);
      assert.deepEqual(t.withSuffix("/a/b/c/d/"), ["/a/b/c/d/"]); // Limited lookups

      assert.deepEqual(t.withSuffix("d", 1), ["a/b/c/d"]);
      assert.deepEqual(t.withSuffix("d", 2), ["a/b/c/d", "b/a/c/d"]);
    });
  });
});
define("discourse/tests/unit/lib/text-direction-test", ["discourse/lib/text-direction", "qunit"], function (_textDirection, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/lib/text-direction",0,"qunit"eaimeta@70e063a35619d71f

  function quoteHtml() {
    return `
    <aside class="quote">
      <div class="title">
        <img src="/images/avatar.png"> osama:
      </div>
      <blockquote>
        <p>  </p>
        <p>English words here!!</p>
        <aside class="quote">
          <div class="title">
            <img src="/images/avatar.png"> :
          </div>
          <blockquote>
            <p>English words here (nested quote)</p>
            <p>   ( )</p>
          </blockquote>
        </aside>
      </blockquote>
    </aside>
    <p>Testing quotes with mixed text direction!</p>
    <p>     </p>
  `;
  }

  function assertDirection(assert, elem, expected, message) {
    assert.strictEqual(elem.getAttribute("dir"), expected, message);
  }

  (0, _qunit.module)("Unit | Utility | text-direction", function () {
    (0, _qunit.test)("isRTL", function (assert) {
      // Hebrew
      assert.strictEqual((0, _textDirection.isRTL)(" "), true); // Arabic

      assert.strictEqual((0, _textDirection.isRTL)(" "), true); // Persian

      assert.strictEqual((0, _textDirection.isRTL)("   "), true);
      assert.strictEqual((0, _textDirection.isRTL)("This is a test"), false);
      assert.strictEqual((0, _textDirection.isRTL)(""), false);
    });
    (0, _qunit.test)("isLTR", function (assert) {
      assert.strictEqual((0, _textDirection.isLTR)("This is a test"), true);
      assert.strictEqual((0, _textDirection.isLTR)(" "), false);
    });
    (0, _qunit.test)("setTextDirections", function (assert) {
      const cooked = document.createElement("div");
      cooked.classList.add("cooked");
      cooked.innerHTML = quoteHtml();
      (0, _textDirection.setTextDirections)(cooked);
      const [englishTitle, arabicTitle] = Array.from(cooked.querySelectorAll(".title"));
      assertDirection(assert, englishTitle, "ltr", "quote title always matches site direction regardless of its content");
      assertDirection(assert, arabicTitle, "ltr", "quote title always matches site direction regardless of its content");
      const [quotedRtl, quotedLtr, quotedLtrNested, quotedRtlNested, notQuotedLtr, notQuotedRtl] = Array.from(cooked.querySelectorAll("p"));
      assertDirection(assert, quotedRtl, "rtl", "RTL paragraphs inside quote have rtl dir");
      assertDirection(assert, quotedLtr, "ltr", "LTR paragraphs inside quote have ltr dir");
      assertDirection(assert, quotedLtrNested, "ltr", "LTR paragraphs inside nested quote have ltr dir");
      assertDirection(assert, quotedRtlNested, "rtl", "RTL paragraphs inside nested quote have rtl dir");
      assertDirection(assert, notQuotedLtr, "ltr", "LTR paragraphs outside quotes have ltr dir");
      assertDirection(assert, notQuotedRtl, "rtl", "RTL paragraphs outside quotes have rtl dir");
    });
  });
});
define("discourse/tests/unit/lib/text-test", ["qunit", "discourse/lib/text"], function (_qunit, _text) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/lib/text"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | text", function () {
    (0, _qunit.test)("parseAsync", async function (assert) {
      await (0, _text.parseAsync)("**test**").then(tokens => {
        assert.strictEqual(tokens[1].children[1].type, "strong_open", "it parses the raw markdown");
      });
    });
  });
});
define("discourse/tests/unit/lib/time-shortcut-test", ["qunit", "discourse/tests/helpers/qunit-helpers", "discourse/lib/time-shortcut"], function (_qunit, _qunitHelpers, _timeShortcut) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/lib/time-shortcut"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Lib | time-shortcut | hideDynamicTimeShortcuts", function (hooks) {
    hooks.afterEach(function () {
      if (this.clock) {
        this.clock.restore();
      }
    });
    (0, _qunit.test)("hides 'Later Today' at the end of the day", function (assert) {
      const timezone = moment.tz.guess();
      const shortcuts = (0, _timeShortcut.defaultTimeShortcuts)(timezone);
      this.clock = (0, _qunitHelpers.fakeTime)("2100-04-19 08:00:00", timezone, true); // morning

      let result = (0, _timeShortcut.hideDynamicTimeShortcuts)(shortcuts, timezone).mapBy("id");
      assert.ok(result.includes("later_today"), "shows later_today in the morning");
      this.clock.restore();
      this.clock = (0, _qunitHelpers.fakeTime)("2100-04-19 18:00:00", timezone, true); // evening

      result = (0, _timeShortcut.hideDynamicTimeShortcuts)(shortcuts, timezone).mapBy("id");
      assert.notOk(result.includes("doesn't show later_today in the evening"));
    });
    (0, _qunit.test)("hides 'Later This Week' starting from Thursday", function (assert) {
      const timezone = moment.tz.guess();
      const shortcuts = (0, _timeShortcut.defaultTimeShortcuts)(timezone);
      this.clock = (0, _qunitHelpers.fakeTime)("2100-04-21 18:00:00", timezone, true); // Wednesday

      let result = (0, _timeShortcut.hideDynamicTimeShortcuts)(shortcuts, timezone).mapBy("id");
      assert.ok(result.includes("later_this_week"), "shows later_this_week on Wednesdays");
      this.clock.restore();
      this.clock = (0, _qunitHelpers.fakeTime)("2100-04-22 18:00:00", timezone, true); // Thursday

      result = (0, _timeShortcut.hideDynamicTimeShortcuts)(shortcuts, timezone).mapBy("id");
      assert.notOk(result.includes("later_this_week"), "doesn't show later_this_week on Thursdays");
      this.clock.restore();
      this.clock = (0, _qunitHelpers.fakeTime)("2100-04-23 18:00:00", timezone, true); // Friday

      result = (0, _timeShortcut.hideDynamicTimeShortcuts)(shortcuts, timezone).mapBy("id");
      assert.notOk(result.includes("later_this_week"), "doesn't show later_this_week on Fridays");
    });
    (0, _qunit.test)("hides 'This Weekend' on Fridays, Saturdays and Sundays", function (assert) {
      const siteSettings = {
        suggest_weekends_in_date_pickers: true
      };
      const timezone = moment.tz.guess();
      const shortcuts = (0, _timeShortcut.defaultTimeShortcuts)(timezone);
      this.clock = (0, _qunitHelpers.fakeTime)("2100-04-22 18:00:00", timezone, true); // Thursday

      let result = (0, _timeShortcut.hideDynamicTimeShortcuts)(shortcuts, timezone, siteSettings).mapBy("id");
      assert.ok(result.includes("this_weekend"), "shows this_weekend on Thursdays");
      this.clock.restore();
      this.clock = (0, _qunitHelpers.fakeTime)("2100-04-23 18:00:00", timezone, true); // Friday

      result = (0, _timeShortcut.hideDynamicTimeShortcuts)(shortcuts, timezone, siteSettings).mapBy("id");
      assert.notOk(result.includes("this_weekend"), "doesn't show this_weekend on Fridays");
      this.clock.restore();
      this.clock = (0, _qunitHelpers.fakeTime)("2100-04-24 18:00:00", timezone, true); // Saturday

      result = (0, _timeShortcut.hideDynamicTimeShortcuts)(shortcuts, timezone, siteSettings).mapBy("id");
      assert.notOk(result.includes("this_weekend"), "doesn't show this_weekend on Saturdays");
      this.clock.restore();
      this.clock = (0, _qunitHelpers.fakeTime)("2100-04-25 18:00:00", timezone, true); // Sunday

      result = (0, _timeShortcut.hideDynamicTimeShortcuts)(shortcuts, timezone, siteSettings).mapBy("id");
      assert.notOk(result.includes("this_weekend"), "doesn't show this_weekend on Sundays");
    });
    (0, _qunit.test)("hides 'This Weekend' when disabled in site settings", function (assert) {
      const siteSettings = {
        suggest_weekends_in_date_pickers: false
      };
      const timezone = moment.tz.guess();
      const shortcuts = (0, _timeShortcut.defaultTimeShortcuts)(timezone);
      this.clock = (0, _qunitHelpers.fakeTime)("2100-04-19 18:00:00", timezone, true); // Monday

      let result = (0, _timeShortcut.hideDynamicTimeShortcuts)(shortcuts, timezone, siteSettings).mapBy("id");
      assert.notOk(result.includes("this_weekend"), "shows this_weekend on Thursdays");
    });
  });
});
define("discourse/tests/unit/lib/time-utils-test", ["discourse/tests/helpers/qunit-helpers", "discourse/lib/time-utils", "qunit"], function (_qunitHelpers, _timeUtils, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"discourse/lib/time-utils",0,"qunit"eaimeta@70e063a35619d71f

  const timezone = "Australia/Brisbane";
  (0, _qunitHelpers.discourseModule)("Unit | lib | timeUtils", function () {
    (0, _qunit.test)("nextMonth gets next month correctly", function (assert) {
      (0, _qunitHelpers.withFrozenTime)("2019-12-11T08:00:00", timezone, () => {
        assert.strictEqual((0, _timeUtils.nextMonth)(timezone).format("YYYY-MM-DD"), "2020-01-01");
      });
    });
    (0, _qunit.test)("laterThisWeek gets 2 days from now", function (assert) {
      (0, _qunitHelpers.withFrozenTime)("2019-12-10T08:00:00", timezone, () => {
        assert.strictEqual((0, _timeUtils.laterThisWeek)(timezone).format("YYYY-MM-DD"), "2019-12-12");
      });
    });
    (0, _qunit.test)("tomorrow gets tomorrow correctly", function (assert) {
      (0, _qunitHelpers.withFrozenTime)("2019-12-11T08:00:00", timezone, () => {
        assert.strictEqual((0, _timeUtils.tomorrow)(timezone).format("YYYY-MM-DD"), "2019-12-12");
      });
    });
    (0, _qunit.test)("startOfDay changes the time of the provided date to 8:00am correctly", function (assert) {
      let dt = moment.tz("2019-12-11T11:37:16", timezone);
      assert.strictEqual((0, _timeUtils.startOfDay)(dt).format("YYYY-MM-DD HH:mm:ss"), "2019-12-11 08:00:00");
    });
    (0, _qunit.test)("laterToday gets 3 hours from now and if before half-past, it rounds down", function (assert) {
      (0, _qunitHelpers.withFrozenTime)("2019-12-11T08:13:00", timezone, () => {
        assert.strictEqual((0, _timeUtils.laterToday)(timezone).format("YYYY-MM-DD HH:mm:ss"), "2019-12-11 11:00:00");
      });
    });
    (0, _qunit.test)("laterToday gets 3 hours from now and if after half-past, it rounds up to the next hour", function (assert) {
      (0, _qunitHelpers.withFrozenTime)("2019-12-11T08:43:00", timezone, () => {
        assert.strictEqual((0, _timeUtils.laterToday)(timezone).format("YYYY-MM-DD HH:mm:ss"), "2019-12-11 12:00:00");
      });
    });
    (0, _qunit.test)("laterToday is capped to 6pm. later today at 3pm = 6pm, 3:30pm = 6pm, 4pm = 6pm, 4:59pm = 6pm", function (assert) {
      (0, _qunitHelpers.withFrozenTime)("2019-12-11T15:00:00", timezone, () => {
        assert.strictEqual((0, _timeUtils.laterToday)(timezone).format("YYYY-MM-DD HH:mm:ss"), "2019-12-11 18:00:00", "3pm should max to 6pm");
      });
      (0, _qunitHelpers.withFrozenTime)("2019-12-11T15:31:00", timezone, () => {
        assert.strictEqual((0, _timeUtils.laterToday)(timezone).format("YYYY-MM-DD HH:mm:ss"), "2019-12-11 18:00:00", "3:30pm should max to 6pm");
      });
      (0, _qunitHelpers.withFrozenTime)("2019-12-11T16:00:00", timezone, () => {
        assert.strictEqual((0, _timeUtils.laterToday)(timezone).format("YYYY-MM-DD HH:mm:ss"), "2019-12-11 18:00:00", "4pm should max to 6pm");
      });
      (0, _qunitHelpers.withFrozenTime)("2019-12-11T16:59:00", timezone, () => {
        assert.strictEqual((0, _timeUtils.laterToday)(timezone).format("YYYY-MM-DD HH:mm:ss"), "2019-12-11 18:00:00", "4:59pm should max to 6pm");
      });
    });
  });
});
define("discourse/tests/unit/lib/to-markdown-test", ["qunit", "discourse/lib/to-markdown"], function (_qunit, _toMarkdown) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/lib/to-markdown"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | to-markdown", function () {
    (0, _qunit.test)("converts styles between normal words", function (assert) {
      const html = `Line with <s>styles</s> <b><i>between</i></b> words.`;
      const markdown = `Line with ~~styles~~ ***between*** words.`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
      assert.strictEqual((0, _toMarkdown.default)("A <b>bold </b>word"), "A **bold** word");
      assert.strictEqual((0, _toMarkdown.default)("A <b>bold</b>, word"), "A **bold**, word");
    });
    (0, _qunit.test)("converts inline nested styles", function (assert) {
      let html = `<em>Italicised line with <strong>some random</strong> <b>bold</b> words.</em>`;
      let markdown = `*Italicised line with **some random** **bold** words.*`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
      html = `<i class="fa">Italicised line
     with <b title="strong">some<br>
     random</b> <s>bold</s> words.</i>`;
      markdown = `<i>Italicised line with <b>some\nrandom</b> ~~bold~~ words.</i>`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown); // eslint-disable-next-line no-irregular-whitespace

      html = `<span>this is<span></span></span><strong>bold</strong><span><span></span>statement</span>`;
      markdown = `this is **bold** statement`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
    });
    (0, _qunit.test)("converts a link", function (assert) {
      let html = `<a href="https://discourse.org">Discourse</a>`;
      let markdown = `[Discourse](https://discourse.org)`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
      html = `<a href="https://discourse.org">Disc\n\n\nour\n\nse</a>`;
      markdown = `[Disc our se](https://discourse.org)`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
    });
    (0, _qunit.test)("converts a link which is an attachment", function (assert) {
      let html = `<a class="attachment" href="https://discourse.org/pdfs/stuff.pdf">stuff.pdf</a>`;
      let markdown = `[stuff.pdf|attachment](https://discourse.org/pdfs/stuff.pdf)`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
    });
    (0, _qunit.test)("put raw URL instead of converting the link", function (assert) {
      let url = "https://discourse.org";

      const html = () => `<a href="${url}">${url}</a>`;

      assert.strictEqual((0, _toMarkdown.default)(html()), url);
      url = "discourse.org/t/topic-slug/1";
      assert.strictEqual((0, _toMarkdown.default)(html()), url);
    });
    (0, _qunit.test)("skip empty link", function (assert) {
      assert.strictEqual((0, _toMarkdown.default)(`<a href="https://example.com"></a>`), "");
    });
    (0, _qunit.test)("converts heading tags", function (assert) {
      const html = `
    <h1>Heading 1</h1>
    <h2>Heading 2</h2>

    \t  <h3>Heading 3</h3>


    <h4>Heading 4</h4>



  <h5>Heading 5</h5>




  <h6>Heading 6</h6>
    `;
      const markdown = `# Heading 1\n\n## Heading 2\n\n### Heading 3\n\n#### Heading 4\n\n##### Heading 5\n\n###### Heading 6`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
    });
    (0, _qunit.test)("converts ul list tag", function (assert) {
      let html = `
    <ul>
      <li>Item 1</li>
      <li>
        Item 2
        <ul>
          <li>Sub Item 1</li>
          <li><p>Sub Item 2</p></li>
          <li>Sub Item 3<ul><li>Sub <i>Sub</i> Item 1</li><li>Sub <b>Sub</b> Item 2</li></ul></li>
        </ul>
      </li>
      <li>Item 3</li>
    </ul>
    `;
      let markdown = `* Item 1\n* Item 2\n  * Sub Item 1\n  * Sub Item 2\n  * Sub Item 3\n    * Sub *Sub* Item 1\n    * Sub **Sub** Item 2\n* Item 3`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
      html = `
  <ul>
    <li><p><span>Bullets at level 1</span></p></li>
    <li><p><span>Bullets at level 1</span></p></li>  <ul>    <li><p><span>Bullets at level 2</span></p></li>    <li><p><span>Bullets at level 2</span></p></li>    <ul>      <li><p><span>Bullets at level 3</span></p></li>    </ul>    <li><p><span>Bullets at level 2</span></p></li>  </ul>  <li><p><span>Bullets at level 1</span></p></li></ul>  `;
      markdown = `* Bullets at level 1
* Bullets at level 1
  * Bullets at level 2
  * Bullets at level 2
    * Bullets at level 3
  * Bullets at level 2
* Bullets at level 1`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
    });
    (0, _qunit.test)("stripes unwanted inline tags", function (assert) {
      const html = `
    <p>Lorem ipsum <span>dolor sit amet, consectetur</span> <strike>elit.</strike></p>
    <p>Ut minim veniam, <label>quis nostrud</label> laboris <nisi> ut aliquip ex ea</nisi> commodo.</p>
    `;
      const markdown = `Lorem ipsum dolor sit amet, consectetur ~~elit.~~\n\nUt minim veniam, quis nostrud laboris ut aliquip ex ea commodo.`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
    });
    (0, _qunit.test)("converts table tags", function (assert) {
      let html = `<address>Discourse Avenue</address><b>laboris</b>
    <table>
      <thead> <tr><th>Heading 1</th><th>Head 2</th></tr> </thead>
        <tbody>
          <tr><td>Lorem</td><td>ipsum</td></tr>
          <tr><td><b>dolor</b></td> <td><i>sit amet</i></td> </tr>

          </tbody>
  </table>
    `;
      let markdown = `Discourse Avenue\n\n**laboris**\n\n|Heading 1|Head 2|\n| --- | --- |\n|Lorem|ipsum|\n|**dolor**|*sit amet*|`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
      html = `<table>
              <tr><th>Heading 1</th><th>Head 2</th></tr>
              <tr><td><a href="http://example.com"><img src="http://example.com/image.png" alt="Lorem" width="45" height="45"></a></td><td>ipsum</td></tr>
            </table>`;
      markdown = `|Heading 1|Head 2|\n| --- | --- |\n|[![Lorem\\|45x45](http://example.com/image.png)](http://example.com)|ipsum|`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
    });
    (0, _qunit.test)("replace pipes with spaces if table format not supported", function (assert) {
      let html = `<table>
      <thead> <tr><th>Headi<br><br>ng 1</th><th>Head 2</th></tr> </thead>
        <tbody>
          <tr><td>Lorem</td><td>ipsum</td></tr>
          <tr><td><a href="http://example.com"><img src="http://dolor.com/image.png" /></a></td> <td><i>sit amet</i></td></tr></tbody>
  </table>
    `;
      let markdown = `Headi\n\nng 1 Head 2\nLorem ipsum\n[![](http://dolor.com/image.png)](http://example.com) *sit amet*`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
      html = `<table>
      <thead> <tr><th>Heading 1</th></tr> </thead>
        <tbody>
          <tr><td>Lorem</td></tr>
          <tr><td><i>sit amet</i></td></tr></tbody>
  </table>
    `;
      markdown = `Heading 1\nLorem\n*sit amet*`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
      html = `<table><tr><td>Lorem</td><td><strong>sit amet</strong></td></tr></table>`;
      markdown = `Lorem **sit amet**`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
    });
    (0, _qunit.test)("converts img tag", function (assert) {
      const url = "https://example.com/image.png";
      const base62SHA1 = "q16M6GR110R47Z9p9Dk3PMXOJoE";
      let html = `<img src="${url}" width="100" height="50">`;
      assert.strictEqual((0, _toMarkdown.default)(html), `![|100x50](${url})`);
      html = `<img src="${url}" width="100" height="50" title="some title">`;
      assert.strictEqual((0, _toMarkdown.default)(html), `![|100x50](${url} "some title")`);
      html = `<img src="${url}" width="100" height="50" title="some title" data-base62-sha1="${base62SHA1}">`;
      assert.strictEqual((0, _toMarkdown.default)(html), `![|100x50](upload://${base62SHA1} "some title")`);
      html = `<div><span><img src="${url}" alt="description" width="50" height="100" /></span></div>`;
      assert.strictEqual((0, _toMarkdown.default)(html), `![description|50x100](${url})`);
      html = `<a href="http://example.com"><img src="${url}" alt="description" /></a>`;
      assert.strictEqual((0, _toMarkdown.default)(html), `[![description](${url})](http://example.com)`);
      html = `<a href="http://example.com">description <img src="${url}" /></a>`;
      assert.strictEqual((0, _toMarkdown.default)(html), `[description ![](${url})](http://example.com)`);
      html = `<img alt="description" />`;
      assert.strictEqual((0, _toMarkdown.default)(html), "");
      html = `<a><img src="${url}" alt="description" /></a>`;
      assert.strictEqual((0, _toMarkdown.default)(html), `![description](${url})`);
    });
    (0, _qunit.test)("supporting html tags by keeping them", function (assert) {
      let html = "Lorem <del>ipsum dolor</del> sit <big>amet, <ins>consectetur</ins></big>";
      let output = html;
      assert.strictEqual((0, _toMarkdown.default)(html), output);
      html = `Lorem <del style="font-weight: bold">ipsum dolor</del> sit <big>amet, <ins onclick="alert('hello')">consectetur</ins></big>`;
      assert.strictEqual((0, _toMarkdown.default)(html), output);
      html = `<a href="http://example.com" onload="">Lorem <del style="font-weight: bold">ipsum dolor</del> sit</a>.`;
      output = `[Lorem <del>ipsum dolor</del> sit](http://example.com).`;
      assert.strictEqual((0, _toMarkdown.default)(html), output);
      html = `Lorem <del>ipsum dolor</del> sit.`;
      assert.strictEqual((0, _toMarkdown.default)(html), html);
      html = `Have you tried clicking the <kbd>Help Me!</kbd> button?`;
      assert.strictEqual((0, _toMarkdown.default)(html), html);
      html = `<mark>This is highlighted!</mark>`;
      assert.strictEqual((0, _toMarkdown.default)(html), html);
      html = `Lorem <a href="http://example.com"><del>ipsum \n\n\n dolor</del> sit.</a>`;
      output = `Lorem [<del>ipsum dolor</del> sit.](http://example.com)`;
      assert.strictEqual((0, _toMarkdown.default)(html), output);
    });
    (0, _qunit.test)("converts code tags", function (assert) {
      let html = `Lorem ipsum dolor sit amet,
  <pre><code>var helloWorld = () => {
  alert('    hello \t\t world    ');
    return;
}
helloWorld();</code></pre>
  consectetur.`;
      let output = `Lorem ipsum dolor sit amet,\n\n\`\`\`\nvar helloWorld = () => {\n  alert('    hello \t\t world    ');\n    return;\n}\nhelloWorld();\n\`\`\`\n\nconsectetur.`;
      assert.strictEqual((0, _toMarkdown.default)(html), output);
      html = `Lorem ipsum dolor sit amet, <code>var helloWorld = () => {
  alert('    hello \t\t world    ');
    return;
}
helloWorld();</code>consectetur.`;
      output = `Lorem ipsum dolor sit amet, \`var helloWorld = () => {\n  alert('    hello \t\t world    ');\n    return;\n}\nhelloWorld();\`consectetur.`;
      assert.strictEqual((0, _toMarkdown.default)(html), output);
    });
    (0, _qunit.test)("converts blockquote tag", function (assert) {
      let html = "<blockquote>Lorem ipsum</blockquote>";
      let output = "> Lorem ipsum";
      assert.strictEqual((0, _toMarkdown.default)(html), output);
      html = "<blockquote>Lorem ipsum</blockquote><blockquote><p>dolor sit amet</p></blockquote>";
      output = "> Lorem ipsum\n\n> dolor sit amet";
      assert.strictEqual((0, _toMarkdown.default)(html), output);
      html = "<blockquote>\nLorem ipsum\n<blockquote><p>dolor <blockquote>sit</blockquote> amet</p></blockquote></blockquote>";
      output = "> Lorem ipsum\n> > dolor\n> > > sit\n> > amet";
      assert.strictEqual((0, _toMarkdown.default)(html), output);
    });
    (0, _qunit.test)("converts ol list tag", function (assert) {
      const html = `Testing
    <ol>
      <li>Item 1</li>
      <li>
        Item 2
        <ol start="100">
          <li>Sub Item 1</li>
          <li>Sub Item 2</li>
        </ol>
      </li>
      <li>Item 3</li>
    </ol>
    `;
      const markdown = `Testing\n\n1. Item 1\n2. Item 2\n  100. Sub Item 1\n  101. Sub Item 2\n3. Item 3`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
    });
    (0, _qunit.test)("converts list tag from word", function (assert) {
      const html = `Sample<!--StartFragment-->
    <p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;mso-list:l0 level1 lfo1'>
      <![if !supportLists]>
      <span style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:  Symbol;mso-bidi-font-weight:bold'>
        <span style='mso-list:Ignore'>
          <span style='font:7.0pt "Times New Roman"'> </span>
        </span>
      </span>
      <![endif]>
      <b>Item 1
        <o:p></o:p>
      </b>
    </p>
    <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l0 level2 lfo1'>
      <![if !supportLists]>
      <span style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:  Symbol;mso-bidi-font-style:italic'>
        <span style='mso-list:Ignore'>
          <span style='font:7.0pt "Times New Roman"'> </span>
        </span>
      </span>
      <![endif]>
      <i>Item 2
        <o:p></o:p>
      </i>
    </p>
    <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l0 level3 lfo1'>
      <![if !supportLists]>
      <span style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:  Symbol'>
        <span style='mso-list:Ignore'>
          <span style='font:7.0pt "Times New Roman"'> </span>
        </span>
      </span>
      <![endif]>Item 3 </p>
    <p class=MsoListParagraphCxSpLast style='text-indent:-.25in;mso-list:l0 level1 lfo1'>
      <![if !supportLists]>
      <span style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:  Symbol'>
        <span style='mso-list:Ignore'>
          <span style='font:7.0pt "Times New Roman"'> </span>
        </span>
      </span>
      <![endif]>Item 4</p>
    <!--EndFragment-->List`;
      const markdown = `Sample\n\n* **Item 1**\n  * *Item 2*\n    * Item 3\n* Item 4\n\nList`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
    });
    (0, _qunit.test)("keeps mention/hash class", function (assert) {
      const html = `
      <p>User mention: <a class="mention" href="/u/discourse">@discourse</a></p>
      <p>Group mention: <a class="mention-group" href="/groups/discourse">@discourse-group</a></p>
      <p>Category link: <a class="hashtag" href="/c/foo/1">#<span>foo</span></a></p>
      <p>Sub-category link: <a class="hashtag" href="/c/foo/bar/2">#<span>foo:bar</span></a></p>
    `;
      const markdown = `User mention: @discourse\n\nGroup mention: @discourse-group\n\nCategory link: #foo\n\nSub-category link: #foo:bar`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
    });
    (0, _qunit.test)("keeps emoji and removes click count", function (assert) {
      const html = `
      <p>
        A <a href="http://example.com">link</a><span class="badge badge-notification clicks" title="1 click">1</span> with click count
        and <img class="emoji" title=":boom:" src="https://d11a6trkgmumsb.cloudfront.net/images/emoji/twitter/boom.png?v=5" alt=":boom:" /> emoji.
      </p>
    `;
      const markdown = `A [link](http://example.com) with click count and :boom: emoji.`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
    });
    (0, _qunit.test)("keeps emoji syntax for custom emoji", function (assert) {
      const html = `
      <p>
        <img class="emoji emoji-custom" title=":custom_emoji:" src="https://d11a6trkgmumsb.cloudfront.net/images/emoji/custom_emoji" alt=":custom_emoji:" />
      </p>
    `;
      const markdown = `:custom_emoji:`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
    });
    (0, _qunit.test)("converts image lightboxes to markdown", function (assert) {
      let html = `
    <a class="lightbox" href="https://d11a6trkgmumsb.cloudfront.net/uploads/default/original/1X/8hkjhk7692f6afed3cb99d43ab2abd4e30aa8cba.jpeg" data-download-href="https://d11a6trkgmumsb.cloudfront.net/uploads/default/8hkjhk7692f6afed3cb99d43ab2abd4e30aa8cba" title="sherlock3_sig.jpg" rel="nofollow noopener"><img src="https://d11a6trkgmumsb.cloudfront.net/uploads/default/optimized/1X/8hkjhk7692f6afed3cb99d43ab2abd4e30aa8cba_2_689x459.jpeg" alt="sherlock3_sig" width="689" height="459" class="d-lazyload" srcset="https://d11a6trkgmumsb.cloudfront.net/uploads/default/optimized/1X/8hkjhk7692f6afed3cb99d43ab2abd4e30aa8cba_2_689x459.jpeg, https://d11a6trkgmumsb.cloudfront.net/uploads/default/optimized/1X/8hkjhk7692f6afed3cb99d43ab2abd4e30aa8cba_2_1033x688.jpeg 1.5x, https://d11a6trkgmumsb.cloudfront.net/uploads/default/optimized/1X/8hkjhk7692f6afed3cb99d43ab2abd4e30aa8cba_2_1378x918.jpeg 2x"><div class="meta">
    <span class="filename">sherlock3_sig.jpg</span><span class="informations">54963664 2 MB</span><span class="expand"></span>
    </div></a>
    `;
      let markdown = `![sherlock3_sig.jpg](https://d11a6trkgmumsb.cloudfront.net/uploads/default/original/1X/8hkjhk7692f6afed3cb99d43ab2abd4e30aa8cba.jpeg)`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
      html = `<a class="lightbox" href="https://d11a6trkgmumsb.cloudfront.net/uploads/default/original/1X/8hkjhk7692f6afed3cb99d43ab2abd4e30aa8cba.jpeg" data-download-href="https://d11a6trkgmumsb.cloudfront.net/uploads/default/8hkjhk7692f6afed3cb99d43ab2abd4e30aa8cba" title="sherlock3_sig.jpg" rel="nofollow noopener"><img src="https://d11a6trkgmumsb.cloudfront.net/uploads/default/optimized/1X/8hkjhk7692f6afed3cb99d43ab2abd4e30aa8cba_2_689x459.jpeg" alt="sherlock3_sig" width="689" height="459" class="d-lazyload" srcset="https://d11a6trkgmumsb.cloudfront.net/uploads/default/optimized/1X/8hkjhk7692f6afed3cb99d43ab2abd4e30aa8cba_2_689x459.jpeg, https://d11a6trkgmumsb.cloudfront.net/uploads/default/optimized/1X/8hkjhk7692f6afed3cb99d43ab2abd4e30aa8cba_2_1033x688.jpeg 1.5x, https://d11a6trkgmumsb.cloudfront.net/uploads/default/optimized/1X/8hkjhk7692f6afed3cb99d43ab2abd4e30aa8cba_2_1378x918.jpeg 2x"></a>`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
      html = `
    <a class="lightbox" href="https://d11a6trkgmumsb.cloudfront.net/uploads/default/original/1X/8hkjhk7692f6afed3cb99d43ab2abd4e30aa8cba.jpeg" data-download-href="https://d11a6trkgmumsb.cloudfront.net/uploads/default/8hkjhk7692f6afed3cb99d43ab2abd4e30aa8cba" title="sherlock3_sig.jpg" rel="nofollow noopener"><img src="https://d11a6trkgmumsb.cloudfront.net/uploads/default/optimized/1X/8hkjhk7692f6afed3cb99d43ab2abd4e30aa8cba_2_689x459.jpeg" data-base62-sha1="1frsimI7TOtFJyD2LLyKSHM8JWe" alt="sherlock3_sig" width="689" height="459" class="d-lazyload" srcset="https://d11a6trkgmumsb.cloudfront.net/uploads/default/optimized/1X/8hkjhk7692f6afed3cb99d43ab2abd4e30aa8cba_2_689x459.jpeg, https://d11a6trkgmumsb.cloudfront.net/uploads/default/optimized/1X/8hkjhk7692f6afed3cb99d43ab2abd4e30aa8cba_2_1033x688.jpeg 1.5x, https://d11a6trkgmumsb.cloudfront.net/uploads/default/optimized/1X/8hkjhk7692f6afed3cb99d43ab2abd4e30aa8cba_2_1378x918.jpeg 2x"><div class="meta">
    <span class="filename">sherlock3_sig.jpg</span><span class="informations">54963664 2 MB</span><span class="expand"></span>
    </div></a>
    `;
      markdown = `![sherlock3_sig.jpg](upload://1frsimI7TOtFJyD2LLyKSHM8JWe)`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown);
    });
    (0, _qunit.test)("converts quotes to markdown", function (assert) {
      let html = `
    <p>there is a quote below</p>
    <aside class="quote no-group" data-username="foo" data-post="1" data-topic="2">
    <div class="title" style="cursor: pointer;">
    <div class="quote-controls"><span class="svg-icon-title" title="expand/collapse"><svg class="fa d-icon d-icon-chevron-down svg-icon svg-string" xmlns="http://www.w3.org/2000/svg"><use href="#chevron-down"></use></svg></span><a href="/t/hello-world-i-am-posting-an-image/158/1" title="go to the quoted post" class="back"><svg class="fa d-icon d-icon-arrow-up svg-icon svg-string" xmlns="http://www.w3.org/2000/svg"><use href="#arrow-up"></use></svg></a></div>
    <img alt="" width="20" height="20" src="" class="avatar"> foo:</div>
    <blockquote>
    <p>this is a quote</p>
    </blockquote>
    </aside>
    <p>there is a quote above</p>
    `;
      let markdown = `
there is a quote below

[quote="foo, post:1, topic:2"]
this is a quote
[/quote]

there is a quote above
`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown.trim());
    });
    (0, _qunit.test)("converts nested quotes to markdown", function (assert) {
      let html = `
      <aside class="quote no-group">
        <blockquote>
          <aside class="quote no-group">
            <blockquote>
              <p dir="ltr">test</p>
            </blockquote>
          </aside>
          <p dir="ltr">test2</p>
        </blockquote>
      </aside>
    `;
      let markdown = `
[quote]
[quote]
test
[/quote]

test2
[/quote]
`;
      assert.strictEqual((0, _toMarkdown.default)(html), markdown.trim());
    });
    (0, _qunit.test)("strips base64 image URLs", function (assert) {
      const html = '<img src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAgAAZABkAAD/7AARRHVja3kAAQAEAAAAPAAA/+4AJkFkb2JlAGTAAAAAAQMAFQQDBgoNAAABywAAAgsAAAJpAAACyf/bAIQABgQEBAUEBgUFBgkGBQYJCwgGBggLDAoKCwoKDBAMDAwMDAwQDA4PEA8ODBMTFBQTExwbGxscHx8fHx8fHx8fHwEHBwcNDA0YEBAYGhURFRofHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8f/8IAEQgAEAAQAwERAAIRAQMRAf/EAJQAAQEBAAAAAAAAAAAAAAAAAAMFBwEAAwEAAAAAAAAAAAAAAAAAAAEDAhAAAQUBAQAAAAAAAAAAAAAAAgABAwQFESARAAIBAwIHAAAAAAAAAAAAAAERAgAhMRIDQWGRocEiIxIBAAAAAAAAAAAAAAAAAAAAIBMBAAMAAQQDAQAAAAAAAAAAAQARITHwQVGBYXGR4f/aAAwDAQACEQMRAAAB0UlMciEJn//aAAgBAQABBQK5bGtFn6pWi2K12wWTRkjb/9oACAECAAEFAvH/2gAIAQMAAQUCIuIJOqRndRiv/9oACAECAgY/Ah//2gAIAQMCBj8CH//aAAgBAQEGPwLWQzwHepfNbcUNfM4tUIbA9QL4AvnxTlAxacpWJReOlf/aAAgBAQMBPyHZDveuCyu4B4lz2lDKto2ca5uclPK0aoq32x8xgTSLeSgbyzT65n//2gAIAQIDAT8hlQjP/9oACAEDAwE/IaE9GcZFJ//aAAwDAQACEQMRAAAQ5F//2gAIAQEDAT8Q1oowKccI3KTdAWkPLw2ssIrwKYUzuJoUJsIHOCoG23ISlja+rU9QvCx//9oACAECAwE/EAuNIiKf/9oACAEDAwE/ECujJzHf7iwHOv5NhK+8efH50z//2Q==" />';
      assert.strictEqual((0, _toMarkdown.default)(html), "[image]");
    });
    (0, _qunit.test)("addTagDecorateCallback", function (assert) {
      const html = `<span class="loud">HELLO THERE</span>`;
      (0, _toMarkdown.addTagDecorateCallback)(function (text) {
        if (this.element.attributes.class === "loud") {
          this.prefix = "^^";
          this.suffix = "^^";
          return text.toLowerCase();
        }
      });
      assert.strictEqual((0, _toMarkdown.default)(html), "^^hello there^^");
    });
    (0, _qunit.test)("addBlockDecorateCallback", function (assert) {
      const html = `<div class="quiet">hey<br>there</div>`;
      (0, _toMarkdown.addBlockDecorateCallback)(function () {
        if (this.element.attributes.class === "quiet") {
          this.prefix = "[quiet]";
          this.suffix = "[/quiet]";
        }
      });
      assert.strictEqual((0, _toMarkdown.default)(html), "[quiet]hey\nthere[/quiet]");
    });
  });
});
define("discourse/tests/unit/lib/upload-short-url-test", ["pretty-text/upload-short-url", "qunit", "discourse/tests/helpers/create-pretender", "discourse/lib/ajax", "discourse/tests/helpers/qunit-helpers", "@ember/test-helpers"], function (_uploadShortUrl, _qunit, _createPretender, _ajax, _qunitHelpers, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"pretty-text/upload-short-url",0,"qunit",0,"discourse/tests/helpers/create-pretender",0,"discourse/lib/ajax",0,"discourse/tests/helpers/qunit-helpers",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  function stubUrls(imageSrcs, attachmentSrcs, otherMediaSrcs) {
    if (!imageSrcs) {
      imageSrcs = [{
        short_url: "upload://a.jpeg",
        url: "/images/avatar.png?a",
        short_path: "/uploads/short-url/a.jpeg"
      }, {
        short_url: "upload://b.jpeg",
        url: "/images/avatar.png?b",
        short_path: "/uploads/short-url/b.jpeg"
      }, {
        short_url: "upload://z.jpeg",
        url: "/images/avatar.png?z",
        short_path: "/uploads/short-url/z.jpeg"
      }];
    }

    if (!attachmentSrcs) {
      attachmentSrcs = [{
        short_url: "upload://c.pdf",
        url: "/uploads/default/original/3X/c/b/3.pdf",
        short_path: "/uploads/short-url/c.pdf"
      }];
    }

    if (!otherMediaSrcs) {
      otherMediaSrcs = [{
        short_url: "upload://d.mp4",
        url: "/uploads/default/original/3X/c/b/4.mp4",
        short_path: "/uploads/short-url/d.mp4"
      }, {
        short_url: "upload://e.mp3",
        url: "/uploads/default/original/3X/c/b/5.mp3",
        short_path: "/uploads/short-url/e.mp3"
      }, {
        short_url: "upload://f.mp4",
        url: "http://localhost:3000/uploads/default/original/3X/c/b/6.mp4",
        short_path: "/uploads/short-url/f.mp4"
      }];
    }

    _createPretender.default.post("/uploads/lookup-urls", () => (0, _createPretender.response)(imageSrcs.concat(attachmentSrcs.concat(otherMediaSrcs))));

    (0, _qunitHelpers.fixture)().innerHTML = imageSrcs.map(src => `<img data-orig-src="${src.short_url}"/>`).join("") + attachmentSrcs.map(src => `<a data-orig-href="${src.short_url}">big enterprise contract.pdf</a>`).join("") + `<div class="scoped-area"><img data-orig-src="${imageSrcs[2].url}"></div>` + otherMediaSrcs.map(src => {
      if (src.short_url.includes("mp3")) {
        return `<audio controls><source data-orig-src="${src.short_url}"></audio>`;
      } else {
        return `<video controls><source data-orig-src="${src.short_url}"></video>`;
      }
    }).join("");
  }

  (0, _qunit.module)("Unit | Utility | pretty-text/upload-short-url", function (hooks) {
    hooks.afterEach(function () {
      (0, _uploadShortUrl.resetCache)();
    });
    (0, _qunit.test)("resolveAllShortUrls", async function (assert) {
      stubUrls();
      let lookup;
      lookup = (0, _uploadShortUrl.lookupCachedUploadUrl)("upload://a.jpeg");
      assert.deepEqual(lookup, {});
      await (0, _uploadShortUrl.resolveAllShortUrls)(_ajax.ajax, {
        secure_media: false
      }, (0, _qunitHelpers.fixture)());
      await (0, _testHelpers.settled)();
      lookup = (0, _uploadShortUrl.lookupCachedUploadUrl)("upload://a.jpeg");
      assert.deepEqual(lookup, {
        url: "/images/avatar.png?a",
        short_path: "/uploads/short-url/a.jpeg"
      });
      lookup = (0, _uploadShortUrl.lookupCachedUploadUrl)("upload://b.jpeg");
      assert.deepEqual(lookup, {
        url: "/images/avatar.png?b",
        short_path: "/uploads/short-url/b.jpeg"
      });
      lookup = (0, _uploadShortUrl.lookupCachedUploadUrl)("upload://c.jpeg");
      assert.deepEqual(lookup, {});
      lookup = (0, _uploadShortUrl.lookupCachedUploadUrl)("upload://c.pdf");
      assert.deepEqual(lookup, {
        url: "/uploads/default/original/3X/c/b/3.pdf",
        short_path: "/uploads/short-url/c.pdf"
      });
      lookup = (0, _uploadShortUrl.lookupCachedUploadUrl)("upload://d.mp4");
      assert.deepEqual(lookup, {
        url: "/uploads/default/original/3X/c/b/4.mp4",
        short_path: "/uploads/short-url/d.mp4"
      });
      lookup = (0, _uploadShortUrl.lookupCachedUploadUrl)("upload://e.mp3");
      assert.deepEqual(lookup, {
        url: "/uploads/default/original/3X/c/b/5.mp3",
        short_path: "/uploads/short-url/e.mp3"
      });
      lookup = (0, _uploadShortUrl.lookupCachedUploadUrl)("upload://f.mp4");
      assert.deepEqual(lookup, {
        url: "http://localhost:3000/uploads/default/original/3X/c/b/6.mp4",
        short_path: "/uploads/short-url/f.mp4"
      });
    });
    (0, _qunit.test)("resolveAllShortUrls - href + src replaced correctly", async function (assert) {
      stubUrls();
      await (0, _uploadShortUrl.resolveAllShortUrls)(_ajax.ajax, {
        secure_media: false
      }, (0, _qunitHelpers.fixture)());
      await (0, _testHelpers.settled)();
      let image1 = (0, _qunitHelpers.fixture)().querySelector("img");
      let image2 = (0, _qunitHelpers.fixture)().querySelectorAll("img")[1];
      let audio = (0, _qunitHelpers.fixture)().querySelector("audio");
      let video = (0, _qunitHelpers.fixture)().querySelector("video");
      let link = (0, _qunitHelpers.fixture)().querySelector("a");
      assert.strictEqual(image1.getAttribute("src"), "/images/avatar.png?a");
      assert.strictEqual(image2.getAttribute("src"), "/images/avatar.png?b");
      assert.strictEqual(link.getAttribute("href"), "/uploads/short-url/c.pdf");
      assert.strictEqual(video.querySelector("source").getAttribute("src"), "/uploads/default/original/3X/c/b/4.mp4");
      assert.strictEqual(audio.querySelector("source").getAttribute("src"), "/uploads/default/original/3X/c/b/5.mp3");
    });
    (0, _qunit.test)("resolveAllShortUrls - url with full origin replaced correctly", async function (assert) {
      stubUrls();
      await (0, _uploadShortUrl.resolveAllShortUrls)(_ajax.ajax, {
        secure_media: false
      }, (0, _qunitHelpers.fixture)());
      await (0, _testHelpers.settled)();
      let video = (0, _qunitHelpers.fixture)().querySelectorAll("video")[1];
      assert.strictEqual(video.querySelector("source").getAttribute("src"), "http://localhost:3000/uploads/default/original/3X/c/b/6.mp4");
    });
    (0, _qunit.test)("resolveAllShortUrls - when secure media is enabled use the attachment full URL", async function (assert) {
      stubUrls(null, [{
        short_url: "upload://c.pdf",
        url: "/secure-media-uploads/default/original/3X/c/b/3.pdf",
        short_path: "/uploads/short-url/c.pdf"
      }], null);
      await (0, _uploadShortUrl.resolveAllShortUrls)(_ajax.ajax, {
        secure_media: true
      }, (0, _qunitHelpers.fixture)());
      await (0, _testHelpers.settled)();
      let link = (0, _qunitHelpers.fixture)().querySelector("a");
      assert.strictEqual(link.getAttribute("href"), "/secure-media-uploads/default/original/3X/c/b/3.pdf");
    });
    (0, _qunit.test)("resolveAllShortUrls - scoped", async function (assert) {
      stubUrls();
      let lookup;
      let scopedElement = (0, _qunitHelpers.fixture)().querySelector(".scoped-area");
      await (0, _uploadShortUrl.resolveAllShortUrls)(_ajax.ajax, {}, scopedElement);
      await (0, _testHelpers.settled)();
      lookup = (0, _uploadShortUrl.lookupCachedUploadUrl)("upload://z.jpeg");
      assert.deepEqual(lookup, {
        url: "/images/avatar.png?z",
        short_path: "/uploads/short-url/z.jpeg"
      }); // do this because the pretender caches ALL the urls, not
      // just the ones being looked up (like the normal behaviour)

      (0, _uploadShortUrl.resetCache)();
      await (0, _uploadShortUrl.resolveAllShortUrls)(_ajax.ajax, {}, scopedElement);
      await (0, _testHelpers.settled)();
      lookup = (0, _uploadShortUrl.lookupCachedUploadUrl)("upload://a.jpeg");
      assert.deepEqual(lookup, {});
    });
  });
});
define("discourse/tests/unit/lib/uploads-test", ["discourse/lib/utilities", "discourse/lib/uploads", "I18n", "discourse/models/user", "bootbox", "discourse/tests/helpers/qunit-helpers", "sinon", "qunit"], function (Utilities, _uploads, _I18n, _user, _bootbox, _qunitHelpers, _sinon, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/lib/utilities",0,"discourse/lib/uploads",0,"I18n",0,"discourse/models/user",0,"bootbox",0,"discourse/tests/helpers/qunit-helpers",0,"sinon",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Utility | uploads", function () {
    (0, _qunit.test)("validateUploadedFiles", function (assert) {
      assert.notOk((0, _uploads.validateUploadedFiles)(null, {
        siteSettings: this.siteSettings
      }), "no files are invalid");
      assert.notOk((0, _uploads.validateUploadedFiles)(undefined, {
        siteSettings: this.siteSettings
      }), "undefined files are invalid");
      assert.notOk((0, _uploads.validateUploadedFiles)([], {
        siteSettings: this.siteSettings
      }), "empty array of files is invalid");
    });
    (0, _qunit.test)("uploading one file", function (assert) {
      _sinon.default.stub(_bootbox.default, "alert");

      assert.notOk((0, _uploads.validateUploadedFiles)([1, 2], {
        siteSettings: this.siteSettings
      }));
      assert.ok(_bootbox.default.alert.calledWith(_I18n.default.t("post.errors.too_many_uploads")));
    });
    (0, _qunit.test)("new user cannot upload images", function (assert) {
      this.siteSettings.newuser_max_embedded_media = 0;

      _sinon.default.stub(_bootbox.default, "alert");

      assert.notOk((0, _uploads.validateUploadedFiles)([{
        name: "image.png"
      }], {
        user: _user.default.create(),
        siteSettings: this.siteSettings
      }), "the upload is not valid");
      assert.ok(_bootbox.default.alert.calledWith(_I18n.default.t("post.errors.image_upload_not_allowed_for_new_user")), "the alert is called");
    });
    (0, _qunit.test)("new user can upload images if allowed", function (assert) {
      this.siteSettings.newuser_max_embedded_media = 1;
      this.siteSettings.default_trust_level = 0;

      _sinon.default.stub(_bootbox.default, "alert");

      assert.ok((0, _uploads.validateUploadedFiles)([{
        name: "image.png"
      }], {
        user: _user.default.create(),
        siteSettings: this.siteSettings
      }));
    });
    (0, _qunit.test)("TL1 can upload images", function (assert) {
      this.siteSettings.newuser_max_embedded_media = 0;

      _sinon.default.stub(_bootbox.default, "alert");

      assert.ok((0, _uploads.validateUploadedFiles)([{
        name: "image.png"
      }], {
        user: _user.default.create({
          trust_level: 1
        }),
        siteSettings: this.siteSettings
      }));
    });
    (0, _qunit.test)("new user cannot upload attachments", function (assert) {
      this.siteSettings.newuser_max_attachments = 0;

      _sinon.default.stub(_bootbox.default, "alert");

      assert.notOk((0, _uploads.validateUploadedFiles)([{
        name: "roman.txt"
      }], {
        user: _user.default.create(),
        siteSettings: this.siteSettings
      }));
      assert.ok(_bootbox.default.alert.calledWith(_I18n.default.t("post.errors.attachment_upload_not_allowed_for_new_user")));
    });
    (0, _qunit.test)("ensures an authorized upload", function (assert) {
      _sinon.default.stub(_bootbox.default, "alert");

      assert.notOk((0, _uploads.validateUploadedFiles)([{
        name: "unauthorized.html"
      }], {
        siteSettings: this.siteSettings
      }));
      assert.ok(_bootbox.default.alert.calledWith(_I18n.default.t("post.errors.upload_not_authorized", {
        authorized_extensions: (0, _uploads.authorizedExtensions)(false, this.siteSettings).join(", ")
      })));
    });
    (0, _qunit.test)("skipping validation works", function (assert) {
      const files = [{
        name: "backup.tar.gz"
      }];

      _sinon.default.stub(_bootbox.default, "alert");

      assert.notOk((0, _uploads.validateUploadedFiles)(files, {
        skipValidation: false,
        siteSettings: this.siteSettings
      }));
      assert.ok((0, _uploads.validateUploadedFiles)(files, {
        skipValidation: true,
        siteSettings: this.siteSettings
      }));
    });
    (0, _qunit.test)("staff can upload anything in PM", function (assert) {
      const files = [{
        name: "some.docx"
      }];
      this.siteSettings.authorized_extensions = "jpeg";

      _sinon.default.stub(_bootbox.default, "alert");

      let user = _user.default.create({
        moderator: true
      });

      assert.notOk((0, _uploads.validateUploadedFiles)(files, {
        user,
        siteSettings: this.siteSettings
      }));
      assert.ok((0, _uploads.validateUploadedFiles)(files, {
        isPrivateMessage: true,
        allowStaffToUploadAnyFileInPm: true,
        siteSettings: this.siteSettings,
        user
      }));
    });
    const imageSize = 10 * 1024;

    const dummyBlob = function () {
      const BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;

      if (BlobBuilder) {
        let bb = new BlobBuilder();
        bb.append([new Int8Array(imageSize)]);
        return bb.getBlob("image/png");
      } else {
        return new Blob([new Int8Array(imageSize)], {
          type: "image/png"
        });
      }
    };

    (0, _qunit.test)("allows valid uploads to go through", function (assert) {
      _sinon.default.stub(_bootbox.default, "alert");

      let user = _user.default.create({
        trust_level: 1
      }); // image


      let image = {
        name: "image.png",
        size: imageSize
      };
      assert.ok((0, _uploads.validateUploadedFiles)([image], {
        user,
        siteSettings: this.siteSettings
      })); // pasted image

      let pastedImage = dummyBlob();
      assert.ok((0, _uploads.validateUploadedFiles)([pastedImage], {
        user,
        siteSettings: this.siteSettings
      }));
      assert.notOk(_bootbox.default.alert.calledOnce);
    });
    (0, _qunit.test)("isImage", function (assert) {
      ["png", "webp", "jpg", "jpeg", "gif", "ico"].forEach(extension => {
        let image = "image." + extension;
        assert.ok((0, _uploads.isImage)(image), image + " is recognized as an image");
        assert.ok((0, _uploads.isImage)("http://foo.bar/path/to/" + image), image + " is recognized as an image");
      });
      assert.notOk((0, _uploads.isImage)("file.txt"));
      assert.notOk((0, _uploads.isImage)("http://foo.bar/path/to/file.txt"));
      assert.notOk((0, _uploads.isImage)(""));
    });
    (0, _qunit.test)("allowsImages", function (assert) {
      this.siteSettings.authorized_extensions = "jpg|jpeg|gif";
      assert.ok((0, _uploads.allowsImages)(false, this.siteSettings), "works");
      this.siteSettings.authorized_extensions = ".jpg|.jpeg|.gif";
      assert.ok((0, _uploads.allowsImages)(false, this.siteSettings), "works with old extensions syntax");
      this.siteSettings.authorized_extensions = "txt|pdf|*";
      assert.ok((0, _uploads.allowsImages)(false, this.siteSettings), "images are allowed when all extensions are allowed");
      this.siteSettings.authorized_extensions = "json|jpg|pdf|txt";
      assert.ok((0, _uploads.allowsImages)(false, this.siteSettings), "images are allowed when at least one extension is an image extension");
    });
    (0, _qunit.test)("allowsAttachments", function (assert) {
      this.siteSettings.authorized_extensions = "jpg|jpeg|gif";
      assert.notOk((0, _uploads.allowsAttachments)(false, this.siteSettings), "no attachments allowed by default");
      this.siteSettings.authorized_extensions = "jpg|jpeg|gif|*";
      assert.ok((0, _uploads.allowsAttachments)(false, this.siteSettings), "attachments are allowed when all extensions are allowed");
      this.siteSettings.authorized_extensions = "jpg|jpeg|gif|pdf";
      assert.ok((0, _uploads.allowsAttachments)(false, this.siteSettings), "attachments are allowed when at least one extension is not an image extension");
      this.siteSettings.authorized_extensions = ".jpg|.jpeg|.gif|.pdf";
      assert.ok((0, _uploads.allowsAttachments)(false, this.siteSettings), "works with old extensions syntax");
    });

    function testUploadMarkdown(filename) {
      let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      return (0, _uploads.getUploadMarkdown)(Object.assign({
        original_filename: filename,
        filesize: 42,
        thumbnail_width: 100,
        thumbnail_height: 200,
        url: "/uploads/123/abcdef.ext"
      }, opts));
    }

    (0, _qunit.test)("getUploadMarkdown", function (assert) {
      assert.strictEqual(testUploadMarkdown("lolcat.gif"), "![lolcat|100x200](/uploads/123/abcdef.ext)");
      assert.strictEqual(testUploadMarkdown("[foo|bar].png"), "![foobar|100x200](/uploads/123/abcdef.ext)");
      assert.strictEqual(testUploadMarkdown("file name with space.png"), "![file name with space|100x200](/uploads/123/abcdef.ext)");
      assert.strictEqual(testUploadMarkdown("image.file.name.with.dots.png"), "![image.file.name.with.dots|100x200](/uploads/123/abcdef.ext)");
      const short_url = "uploads://asdaasd.ext";
      assert.strictEqual(testUploadMarkdown("important.txt", {
        short_url
      }), `[important.txt|attachment](${short_url}) (42 Bytes)`);
    });
    (0, _qunit.test)("getUploadMarkdown - replaces GUID in image alt text on iOS", function (assert) {
      assert.strictEqual(testUploadMarkdown("8F2B469B-6B2C-4213-BC68-57B4876365A0.jpeg"), "![8F2B469B-6B2C-4213-BC68-57B4876365A0|100x200](/uploads/123/abcdef.ext)");

      _sinon.default.stub(Utilities, "isAppleDevice").returns(true);

      assert.strictEqual(testUploadMarkdown("8F2B469B-6B2C-4213-BC68-57B4876365A0.jpeg"), "![image|100x200](/uploads/123/abcdef.ext)");
    });
    (0, _qunit.test)("displayErrorForUpload - jquery file upload - jqXHR present", function (assert) {
      _sinon.default.stub(_bootbox.default, "alert");

      (0, _uploads.displayErrorForUpload)({
        jqXHR: {
          status: 422,
          responseJSON: {
            message: "upload failed"
          }
        }
      }, {
        max_attachment_size_kb: 1024,
        max_image_size_kb: 1024
      }, "test.png");
      assert.ok(_bootbox.default.alert.calledWith("upload failed"), "the alert is called");
    });
    (0, _qunit.test)("displayErrorForUpload - jquery file upload - jqXHR missing, errors present", function (assert) {
      _sinon.default.stub(_bootbox.default, "alert");

      (0, _uploads.displayErrorForUpload)({
        errors: ["upload failed"]
      }, {
        max_attachment_size_kb: 1024,
        max_image_size_kb: 1024
      }, "test.png");
      assert.ok(_bootbox.default.alert.calledWith("upload failed"), "the alert is called");
    });
    (0, _qunit.test)("displayErrorForUpload - jquery file upload - no errors", function (assert) {
      _sinon.default.stub(_bootbox.default, "alert");

      (0, _uploads.displayErrorForUpload)({}, {
        max_attachment_size_kb: 1024,
        max_image_size_kb: 1024
      }, "test.png");
      assert.ok(_bootbox.default.alert.calledWith(_I18n.default.t("post.errors.upload")), "the alert is called");
    });
    (0, _qunit.test)("displayErrorForUpload - uppy - with response status and body", function (assert) {
      _sinon.default.stub(_bootbox.default, "alert");

      (0, _uploads.displayErrorForUpload)({
        status: 422,
        body: {
          message: "upload failed"
        }
      }, "test.png", {
        max_attachment_size_kb: 1024,
        max_image_size_kb: 1024
      });
      assert.ok(_bootbox.default.alert.calledWith("upload failed"), "the alert is called");
    });
  });
});
define("discourse/tests/unit/lib/uppy-checksum-plugin-test", ["discourse/lib/uppy-checksum-plugin", "qunit", "discourse/tests/helpers/qunit-helpers", "sinon"], function (_uppyChecksumPlugin, _qunit, _qunitHelpers, _sinon) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/lib/uppy-checksum-plugin",0,"qunit",0,"discourse/tests/helpers/qunit-helpers",0,"sinon"eaimeta@70e063a35619d71f

  class FakeUppy {
    constructor() {
      this.preprocessors = [];
      this.emitted = [];
      this.files = {
        "uppy-test/file/vv2/xvejg5w/blah/png-1d-1d-2v-1d-1e-image/jpeg-9043429-1624921727764": {
          meta: {},
          data: (0, _qunitHelpers.createFile)("test1.png", "image/png", "testblobdata1"),
          size: 1024
        },
        "uppy-test/file/blah1/ads37x2/blah1/png-1d-1d-2v-1d-1e-image/jpeg-99999-1837921727764": {
          meta: {},
          data: (0, _qunitHelpers.createFile)("test2.png", "image/png", "testblobdata2"),
          size: 2048
        },
        "uppy-test/file/mnb3/jfhrg43x/blah3/png-1d-1d-2v-1d-1e-image/jpeg-111111-1837921727764": {
          meta: {},
          data: (0, _qunitHelpers.createFile)("test2.png", "image/png", "testblobdata2"),
          size: 209715200
        }
      };
    }

    addPreProcessor(fn) {
      this.preprocessors.push(fn);
    }

    getFile(id) {
      return this.files[id];
    }

    emit(event, file, data) {
      this.emitted.push({
        event,
        file,
        data
      });
    }

    setFileMeta(fileId, meta) {
      this.files[fileId].meta = meta;
    }

  }

  let withCrypto = window.crypto.subtle ? _qunit.test : _qunit.skip;
  (0, _qunit.module)("Unit | Utility | UppyChecksum Plugin", function () {
    (0, _qunit.test)("sets the options passed in", function (assert) {
      const capabilities = {};
      const fakeUppy = new FakeUppy();
      const plugin = new _uppyChecksumPlugin.default(fakeUppy, {
        capabilities
      });
      assert.strictEqual(plugin.id, "uppy-checksum");
      assert.strictEqual(plugin.capabilities, capabilities);
    });
    withCrypto("it does nothing if not running in a secure context", function (assert) {
      const capabilities = {};
      const fakeUppy = new FakeUppy();
      const plugin = new _uppyChecksumPlugin.default(fakeUppy, {
        capabilities
      });
      plugin.install();

      _sinon.default.stub(plugin, "_secureContext").returns(false);

      const fileId = "uppy-test/file/vv2/xvejg5w/blah/png-1d-1d-2v-1d-1e-image/jpeg-9043429-1624921727764";
      return plugin.uppy.preprocessors[0]([fileId]).then(() => {
        assert.strictEqual(plugin.uppy.emitted.length, 1, "only the complete event was fired by the checksum plugin because it skipped the file");
      });
    });
    withCrypto("it does nothing if the crypto object + cipher is not available", function (assert) {
      const capabilities = {};
      const fakeUppy = new FakeUppy();
      const plugin = new _uppyChecksumPlugin.default(fakeUppy, {
        capabilities
      });
      plugin.install();

      _sinon.default.stub(plugin, "_hasCryptoCipher").returns(false);

      const fileId = "uppy-test/file/vv2/xvejg5w/blah/png-1d-1d-2v-1d-1e-image/jpeg-9043429-1624921727764";
      return plugin.uppy.preprocessors[0]([fileId]).then(() => {
        assert.strictEqual(plugin.uppy.emitted.length, 1, "only the complete event was fired by the checksum plugin because it skipped the file");
      });
    });
    (0, _qunit.test)("it does nothing if the browser is IE11", function (assert) {
      const capabilities = {
        isIE11: true
      };
      const fakeUppy = new FakeUppy();
      const plugin = new _uppyChecksumPlugin.default(fakeUppy, {
        capabilities
      });
      plugin.install();
      const fileId = "uppy-test/file/vv2/xvejg5w/blah/png-1d-1d-2v-1d-1e-image/jpeg-9043429-1624921727764";
      return plugin.uppy.preprocessors[0]([fileId]).then(() => {
        assert.strictEqual(plugin.uppy.emitted.length, 1, "only the complete event was fired by the checksum plugin because it skipped the file");
      });
    });
    withCrypto("it does nothing if the file is > 100MB", function (assert) {
      const capabilities = {};
      const fakeUppy = new FakeUppy();
      const plugin = new _uppyChecksumPlugin.default(fakeUppy, {
        capabilities
      });
      plugin.install();
      const fileId = "uppy-test/file/mnb3/jfhrg43x/blah3/png-1d-1d-2v-1d-1e-image/jpeg-111111-1837921727764";
      return plugin.uppy.preprocessors[0]([fileId]).then(() => {
        assert.strictEqual(plugin.uppy.emitted[0].event, "preprocess-progress");
        assert.strictEqual(plugin.uppy.emitted[1].event, "preprocess-complete");
        assert.strictEqual(plugin.uppy.getFile(fileId).meta.sha1_checksum, undefined);
      });
    });
    withCrypto("it gets a sha1 hash of each file and adds it to the file meta", function (assert) {
      const capabilities = {};
      const fakeUppy = new FakeUppy();
      const plugin = new _uppyChecksumPlugin.default(fakeUppy, {
        capabilities
      });
      plugin.install();
      const fileIds = ["uppy-test/file/vv2/xvejg5w/blah/png-1d-1d-2v-1d-1e-image/jpeg-9043429-1624921727764", "uppy-test/file/blah1/ads37x2/blah1/png-1d-1d-2v-1d-1e-image/jpeg-99999-1837921727764"];
      return plugin.uppy.preprocessors[0](fileIds).then(() => {
        assert.strictEqual(plugin.uppy.emitted[0].event, "preprocess-progress");
        assert.strictEqual(plugin.uppy.emitted[1].event, "preprocess-progress");
        assert.strictEqual(plugin.uppy.emitted[2].event, "preprocess-complete");
        assert.strictEqual(plugin.uppy.emitted[3].event, "preprocess-complete"); // these checksums are the actual SHA1 hashes of the test file names

        assert.strictEqual(plugin.uppy.getFile(fileIds[0]).meta.sha1_checksum, "2aa31a700d084c78cecbf030b041ad63eb4f6e8a");
        assert.strictEqual(plugin.uppy.getFile(fileIds[1]).meta.sha1_checksum, "dfa8c725a5a6710ce4467f29655ec9d26a8de3d0");
      });
    });
    withCrypto("it does nothing if the window.crypto.subtle.digest function throws an error / rejects", function (assert) {
      const capabilities = {};
      const fakeUppy = new FakeUppy();
      const plugin = new _uppyChecksumPlugin.default(fakeUppy, {
        capabilities
      });
      plugin.install();
      const fileIds = ["uppy-test/file/vv2/xvejg5w/blah/png-1d-1d-2v-1d-1e-image/jpeg-9043429-1624921727764", "uppy-test/file/blah1/ads37x2/blah1/png-1d-1d-2v-1d-1e-image/jpeg-99999-1837921727764"];

      _sinon.default.stub(window.crypto.subtle, "digest").rejects({
        message: "Algorithm: Unrecognized name"
      });

      return plugin.uppy.preprocessors[0](fileIds).then(() => {
        assert.strictEqual(plugin.uppy.emitted[0].event, "preprocess-progress");
        assert.strictEqual(plugin.uppy.emitted[1].event, "preprocess-progress");
        assert.strictEqual(plugin.uppy.emitted[2].event, "preprocess-complete");
        assert.strictEqual(plugin.uppy.emitted[3].event, "preprocess-complete");
        assert.deepEqual(plugin.uppy.getFile(fileIds[0]).meta, {});
        assert.deepEqual(plugin.uppy.getFile(fileIds[1]).meta, {});
      });
    });
  });
});
define("discourse/tests/unit/lib/uppy-media-optimization-plugin-test", ["discourse/lib/uppy-media-optimization-plugin", "qunit"], function (_uppyMediaOptimizationPlugin, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/lib/uppy-media-optimization-plugin",0,"qunit"eaimeta@70e063a35619d71f

  class FakeUppy {
    constructor() {
      this.preprocessors = [];
      this.emitted = [];
      this.files = {
        "uppy-test/file/vv2/xvejg5w/blah/jpg-1d-1d-2v-1d-1e-image/jpeg-9043429-1624921727764": {
          data: "old file state"
        },
        "uppy-test/file/blah1/ads37x2/blah1/jpg-1d-1d-2v-1d-1e-image/jpeg-99999-1837921727764": {
          data: "old file state 1"
        }
      };
    }

    addPreProcessor(fn) {
      this.preprocessors.push(fn);
    }

    getFile(id) {
      return this.files[id];
    }

    emit(event, file, data) {
      this.emitted.push({
        event,
        file,
        data
      });
    }

    setFileState(fileId, state) {
      this.files[fileId] = state;
    }

  }

  (0, _qunit.module)("Unit | Utility | UppyMediaOptimization Plugin", function () {
    (0, _qunit.test)("sets the options passed in", function (assert) {
      const fakeUppy = new FakeUppy();
      const plugin = new _uppyMediaOptimizationPlugin.default(fakeUppy, {
        runParallel: true,
        optimizeFn: function () {
          return "wow such optimized";
        }
      });
      assert.strictEqual(plugin.id, "uppy-media-optimization");
      assert.strictEqual(plugin.runParallel, true);
      assert.strictEqual(plugin.optimizeFn(), "wow such optimized");
    });
    (0, _qunit.test)("installation uses the correct function", function (assert) {
      const fakeUppy = new FakeUppy();
      const plugin = new _uppyMediaOptimizationPlugin.default(fakeUppy, {
        runParallel: true
      });
      Object.defineProperty(plugin, "_optimizeParallel", {
        value: () => "using parallel"
      });
      Object.defineProperty(plugin, "_optimizeSerial", {
        value: () => "using serial"
      });
      plugin.install();
      assert.strictEqual(plugin.uppy.preprocessors[0](), "using parallel");
      plugin.runParallel = false;
      plugin.uppy.preprocessors = [];
      plugin.install();
      assert.strictEqual(plugin.uppy.preprocessors[0](), "using serial");
    });
    (0, _qunit.test)("sets the file state when successfully optimizing the file and emits events", function (assert) {
      const fakeUppy = new FakeUppy();
      const plugin = new _uppyMediaOptimizationPlugin.default(fakeUppy, {
        runParallel: true,
        optimizeFn: async () => "new file state"
      });
      plugin.install();
      const done = assert.async();
      const fileId = "uppy-test/file/vv2/xvejg5w/blah/jpg-1d-1d-2v-1d-1e-image/jpeg-9043429-1624921727764";
      plugin.uppy.preprocessors[0]([fileId]).then(() => {
        assert.strictEqual(plugin.uppy.emitted[0].event, "preprocess-progress");
        assert.strictEqual(plugin.uppy.emitted[1].event, "preprocess-complete");
        assert.strictEqual(plugin.uppy.getFile(fileId).data, "new file state");
        done();
      });
    });
    (0, _qunit.test)("handles optimizer errors gracefully by leaving old file state and calling preprocess-complete", function (assert) {
      const fakeUppy = new FakeUppy();
      const plugin = new _uppyMediaOptimizationPlugin.default(fakeUppy, {
        runParallel: true,
        optimizeFn: async () => {
          throw new Error("bad stuff");
        }
      });
      plugin.install();
      const done = assert.async();
      const fileId = "uppy-test/file/vv2/xvejg5w/blah/jpg-1d-1d-2v-1d-1e-image/jpeg-9043429-1624921727764";
      plugin.uppy.preprocessors[0]([fileId]).then(() => {
        assert.strictEqual(plugin.uppy.emitted[0].event, "preprocess-progress");
        assert.strictEqual(plugin.uppy.emitted[1].event, "preprocess-complete");
        assert.strictEqual(plugin.uppy.getFile(fileId).data, "old file state");
        done();
      });
    });
    (0, _qunit.test)("handles serial file optimization successfully", function (assert) {
      const fakeUppy = new FakeUppy();
      const plugin = new _uppyMediaOptimizationPlugin.default(fakeUppy, {
        runParallel: false,
        optimizeFn: async () => "new file state"
      });
      plugin.install();
      const done = assert.async();
      const fileIds = ["uppy-test/file/vv2/xvejg5w/blah/jpg-1d-1d-2v-1d-1e-image/jpeg-9043429-1624921727764", "uppy-test/file/blah1/ads37x2/blah1/jpg-1d-1d-2v-1d-1e-image/jpeg-99999-1837921727764"];
      plugin.uppy.preprocessors[0](fileIds).then(() => {
        assert.strictEqual(plugin.uppy.emitted[0].event, "preprocess-progress");
        assert.strictEqual(plugin.uppy.emitted[1].event, "preprocess-complete");
        assert.strictEqual(plugin.uppy.emitted[2].event, "preprocess-progress");
        assert.strictEqual(plugin.uppy.emitted[3].event, "preprocess-complete");
        assert.strictEqual(plugin.uppy.getFile(fileIds[0]).data, "new file state");
        assert.strictEqual(plugin.uppy.getFile(fileIds[1]).data, "new file state");
        done();
      });
    });
    (0, _qunit.test)("handles parallel file optimization successfully", function (assert) {
      const fakeUppy = new FakeUppy();
      const plugin = new _uppyMediaOptimizationPlugin.default(fakeUppy, {
        runParallel: true,
        optimizeFn: async () => "new file state"
      });
      plugin.install();
      const done = assert.async();
      const fileIds = ["uppy-test/file/vv2/xvejg5w/blah/jpg-1d-1d-2v-1d-1e-image/jpeg-9043429-1624921727764", "uppy-test/file/blah1/ads37x2/blah1/jpg-1d-1d-2v-1d-1e-image/jpeg-99999-1837921727764"];
      plugin.uppy.preprocessors[0](fileIds).then(() => {
        assert.strictEqual(plugin.uppy.emitted[0].event, "preprocess-progress");
        assert.strictEqual(plugin.uppy.emitted[1].event, "preprocess-progress");
        assert.strictEqual(plugin.uppy.emitted[2].event, "preprocess-complete");
        assert.strictEqual(plugin.uppy.emitted[3].event, "preprocess-complete");
        assert.strictEqual(plugin.uppy.getFile(fileIds[0]).data, "new file state");
        assert.strictEqual(plugin.uppy.getFile(fileIds[1]).data, "new file state");
        done();
      });
    });
  });
});
define("discourse/tests/unit/lib/url-test", ["discourse/lib/url", "qunit", "discourse/models/user", "discourse/tests/helpers/qunit-helpers", "discourse-common/lib/get-url", "sinon"], function (_url, _qunit, _user, _qunitHelpers, _getUrl, _sinon) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/lib/url",0,"qunit",0,"discourse/models/user",0,"discourse/tests/helpers/qunit-helpers",0,"discourse-common/lib/get-url",0,"sinon"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | url", function () {
    (0, _qunit.test)("isInternal with a HTTP url", function (assert) {
      _sinon.default.stub(_url.default, "origin").returns("http://eviltrout.com");

      assert.notOk(_url.default.isInternal(null), "a blank URL is not internal");
      assert.ok(_url.default.isInternal("/test"), "relative URLs are internal");
      assert.ok(_url.default.isInternal("//eviltrout.com"), "a url on the same host is internal (protocol-less)");
      assert.ok(_url.default.isInternal("http://eviltrout.com/tophat"), "a url on the same host is internal");
      assert.ok(_url.default.isInternal("https://eviltrout.com/moustache"), "a url on a HTTPS of the same host is internal");
      assert.notOk(_url.default.isInternal("//twitter.com.com"), "a different host is not internal (protocol-less)");
      assert.notOk(_url.default.isInternal("http://twitter.com"), "a different host is not internal");
    });
    (0, _qunit.test)("isInternal with a HTTPS url", function (assert) {
      _sinon.default.stub(_url.default, "origin").returns("https://eviltrout.com");

      assert.ok(_url.default.isInternal("http://eviltrout.com/monocle"), "HTTPS urls match HTTP urls");
    });
    (0, _qunit.test)("isInternal on subfolder install", function (assert) {
      _sinon.default.stub(_url.default, "origin").returns("http://eviltrout.com/forum");

      assert.notOk(_url.default.isInternal("http://eviltrout.com"), "the host root is not internal");
      assert.notOk(_url.default.isInternal("http://eviltrout.com/tophat"), "a url on the same host but on a different folder is not internal");
      assert.ok(_url.default.isInternal("http://eviltrout.com/forum/moustache"), "a url on the same host and on the same folder is internal");
    });
    (0, _qunit.test)("userPath", function (assert) {
      assert.strictEqual((0, _url.userPath)(), "/u");
      assert.strictEqual((0, _url.userPath)("eviltrout"), "/u/eviltrout");
    });
    (0, _qunit.test)("userPath with prefix", function (assert) {
      (0, _getUrl.setPrefix)("/forum");
      assert.strictEqual((0, _url.userPath)(), "/forum/u");
      assert.strictEqual((0, _url.userPath)("eviltrout"), "/forum/u/eviltrout");
    });
    (0, _qunit.test)("routeTo with prefix", async function (assert) {
      (0, _getUrl.setPrefix)("/forum");
      (0, _qunitHelpers.logIn)();

      const user = _user.default.current();

      _sinon.default.stub(_url.default, "router").get(() => {
        return {
          currentURL: "/forum"
        };
      });

      _sinon.default.stub(_url.default, "handleURL");

      _url.default.routeTo("/my/messages");

      assert.ok(_url.default.handleURL.calledWith(`/u/${user.username}/messages`), "it should navigate to the messages page");
    });
    (0, _qunit.test)("prefixProtocol", async function (assert) {
      assert.strictEqual((0, _url.prefixProtocol)("mailto:mr-beaver@aol.com"), "mailto:mr-beaver@aol.com");
      assert.strictEqual((0, _url.prefixProtocol)("discourse.org"), "https://discourse.org");
      assert.strictEqual((0, _url.prefixProtocol)("www.discourse.org"), "https://www.discourse.org");
      assert.strictEqual((0, _url.prefixProtocol)("www.discourse.org/mailto:foo"), "https://www.discourse.org/mailto:foo");
    });
    (0, _qunit.test)("getCategoryAndTagUrl", function (assert) {
      assert.strictEqual((0, _url.getCategoryAndTagUrl)({
        path: "/c/foo/1",
        default_list_filter: "all"
      }, true), "/c/foo/1");
      assert.strictEqual((0, _url.getCategoryAndTagUrl)({
        path: "/c/foo/1",
        default_list_filter: "all"
      }, false), "/c/foo/1/none");
      assert.strictEqual((0, _url.getCategoryAndTagUrl)({
        path: "/c/foo/1",
        default_list_filter: "none"
      }, true), "/c/foo/1/all");
      assert.strictEqual((0, _url.getCategoryAndTagUrl)({
        path: "/c/foo/1",
        default_list_filter: "none"
      }, false), "/c/foo/1");
    });
    (0, _qunit.test)("routeTo redirects secure media URLS because they are server side only", async function (assert) {
      _sinon.default.stub(_url.default, "redirectTo");

      _sinon.default.stub(_url.default, "handleURL");

      _url.default.routeTo("/secure-media-uploads/original/1X/test.pdf");

      assert.ok(_url.default.redirectTo.calledWith("/secure-media-uploads/original/1X/test.pdf"));
    });
  });
});
define("discourse/tests/unit/lib/user-search-test", ["qunit", "discourse/tests/helpers/create-pretender", "discourse/lib/autocomplete", "discourse/lib/user-search"], function (_qunit, _createPretender, _autocomplete, _userSearch) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/create-pretender",0,"discourse/lib/autocomplete",0,"discourse/lib/user-search"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Utility | user-search", function (hooks) {
    hooks.beforeEach(function () {
      _createPretender.default.get("/u/search/users", request => {
        // special responder for per category search
        const categoryMatch = request.url.match(/category_id=([0-9]+)/);

        if (categoryMatch) {
          if (categoryMatch[1] === "3") {
            return (0, _createPretender.response)({});
          }

          return (0, _createPretender.response)({
            users: [{
              username: `category_${categoryMatch[1]}`,
              name: "category user",
              avatar_template: "https://avatars.discourse.org/v3/letter/t/41988e/{size}.png"
            }]
          });
        }

        if (request.url.match(/no-results/)) {
          return (0, _createPretender.response)({
            users: []
          });
        }

        return (0, _createPretender.response)({
          users: [{
            username: "TeaMoe",
            name: "TeaMoe",
            avatar_template: "https://avatars.discourse.org/v3/letter/t/41988e/{size}.png"
          }, {
            username: "TeamOneJ",
            name: "J Cobb",
            avatar_template: "https://avatars.discourse.org/v3/letter/t/3d9bf3/{size}.png"
          }, {
            username: "kudos",
            name: "Team Blogeto.com",
            avatar_template: "/user_avatar/meta.discourse.org/kudos/{size}/62185_1.png"
          }, {
            username: "RosieLinda",
            name: "Linda Teaman",
            avatar_template: "https://avatars.discourse.org/v3/letter/r/bc8723/{size}.png"
          }, {
            username: "legalatom",
            name: "Team LegalAtom",
            avatar_template: "https://avatars.discourse.org/v3/letter/l/a9a28c/{size}.png"
          }, {
            username: "dzsat_team",
            name: "Dz Sat Dz Sat",
            avatar_template: "https://avatars.discourse.org/v3/letter/d/eb9ed0/{size}.png"
          }],
          groups: [{
            name: "bob",
            usernames: []
          }, {
            name: "team",
            usernames: []
          }]
        });
      });
    });
    (0, _qunit.test)("it flushes cache when switching categories", async function (assert) {
      let results = await (0, _userSearch.default)({
        term: "hello",
        categoryId: 1
      });
      assert.strictEqual(results[0].username, "category_1");
      assert.strictEqual(results.length, 1); // this is cached ... so let's check the cache is good

      results = await (0, _userSearch.default)({
        term: "hello",
        categoryId: 1
      });
      assert.strictEqual(results[0].username, "category_1");
      assert.strictEqual(results.length, 1);
      results = await (0, _userSearch.default)({
        term: "hello",
        categoryId: 2
      });
      assert.strictEqual(results[0].username, "category_2");
      assert.strictEqual(results.length, 1);
    });
    (0, _qunit.test)("it returns cancel when eager completing with no results", async function (assert) {
      // Do everything twice, to check the cache works correctly
      for (let i = 0; i < 2; i++) {
        // No topic or category, will always cancel
        let result = await (0, _userSearch.default)({
          term: ""
        });
        assert.strictEqual(result, _autocomplete.CANCELLED_STATUS);
      }

      for (let i = 0; i < 2; i++) {
        // Unsecured category, so has no recommendations
        let result = await (0, _userSearch.default)({
          term: "",
          categoryId: 3
        });
        assert.strictEqual(result, _autocomplete.CANCELLED_STATUS);
      }

      for (let i = 0; i < 2; i++) {
        // Secured category, will have 1 recommendation
        let results = await (0, _userSearch.default)({
          term: "",
          categoryId: 1
        });
        assert.strictEqual(results[0].username, "category_1");
        assert.strictEqual(results.length, 1);
      }
    });
    (0, _qunit.test)("it places groups unconditionally for exact match", async function (assert) {
      let results = await (0, _userSearch.default)({
        term: "Team"
      });
      assert.strictEqual(results[results.length - 1]["name"], "team");
    });
    (0, _qunit.test)("it strips @ from the beginning", async function (assert) {
      let results = await (0, _userSearch.default)({
        term: "@Team"
      });
      assert.strictEqual(results[results.length - 1]["name"], "team");
    });
    (0, _qunit.test)("it skips a search depending on punctuation", async function (assert) {
      let results;
      let skippedTerms = ["@sam  s", // double space is not allowed
      "@sam;", "@sam,", "@sam:"];

      for (let term of skippedTerms) {
        results = await (0, _userSearch.default)({
          term
        });
        assert.strictEqual(results.length, 0);
      }

      let allowedTerms = ["@sam sam", // double space is not allowed
      "@sam.sam", "@sam_sam", "@sam-sam", "@"];
      let topicId = 100;

      for (let term of allowedTerms) {
        results = await (0, _userSearch.default)({
          term,
          topicId
        });
        assert.strictEqual(results.length, 6);
      }

      results = await (0, _userSearch.default)({
        term: "sam@sam.com",
        allowEmails: true
      }); // 6 + email

      assert.strictEqual(results.length, 7);
      results = await (0, _userSearch.default)({
        term: "sam+test@sam.com",
        allowEmails: true
      });
      assert.strictEqual(results.length, 7);
      results = await (0, _userSearch.default)({
        term: "sam@sam.com"
      });
      assert.strictEqual(results.length, 0);
      results = await (0, _userSearch.default)({
        term: "no-results@example.com",
        allowEmails: true
      });
      assert.strictEqual(results.length, 1);
    });
  });
});
define("discourse/tests/unit/lib/utilities-test", ["rsvp", "discourse/lib/utilities", "sinon", "qunit", "handlebars", "discourse/tests/helpers/qunit-helpers"], function (_rsvp, _utilities, _sinon, _qunit, _handlebars, _qunitHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"rsvp",0,"discourse/lib/utilities",0,"sinon",0,"qunit",0,"handlebars",0,"discourse/tests/helpers/qunit-helpers"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Utilities", function () {
    (0, _qunit.test)("escapeExpression", function (assert) {
      assert.strictEqual((0, _utilities.escapeExpression)(">"), "&gt;", "escapes unsafe characters");
      assert.strictEqual((0, _utilities.escapeExpression)(new _handlebars.default.SafeString("&gt;")), "&gt;", "does not double-escape safe strings");
      assert.strictEqual((0, _utilities.escapeExpression)(undefined), "", "returns a falsy string when given a falsy value");
    });
    (0, _qunit.test)("emailValid", function (assert) {
      assert.ok((0, _utilities.emailValid)("Bob@example.com"), "allows upper case in the first part of emails");
      assert.ok((0, _utilities.emailValid)("bob@EXAMPLE.com"), "allows upper case in the email domain");
    });
    (0, _qunit.test)("extractDomainFromUrl", function (assert) {
      assert.strictEqual((0, _utilities.extractDomainFromUrl)("http://meta.discourse.org:443/random"), "meta.discourse.org", "extract domain name from url");
      assert.strictEqual((0, _utilities.extractDomainFromUrl)("meta.discourse.org:443/random"), "meta.discourse.org", "extract domain regardless of scheme presence");
      assert.strictEqual((0, _utilities.extractDomainFromUrl)("http://192.168.0.1:443/random"), "192.168.0.1", "works for IP address");
      assert.strictEqual((0, _utilities.extractDomainFromUrl)("http://localhost:443/random"), "localhost", "works for localhost");
    });
    (0, _qunit.test)("avatarUrl", function (assert) {
      let rawSize = _utilities.getRawSize;
      assert.blank((0, _utilities.avatarUrl)("", "tiny"), "no template returns blank");
      assert.strictEqual((0, _utilities.avatarUrl)("/fake/template/{size}.png", "tiny"), "/fake/template/" + rawSize(20) + ".png", "simple avatar url");
      assert.strictEqual((0, _utilities.avatarUrl)("/fake/template/{size}.png", "large"), "/fake/template/" + rawSize(45) + ".png", "different size");
    });

    let setDevicePixelRatio = function (value) {
      if (Object.defineProperty && !window.hasOwnProperty("devicePixelRatio")) {
        Object.defineProperty(window, "devicePixelRatio", {
          value: 2
        });
      } else {
        window.devicePixelRatio = value;
      }
    };

    (0, _qunit.test)("avatarImg", function (assert) {
      let oldRatio = window.devicePixelRatio;
      setDevicePixelRatio(2);
      let avatarTemplate = "/path/to/avatar/{size}.png";
      assert.strictEqual((0, _utilities.avatarImg)({
        avatarTemplate,
        size: "tiny"
      }), "<img loading='lazy' alt='' width='20' height='20' src='/path/to/avatar/40.png' class='avatar'>", "it returns the avatar html");
      assert.strictEqual((0, _utilities.avatarImg)({
        avatarTemplate,
        size: "tiny",
        title: "evilest trout"
      }), "<img loading='lazy' alt='' width='20' height='20' src='/path/to/avatar/40.png' class='avatar' title='evilest trout' aria-label='evilest trout'>", "it adds a title if supplied");
      assert.strictEqual((0, _utilities.avatarImg)({
        avatarTemplate,
        size: "tiny",
        extraClasses: "evil fish"
      }), "<img loading='lazy' alt='' width='20' height='20' src='/path/to/avatar/40.png' class='avatar evil fish'>", "it adds extra classes if supplied");
      assert.blank((0, _utilities.avatarImg)({
        avatarTemplate: "",
        size: "tiny"
      }), "it doesn't render avatars for invalid avatar template");
      setDevicePixelRatio(oldRatio);
    });
    (0, _qunit.test)("defaultHomepage via meta tag", function (assert) {
      let meta = document.createElement("meta");
      meta.name = "discourse_current_homepage";
      meta.content = "hot";
      document.body.appendChild(meta);
      (0, _utilities.initializeDefaultHomepage)(this.siteSettings);
      assert.strictEqual((0, _utilities.defaultHomepage)(), "hot", "default homepage is pulled from <meta name=discourse_current_homepage>");
      document.body.removeChild(meta);
    });
    (0, _qunit.test)("defaultHomepage via site settings", function (assert) {
      this.siteSettings.top_menu = "top|latest|hot";
      (0, _utilities.initializeDefaultHomepage)(this.siteSettings);
      assert.strictEqual((0, _utilities.defaultHomepage)(), "top", "default homepage is the first item in the top_menu site setting");
    });
    (0, _qunit.test)("setDefaultHomepage", function (assert) {
      (0, _utilities.initializeDefaultHomepage)(this.siteSettings);
      assert.strictEqual((0, _utilities.defaultHomepage)(), "latest");
      (0, _utilities.setDefaultHomepage)("top");
      assert.strictEqual((0, _utilities.defaultHomepage)(), "top");
    });
    (0, _qunit.test)("caretRowCol", function (assert) {
      let textarea = document.createElement("textarea");
      const content = document.createTextNode("01234\n56789\n012345");
      textarea.appendChild(content);
      document.body.appendChild(textarea);

      const assertResult = (setCaretPos, expectedRowNum, expectedColNum) => {
        (0, _utilities.setCaretPosition)(textarea, setCaretPos);
        const result = (0, _utilities.caretRowCol)(textarea);
        assert.strictEqual(result.rowNum, expectedRowNum, "returns the right row of the caret");
        assert.strictEqual(result.colNum, expectedColNum, "returns the right col of the caret");
      };

      assertResult(0, 1, 0);
      assertResult(5, 1, 5);
      assertResult(6, 2, 0);
      assertResult(11, 2, 5);
      assertResult(14, 3, 2);
      document.body.removeChild(textarea);
    });
    (0, _qunit.test)("toAsciiPrintable", function (assert) {
      const accentedString = "Crme_Brle!";
      const unicodeString = "";
      assert.strictEqual((0, _utilities.toAsciiPrintable)(accentedString, "discourse"), "Creme_Brulee!", "it replaces accented characters with the appropriate ASCII equivalent");
      assert.strictEqual((0, _utilities.toAsciiPrintable)(unicodeString, "discourse"), "discourse", "it uses the fallback string when unable to convert");
      assert.strictEqual(typeof (0, _utilities.toAsciiPrintable)(unicodeString), "undefined", "it returns undefined when unable to convert and no fallback is provided");
    });
    (0, _qunit.test)("slugify", function (assert) {
      const asciiString = "--- 0__( Some-cool Discourse Site! )__0 --- ";
      const accentedString = "Crme_Brle!";
      const unicodeString = "";
      assert.strictEqual((0, _utilities.slugify)(asciiString), "0-some-cool-discourse-site-0", "it properly slugifies an ASCII string");
      assert.strictEqual((0, _utilities.slugify)(accentedString), "crme-brle", "it removes accented characters");
      assert.strictEqual((0, _utilities.slugify)(unicodeString), "", "it removes unicode characters");
    });
    (0, _qunit.test)("fillMissingDates", function (assert) {
      const startDate = "2017-11-12"; // YYYY-MM-DD

      const endDate = "2017-12-12"; // YYYY-MM-DD

      const data = '[{"x":"2017-11-12","y":3},{"x":"2017-11-27","y":2},{"x":"2017-12-06","y":9},{"x":"2017-12-11","y":2}]';
      assert.strictEqual((0, _utilities.fillMissingDates)(JSON.parse(data), startDate, endDate).length, 31, "it returns a JSON array with 31 dates");
    });
    (0, _qunit.test)("inCodeBlock", function (assert) {
      const texts = [// closed code blocks
      "000\n\n    111\n\n000", "000 `111` 000", "000\n```\n111\n```\n000", "000\n[code]111[/code]\n000", // open code blocks
      "000\n\n    111", "000 `111", "000\n```\n111", "000\n[code]111", // complex test
      "000\n\n```\n111\n```\n\n000\n\n`111 111`\n\n000\n\n[code]\n111\n[/code]\n\n    111\n\t111\n\n000`111"];
      texts.forEach(text => {
        for (let i = 0; i < text.length; ++i) {
          if (text[i] === "0" || text[i] === "1") {
            assert.strictEqual((0, _utilities.inCodeBlock)(text, i), text[i] === "1");
          }
        }
      });
    });
  });
  (0, _qunitHelpers.discourseModule)("Unit | Utilities | clipboard", function (hooks) {
    let mockClipboard;
    hooks.beforeEach(function () {
      mockClipboard = {
        writeText: _sinon.default.stub().resolves(true),
        write: _sinon.default.stub().resolves(true)
      };

      _sinon.default.stub(window.navigator, "clipboard").get(() => mockClipboard);
    });

    function getPromiseFunction() {
      return () => new _rsvp.Promise(resolve => {
        resolve(new Blob(["some text to copy"], {
          type: "text/plain"
        }));
      });
    }

    (0, _qunit.test)("clipboardCopyAsync - browser does not support window.ClipboardItem", async function (assert) {
      // without this check the stubbing will fail on Firefox
      if (window.ClipboardItem) {
        _sinon.default.stub(window, "ClipboardItem").value(null);
      }

      await (0, _utilities.clipboardCopyAsync)(getPromiseFunction());
      assert.strictEqual(mockClipboard.writeText.calledWith("some text to copy"), true, "it writes to the clipboard using writeText instead of write");
    });
    (0, _qunitHelpers.chromeTest)("clipboardCopyAsync - browser does support window.ClipboardItem", async function (assert) {
      await (0, _utilities.clipboardCopyAsync)(getPromiseFunction());
      assert.strictEqual(mockClipboard.write.called, true, "it writes to the clipboard using write");
    });
  });
});
define("discourse/tests/unit/localization-test", ["qunit", "I18n", "discourse/initializers/localization", "@ember/test-helpers"], function (_qunit, _I18n, _localization, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"I18n",0,"discourse/initializers/localization",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunit.module)("initializer:localization", {
    _locale: _I18n.default.locale,
    _translations: _I18n.default.translations,
    _extras: _I18n.default.extras,
    _compiledMFs: _I18n.default._compiledMFs,
    _overrides: _I18n.default._overrides,
    _mfOverrides: _I18n.default._mfOverrides,

    beforeEach() {
      _I18n.default.locale = "fr";
      _I18n.default.translations = {
        fr: {
          js: {
            composer: {
              both_languages1: "composer.both_languages1 (FR)",
              both_languages2: "composer.both_languages2 (FR)"
            }
          }
        },
        en: {
          js: {
            composer: {
              both_languages1: "composer.both_languages1 (EN)",
              both_languages2: "composer.both_languages2 (EN)",
              only_english1: "composer.only_english1 (EN)",
              only_english2: "composer.only_english2 (EN)"
            }
          }
        }
      };
      _I18n.default._compiledMFs = {
        "user.messages.some_key_MF": () => "user.messages.some_key_MF (FR)"
      };
      _I18n.default.extras = {
        fr: {
          admin: {
            api: {
              both_languages1: "admin.api.both_languages1 (FR)",
              both_languages2: "admin.api.both_languages2 (FR)"
            }
          }
        },
        en: {
          admin: {
            api: {
              both_languages1: "admin.api.both_languages1 (EN)",
              both_languages2: "admin.api.both_languages2 (EN)",
              only_english1: "admin.api.only_english1 (EN)",
              only_english2: "admin.api.only_english2 (EN)"
            }
          }
        }
      };
    },

    afterEach() {
      _I18n.default.locale = this._locale;
      _I18n.default.translations = this._translations;
      _I18n.default.extras = this._extras;
      _I18n.default._compiledMFs = this._compiledMFs;
      _I18n.default._overrides = this._overrides;
      _I18n.default._mfOverrides = this._mfOverrides;
    }

  });
  (0, _qunit.test)("translation overrides", function (assert) {
    _I18n.default._overrides = {
      fr: {
        "js.composer.both_languages1": "composer.both_languages1 (FR override)",
        "js.composer.only_english2": "composer.only_english2 (FR override)"
      },
      en: {
        "js.composer.both_languages2": "composer.both_languages2 (EN override)",
        "js.composer.only_english1": "composer.only_english1 (EN override)"
      }
    };

    _localization.default.initialize((0, _testHelpers.getApplication)());

    assert.strictEqual(_I18n.default.t("composer.both_languages1"), "composer.both_languages1 (FR override)", "overrides existing translation in current locale");
    assert.strictEqual(_I18n.default.t("composer.only_english1"), "composer.only_english1 (EN override)", "overrides translation in fallback locale");
    assert.strictEqual(_I18n.default.t("composer.only_english2"), "composer.only_english2 (FR override)", "overrides translation that doesn't exist in current locale");
    assert.strictEqual(_I18n.default.t("composer.both_languages2"), "composer.both_languages2 (FR)", "prefers translation in current locale over override in fallback locale");
  });
  (0, _qunit.test)("translation overrides (admin_js)", function (assert) {
    _I18n.default._overrides = {
      fr: {
        "admin_js.api.both_languages1": "admin.api.both_languages1 (FR override)",
        "admin_js.api.only_english2": "admin.api.only_english2 (FR override)"
      },
      en: {
        "admin_js.api.both_languages2": "admin.api.both_languages2 (EN override)",
        "admin_js.api.only_english1": "admin.api.only_english1 (EN override)"
      }
    };

    _localization.default.initialize((0, _testHelpers.getApplication)());

    assert.strictEqual(_I18n.default.t("admin.api.both_languages1"), "admin.api.both_languages1 (FR override)", "overrides existing translation in current locale");
    assert.strictEqual(_I18n.default.t("admin.api.only_english1"), "admin.api.only_english1 (EN override)", "overrides translation in fallback locale");
    assert.strictEqual(_I18n.default.t("admin.api.only_english2"), "admin.api.only_english2 (FR override)", "overrides translation that doesn't exist in current locale");
    assert.strictEqual(_I18n.default.t("admin.api.both_languages2"), "admin.api.both_languages2 (FR)", "prefers translation in current locale over override in fallback locale");
  });
  (0, _qunit.test)("translation overrides for MessageFormat strings", function (assert) {
    _I18n.default._mfOverrides = {
      "js.user.messages.some_key_MF": () => "user.messages.some_key_MF (FR override)"
    };

    _localization.default.initialize((0, _testHelpers.getApplication)());

    assert.strictEqual(_I18n.default.messageFormat("user.messages.some_key_MF", {}), "user.messages.some_key_MF (FR override)", "overrides existing MessageFormat string");
  });
  (0, _qunit.test)("skip translation override if parent node is not an object", function (assert) {
    _I18n.default._overrides = {
      fr: {
        "js.composer.both_languages1.foo": "composer.both_languages1.foo (FR override)"
      }
    };

    _localization.default.initialize((0, _testHelpers.getApplication)());

    assert.strictEqual(_I18n.default.t("composer.both_languages1.foo"), "[fr.composer.both_languages1.foo]");
  });
});
define("discourse/tests/unit/mixins/grant-badge-controller-test", ["qunit", "discourse/models/badge", "@ember/controller", "discourse/mixins/grant-badge-controller"], function (_qunit, _badge, _controller, _grantBadgeController) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/models/badge",0,"@ember/controller",0,"discourse/mixins/grant-badge-controller"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Mixin | grant-badge-controller", function (hooks) {
    hooks.beforeEach(function () {
      this.GrantBadgeController = _controller.default.extend(_grantBadgeController.default);
      this.badgeFirst = _badge.default.create({
        id: 3,
        name: "A Badge",
        enabled: true,
        manually_grantable: true
      });
      this.badgeMiddle = _badge.default.create({
        id: 1,
        name: "My Badge",
        enabled: true,
        manually_grantable: true
      });
      this.badgeLast = _badge.default.create({
        id: 2,
        name: "Zoo Badge",
        enabled: true,
        manually_grantable: true
      });
      this.badgeDisabled = _badge.default.create({
        id: 4,
        name: "Disabled Badge",
        enabled: false,
        manually_grantable: true
      });
      this.badgeAutomatic = _badge.default.create({
        id: 5,
        name: "Automatic Badge",
        enabled: true,
        manually_grantable: false
      });
      this.subject = this.GrantBadgeController.create({
        userBadges: [],
        allBadges: [this.badgeLast, this.badgeFirst, this.badgeMiddle, this.badgeDisabled, this.badgeAutomatic]
      });
    });
    (0, _qunit.test)("grantableBadges", function (assert) {
      const sortedNames = [this.badgeFirst.name, this.badgeMiddle.name, this.badgeLast.name];
      const badgeNames = this.subject.get("grantableBadges").map(badge => badge.name);
      assert.notOk(badgeNames.includes(this.badgeDisabled), "excludes disabled badges");
      assert.notOk(badgeNames.includes(this.badgeAutomatic), "excludes automatic badges");
      assert.deepEqual(badgeNames, sortedNames, "sorts badges by name");
    });
    (0, _qunit.test)("selectedBadgeGrantable", function (assert) {
      this.subject.set("selectedBadgeId", this.badgeDisabled.id);
      assert.notOk(this.subject.get("selectedBadgeGrantable"));
      this.subject.set("selectedBadgeId", this.badgeFirst.id);
      assert.ok(this.subject.get("selectedBadgeGrantable"));
    });
  });
});
define("discourse/tests/unit/mixins/setting-object-test", ["qunit", "@ember/object", "admin/mixins/setting-object"], function (_qunit, _object, _settingObject) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"@ember/object",0,"admin/mixins/setting-object"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Mixin | setting-object", function () {
    (0, _qunit.test)("flat array", function (assert) {
      const FooSetting = _object.default.extend(_settingObject.default);

      const fooSettingInstance = FooSetting.create({
        valid_values: ["foo", "bar"]
      });
      assert.strictEqual(fooSettingInstance.computedValueProperty, null);
      assert.strictEqual(fooSettingInstance.computedNameProperty, null);
    });
    (0, _qunit.test)("object", function (assert) {
      const FooSetting = _object.default.extend(_settingObject.default);

      const fooSettingInstance = FooSetting.create({
        valid_values: [{
          value: "foo",
          name: "bar"
        }]
      });
      assert.strictEqual(fooSettingInstance.computedValueProperty, "value");
      assert.strictEqual(fooSettingInstance.computedNameProperty, "name");
    });
    (0, _qunit.test)("no values", function (assert) {
      const FooSetting = _object.default.extend(_settingObject.default);

      const fooSettingInstance = FooSetting.create({
        valid_values: []
      });
      assert.strictEqual(fooSettingInstance.computedValueProperty, null);
      assert.strictEqual(fooSettingInstance.computedNameProperty, null);
    });
    (0, _qunit.test)("value/name properties defined", function (assert) {
      const FooSetting = _object.default.extend(_settingObject.default);

      const fooSettingInstance = FooSetting.create({
        valueProperty: "foo",
        nameProperty: "bar",
        valid_values: []
      });
      assert.strictEqual(fooSettingInstance.computedValueProperty, "foo");
      assert.strictEqual(fooSettingInstance.computedNameProperty, "bar");
    });
  });
});
define("discourse/tests/unit/mixins/singleton-test", ["qunit", "@ember/object", "discourse/mixins/singleton"], function (_qunit, _object, _singleton) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"@ember/object",0,"discourse/mixins/singleton"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Mixin | singleton", function () {
    (0, _qunit.test)("current", function (assert) {
      let DummyModel = _object.default.extend({});

      DummyModel.reopenClass(_singleton.default);
      let current = DummyModel.current();
      assert.present(current, "current returns the current instance");
      assert.strictEqual(current, DummyModel.current(), "calling it again returns the same instance");
      assert.notStrictEqual(current, DummyModel.create({}), "we can create other instances that are not the same as current");
    });
    (0, _qunit.test)("currentProp reading", function (assert) {
      let DummyModel = _object.default.extend({});

      DummyModel.reopenClass(_singleton.default);
      let current = DummyModel.current();
      assert.blank(DummyModel.currentProp("evil"), "by default attributes are blank");
      current.set("evil", "trout");
      assert.strictEqual(DummyModel.currentProp("evil"), "trout", "after changing the instance, the value is set");
    });
    (0, _qunit.test)("currentProp writing", function (assert) {
      let DummyModel = _object.default.extend({});

      DummyModel.reopenClass(_singleton.default);
      assert.blank(DummyModel.currentProp("adventure"), "by default attributes are blank");
      let result = DummyModel.currentProp("adventure", "time");
      assert.strictEqual(result, "time", "it returns the new value");
      assert.strictEqual(DummyModel.currentProp("adventure"), "time", "after calling currentProp the value is set");
      DummyModel.currentProp("count", 0);
      assert.strictEqual(DummyModel.currentProp("count"), 0, "we can set the value to 0");
      DummyModel.currentProp("adventure", null);
      assert.strictEqual(DummyModel.currentProp("adventure"), null, "we can set the value to null");
    });
    (0, _qunit.test)("createCurrent", function (assert) {
      let Shoe = _object.default.extend({});

      Shoe.reopenClass(_singleton.default, {
        createCurrent: function () {
          return Shoe.create({
            toes: 5
          });
        }
      });
      assert.strictEqual(Shoe.currentProp("toes"), 5, "it created the class using `createCurrent`");
    });
    (0, _qunit.test)("createCurrent that returns null", function (assert) {
      let Missing = _object.default.extend({});

      Missing.reopenClass(_singleton.default, {
        createCurrent: function () {
          return null;
        }
      });
      assert.blank(Missing.current(), "it doesn't return an instance");
      assert.blank(Missing.currentProp("madeup"), "it won't raise an error asking for a property. Will just return null.");
    });
  });
});
define("discourse/tests/unit/models/badge-test", ["qunit", "discourse/models/badge"], function (_qunit, _badge) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/models/badge"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Model | badge", function () {
    (0, _qunit.test)("newBadge", function (assert) {
      const badge1 = _badge.default.create({
        name: "New Badge"
      }),
            badge2 = _badge.default.create({
        id: 1,
        name: "Old Badge"
      });

      assert.ok(badge1.get("newBadge"), "badges without ids are new");
      assert.ok(!badge2.get("newBadge"), "badges with ids are not new");
    });
    (0, _qunit.test)("createFromJson array", function (assert) {
      const badgesJson = {
        badge_types: [{
          id: 6,
          name: "Silver 1"
        }],
        badges: [{
          id: 1126,
          name: "Badge 1",
          description: null,
          badge_type_id: 6
        }]
      };

      const badges = _badge.default.createFromJson(badgesJson);

      assert.ok(Array.isArray(badges), "returns an array");
      assert.strictEqual(badges[0].get("name"), "Badge 1", "badge details are set");
      assert.strictEqual(badges[0].get("badge_type.name"), "Silver 1", "badge_type reference is set");
    });
    (0, _qunit.test)("createFromJson single", function (assert) {
      const badgeJson = {
        badge_types: [{
          id: 6,
          name: "Silver 1"
        }],
        badge: {
          id: 1126,
          name: "Badge 1",
          description: null,
          badge_type_id: 6
        }
      };

      const badge = _badge.default.createFromJson(badgeJson);

      assert.ok(!Array.isArray(badge), "does not returns an array");
    });
    (0, _qunit.test)("updateFromJson", function (assert) {
      const badgeJson = {
        badge_types: [{
          id: 6,
          name: "Silver 1"
        }],
        badge: {
          id: 1126,
          name: "Badge 1",
          description: null,
          badge_type_id: 6
        }
      };

      const badge = _badge.default.create({
        name: "Badge 1"
      });

      badge.updateFromJson(badgeJson);
      assert.strictEqual(badge.get("id"), 1126, "id is set");
      assert.strictEqual(badge.get("badge_type.name"), "Silver 1", "badge_type reference is set");
    });
    (0, _qunit.test)("save", function (assert) {
      assert.expect(0);

      const badge = _badge.default.create({
        name: "New Badge",
        description: "This is a new badge.",
        badge_type_id: 1
      });

      return badge.save(["name", "description", "badge_type_id"]);
    });
    (0, _qunit.test)("destroy", function (assert) {
      assert.expect(0);

      const badge = _badge.default.create({
        name: "New Badge",
        description: "This is a new badge.",
        badge_type_id: 1
      });

      badge.destroy();
      badge.set("id", 3);
      return badge.destroy();
    });
  });
});
define("discourse/tests/unit/models/bookmark-test", ["qunit", "discourse/models/bookmark"], function (_qunit, _bookmark) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/models/bookmark"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Model | bookmark", function () {
    (0, _qunit.test)("topicForList - Topic bookmarkable", function (assert) {
      let bookmark = _bookmark.default.create({
        id: 1,
        bookmarkable_type: "Topic",
        bookmarkable_id: 999,
        linked_post_number: null,
        topic_id: 999,
        fancy_title: "Some test topic",
        last_read_post_number: 23,
        highest_post_number: 30
      });

      assert.strictEqual(bookmark.topicForList.linked_post_number, null, "linked_post_number is null");
    });
    (0, _qunit.test)("topicForList - Post bookmarkable", function (assert) {
      let bookmark = _bookmark.default.create({
        id: 1,
        bookmarkable_type: "Post",
        bookmarkable_id: 999,
        linked_post_number: 787,
        topic_id: 999,
        fancy_title: "Some test topic",
        last_read_post_number: 23,
        highest_post_number: 30
      });

      assert.strictEqual(bookmark.topicForList.linked_post_number, 787, "linked_post_number is correct");
    });
  });
});
define("discourse/tests/unit/models/category-test", ["qunit", "discourse/models/category", "discourse/tests/helpers/create-store", "sinon"], function (_qunit, _category, _createStore, _sinon) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/models/category",0,"discourse/tests/helpers/create-store",0,"sinon"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Model | category", function () {
    (0, _qunit.test)("slugFor", function (assert) {
      const store = (0, _createStore.default)();

      const slugFor = function (cat, val, text) {
        assert.strictEqual(_category.default.slugFor(cat), val, text);
      };

      slugFor(store.createRecord("category", {
        slug: "hello"
      }), "hello", "It calculates the proper slug for hello");
      slugFor(store.createRecord("category", {
        id: 123,
        slug: ""
      }), "123-category", "It returns id-category for empty strings");
      slugFor(store.createRecord("category", {
        id: 456
      }), "456-category", "It returns id-category for undefined slugs");
      slugFor(store.createRecord("category", {
        slug: ""
      }), "", "It can be non english characters");
      const parentCategory = store.createRecord("category", {
        id: 345,
        slug: "darth"
      });
      slugFor(store.createRecord("category", {
        slug: "luke",
        parentCategory
      }), "darth/luke", "it uses the parent slug before the child");
      slugFor(store.createRecord("category", {
        id: 555,
        parentCategory
      }), "darth/555-category", "it uses the parent slug before the child and then uses id");
      parentCategory.set("slug", null);
      slugFor(store.createRecord("category", {
        id: 555,
        parentCategory
      }), "345-category/555-category", "it uses the parent before the child and uses ids for both");
    });
    (0, _qunit.test)("findBySlug", function (assert) {
      assert.expect(6);
      const store = (0, _createStore.default)();
      const darth = store.createRecord("category", {
        id: 1,
        slug: "darth"
      }),
            luke = store.createRecord("category", {
        id: 2,
        slug: "luke",
        parentCategory: darth
      }),
            hurricane = store.createRecord("category", {
        id: 3,
        slug: ""
      }),
            newsFeed = store.createRecord("category", {
        id: 4,
        slug: "",
        parentCategory: hurricane
      }),
            time = store.createRecord("category", {
        id: 5,
        slug: "",
        parentCategory: darth
      }),
            bah = store.createRecord("category", {
        id: 6,
        slug: "bah",
        parentCategory: hurricane
      }),
            categoryList = [darth, luke, hurricane, newsFeed, time, bah];

      _sinon.default.stub(_category.default, "list").returns(categoryList);

      assert.deepEqual(_category.default.findBySlug("darth"), darth, "we can find a category");
      assert.deepEqual(_category.default.findBySlug("luke", "darth"), luke, "we can find the other category with parent category");
      assert.deepEqual(_category.default.findBySlug(""), hurricane, "we can find a category with CJK slug");
      assert.deepEqual(_category.default.findBySlug("", ""), newsFeed, "we can find a category with CJK slug whose parent slug is also CJK");
      assert.deepEqual(_category.default.findBySlug("", "darth"), time, "we can find a category with CJK slug whose parent slug is english");
      assert.deepEqual(_category.default.findBySlug("bah", ""), bah, "we can find a category with english slug whose parent slug is CJK");
    });
    (0, _qunit.test)("findSingleBySlug", function (assert) {
      assert.expect(6);
      const store = (0, _createStore.default)();
      const darth = store.createRecord("category", {
        id: 1,
        slug: "darth"
      }),
            luke = store.createRecord("category", {
        id: 2,
        slug: "luke",
        parentCategory: darth
      }),
            hurricane = store.createRecord("category", {
        id: 3,
        slug: ""
      }),
            newsFeed = store.createRecord("category", {
        id: 4,
        slug: "",
        parentCategory: hurricane
      }),
            time = store.createRecord("category", {
        id: 5,
        slug: "",
        parentCategory: darth
      }),
            bah = store.createRecord("category", {
        id: 6,
        slug: "bah",
        parentCategory: hurricane
      }),
            categoryList = [darth, luke, hurricane, newsFeed, time, bah];

      _sinon.default.stub(_category.default, "list").returns(categoryList);

      assert.deepEqual(_category.default.findSingleBySlug("darth"), darth, "we can find a category");
      assert.deepEqual(_category.default.findSingleBySlug("darth/luke"), luke, "we can find the other category with parent category");
      assert.deepEqual(_category.default.findSingleBySlug(""), hurricane, "we can find a category with CJK slug");
      assert.deepEqual(_category.default.findSingleBySlug("/"), newsFeed, "we can find a category with CJK slug whose parent slug is also CJK");
      assert.deepEqual(_category.default.findSingleBySlug("darth/"), time, "we can find a category with CJK slug whose parent slug is english");
      assert.deepEqual(_category.default.findSingleBySlug("/bah"), bah, "we can find a category with english slug whose parent slug is CJK");
    });
    (0, _qunit.test)("findBySlugPathWithID", function (assert) {
      const store = (0, _createStore.default)();
      const foo = store.createRecord("category", {
        id: 1,
        slug: "foo"
      });
      const bar = store.createRecord("category", {
        id: 2,
        slug: "bar",
        parentCategory: foo
      });
      const baz = store.createRecord("category", {
        id: 3,
        slug: "baz",
        parentCategory: foo
      });
      const categoryList = [foo, bar, baz];

      _sinon.default.stub(_category.default, "list").returns(categoryList);

      assert.deepEqual(_category.default.findBySlugPathWithID("foo"), foo);
      assert.deepEqual(_category.default.findBySlugPathWithID("foo/bar"), bar);
      assert.deepEqual(_category.default.findBySlugPathWithID("foo/bar/"), bar);
      assert.deepEqual(_category.default.findBySlugPathWithID("foo/baz/3"), baz);
    });
    (0, _qunit.test)("minimumRequiredTags", function (assert) {
      const store = (0, _createStore.default)();
      let foo = store.createRecord("category", {
        id: 1,
        slug: "foo",
        required_tag_groups: [{
          name: "bar",
          min_count: 2
        }]
      });
      assert.equal(foo.minimumRequiredTags, 2);
      foo = store.createRecord("category", {
        id: 2,
        slug: "foo"
      });
      assert.equal(foo.minimumRequiredTags, null);
      foo = store.createRecord("category", {
        id: 3,
        slug: "foo",
        minimum_required_tags: 0
      });
      assert.equal(foo.minimumRequiredTags, null);
      foo = store.createRecord("category", {
        id: 4,
        slug: "foo",
        minimum_required_tags: 2
      });
      assert.equal(foo.minimumRequiredTags, 2);
      foo = store.createRecord("category", {
        id: 5,
        slug: "foo",
        required_tag_groups: []
      });
      assert.equal(foo.minimumRequiredTags, null);
    });
    (0, _qunit.test)("search with category name", function (assert) {
      const store = (0, _createStore.default)(),
            category1 = store.createRecord("category", {
        id: 1,
        name: "middle term",
        slug: "different-slug"
      }),
            category2 = store.createRecord("category", {
        id: 2,
        name: "middle term",
        slug: "another-different-slug"
      }),
            subcategory = store.createRecord("category", {
        id: 3,
        name: "middle term",
        slug: "another-different-slug2",
        parent_category_id: 2
      });

      _sinon.default.stub(_category.default, "listByActivity").returns([category1, category2, subcategory]);

      assert.deepEqual(_category.default.search("term", {
        limit: 0
      }), [], "returns an empty array when limit is 0");
      assert.deepEqual(_category.default.search(""), [category1, category2], "orders by activity if no term is matched");
      assert.deepEqual(_category.default.search("term"), [category1, category2, subcategory], "orders by activity");
      category2.set("name", "TeRm start");
      assert.deepEqual(_category.default.search("tErM"), [category2, category1, subcategory], "ignores case of category name and search term");
      category2.set("name", "term start");
      assert.deepEqual(_category.default.search("term"), [category2, category1, subcategory], "orders matching begin with and then contains");
      assert.deepEqual(_category.default.search("term", {
        parentCategoryId: 2
      }), [subcategory], "search only subcategories belonging to specific parent category");

      _sinon.default.restore();

      const child_category1 = store.createRecord("category", {
        id: 3,
        name: "term start",
        parent_category_id: category1.get("id")
      }),
            read_restricted_category = store.createRecord("category", {
        id: 4,
        name: "some term",
        read_restricted: true
      });

      _sinon.default.stub(_category.default, "listByActivity").returns([read_restricted_category, category1, child_category1, category2]);

      assert.deepEqual(_category.default.search(""), [category1, category2, read_restricted_category], "prioritize non read_restricted and does not include child categories when term is blank");
      assert.deepEqual(_category.default.search("", {
        limit: 3
      }), [category1, category2, read_restricted_category], "prioritize non read_restricted and does not include child categories categories when term is blank with limit");
      assert.deepEqual(_category.default.search("term"), [child_category1, category2, category1, read_restricted_category], "prioritize non read_restricted");
      assert.deepEqual(_category.default.search("term", {
        limit: 3
      }), [child_category1, category2, read_restricted_category], "prioritize non read_restricted with limit");
    });
    (0, _qunit.test)("search with category slug", function (assert) {
      const store = (0, _createStore.default)(),
            category1 = store.createRecord("category", {
        id: 1,
        name: "middle term",
        slug: "different-slug"
      }),
            category2 = store.createRecord("category", {
        id: 2,
        name: "middle term",
        slug: "another-different-slug"
      });

      _sinon.default.stub(_category.default, "listByActivity").returns([category1, category2]);

      assert.deepEqual(_category.default.search("different-slug"), [category1, category2], "returns the right categories");
      assert.deepEqual(_category.default.search("another-different"), [category2], "returns the right categories");
      category2.set("slug", "ANOTher-DIFfereNT");
      assert.deepEqual(_category.default.search("anOtHer-dIfFeREnt"), [category2], "ignores case of category slug and search term");
    });
  });
});
define("discourse/tests/unit/models/composer-test", ["discourse/models/composer", "discourse/tests/helpers/qunit-helpers", "discourse/services/app-events", "@ember/object", "discourse/models/post", "discourse/tests/helpers/create-store", "qunit"], function (_composer, _qunitHelpers, _appEvents, _object, _post, _createStore, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/models/composer",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/services/app-events",0,"@ember/object",0,"discourse/models/post",0,"discourse/tests/helpers/create-store",0,"qunit"eaimeta@70e063a35619d71f

  function createComposer(opts) {
    opts = opts || {};
    opts.user = opts.user || (0, _qunitHelpers.currentUser)();
    opts.appEvents = _appEvents.default.create();
    return (0, _createStore.default)().createRecord("composer", opts);
  }

  function openComposer(opts) {
    const composer = createComposer(opts);
    composer.open(opts);
    return composer;
  }

  (0, _qunitHelpers.discourseModule)("Unit | Model | composer", function () {
    (0, _qunit.test)("replyLength", function (assert) {
      const replyLength = function (val, expectedLength) {
        const composer = createComposer({
          reply: val
        });
        assert.strictEqual(composer.get("replyLength"), expectedLength);
      };

      replyLength("basic reply", 11, "basic reply length");
      replyLength(" \nbasic reply\t", 11, "trims whitespaces");
      replyLength("ba sic\n\nreply", 12, "count only significant whitespaces");
      replyLength("1[quote=]not counted[/quote]2[quote=]at all[/quote]3", 3, "removes quotes");
      replyLength("1[quote=]not[quote=]counted[/quote]yay[/quote]2", 2, "handles nested quotes correctly");
      replyLength("<!-- a comment -->", 0, "remove comments");
      replyLength("<!-- a comment -->\n more text \n<!-- a comment -->", 9, "remove multiple comments");
      replyLength("<!-- <!-- a comment --> -->more text", 12, "remove multiple comments");
    });
    (0, _qunit.test)("missingReplyCharacters", function (assert) {
      this.siteSettings.min_first_post_length = 40;

      const missingReplyCharacters = function (val, isPM, isFirstPost, expected, message) {
        let action = _composer.REPLY;

        if (isPM) {
          action = _composer.PRIVATE_MESSAGE;
        }

        if (isFirstPost) {
          action = _composer.CREATE_TOPIC;
        }

        const composer = createComposer({
          reply: val,
          action
        });
        assert.strictEqual(composer.get("missingReplyCharacters"), expected, message);
      };

      missingReplyCharacters("hi", false, false, this.siteSettings.min_post_length - 2, "too short public post");
      missingReplyCharacters("hi", false, true, this.siteSettings.min_first_post_length - 2, "too short first post");
      missingReplyCharacters("hi", true, false, this.siteSettings.min_personal_message_post_length - 2, "too short private message");
      const link = "http://imgur.com/gallery/grxX8";
      this.siteSettings.topic_featured_link_enabled = true;
      this.siteSettings.topic_featured_link_allowed_category_ids = 12345;
      const composer = createComposer({
        title: link,
        categoryId: 12345,
        featuredLink: link,
        action: _composer.CREATE_TOPIC,
        reply: link
      });
      assert.strictEqual(composer.get("missingReplyCharacters"), 0, "don't require any post content");
    });
    (0, _qunit.test)("missingTitleCharacters", function (assert) {
      const missingTitleCharacters = function (val, isPM, expected, message) {
        const composer = createComposer({
          title: val,
          action: isPM ? _composer.PRIVATE_MESSAGE : _composer.REPLY
        });
        assert.strictEqual(composer.get("missingTitleCharacters"), expected, message);
      };

      missingTitleCharacters("hi", false, this.siteSettings.min_topic_title_length - 2, "too short post title");
      missingTitleCharacters("z", true, this.siteSettings.min_personal_message_title_length - 1, "too short pm title");
    });
    (0, _qunit.test)("replyDirty", function (assert) {
      const composer = createComposer();
      assert.ok(!composer.get("replyDirty"), "by default it's false");
      composer.setProperties({
        originalText: "hello",
        reply: "hello"
      });
      assert.ok(!composer.get("replyDirty"), "it's false when the originalText is the same as the reply");
      composer.set("reply", "hello world");
      assert.ok(composer.get("replyDirty"), "it's true when the reply changes");
    });
    (0, _qunit.test)("appendText", function (assert) {
      const composer = createComposer();
      assert.blank(composer.get("reply"), "the reply is blank by default");
      composer.appendText("hello");
      assert.strictEqual(composer.get("reply"), "hello", "it appends text to nothing");
      composer.appendText(" world");
      assert.strictEqual(composer.get("reply"), "hello world", "it appends text to existing text");
      composer.clearState();
      composer.appendText("a\n\n\n\nb");
      composer.appendText("c", 3, {
        block: true
      });
      assert.strictEqual(composer.get("reply"), "a\n\nc\n\nb");
      composer.clearState();
      composer.appendText("ab");
      composer.appendText("c", 1, {
        block: true
      });
      assert.strictEqual(composer.get("reply"), "a\n\nc\n\nb");
      composer.clearState();
      composer.appendText("\nab");
      composer.appendText("c", 0, {
        block: true
      });
      assert.strictEqual(composer.get("reply"), "c\n\nab");
    });
    (0, _qunit.test)("prependText", function (assert) {
      const composer = createComposer();
      assert.blank(composer.get("reply"), "the reply is blank by default");
      composer.prependText("hello");
      assert.strictEqual(composer.get("reply"), "hello", "it prepends text to nothing");
      composer.prependText("world ");
      assert.strictEqual(composer.get("reply"), "world hello", "it prepends text to existing text");
      composer.prependText("before new line", {
        new_line: true
      });
      assert.strictEqual(composer.get("reply"), "before new line\n\nworld hello", "it prepends text with new line to existing text");
    });
    (0, _qunit.test)("Title length for regular topics", function (assert) {
      this.siteSettings.min_topic_title_length = 5;
      this.siteSettings.max_topic_title_length = 10;
      const composer = createComposer();
      composer.set("title", "asdf");
      assert.ok(!composer.get("titleLengthValid"), "short titles are not valid");
      composer.set("title", "this is a long title");
      assert.ok(!composer.get("titleLengthValid"), "long titles are not valid");
      composer.set("title", "just right");
      assert.ok(composer.get("titleLengthValid"), "in the range is okay");
    });
    (0, _qunit.test)("Title length for private messages", function (assert) {
      this.siteSettings.min_personal_message_title_length = 5;
      this.siteSettings.max_topic_title_length = 10;
      const composer = createComposer({
        action: _composer.PRIVATE_MESSAGE
      });
      composer.set("title", "asdf");
      assert.ok(!composer.get("titleLengthValid"), "short titles are not valid");
      composer.set("title", "this is a long title");
      assert.ok(!composer.get("titleLengthValid"), "long titles are not valid");
      composer.set("title", "just right");
      assert.ok(composer.get("titleLengthValid"), "in the range is okay");
    });
    (0, _qunit.test)("Post length for private messages with non human users", function (assert) {
      const composer = createComposer({
        topic: _object.default.create({
          pm_with_non_human_user: true
        })
      });
      assert.strictEqual(composer.get("minimumPostLength"), 1);
    });
    (0, _qunit.test)("editingFirstPost", function (assert) {
      const composer = createComposer();
      assert.ok(!composer.get("editingFirstPost"), "it's false by default");

      const post = _post.default.create({
        id: 123,
        post_number: 2
      });

      composer.setProperties({
        post,
        action: _composer.EDIT
      });
      assert.ok(!composer.get("editingFirstPost"), "it's false when not editing the first post");
      post.set("post_number", 1);
      assert.ok(composer.get("editingFirstPost"), "it's true when editing the first post");
    });
    (0, _qunit.test)("clearState", function (assert) {
      const composer = createComposer({
        originalText: "asdf",
        reply: "asdf2",
        post: _post.default.create({
          id: 1
        }),
        title: "wat"
      });
      composer.clearState();
      assert.blank(composer.get("originalText"));
      assert.blank(composer.get("reply"));
      assert.blank(composer.get("post"));
      assert.blank(composer.get("title"));
    });
    (0, _qunit.test)("initial category when uncategorized is allowed", function (assert) {
      this.siteSettings.allow_uncategorized_topics = true;
      const composer = openComposer({
        action: _composer.CREATE_TOPIC,
        draftKey: "asfd",
        draftSequence: 1
      });
      assert.ok(!composer.get("categoryId"), "Uncategorized by default");
    });
    (0, _qunit.test)("initial category when uncategorized is not allowed", function (assert) {
      this.siteSettings.allow_uncategorized_topics = false;
      const composer = openComposer({
        action: _composer.CREATE_TOPIC,
        draftKey: "asfd",
        draftSequence: 1
      });
      assert.ok(!composer.get("categoryId"), "Uncategorized by default. Must choose a category.");
    });
    (0, _qunit.test)("open with a quote", function (assert) {
      const quote = '[quote="neil, post:5, topic:413"]\nSimmer down you two.\n[/quote]';

      const newComposer = function () {
        return openComposer({
          action: _composer.REPLY,
          draftKey: "asfd",
          draftSequence: 1,
          quote
        });
      };

      assert.strictEqual(newComposer().get("originalText"), quote, "originalText is the quote");
      assert.strictEqual(newComposer().get("replyDirty"), false, "replyDirty is initially false with a quote");
    });
    (0, _qunit.test)("Title length for static page topics as admin", function (assert) {
      this.siteSettings.min_topic_title_length = 5;
      this.siteSettings.max_topic_title_length = 10;
      const composer = createComposer();

      const post = _post.default.create({
        id: 123,
        post_number: 2,
        static_doc: true
      });

      composer.setProperties({
        post,
        action: _composer.EDIT
      });
      composer.set("title", "asdf");
      assert.ok(composer.get("titleLengthValid"), "admins can use short titles");
      composer.set("title", "this is a long title");
      assert.ok(composer.get("titleLengthValid"), "admins can use long titles");
      composer.set("title", "just right");
      assert.ok(composer.get("titleLengthValid"), "in the range is okay");
      composer.set("title", "");
      assert.ok(!composer.get("titleLengthValid"), "admins must set title to at least 1 character");
    });
    (0, _qunit.test)("title placeholder depends on what you're doing", function (assert) {
      let composer = createComposer({
        action: _composer.CREATE_TOPIC
      });
      assert.strictEqual(composer.get("titlePlaceholder"), "composer.title_placeholder", "placeholder for normal topic");
      composer = createComposer({
        action: _composer.PRIVATE_MESSAGE
      });
      assert.strictEqual(composer.get("titlePlaceholder"), "composer.title_placeholder", "placeholder for private message");
      this.siteSettings.topic_featured_link_enabled = true;
      composer = createComposer({
        action: _composer.CREATE_TOPIC
      });
      assert.strictEqual(composer.get("titlePlaceholder"), "composer.title_or_link_placeholder", "placeholder invites you to paste a link");
      composer = createComposer({
        action: _composer.PRIVATE_MESSAGE
      });
      assert.strictEqual(composer.get("titlePlaceholder"), "composer.title_placeholder", "placeholder for private message with topic links enabled");
    });
    (0, _qunit.test)("allows featured link before choosing a category", function (assert) {
      this.siteSettings.topic_featured_link_enabled = true;
      this.siteSettings.allow_uncategorized_topics = false;
      let composer = createComposer({
        action: _composer.CREATE_TOPIC
      });
      assert.strictEqual(composer.get("titlePlaceholder"), "composer.title_or_link_placeholder", "placeholder invites you to paste a link");
      assert.ok(composer.get("canEditTopicFeaturedLink"), "can paste link");
    });
    (0, _qunit.test)("targetRecipientsArray contains types", function (assert) {
      let composer = createComposer({
        targetRecipients: "test,codinghorror,staff,foo@bar.com"
      });
      assert.ok(composer.targetRecipientsArray, [{
        type: "group",
        name: "test"
      }, {
        type: "user",
        name: "codinghorror"
      }, {
        type: "group",
        name: "staff"
      }, {
        type: "email",
        name: "foo@bar.com"
      }]);
    });
  });
});
define("discourse/tests/unit/models/email-log-test", ["qunit", "admin/models/email-log", "discourse-common/lib/get-url"], function (_qunit, _emailLog, _getUrl) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"admin/models/email-log",0,"discourse-common/lib/get-url"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Model | email-log", function () {
    (0, _qunit.test)("create", function (assert) {
      assert.ok(_emailLog.default.create(), "it can be created without arguments");
    });
    (0, _qunit.test)("subfolder support", function (assert) {
      (0, _getUrl.setPrefix)("/forum");
      const attrs = {
        id: 60,
        to_address: "wikiman@asdf.com",
        email_type: "user_linked",
        user_id: 9,
        created_at: "2018-08-08T17:21:52.022Z",
        post_url: "/t/some-pro-tips-for-you/41/5",
        post_description: "Some Pro Tips For You",
        bounced: false,
        user: {
          id: 9,
          username: "wikiman",
          avatar_template: "/forum/letter_avatar_proxy/v2/letter/w/dfb087/{size}.png"
        }
      };

      const emailLog = _emailLog.default.create(attrs);

      assert.strictEqual(emailLog.get("post_url"), "/forum/t/some-pro-tips-for-you/41/5", "includes the subfolder in the post url");
    });
  });
});
define("discourse/tests/unit/models/group-test", ["qunit", "discourse/models/group"], function (_qunit, _group) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/models/group"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Model | group", function () {
    (0, _qunit.test)("displayName", function (assert) {
      const group = _group.default.create({
        name: "test",
        display_name: "donkey"
      });

      assert.strictEqual(group.get("displayName"), "donkey", "it should return the display name");
      group.set("display_name", null);
      assert.strictEqual(group.get("displayName"), "test", "it should return the group's name");
    });
  });
});
define("discourse/tests/unit/models/invite-test", ["qunit", "discourse/models/invite"], function (_qunit, _invite) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/models/invite"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Model | invite", function () {
    (0, _qunit.test)("create", function (assert) {
      assert.ok(_invite.default.create(), "it can be created without arguments");
    });
  });
});
define("discourse/tests/unit/models/nav-item-test", ["qunit", "discourse/models/category", "discourse/models/nav-item", "discourse/models/site", "discourse/tests/helpers/create-store", "@ember/runloop"], function (_qunit, _category, _navItem, _site, _createStore, _runloop) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/models/category",0,"discourse/models/nav-item",0,"discourse/models/site",0,"discourse/tests/helpers/create-store",0,"@ember/runloop"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Model | nav-item", function (hooks) {
    hooks.beforeEach(function () {
      (0, _runloop.run)(function () {
        const fooCategory = _category.default.create({
          slug: "foo",
          id: 123
        });

        _site.default.currentProp("categories").addObject(fooCategory);
      });
    });
    (0, _qunit.test)("href", function (assert) {
      assert.expect(4);

      function href(text, opts, expected, label) {
        assert.strictEqual(_navItem.default.fromText(text, opts).get("href"), expected, label);
      }

      href("latest", {}, "/latest", "latest");
      href("categories", {}, "/categories", "categories");
      href("latest", {
        tagId: "bar"
      }, "/tag/bar/l/latest", "latest with tag");
      href("latest", {
        tagId: "bar",
        category: _category.default.findBySlugPath(["foo"])
      }, "/tags/c/foo/123/bar/l/latest", "latest with tag and category");
    });
    (0, _qunit.test)("count", function (assert) {
      const navItem = (0, _createStore.default)().createRecord("nav-item", {
        name: "new"
      });
      assert.strictEqual(navItem.get("count"), 0, "it has no count by default");
      const tracker = navItem.get("topicTrackingState");
      tracker.modifyState("t1", {
        topic_id: 1,
        last_read_post_number: null,
        created_in_new_period: true
      });
      tracker.incrementMessageCount();
      assert.strictEqual(navItem.get("count"), 1, "it updates when a new message arrives");
    });
    (0, _qunit.test)("displayName", function (assert) {
      const navItem = (0, _createStore.default)().createRecord("nav-item", {
        name: "something"
      });
      assert.strictEqual(navItem.displayName, "[en.filters.something.title count=0]");
      navItem.set("displayName", "Extra Item");
      assert.strictEqual(navItem.displayName, "Extra Item");
    });
    (0, _qunit.test)("title", function (assert) {
      const navItem = (0, _createStore.default)().createRecord("nav-item", {
        name: "something"
      });
      assert.strictEqual(navItem.title, "[en.filters.something.help]");
      navItem.set("title", "Extra Item");
      assert.strictEqual(navItem.title, "Extra Item");
    });
  });
});
define("discourse/tests/unit/models/pending-post-test", ["qunit", "discourse/models/pending-post", "discourse/tests/helpers/create-store", "@ember/test-helpers"], function (_qunit, _pendingPost, _createStore, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/models/pending-post",0,"discourse/tests/helpers/create-store",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Model | pending-post", function () {
    (0, _qunit.test)("Properties", async function (assert) {
      const store = (0, _createStore.default)();
      const category = store.createRecord("category", {
        id: 2
      });

      const post = _pendingPost.default.create({
        id: 1,
        topic_url: "topic-url",
        username: "USERNAME",
        category_id: 2
      });

      await (0, _testHelpers.settled)();
      assert.equal(post.postUrl, "topic-url", "topic_url is aliased to postUrl");
      assert.equal(post.truncated, false, "truncated is always false");
      assert.equal(post.userUrl, "/u/username", "it returns user URL from the username");
      assert.strictEqual(post.category, category, "it returns the proper category object based on category_id");
    });
    (0, _qunit.test)("it cooks raw_text", async function (assert) {
      const post = _pendingPost.default.create({
        raw_text: "**bold text**"
      });

      await (0, _testHelpers.settled)();
      assert.equal(post.expandedExcerpt.string, "<p><strong>bold text</strong></p>");
    });
  });
});
define("discourse/tests/unit/models/post-stream-test", ["qunit", "discourse/services/app-events", "@ember/array/proxy", "discourse/models/post", "discourse/models/user", "discourse/tests/helpers/create-store", "discourse/tests/helpers/create-pretender", "sinon"], function (_qunit, _appEvents, _proxy, _post, _user, _createStore, _createPretender, _sinon) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/services/app-events",0,"@ember/array/proxy",0,"discourse/models/post",0,"discourse/models/user",0,"discourse/tests/helpers/create-store",0,"discourse/tests/helpers/create-pretender",0,"sinon"eaimeta@70e063a35619d71f

  function buildStream(id, stream) {
    const store = (0, _createStore.default)();
    const topic = store.createRecord("topic", {
      id,
      chunk_size: 5
    });
    const ps = topic.postStream;

    if (stream) {
      ps.set("stream", stream);
    }

    ps.appEvents = _appEvents.default.create();
    return ps;
  }

  const participant = {
    username: "eviltrout"
  };
  (0, _qunit.module)("Unit | Model | post-stream", function () {
    (0, _qunit.test)("create", function (assert) {
      const store = (0, _createStore.default)();
      assert.ok(store.createRecord("postStream"), "it can be created with no parameters");
    });
    (0, _qunit.test)("defaults", function (assert) {
      const postStream = buildStream(1234);
      assert.blank(postStream.posts, "there are no posts in a stream by default");
      assert.ok(!postStream.get("loaded"), "it has never loaded");
      assert.present(postStream.get("topic"));
    });
    (0, _qunit.test)("appending posts", function (assert) {
      const postStream = buildStream(4567, [1, 3, 4]);
      const store = postStream.store;
      assert.strictEqual(postStream.get("lastPostId"), 4, "the last post id is 4");
      assert.ok(!postStream.get("hasPosts"), "there are no posts by default");
      assert.ok(!postStream.get("firstPostPresent"), "the first post is not loaded");
      assert.ok(!postStream.get("loadedAllPosts"), "the last post is not loaded");
      assert.strictEqual(postStream.get("posts.length"), 0, "it has no posts initially");
      postStream.appendPost(store.createRecord("post", {
        id: 2,
        post_number: 2
      }));
      assert.ok(!postStream.get("firstPostPresent"), "the first post is still not loaded");
      assert.strictEqual(postStream.get("posts.length"), 1, "it has one post in the stream");
      postStream.appendPost(store.createRecord("post", {
        id: 4,
        post_number: 4
      }));
      assert.ok(!postStream.get("firstPostPresent"), "the first post is still loaded");
      assert.ok(postStream.get("loadedAllPosts"), "the last post is now loaded");
      assert.strictEqual(postStream.get("posts.length"), 2, "it has two posts in the stream");
      postStream.appendPost(store.createRecord("post", {
        id: 4,
        post_number: 4
      }));
      assert.strictEqual(postStream.get("posts.length"), 2, "it will not add the same post with id twice");
      const stagedPost = store.createRecord("post", {
        raw: "incomplete post"
      });
      postStream.appendPost(stagedPost);
      assert.strictEqual(postStream.get("posts.length"), 3, "it can handle posts without ids");
      postStream.appendPost(stagedPost);
      assert.strictEqual(postStream.get("posts.length"), 3, "it won't add the same post without an id twice"); // change the stream

      postStream.set("stream", [1, 2, 4]);
      assert.ok(!postStream.get("firstPostPresent"), "the first post no longer loaded since the stream changed.");
      assert.ok(postStream.get("loadedAllPosts"), "the last post is still the last post in the new stream");
    });
    (0, _qunit.test)("closestPostNumberFor", function (assert) {
      const postStream = buildStream(1231);
      const store = postStream.store;
      assert.blank(postStream.closestPostNumberFor(1), "there is no closest post when nothing is loaded");
      postStream.appendPost(store.createRecord("post", {
        id: 1,
        post_number: 2
      }));
      postStream.appendPost(store.createRecord("post", {
        id: 2,
        post_number: 3
      }));
      assert.strictEqual(postStream.closestPostNumberFor(2), 2, "If a post is in the stream it returns its post number");
      assert.strictEqual(postStream.closestPostNumberFor(3), 3, "If a post is in the stream it returns its post number");
      assert.strictEqual(postStream.closestPostNumberFor(10), 3, "it clips to the upper bound of the stream");
      assert.strictEqual(postStream.closestPostNumberFor(0), 2, "it clips to the lower bound of the stream");
    });
    (0, _qunit.test)("closestDaysAgoFor", function (assert) {
      const postStream = buildStream(1231);
      postStream.set("timelineLookup", [[1, 10], [3, 8], [5, 1]]);
      assert.strictEqual(postStream.closestDaysAgoFor(1), 10);
      assert.strictEqual(postStream.closestDaysAgoFor(2), 10);
      assert.strictEqual(postStream.closestDaysAgoFor(3), 8);
      assert.strictEqual(postStream.closestDaysAgoFor(4), 8);
      assert.strictEqual(postStream.closestDaysAgoFor(5), 1); // Out of bounds

      assert.strictEqual(postStream.closestDaysAgoFor(-1), 10);
      assert.strictEqual(postStream.closestDaysAgoFor(0), 10);
      assert.strictEqual(postStream.closestDaysAgoFor(10), 1);
      postStream.set("timelineLookup", []);
      assert.strictEqual(postStream.closestDaysAgoFor(1), undefined);
    });
    (0, _qunit.test)("closestDaysAgoFor - empty", function (assert) {
      const postStream = buildStream(1231);
      postStream.set("timelineLookup", []);
      assert.strictEqual(postStream.closestDaysAgoFor(1), undefined);
    });
    (0, _qunit.test)("updateFromJson", function (assert) {
      const postStream = buildStream(1231);
      postStream.updateFromJson({
        posts: [{
          id: 1
        }],
        stream: [1],
        extra_property: 12
      });
      assert.strictEqual(postStream.get("posts.length"), 1, "it loaded the posts");
      assert.containsInstance(postStream.posts, _post.default);
      assert.strictEqual(postStream.get("extra_property"), 12);
    });
    (0, _qunit.test)("removePosts", function (assert) {
      const postStream = buildStream(10000001, [1, 2, 3]);
      const store = postStream.store;
      const p1 = store.createRecord("post", {
        id: 1,
        post_number: 2
      }),
            p2 = store.createRecord("post", {
        id: 2,
        post_number: 3
      }),
            p3 = store.createRecord("post", {
        id: 3,
        post_number: 4
      });
      postStream.appendPost(p1);
      postStream.appendPost(p2);
      postStream.appendPost(p3); // Removing nothing does nothing

      postStream.removePosts();
      assert.strictEqual(postStream.get("posts.length"), 3);
      postStream.removePosts([p1, p3]);
      assert.strictEqual(postStream.get("posts.length"), 1);
      assert.deepEqual(postStream.get("stream"), [2]);
    });
    (0, _qunit.test)("cancelFilter", function (assert) {
      const postStream = buildStream(1235);

      _sinon.default.stub(postStream, "refresh").resolves();

      postStream.set("filter", "summary");
      postStream.cancelFilter();
      assert.ok(!postStream.get("summary"), "summary is cancelled");
      postStream.filterParticipant(participant);
      postStream.cancelFilter();
      assert.blank(postStream.get("userFilters"), "cancelling the filters clears the userFilters");
    });
    (0, _qunit.test)("findPostIdForPostNumber", function (assert) {
      const postStream = buildStream(1234, [10, 20, 30, 40, 50, 60, 70]);
      postStream.set("gaps", {
        before: {
          60: [55, 58]
        }
      });
      assert.strictEqual(postStream.findPostIdForPostNumber(500), undefined, "it returns undefined when the post cannot be found");
      assert.strictEqual(postStream.findPostIdForPostNumber(1), 10, "it finds the postId at the beginning");
      assert.strictEqual(postStream.findPostIdForPostNumber(5), 50, "it finds the postId in the middle");
      assert.strictEqual(postStream.findPostIdForPostNumber(8), 60, "it respects gaps");
    });
    (0, _qunit.test)("fillGapBefore", function (assert) {
      const postStream = buildStream(1234, [60]);

      _sinon.default.stub(postStream, "findPostsByIds").resolves([]);

      let post = postStream.store.createRecord("post", {
        id: 60,
        post_number: 60
      });
      postStream.set("gaps", {
        before: {
          60: [51, 52, 53, 54, 55, 56, 57, 58, 59]
        }
      });
      postStream.fillGapBefore(post, [51, 52, 53, 54, 55, 56, 57, 58, 59]);
      assert.deepEqual(postStream.stream, [51, 52, 53, 54, 55, 60], "partial results are included in the stream");
    });
    (0, _qunit.test)("filterParticipant", function (assert) {
      const postStream = buildStream(1236);

      _sinon.default.stub(postStream, "refresh").resolves();

      assert.strictEqual(postStream.get("userFilters.length"), 0, "by default no participants are toggled");
      postStream.filterParticipant(participant.username);
      assert.ok(postStream.get("userFilters").includes("eviltrout"), "eviltrout is in the filters");
      postStream.cancelFilter();
      assert.blank(postStream.get("userFilters"), "cancelFilter clears");
    });
    (0, _qunit.test)("filterReplies", function (assert) {
      const postStream = buildStream(1234),
            store = postStream.store;
      postStream.appendPost(store.createRecord("post", {
        id: 2,
        post_number: 3
      }));

      _sinon.default.stub(postStream, "refresh").resolves();

      assert.strictEqual(postStream.get("filterRepliesToPostNumber"), false, "by default no replies are filtered");
      postStream.filterReplies(3, 2);
      assert.strictEqual(postStream.get("filterRepliesToPostNumber"), 3, "postNumber is in the filters");
      postStream.cancelFilter();
      assert.strictEqual(postStream.get("filterRepliesToPostNumber"), false, "cancelFilter clears");
    });
    (0, _qunit.test)("filterUpwards", function (assert) {
      const postStream = buildStream(1234),
            store = postStream.store;
      postStream.appendPost(store.createRecord("post", {
        id: 2,
        post_number: 3
      }));

      _sinon.default.stub(postStream, "refresh").resolves();

      assert.strictEqual(postStream.get("filterUpwardsPostID"), false, "by default filter is false");
      postStream.filterUpwards(2);
      assert.strictEqual(postStream.get("filterUpwardsPostID"), 2, "filter is set");
      postStream.cancelFilter();
      assert.strictEqual(postStream.get("filterUpwardsPostID"), false, "filter cleared");
    });
    (0, _qunit.test)("streamFilters", function (assert) {
      const postStream = buildStream(1237);

      _sinon.default.stub(postStream, "refresh").resolves();

      assert.deepEqual(postStream.get("streamFilters"), {}, "there are no postFilters by default");
      assert.ok(postStream.get("hasNoFilters"), "there are no filters by default");
      postStream.set("filter", "summary");
      assert.deepEqual(postStream.get("streamFilters"), {
        filter: "summary"
      }, "postFilters contains the summary flag");
      assert.ok(!postStream.get("hasNoFilters"), "now there are filters present");
      postStream.filterParticipant(participant.username);
      assert.deepEqual(postStream.get("streamFilters"), {
        username_filters: "eviltrout"
      }, "streamFilters contains the username we filtered");
      postStream.filterUpwards(2);
      assert.deepEqual(postStream.get("streamFilters"), {
        filter_upwards_post_id: 2
      }, "streamFilters contains only the post ID");
      postStream.filterReplies(1);
      assert.deepEqual(postStream.get("streamFilters"), {
        replies_to_post_number: 1
      }, "streamFilters contains only the last filter");
    });
    (0, _qunit.test)("loading", function (assert) {
      let postStream = buildStream(1234);
      assert.ok(!postStream.get("loading"), "we're not loading by default");
      postStream.set("loadingAbove", true);
      assert.ok(postStream.get("loading"), "we're loading if loading above");
      postStream = buildStream(1234);
      postStream.set("loadingBelow", true);
      assert.ok(postStream.get("loading"), "we're loading if loading below");
      postStream = buildStream(1234);
      postStream.set("loadingFilter", true);
      assert.ok(postStream.get("loading"), "we're loading if loading a filter");
    });
    (0, _qunit.test)("nextWindow", function (assert) {
      const postStream = buildStream(1234, [1, 2, 3, 5, 8, 9, 10, 11, 13, 14, 15, 16]);
      assert.blank(postStream.get("nextWindow"), "With no posts loaded, the window is blank");
      postStream.updateFromJson({
        posts: [{
          id: 1
        }, {
          id: 2
        }]
      });
      assert.deepEqual(postStream.get("nextWindow"), [3, 5, 8, 9, 10], "If we've loaded the first 2 posts, the window should be the 5 after that");
      postStream.updateFromJson({
        posts: [{
          id: 13
        }]
      });
      assert.deepEqual(postStream.get("nextWindow"), [14, 15, 16], "Boundary check: stop at the end.");
      postStream.updateFromJson({
        posts: [{
          id: 16
        }]
      });
      assert.blank(postStream.get("nextWindow"), "Once we've seen everything there's nothing to load.");
    });
    (0, _qunit.test)("previousWindow", function (assert) {
      const postStream = buildStream(1234, [1, 2, 3, 5, 8, 9, 10, 11, 13, 14, 15, 16]);
      assert.blank(postStream.get("previousWindow"), "With no posts loaded, the window is blank");
      postStream.updateFromJson({
        posts: [{
          id: 11
        }, {
          id: 13
        }]
      });
      assert.deepEqual(postStream.get("previousWindow"), [3, 5, 8, 9, 10], "If we've loaded in the middle, it's the previous 5 posts");
      postStream.updateFromJson({
        posts: [{
          id: 3
        }]
      });
      assert.deepEqual(postStream.get("previousWindow"), [1, 2], "Boundary check: stop at the beginning.");
      postStream.updateFromJson({
        posts: [{
          id: 1
        }]
      });
      assert.blank(postStream.get("previousWindow"), "Once we've seen everything there's nothing to load.");
    });
    (0, _qunit.test)("storePost", function (assert) {
      const postStream = buildStream(1234),
            store = postStream.store,
            post = store.createRecord("post", {
        id: 1,
        post_number: 100,
        raw: "initial value"
      });
      assert.blank(postStream.get("topic.highest_post_number"), "it has no highest post number yet");
      let stored = postStream.storePost(post);
      assert.strictEqual(post, stored, "it returns the post it stored");
      assert.strictEqual(post.get("topic"), postStream.get("topic"), "it creates the topic reference properly");
      assert.strictEqual(postStream.get("topic.highest_post_number"), 100, "it set the highest post number");
      const dupePost = store.createRecord("post", {
        id: 1,
        post_number: 100,
        raw: "updated value"
      });
      const storedDupe = postStream.storePost(dupePost);
      assert.strictEqual(storedDupe, post, "it returns the previously stored post instead to avoid dupes");
      assert.strictEqual(storedDupe.get("raw"), "updated value", "it updates the previously stored post");
      const postWithoutId = store.createRecord("post", {
        raw: "hello world"
      });
      stored = postStream.storePost(postWithoutId);
      assert.strictEqual(stored, postWithoutId, "it returns the same post back");
    });
    (0, _qunit.test)("identity map", async function (assert) {
      const postStream = buildStream(1234);
      const store = postStream.store;
      const p1 = postStream.appendPost(store.createRecord("post", {
        id: 1,
        post_number: 1
      }));
      const p3 = postStream.appendPost(store.createRecord("post", {
        id: 3,
        post_number: 4
      }));
      assert.strictEqual(postStream.findLoadedPost(1), p1, "it can return cached posts by id");
      assert.blank(postStream.findLoadedPost(4), "it can't find uncached posts"); // Find posts by ids uses the identity map

      const result = await postStream.findPostsByIds([1, 2, 3]);
      assert.strictEqual(result.length, 3);
      assert.strictEqual(result.objectAt(0), p1);
      assert.strictEqual(result.objectAt(1).get("post_number"), 2);
      assert.strictEqual(result.objectAt(2), p3);
    });
    (0, _qunit.test)("loadIntoIdentityMap with no data", async function (assert) {
      const result = await buildStream(1234).loadIntoIdentityMap([]);
      assert.strictEqual(result.length, 0, "requesting no posts produces no posts");
    });
    (0, _qunit.test)("loadIntoIdentityMap with post ids", async function (assert) {
      const postStream = buildStream(1234);
      await postStream.loadIntoIdentityMap([10]);
      assert.present(postStream.findLoadedPost(10), "it adds the returned post to the store");
    });
    (0, _qunit.test)("appendMore for megatopic", async function (assert) {
      const postStream = buildStream(1234);
      const store = (0, _createStore.default)();
      const post = store.createRecord("post", {
        id: 1,
        post_number: 1
      });
      postStream.setProperties({
        isMegaTopic: true,
        posts: [post]
      });
      await postStream.appendMore();
      assert.present(postStream.findLoadedPost(2), "it adds the returned post to the store");
      assert.strictEqual(postStream.posts.length, 6, "it adds the right posts into the stream");
    });
    (0, _qunit.test)("prependMore for megatopic", async function (assert) {
      const postStream = buildStream(1234);
      const store = (0, _createStore.default)();
      const post = store.createRecord("post", {
        id: 6,
        post_number: 6
      });
      postStream.setProperties({
        isMegaTopic: true,
        posts: [post]
      });
      await postStream.prependMore();
      assert.present(postStream.findLoadedPost(5), "it adds the returned post to the store");
      assert.strictEqual(postStream.posts.length, 6, "it adds the right posts into the stream");
    });
    (0, _qunit.test)("staging and undoing a new post", function (assert) {
      const postStream = buildStream(10101, [1]);
      const store = postStream.store;
      const original = store.createRecord("post", {
        id: 1,
        post_number: 1,
        topic_id: 10101
      });
      postStream.appendPost(original);
      assert.strictEqual(postStream.get("lastAppended"), original, "the original post is lastAppended");

      const user = _user.default.create({
        username: "eviltrout",
        name: "eviltrout",
        id: 321
      });

      const stagedPost = store.createRecord("post", {
        raw: "hello world this is my new post",
        topic_id: 10101
      });
      const topic = postStream.get("topic");
      topic.setProperties({
        posts_count: 1,
        highest_post_number: 1
      }); // Stage the new post in the stream

      const result = postStream.stagePost(stagedPost, user);
      assert.strictEqual(result, "staged", "it returns staged");
      assert.strictEqual(topic.get("highest_post_number"), 2, "it updates the highest_post_number");
      assert.ok(postStream.get("loading"), "it is loading while the post is being staged");
      assert.strictEqual(postStream.get("lastAppended"), original, "it doesn't consider staged posts as the lastAppended");
      assert.strictEqual(topic.get("posts_count"), 2, "it increases the post count");
      assert.present(topic.get("last_posted_at"), "it updates last_posted_at");
      assert.strictEqual(topic.get("details.last_poster"), user, "it changes the last poster");
      assert.strictEqual(stagedPost.get("topic"), topic, "it assigns the topic reference");
      assert.strictEqual(stagedPost.get("post_number"), 2, "it is assigned the probable post_number");
      assert.present(stagedPost.get("created_at"), "it is assigned a created date");
      assert.ok(postStream.posts.includes(stagedPost), "the post is added to the stream");
      assert.strictEqual(stagedPost.get("id"), -1, "the post has a magical -1 id"); // Undoing a created post (there was an error)

      postStream.undoPost(stagedPost);
      assert.ok(!postStream.get("loading"), "it is no longer loading");
      assert.strictEqual(topic.get("highest_post_number"), 1, "it reverts the highest_post_number");
      assert.strictEqual(topic.get("posts_count"), 1, "it reverts the post count");
      assert.strictEqual(postStream.get("filteredPostsCount"), 1, "it retains the filteredPostsCount");
      assert.ok(!postStream.posts.includes(stagedPost), "the post is removed from the stream");
      assert.strictEqual(postStream.get("lastAppended"), original, "it doesn't consider undid post lastAppended");
    });
    (0, _qunit.test)("staging and committing a post", function (assert) {
      const postStream = buildStream(10101, [1]);
      const store = postStream.store;
      const original = store.createRecord("post", {
        id: 1,
        post_number: 1,
        topic_id: 10101
      });
      postStream.appendPost(original);
      assert.strictEqual(postStream.get("lastAppended"), original, "the original post is lastAppended");

      const user = _user.default.create({
        username: "eviltrout",
        name: "eviltrout",
        id: 321
      });

      const stagedPost = store.createRecord("post", {
        raw: "hello world this is my new post",
        topic_id: 10101
      });
      const topic = postStream.get("topic");
      topic.set("posts_count", 1); // Stage the new post in the stream

      let result = postStream.stagePost(stagedPost, user);
      assert.strictEqual(result, "staged", "it returns staged");
      assert.ok(postStream.get("loading"), "it is loading while the post is being staged");
      stagedPost.setProperties({
        id: 1234,
        raw: "different raw value"
      });
      result = postStream.stagePost(stagedPost, user);
      assert.strictEqual(result, "alreadyStaging", "you can't stage a post while it is currently staging");
      assert.strictEqual(postStream.get("lastAppended"), original, "staging a post doesn't change the lastAppended");
      postStream.commitPost(stagedPost);
      assert.ok(postStream.posts.includes(stagedPost), "the post is still in the stream");
      assert.ok(!postStream.get("loading"), "it is no longer loading");
      assert.strictEqual(postStream.get("filteredPostsCount"), 2, "it increases the filteredPostsCount");
      const found = postStream.findLoadedPost(stagedPost.get("id"));
      assert.present(found, "the post is in the identity map");
      assert.ok(postStream.posts.includes(stagedPost), "the post is in the stream");
      assert.strictEqual(found.get("raw"), "different raw value", "it also updated the value in the stream");
      assert.strictEqual(postStream.get("lastAppended"), found, "committing a post changes lastAppended");
    });
    (0, _qunit.test)("loadedAllPosts when the id changes", function (assert) {
      // This can happen in a race condition between staging a post and it coming through on the
      // message bus. If the id of a post changes we should reconsider the loadedAllPosts property.
      const postStream = buildStream(10101, [1, 2]);
      const store = postStream.store;
      const postWithoutId = store.createRecord("post", {
        raw: "hello world this is my new post"
      });
      postStream.appendPost(store.createRecord("post", {
        id: 1,
        post_number: 1
      }));
      postStream.appendPost(postWithoutId);
      assert.ok(!postStream.get("loadedAllPosts"), "the last post is not loaded");
      postWithoutId.set("id", 2);
      assert.ok(postStream.get("loadedAllPosts"), "the last post is loaded now that the post has an id");
    });
    (0, _qunit.test)("triggerRecoveredPost", async function (assert) {
      const postStream = buildStream(4567);
      const store = postStream.store;
      [1, 2, 3, 5].forEach(id => {
        postStream.appendPost(store.createRecord("post", {
          id,
          post_number: id
        }));
      });

      _createPretender.default.get("/posts/4", () => {
        return (0, _createPretender.response)({
          id: 4,
          post_number: 4
        });
      });

      assert.strictEqual(postStream.get("postsWithPlaceholders.length"), 4, "it should return the right length");
      await postStream.triggerRecoveredPost(4);
      assert.strictEqual(postStream.get("postsWithPlaceholders.length"), 5, "it should return the right length");
    });
    (0, _qunit.test)("committing and triggerNewPostsInStream race condition", function (assert) {
      const postStream = buildStream(4964);
      const store = postStream.store;
      postStream.appendPost(store.createRecord("post", {
        id: 1,
        post_number: 1
      }));

      const user = _user.default.create({
        username: "eviltrout",
        name: "eviltrout",
        id: 321
      });

      const stagedPost = store.createRecord("post", {
        raw: "hello world this is my new post"
      });
      postStream.stagePost(stagedPost, user);
      assert.strictEqual(postStream.get("filteredPostsCount"), 0, "it has no filteredPostsCount yet");
      stagedPost.set("id", 123);

      _sinon.default.stub(postStream, "appendMore");

      postStream.triggerNewPostsInStream([123]);
      assert.strictEqual(postStream.get("filteredPostsCount"), 1, "it added the post");
      postStream.commitPost(stagedPost);
      assert.strictEqual(postStream.get("filteredPostsCount"), 1, "it does not add the same post twice");
    });
    (0, _qunit.test)("triggerNewPostInStream for ignored posts", async function (assert) {
      const postStream = buildStream(280, [1]);
      const store = postStream.store;

      _user.default.resetCurrent(_user.default.create({
        username: "eviltrout",
        name: "eviltrout",
        id: 321,
        ignored_users: ["ignoreduser"]
      }));

      postStream.appendPost(store.createRecord("post", {
        id: 1,
        post_number: 1
      }));
      const post2 = store.createRecord("post", {
        id: 101,
        post_number: 2,
        username: "regularuser"
      });
      const post3 = store.createRecord("post", {
        id: 102,
        post_number: 3,
        username: "ignoreduser"
      });

      let stub = _sinon.default.stub(postStream, "findPostsByIds").resolves([post2]);

      await postStream.triggerNewPostsInStream([101]);
      assert.strictEqual(postStream.posts.length, 2, "it added the regular post to the posts");
      assert.strictEqual(postStream.get("stream.length"), 2, "it added the regular post to the stream");
      stub.restore();

      _sinon.default.stub(postStream, "findPostsByIds").resolves([post3]);

      await postStream.triggerNewPostsInStream([102]);
      assert.strictEqual(postStream.posts.length, 2, "it does not add the ignored post to the posts");
      assert.strictEqual(postStream.stream.length, 2, "it does not add the ignored post to the stream");
    });
    (0, _qunit.test)("postsWithPlaceholders", async function (assert) {
      const postStream = buildStream(4964, [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]);
      const postsWithPlaceholders = postStream.get("postsWithPlaceholders");
      const store = postStream.store;

      const testProxy = _proxy.default.create({
        content: postsWithPlaceholders
      });

      const p1 = store.createRecord("post", {
        id: 1,
        post_number: 1
      });
      const p2 = store.createRecord("post", {
        id: 2,
        post_number: 2
      });
      const p3 = store.createRecord("post", {
        id: 3,
        post_number: 3
      });
      const p4 = store.createRecord("post", {
        id: 4,
        post_number: 4
      });
      postStream.appendPost(p1);
      postStream.appendPost(p2);
      postStream.appendPost(p3); // Test enumerable and array access

      assert.strictEqual(postsWithPlaceholders.get("length"), 3);
      assert.strictEqual(testProxy.get("length"), 3);
      assert.strictEqual(postsWithPlaceholders.nextObject(0), p1);
      assert.strictEqual(postsWithPlaceholders.objectAt(0), p1);
      assert.strictEqual(postsWithPlaceholders.nextObject(1, p1), p2);
      assert.strictEqual(postsWithPlaceholders.objectAt(1), p2);
      assert.strictEqual(postsWithPlaceholders.nextObject(2, p2), p3);
      assert.strictEqual(postsWithPlaceholders.objectAt(2), p3);
      const promise = postStream.appendMore();
      assert.strictEqual(postsWithPlaceholders.get("length"), 8, "we immediately have a larger placeholder window");
      assert.strictEqual(testProxy.get("length"), 8);
      assert.ok(!!postsWithPlaceholders.nextObject(3, p3));
      assert.ok(!!postsWithPlaceholders.objectAt(4));
      assert.ok(postsWithPlaceholders.objectAt(3) !== p4);
      assert.ok(testProxy.objectAt(3) !== p4);
      await promise;
      assert.strictEqual(postsWithPlaceholders.objectAt(3), p4);
      assert.strictEqual(postsWithPlaceholders.get("length"), 8, "have a larger placeholder window when loaded");
      assert.strictEqual(testProxy.get("length"), 8);
      assert.strictEqual(testProxy.objectAt(3), p4);
    });
    (0, _qunit.test)("filteredPostsCount", function (assert) {
      const postStream = buildStream(4567, [1, 3, 4]);
      assert.strictEqual(postStream.get("filteredPostsCount"), 3); // Megatopic

      postStream.set("isMegaTopic", true);
      postStream.set("topic.highest_post_number", 4);
      assert.strictEqual(postStream.get("filteredPostsCount"), 4);
    });
    (0, _qunit.test)("lastPostId", function (assert) {
      const postStream = buildStream(4567, [1, 3, 4]);
      assert.strictEqual(postStream.get("lastPostId"), 4);
      postStream.setProperties({
        isMegaTopic: true,
        lastId: 2
      });
      assert.strictEqual(postStream.get("lastPostId"), 2);
    });
    (0, _qunit.test)("progressIndexOfPostId", function (assert) {
      const postStream = buildStream(4567, [1, 3, 4]);
      const store = (0, _createStore.default)();
      const post = store.createRecord("post", {
        id: 1,
        post_number: 5
      });
      assert.strictEqual(postStream.progressIndexOfPostId(post), 1);
      postStream.set("isMegaTopic", true);
      assert.strictEqual(postStream.progressIndexOfPostId(post), 5);
    });
  });
});
define("discourse/tests/unit/models/post-test", ["qunit", "discourse/models/post", "discourse/models/user", "discourse-common/lib/object"], function (_qunit, _post, _user, _object) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/models/post",0,"discourse/models/user",0,"discourse-common/lib/object"eaimeta@70e063a35619d71f

  function buildPost(args) {
    return _post.default.create((0, _object.deepMerge)({
      id: 1,
      can_delete: true,
      version: 1
    }, args || {}));
  }

  (0, _qunit.module)("Unit | Model | post", function () {
    (0, _qunit.test)("defaults", function (assert) {
      let post = _post.default.create({
        id: 1
      });

      assert.blank(post.get("deleted_at"), "it has no deleted_at by default");
      assert.blank(post.get("deleted_by"), "there is no deleted_by by default");
    });
    (0, _qunit.test)("new_user", function (assert) {
      let post = _post.default.create({
        trust_level: 0
      });

      assert.ok(post.get("new_user"), "post is from a new user");
      post.set("trust_level", 1);
      assert.ok(!post.get("new_user"), "post is no longer from a new user");
    });
    (0, _qunit.test)("firstPost", function (assert) {
      let post = _post.default.create({
        post_number: 1
      });

      assert.ok(post.get("firstPost"), "it's the first post");
      post.set("post_number", 10);
      assert.ok(!post.get("firstPost"), "post is no longer the first post");
    });
    (0, _qunit.test)("updateFromPost", function (assert) {
      let post = _post.default.create({
        post_number: 1,
        raw: "hello world"
      });

      post.updateFromPost(_post.default.create({
        raw: "different raw",
        wat: function () {
          return 123;
        }
      }));
      assert.strictEqual(post.get("raw"), "different raw", "raw field updated");
    });
    (0, _qunit.test)("destroy by staff", async function (assert) {
      let user = _user.default.create({
        username: "staff",
        moderator: true
      });

      let post = buildPost({
        user
      });
      await post.destroy(user);
      assert.present(post.get("deleted_at"), "it has a `deleted_at` field.");
      assert.strictEqual(post.get("deleted_by"), user, "it has the user in the `deleted_by` field");
      await post.recover();
      assert.blank(post.get("deleted_at"), "it clears `deleted_at` when recovering");
      assert.blank(post.get("deleted_by"), "it clears `deleted_by` when recovering");
    });
    (0, _qunit.test)("destroy by non-staff", async function (assert) {
      const originalCooked = "this is the original cooked value";

      const user = _user.default.create({
        username: "evil trout"
      });

      const post = buildPost({
        user,
        cooked: originalCooked
      });
      await post.destroy(user);
      assert.ok(!post.get("can_delete"), "the post can't be deleted again in this session");
      assert.ok(post.get("cooked") !== originalCooked, "the cooked content changed");
      assert.strictEqual(post.get("version"), 2, "the version number increased");
    });
  });
});
define("discourse/tests/unit/models/private-message-topic-tracking-state-test", ["qunit", "discourse/tests/helpers/create-pretender", "discourse/tests/helpers/qunit-helpers", "message-bus-client", "discourse/services/pm-topic-tracking-state", "discourse/models/user"], function (_qunit, _createPretender, _qunitHelpers, _messageBusClient, _pmTopicTrackingState, _user) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/create-pretender",0,"discourse/tests/helpers/qunit-helpers",0,"message-bus-client",0,"discourse/services/pm-topic-tracking-state",0,"discourse/models/user"eaimeta@70e063a35619d71f

  function setupPretender() {
    _createPretender.default.get(`/u/test/private-message-topic-tracking-state`, () => {
      return (0, _createPretender.response)([{
        topic_id: 123,
        highest_post_number: 12,
        last_read_post_number: 12,
        notification_level: 3,
        group_ids: []
      }]);
    });
  }

  (0, _qunitHelpers.discourseModule)("Unit | Model | private-message-topic-tracking-state", function (hooks) {
    let pmTopicTrackingState;
    hooks.beforeEach(function () {
      pmTopicTrackingState = _pmTopicTrackingState.default.create({
        messageBus: _messageBusClient.default,
        currentUser: _user.default.create({
          id: 77889,
          username: "test"
        })
      });
    });
    (0, _qunit.test)("modifying state calls onStateChange callbacks", function (assert) {
      let callbackCalled = false;
      pmTopicTrackingState.onStateChange("testing", () => {
        callbackCalled = true;
      });
      pmTopicTrackingState.set("isTracking", true);
      pmTopicTrackingState.removeTopics([]);
      assert.ok(callbackCalled);
    });
  });
  (0, _qunitHelpers.discourseModule)("Unit | Model | private-message-topic-tracking-state | processing new_topic message", function (hooks) {
    let pmTopicTrackingState;
    hooks.beforeEach(async function () {
      setupPretender();
      pmTopicTrackingState = _pmTopicTrackingState.default.create({
        messageBus: _messageBusClient.default,
        currentUser: _user.default.create({
          id: 77889,
          username: "test"
        })
      });
      await pmTopicTrackingState.startTracking();
    });
    (0, _qunit.test)("modifies the topic state only if the topic was not created by the current user", async function (assert) {
      let payload = {
        last_read_post_number: null,
        highest_post_number: 1,
        group_ids: [],
        created_by_user_id: 5
      };
      await (0, _qunitHelpers.publishToMessageBus)("/private-message-topic-tracking-state/user/77889", {
        message_type: "new_topic",
        topic_id: 4398,
        payload
      });
      assert.deepEqual(pmTopicTrackingState.findState(4398), payload, "the new topic created by a different user is loaded into state");
      payload = {
        last_read_post_number: null,
        highest_post_number: 1,
        group_ids: [],
        created_by_user_id: 77889
      };
      await (0, _qunitHelpers.publishToMessageBus)("/private-message-topic-tracking-state/user/77889", {
        message_type: "new_topic",
        topic_id: 4400,
        payload
      });
      assert.deepEqual(pmTopicTrackingState.findState(4400), undefined, "the new topic created by the current user is not loaded into state");
    });
  });
  (0, _qunitHelpers.discourseModule)("Unit | Model | private-message-topic-tracking-state | processing unread message", function (hooks) {
    let pmTopicTrackingState;
    hooks.beforeEach(async function () {
      setupPretender();
      pmTopicTrackingState = _pmTopicTrackingState.default.create({
        messageBus: _messageBusClient.default,
        currentUser: _user.default.create({
          id: 77889,
          username: "test"
        })
      });
      await pmTopicTrackingState.startTracking();
    });
    (0, _qunit.test)("modifies the last_read_post_number and highest_post_number", async function (assert) {
      let payload = {
        last_read_post_number: 12,
        highest_post_number: 13,
        notification_level: 3,
        group_ids: [],
        created_by_user_id: 5
      };
      await (0, _qunitHelpers.publishToMessageBus)("/private-message-topic-tracking-state/user/77889", {
        message_type: "unread",
        topic_id: 123,
        payload
      });
      let state = pmTopicTrackingState.findState(123);
      assert.deepEqual(state.highest_post_number, 13, "the unread payload triggered by a different user creating a new post updates the state with the correct highest_post_number");
      assert.deepEqual(state.last_read_post_number, 12, "the unread payload triggered by a different user creating a new post updates the state with the correct last_read_post_number");
      payload = {
        last_read_post_number: 14,
        highest_post_number: 14,
        notification_level: 3,
        group_ids: [],
        created_by_user_id: 77889
      };
      await (0, _qunitHelpers.publishToMessageBus)("/private-message-topic-tracking-state/user/77889", {
        message_type: "unread",
        topic_id: 123,
        payload
      });
      state = pmTopicTrackingState.findState(123);
      assert.deepEqual(state.highest_post_number, 14, "the unread payload triggered by the current user creating a new post updates the state with the correct highest_post_number");
      assert.deepEqual(state.last_read_post_number, 14, "the unread payload triggered by the current user creating a new post updates the state with the correct last_read_post_number");
    });
  });
});
define("discourse/tests/unit/models/report-test", ["qunit", "admin/models/report", "discourse-common/lib/get-url"], function (_qunit, _report, _getUrl) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"admin/models/report",0,"discourse-common/lib/get-url"eaimeta@70e063a35619d71f

  function reportWithData(data) {
    return _report.default.create({
      type: "topics",
      data: data.map((val, index) => {
        return {
          x: moment().subtract(index, "days").format("YYYY-MM-DD"),
          y: val
        };
      })
    });
  }

  (0, _qunit.module)("Unit | Model | report", function () {
    (0, _qunit.test)("counts", function (assert) {
      const report = reportWithData([5, 4, 3, 2, 1, 100, 99, 98, 1000]);
      assert.strictEqual(report.get("todayCount"), 5);
      assert.strictEqual(report.get("yesterdayCount"), 4);
      assert.strictEqual(report.valueFor(2, 4), 6, "adds the values for the given range of days, inclusive");
      assert.strictEqual(report.get("lastSevenDaysCount"), 307, "sums 7 days excluding today");
      report.set("type", "time_to_first_response");
      assert.strictEqual(report.valueFor(2, 4), 2, "averages the values for the given range of days");
    });
    (0, _qunit.test)("percentChangeString", function (assert) {
      const report = reportWithData([]);
      assert.strictEqual(report.percentChangeString(5, 8), "+60%", "value increased");
      assert.strictEqual(report.percentChangeString(8, 2), "-75%", "value decreased");
      assert.strictEqual(report.percentChangeString(8, 8), "0%", "value unchanged");
      assert.blank(report.percentChangeString(0, 8), "returns blank when previous value was 0");
      assert.strictEqual(report.percentChangeString(8, 0), "-100%", "yesterday was 0");
      assert.blank(report.percentChangeString(0, 0), "returns blank when both were 0");
    });
    (0, _qunit.test)("yesterdayCountTitle with valid values", function (assert) {
      const title = reportWithData([6, 8, 5, 2, 1]).get("yesterdayCountTitle");
      assert.ok(title.includes("+60%"));
      assert.ok(title.match(/Was 5/));
    });
    (0, _qunit.test)("yesterdayCountTitle when two days ago was 0", function (assert) {
      const title = reportWithData([6, 8, 0, 2, 1]).get("yesterdayCountTitle");
      assert.ok(!title.includes("%"));
      assert.ok(title.match(/Was 0/));
    });
    (0, _qunit.test)("sevenDaysCountTitle", function (assert) {
      const title = reportWithData([100, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 100, 100]).get("sevenDaysCountTitle");
      assert.ok(title.match(/-50%/));
      assert.ok(title.match(/Was 14/));
    });
    (0, _qunit.test)("thirtyDaysCountTitle", function (assert) {
      let report = reportWithData([5, 5, 5, 5]);
      report.set("prev30Days", 10);
      let title = report.get("thirtyDaysCountTitle");
      assert.ok(title.includes("+50%"));
      assert.ok(title.match(/Was 10/));
      report = reportWithData([5, 5, 5, 5]);
      report.set("prev_period", 20);
      title = report.get("thirtyDaysCountTitle");
      assert.ok(title.includes("-25%"));
      assert.ok(title.match(/Was 20/));
    });
    (0, _qunit.test)("sevenDaysTrend", function (assert) {
      let report;
      let trend;
      report = reportWithData([0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]);
      trend = report.get("sevenDaysTrend");
      assert.ok(trend === "no-change");
      report = reportWithData([0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0]);
      trend = report.get("sevenDaysTrend");
      assert.ok(trend === "high-trending-up");
      report = reportWithData([0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0]);
      trend = report.get("sevenDaysTrend");
      assert.ok(trend === "trending-up");
      report = reportWithData([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1]);
      trend = report.get("sevenDaysTrend");
      assert.ok(trend === "high-trending-down");
      report = reportWithData([0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1]);
      trend = report.get("sevenDaysTrend");
      assert.ok(trend === "trending-down");
    });
    (0, _qunit.test)("yesterdayTrend", function (assert) {
      let report;
      let trend;
      report = reportWithData([0, 1, 1]);
      trend = report.get("yesterdayTrend");
      assert.ok(trend === "no-change");
      report = reportWithData([0, 1, 0]);
      trend = report.get("yesterdayTrend");
      assert.ok(trend === "high-trending-up");
      report = reportWithData([0, 1.1, 1]);
      trend = report.get("yesterdayTrend");
      assert.ok(trend === "trending-up");
      report = reportWithData([0, 0, 1]);
      trend = report.get("yesterdayTrend");
      assert.ok(trend === "high-trending-down");
      report = reportWithData([0, 1, 1.1]);
      trend = report.get("yesterdayTrend");
      assert.ok(trend === "trending-down");
    });
    (0, _qunit.test)("thirtyDaysTrend", function (assert) {
      let report;
      let trend;
      report = reportWithData([0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]);
      report.set("prev30Days", 30);
      trend = report.get("thirtyDaysTrend");
      assert.ok(trend === "no-change");
      report = reportWithData([0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]);
      report.set("prev30Days", 0);
      trend = report.get("thirtyDaysTrend");
      assert.ok(trend === "high-trending-up");
      report = reportWithData([0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]);
      report.set("prev30Days", 25);
      trend = report.get("thirtyDaysTrend");
      assert.ok(trend === "trending-up");
      report = reportWithData([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
      report.set("prev30Days", 60);
      trend = report.get("thirtyDaysTrend");
      assert.ok(trend === "high-trending-down");
      report = reportWithData([0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0]);
      report.set("prev30Days", 35);
      trend = report.get("thirtyDaysTrend");
      assert.ok(trend === "trending-down");
    });
    (0, _qunit.test)("higher is better false", function (assert) {
      let report;
      let trend;
      report = reportWithData([0, 1, 0]);
      report.set("higher_is_better", false);
      trend = report.get("yesterdayTrend");
      assert.ok(trend === "high-trending-down");
      report = reportWithData([0, 1.1, 1]);
      report.set("higher_is_better", false);
      trend = report.get("yesterdayTrend");
      assert.ok(trend === "trending-down");
      report = reportWithData([0, 0, 1]);
      report.set("higher_is_better", false);
      trend = report.get("yesterdayTrend");
      assert.ok(trend === "high-trending-up");
      report = reportWithData([0, 1, 1.1]);
      report.set("higher_is_better", false);
      trend = report.get("yesterdayTrend");
      assert.ok(trend === "trending-up");
    });
    (0, _qunit.test)("small variation (-2/+2% change) is no-change", function (assert) {
      let report;
      let trend;
      report = reportWithData([0, 1, 1, 1, 1, 1, 1, 0.9, 1, 1, 1, 1, 1, 1, 1]);
      trend = report.get("sevenDaysTrend");
      assert.ok(trend === "no-change");
      report = reportWithData([0, 1, 1, 1, 1, 1, 1, 1.1, 1, 1, 1, 1, 1, 1, 1]);
      trend = report.get("sevenDaysTrend");
      assert.ok(trend === "no-change");
    });
    (0, _qunit.test)("average", function (assert) {
      let report;
      report = reportWithData([5, 5, 5, 5, 5, 5, 5, 5]);
      report.set("average", true);
      assert.ok(report.get("lastSevenDaysCount") === 5);
      report.set("average", false);
      assert.ok(report.get("lastSevenDaysCount") === 35);
    });
    (0, _qunit.test)("computed labels", function (assert) {
      const data = [{
        username: "joffrey",
        user_id: 1,
        user_avatar: "/",
        flag_count: "1876",
        time_read: 287362,
        note: "This is a long note",
        topic_id: 2,
        topic_title: "Test topic <html>",
        post_number: 3,
        post_raw: "This is the beginning of <html>",
        filesize: 582641
      }];
      const labels = [{
        type: "user",
        properties: {
          username: "username",
          id: "user_id",
          avatar: "user_avatar"
        },
        title: "Moderator"
      }, {
        type: "number",
        property: "flag_count",
        title: "Flag count"
      }, {
        type: "seconds",
        property: "time_read",
        title: "Time read"
      }, {
        type: "text",
        property: "note",
        title: "Note"
      }, {
        type: "topic",
        properties: {
          title: "topic_title",
          id: "topic_id"
        },
        title: "Topic"
      }, {
        type: "post",
        properties: {
          topic_id: "topic_id",
          number: "post_number",
          truncated_raw: "post_raw"
        },
        title: "Post"
      }, {
        type: "bytes",
        property: "filesize",
        title: "Filesize"
      }];

      const report = _report.default.create({
        type: "topics",
        labels,
        data
      });

      const row = report.get("data.0");
      const computedLabels = report.get("computedLabels");
      const usernameLabel = computedLabels[0];
      assert.strictEqual(usernameLabel.mainProperty, "username");
      assert.strictEqual(usernameLabel.sortProperty, "username");
      assert.strictEqual(usernameLabel.title, "Moderator");
      assert.strictEqual(usernameLabel.type, "user");
      const computedUsernameLabel = usernameLabel.compute(row);
      assert.strictEqual(computedUsernameLabel.formattedValue, "<a href='/admin/users/1/joffrey'><img loading='lazy' alt='' width='20' height='20' src='/' class='avatar' title='joffrey' aria-label='joffrey'><span class='username'>joffrey</span></a>");
      assert.strictEqual(computedUsernameLabel.value, "joffrey");
      const flagCountLabel = computedLabels[1];
      assert.strictEqual(flagCountLabel.mainProperty, "flag_count");
      assert.strictEqual(flagCountLabel.sortProperty, "flag_count");
      assert.strictEqual(flagCountLabel.title, "Flag count");
      assert.strictEqual(flagCountLabel.type, "number");
      let computedFlagCountLabel = flagCountLabel.compute(row);
      assert.strictEqual(computedFlagCountLabel.formattedValue, "1.9k");
      assert.strictEqual(computedFlagCountLabel.value, 1876);
      computedFlagCountLabel = flagCountLabel.compute(row, {
        formatNumbers: false
      });
      assert.strictEqual(computedFlagCountLabel.formattedValue, "1876");
      const timeReadLabel = computedLabels[2];
      assert.strictEqual(timeReadLabel.mainProperty, "time_read");
      assert.strictEqual(timeReadLabel.sortProperty, "time_read");
      assert.strictEqual(timeReadLabel.title, "Time read");
      assert.strictEqual(timeReadLabel.type, "seconds");
      const computedTimeReadLabel = timeReadLabel.compute(row);
      assert.strictEqual(computedTimeReadLabel.formattedValue, "3d");
      assert.strictEqual(computedTimeReadLabel.value, 287362);
      const noteLabel = computedLabels[3];
      assert.strictEqual(noteLabel.mainProperty, "note");
      assert.strictEqual(noteLabel.sortProperty, "note");
      assert.strictEqual(noteLabel.title, "Note");
      assert.strictEqual(noteLabel.type, "text");
      const computedNoteLabel = noteLabel.compute(row);
      assert.strictEqual(computedNoteLabel.formattedValue, "This is a long note");
      assert.strictEqual(computedNoteLabel.value, "This is a long note");
      const topicLabel = computedLabels[4];
      assert.strictEqual(topicLabel.mainProperty, "topic_title");
      assert.strictEqual(topicLabel.sortProperty, "topic_title");
      assert.strictEqual(topicLabel.title, "Topic");
      assert.strictEqual(topicLabel.type, "topic");
      const computedTopicLabel = topicLabel.compute(row);
      assert.strictEqual(computedTopicLabel.formattedValue, "<a href='/t/-/2'>Test topic &lt;html&gt;</a>");
      assert.strictEqual(computedTopicLabel.value, "Test topic <html>");
      const postLabel = computedLabels[5];
      assert.strictEqual(postLabel.mainProperty, "post_raw");
      assert.strictEqual(postLabel.sortProperty, "post_raw");
      assert.strictEqual(postLabel.title, "Post");
      assert.strictEqual(postLabel.type, "post");
      const computedPostLabel = postLabel.compute(row);
      assert.strictEqual(computedPostLabel.formattedValue, "<a href='/t/-/2/3'>This is the beginning of &lt;html&gt;</a>");
      assert.strictEqual(computedPostLabel.value, "This is the beginning of <html>");
      const filesizeLabel = computedLabels[6];
      assert.strictEqual(filesizeLabel.mainProperty, "filesize");
      assert.strictEqual(filesizeLabel.sortProperty, "filesize");
      assert.strictEqual(filesizeLabel.title, "Filesize");
      assert.strictEqual(filesizeLabel.type, "bytes");
      const computedFilesizeLabel = filesizeLabel.compute(row);
      assert.strictEqual(computedFilesizeLabel.formattedValue, "569.0 KB");
      assert.strictEqual(computedFilesizeLabel.value, 582641); // subfolder support

      (0, _getUrl.setPrefix)("/forum");
      const postLink = computedLabels[5].compute(row).formattedValue;
      assert.strictEqual(postLink, "<a href='/forum/t/-/2/3'>This is the beginning of &lt;html&gt;</a>");
      const topicLink = computedLabels[4].compute(row).formattedValue;
      assert.strictEqual(topicLink, "<a href='/forum/t/-/2'>Test topic &lt;html&gt;</a>");
      const userLink = computedLabels[0].compute(row).formattedValue;
      assert.strictEqual(userLink, "<a href='/forum/admin/users/1/joffrey'><img loading='lazy' alt='' width='20' height='20' src='/forum/' class='avatar' title='joffrey' aria-label='joffrey'><span class='username'>joffrey</span></a>");
    });
  });
});
define("discourse/tests/unit/models/rest-model-test", ["qunit", "discourse/adapters/rest", "discourse/models/rest", "discourse/tests/helpers/create-store", "sinon"], function (_qunit, _rest, _rest2, _createStore, _sinon) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/adapters/rest",0,"discourse/models/rest",0,"discourse/tests/helpers/create-store",0,"sinon"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Model | rest-model", function () {
    (0, _qunit.test)("munging", function (assert) {
      const store = (0, _createStore.default)();

      const Grape = _rest2.default.extend();

      Grape.reopenClass({
        munge: function (json) {
          json.inverse = 1 - json.percent;
          return json;
        }
      });
      let g = Grape.create({
        store,
        percent: 0.4
      });
      assert.strictEqual(g.get("inverse"), 0.6, "it runs `munge` on `create`");
    });
    (0, _qunit.test)("update", async function (assert) {
      const store = (0, _createStore.default)();
      const widget = await store.find("widget", 123);
      assert.strictEqual(widget.get("name"), "Trout Lure");
      assert.ok(!widget.get("isSaving"), "it is not saving");

      const spyBeforeUpdate = _sinon.default.spy(widget, "beforeUpdate");

      const spyAfterUpdate = _sinon.default.spy(widget, "afterUpdate");

      const promise = widget.update({
        name: "new name"
      });
      assert.ok(widget.get("isSaving"), "it is saving");
      assert.ok(spyBeforeUpdate.calledOn(widget));
      const result = await promise;
      assert.ok(spyAfterUpdate.calledOn(widget));
      assert.ok(!widget.get("isSaving"), "it is no longer saving");
      assert.strictEqual(widget.get("name"), "new name");
      assert.ok(result.target, "it has a reference to the record");
      assert.strictEqual(result.target.name, widget.get("name"));
    });
    (0, _qunit.test)("updating simultaneously", async function (assert) {
      assert.expect(2);
      const store = (0, _createStore.default)();
      const widget = await store.find("widget", 123);
      const firstPromise = widget.update({
        name: "new name"
      });
      const secondPromise = widget.update({
        name: "new name"
      });
      firstPromise.then(function () {
        assert.ok(true, "the first promise succeeds");
      });
      secondPromise.catch(function () {
        assert.ok(true, "the second promise fails");
      });
    });
    (0, _qunit.test)("save new", async function (assert) {
      const store = (0, _createStore.default)();
      const widget = store.createRecord("widget");
      assert.ok(widget.get("isNew"), "it is a new record");
      assert.ok(!widget.get("isCreated"), "it is not created");
      assert.ok(!widget.get("isSaving"), "it is not saving");

      const spyBeforeCreate = _sinon.default.spy(widget, "beforeCreate");

      const spyAfterCreate = _sinon.default.spy(widget, "afterCreate");

      const promise = widget.save({
        name: "Evil Widget"
      });
      assert.ok(widget.get("isSaving"), "it is not saving");
      assert.ok(spyBeforeCreate.calledOn(widget));
      const result = await promise;
      assert.ok(spyAfterCreate.calledOn(widget));
      assert.ok(!widget.get("isSaving"), "it is no longer saving");
      assert.ok(widget.get("id"), "it has an id");
      assert.ok(widget.get("name"), "Evil Widget");
      assert.ok(widget.get("isCreated"), "it is created");
      assert.ok(!widget.get("isNew"), "it is no longer new");
      assert.ok(result.target, "it has a reference to the record");
      assert.strictEqual(result.target.name, widget.get("name"));
    });
    (0, _qunit.test)("creating simultaneously", function (assert) {
      assert.expect(2);
      const store = (0, _createStore.default)();
      const widget = store.createRecord("widget");
      const firstPromise = widget.save({
        name: "Evil Widget"
      });
      const secondPromise = widget.save({
        name: "Evil Widget"
      });
      firstPromise.then(function () {
        assert.ok(true, "the first promise succeeds");
      });
      secondPromise.catch(function () {
        assert.ok(true, "the second promise fails");
      });
    });
    (0, _qunit.test)("destroyRecord", async function (assert) {
      const store = (0, _createStore.default)();
      const widget = await store.find("widget", 123);
      assert.ok(await widget.destroyRecord());
    });
    (0, _qunit.test)("custom api name", async function (assert) {
      const store = (0, _createStore.default)(type => {
        if (type === "adapter:my-widget") {
          return _rest.default.extend({
            // An adapter like this is used when the server-side key/url
            // do not match the name of the es6 class
            apiNameFor() {
              return "widget";
            }

          }).create();
        }
      }); // The pretenders only respond to requests for `widget`
      // If these basic tests pass, the name override worked correctly
      //Create

      const widget = store.createRecord("my-widget");
      await widget.save({
        name: "Evil Widget"
      });
      assert.strictEqual(widget.id, 100, "it saved a new record successfully");
      assert.strictEqual(widget.get("name"), "Evil Widget"); // Update

      await widget.update({
        name: "new name"
      });
      assert.strictEqual(widget.get("name"), "new name"); // Destroy

      await widget.destroyRecord(); // Lookup

      const foundWidget = await store.find("my-widget", 123);
      assert.strictEqual(foundWidget.name, "Trout Lure");
    });
  });
});
define("discourse/tests/unit/models/result-set-test", ["qunit", "discourse/models/result-set", "discourse/tests/helpers/create-store"], function (_qunit, _resultSet, _createStore) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/models/result-set",0,"discourse/tests/helpers/create-store"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Model | result-set", function () {
    (0, _qunit.test)("defaults", function (assert) {
      const resultSet = _resultSet.default.create({
        content: []
      });

      assert.strictEqual(resultSet.get("length"), 0);
      assert.strictEqual(resultSet.get("totalRows"), 0);
      assert.ok(!resultSet.get("loadMoreUrl"));
      assert.ok(!resultSet.get("loading"));
      assert.ok(!resultSet.get("loadingMore"));
      assert.ok(!resultSet.get("refreshing"));
    });
    (0, _qunit.test)("pagination support", async function (assert) {
      const store = (0, _createStore.default)();
      const resultSet = await store.findAll("widget");
      assert.strictEqual(resultSet.get("length"), 2);
      assert.strictEqual(resultSet.get("totalRows"), 4);
      assert.ok(resultSet.get("loadMoreUrl"), "has a url to load more");
      assert.ok(!resultSet.get("loadingMore"), "it is not loading more");
      assert.ok(resultSet.get("canLoadMore"));
      const promise = resultSet.loadMore();
      assert.ok(resultSet.get("loadingMore"), "it is loading more");
      await promise;
      assert.ok(!resultSet.get("loadingMore"), "it finished loading more");
      assert.strictEqual(resultSet.get("length"), 4);
      assert.ok(!resultSet.get("loadMoreUrl"));
      assert.ok(!resultSet.get("canLoadMore"));
    });
    (0, _qunit.test)("refresh support", async function (assert) {
      const store = (0, _createStore.default)();
      const resultSet = await store.findAll("widget");
      assert.strictEqual(resultSet.get("refreshUrl"), "/widgets?refresh=true", "it has the refresh url");
      const promise = resultSet.refresh();
      assert.ok(resultSet.get("refreshing"), "it is refreshing");
      await promise;
      assert.ok(!resultSet.get("refreshing"), "it is finished refreshing");
    });
  });
});
define("discourse/tests/unit/models/session-test", ["qunit", "discourse/models/session"], function (_qunit, _session) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/models/session"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Model | session", function () {
    (0, _qunit.test)("highestSeenByTopic", function (assert) {
      const session = _session.default.current();

      assert.deepEqual(session.get("highestSeenByTopic"), {}, "by default it returns an empty object");
    });
  });
});
define("discourse/tests/unit/models/site-test", ["qunit", "discourse/models/site", "discourse/tests/helpers/create-store"], function (_qunit, _site, _createStore) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/models/site",0,"discourse/tests/helpers/create-store"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Model | site", function () {
    (0, _qunit.test)("create", function (assert) {
      assert.ok(_site.default.create(), "it can create with no parameters");
    });
    (0, _qunit.test)("instance", function (assert) {
      const site = _site.default.current();

      assert.present(site, "We have a current site singleton");
      assert.present(site.get("categories"), "The instance has a list of categories");
      assert.present(site.get("flagTypes"), "The instance has a list of flag types");
      assert.present(site.get("trustLevels"), "The instance has a list of trust levels");
    });
    (0, _qunit.test)("create categories", function (assert) {
      const store = (0, _createStore.default)();
      const site = store.createRecord("site", {
        categories: [{
          id: 3456,
          name: "Test Subcategory",
          parent_category_id: 1234
        }, {
          id: 1234,
          name: "Test"
        }, {
          id: 3458,
          name: "Invalid Subcategory",
          parent_category_id: 6666
        }]
      });
      assert.present(site.categories, "The categories are present");
      assert.deepEqual(site.categories.mapBy("name"), ["Test Subcategory", "Test", "Invalid Subcategory"]);
      assert.deepEqual(site.sortedCategories.mapBy("name"), ["Test", "Test Subcategory"]);
      const parent = site.categories.findBy("id", 1234);
      assert.present(parent, "it loaded the parent category");
      assert.blank(parent.parentCategory, "it has no parent category");
      assert.strictEqual(parent.subcategories.length, 1);
      const subcategory = site.categories.findBy("id", 3456);
      assert.present(subcategory, "it loaded the subcategory");
      assert.strictEqual(subcategory.parentCategory, parent, "it has associated the child with the parent"); // remove invalid category and child

      site.categories.removeObject(site.categories[2]);
      site.categories.removeObject(site.categories[0]);
      assert.strictEqual(site.categoriesByCount.length, site.categories.length, "categoriesByCount should change on removal");
      assert.strictEqual(site.sortedCategories.length, site.categories.length, "sortedCategories should change on removal");
    });
    (0, _qunit.test)("deeply nested categories", function (assert) {
      const store = (0, _createStore.default)();
      const site = store.createRecord("site", {
        categories: [{
          id: 1003,
          name: "Test Sub Sub",
          parent_category_id: 1002
        }, {
          id: 1001,
          name: "Test"
        }, {
          id: 1004,
          name: "Test Sub Sub Sub",
          parent_category_id: 1003
        }, {
          id: 1002,
          name: "Test Sub",
          parent_category_id: 1001
        }, {
          id: 1005,
          name: "Test Sub Sub Sub2",
          parent_category_id: 1003
        }, {
          id: 1006,
          name: "Test2"
        }]
      });
      assert.deepEqual(site.sortedCategories.mapBy("name"), ["Test", "Test Sub", "Test Sub Sub", "Test Sub Sub Sub", "Test Sub Sub Sub2", "Test2"]);
    });
  });
});
define("discourse/tests/unit/models/staff-action-log-test", ["qunit", "admin/models/staff-action-log"], function (_qunit, _staffActionLog) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"admin/models/staff-action-log"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Model | staff-action-log", function () {
    (0, _qunit.test)("create", function (assert) {
      assert.ok(_staffActionLog.default.create(), "it can be created without arguments");
    });
  });
});
define("discourse/tests/unit/models/theme-test", ["qunit", "admin/models/theme"], function (_qunit, _theme) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"admin/models/theme"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Model | theme", function () {
    (0, _qunit.test)("can add an upload correctly", function (assert) {
      let theme = _theme.default.create();

      assert.strictEqual(theme.get("uploads.length"), 0, "uploads should be an empty array");
      theme.setField("common", "bob", "", 999, 2);
      let fields = theme.get("theme_fields");
      assert.strictEqual(fields.length, 1, "expecting 1 theme field");
      assert.strictEqual(fields[0].upload_id, 999, "expecting upload id to be set");
      assert.strictEqual(fields[0].type_id, 2, "expecting type id to be set");
      assert.strictEqual(theme.get("uploads.length"), 1, "expecting an upload");
    });
  });
});
define("discourse/tests/unit/models/topic-details-test", ["qunit", "discourse/models/topic", "discourse/models/user"], function (_qunit, _topic, _user) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/models/topic",0,"discourse/models/user"eaimeta@70e063a35619d71f

  function buildDetails(id) {
    let topicParams = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    const topic = _topic.default.create(Object.assign({
      id
    }, topicParams));

    return topic.get("details");
  }

  (0, _qunit.module)("Unit | Model | topic-details", function () {
    (0, _qunit.test)("defaults", function (assert) {
      let details = buildDetails(1234);
      assert.present(details, "the details are present by default");
      assert.ok(!details.get("loaded"), "details are not loaded by default");
    });
    (0, _qunit.test)("updateFromJson", function (assert) {
      let details = buildDetails(1234);
      details.updateFromJson({
        allowed_users: [{
          username: "eviltrout"
        }]
      });
      assert.strictEqual(details.get("allowed_users.length"), 1, "it loaded the allowed users");
      assert.containsInstance(details.get("allowed_users"), _user.default);
    });
  });
});
define("discourse/tests/unit/models/topic-test", ["discourse/models/category", "discourse/models/topic", "discourse/models/user", "discourse/tests/helpers/qunit-helpers", "qunit", "pretty-text/emoji/version", "discourse/tests/helpers/create-store"], function (_category, _topic, _user, _qunitHelpers, _qunit, _version, _createStore) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/models/category",0,"discourse/models/topic",0,"discourse/models/user",0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"pretty-text/emoji/version",0,"discourse/tests/helpers/create-store"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Model | topic", function () {
    (0, _qunit.test)("defaults", function (assert) {
      const topic = _topic.default.create({
        id: 1234
      });

      assert.blank(topic.get("deleted_at"), "deleted_at defaults to blank");
      assert.blank(topic.get("deleted_by"), "deleted_by defaults to blank");
    });
    (0, _qunit.test)("visited", function (assert) {
      const topic = _topic.default.create({
        highest_post_number: 2,
        last_read_post_number: 1
      });

      assert.notOk(topic.get("visited"), "not visited unless we've read all the posts");
      topic.set("last_read_post_number", 2);
      assert.ok(topic.get("visited"), "is visited once we've read all the posts");
      topic.set("last_read_post_number", 3);
      assert.ok(topic.get("visited"), "is visited if we've read all the posts and some are deleted at the end");
    });
    (0, _qunit.test)("lastUnreadUrl", function (assert) {
      const store = (0, _createStore.default)();
      const category = store.createRecord("category", {
        id: 22,
        navigate_to_first_post_after_read: true
      });

      const topic = _topic.default.create({
        id: 101,
        highest_post_number: 10,
        last_read_post_number: 10,
        slug: "hello",
        category_id: category.id
      });

      assert.strictEqual(topic.get("lastUnreadUrl"), "/t/hello/101/1");
    });
    (0, _qunit.test)("has details", function (assert) {
      const topic = _topic.default.create({
        id: 1234
      });

      const topicDetails = topic.get("details");
      assert.present(topicDetails, "a topic has topicDetails after we create it");
      assert.strictEqual(topicDetails.get("topic"), topic, "the topicDetails has a reference back to the topic");
    });
    (0, _qunit.test)("has a postStream", function (assert) {
      const topic = _topic.default.create({
        id: 1234
      });

      const postStream = topic.get("postStream");
      assert.present(postStream, "a topic has a postStream after we create it");
      assert.strictEqual(postStream.get("topic"), topic, "the postStream has a reference back to the topic");
    });
    (0, _qunit.test)("has suggestedTopics", function (assert) {
      const topic = _topic.default.create({
        suggested_topics: [{
          id: 1
        }, {
          id: 2
        }]
      });

      const suggestedTopics = topic.get("suggestedTopics");
      assert.strictEqual(suggestedTopics.length, 2, "it loaded the suggested_topics");
      assert.containsInstance(suggestedTopics, _topic.default);
    });
    (0, _qunit.test)("category relationship", function (assert) {
      // It finds the category by id
      const category = _category.default.list()[0];

      const topic = _topic.default.create({
        id: 1111,
        category_id: category.get("id")
      });

      assert.strictEqual(topic.get("category"), category);
    });
    (0, _qunit.test)("updateFromJson", function (assert) {
      const topic = _topic.default.create({
        id: 1234
      });

      const category = _category.default.list()[0];

      topic.updateFromJson({
        post_stream: [1, 2, 3],
        details: {
          hello: "world"
        },
        cool: "property",
        category_id: category.get("id")
      });
      assert.blank(topic.get("post_stream"), "it does not update post_stream");
      assert.strictEqual(topic.get("details.hello"), "world", "it updates the details");
      assert.strictEqual(topic.get("cool"), "property", "it updates other properties");
      assert.strictEqual(topic.get("category"), category);
    });
    (0, _qunit.test)("recover", async function (assert) {
      const user = _user.default.create({
        username: "eviltrout"
      });

      const topic = _topic.default.create({
        id: 1234,
        deleted_at: new Date(),
        deleted_by: user
      });

      await topic.recover();
      assert.blank(topic.get("deleted_at"), "it clears deleted_at");
      assert.blank(topic.get("deleted_by"), "it clears deleted_by");
    });
    (0, _qunit.test)("fancyTitle", function (assert) {
      const topic = _topic.default.create({
        fancy_title: ":smile: with all :) the emojis :pear::peach:"
      });

      assert.strictEqual(topic.get("fancyTitle"), `<img width=\"20\" height=\"20\" src='/images/emoji/google_classic/smile.png?v=${_version.IMAGE_VERSION}' title='smile' alt='smile' class='emoji'> with all <img width=\"20\" height=\"20\" src='/images/emoji/google_classic/slight_smile.png?v=${_version.IMAGE_VERSION}' title='slight_smile' alt='slight_smile' class='emoji'> the emojis <img width=\"20\" height=\"20\" src='/images/emoji/google_classic/pear.png?v=${_version.IMAGE_VERSION}' title='pear' alt='pear' class='emoji'><img width=\"20\" height=\"20\" src='/images/emoji/google_classic/peach.png?v=${_version.IMAGE_VERSION}' title='peach' alt='peach' class='emoji'>`, "supports emojis");
    });
    (0, _qunit.test)("fancyTitle direction", function (assert) {
      const rtlTopic = _topic.default.create({
        fancy_title: " "
      });

      const ltrTopic = _topic.default.create({
        fancy_title: "This is a test"
      });

      this.siteSettings.support_mixed_text_direction = true;
      assert.strictEqual(rtlTopic.get("fancyTitle"), `<span dir="rtl"> </span>`, "sets the dir-span to rtl");
      assert.strictEqual(ltrTopic.get("fancyTitle"), `<span dir="ltr">This is a test</span>`, "sets the dir-span to ltr");
    });
    (0, _qunit.test)("excerpt", function (assert) {
      const topic = _topic.default.create({
        excerpt: "This is a test topic :smile:",
        pinned: true
      });

      assert.strictEqual(topic.get("escapedExcerpt"), `This is a test topic <img width=\"20\" height=\"20\" src='/images/emoji/google_classic/smile.png?v=${_version.IMAGE_VERSION}' title='smile' alt='smile' class='emoji'>`, "supports emojis");
    });
    (0, _qunit.test)("visible & invisible", function (assert) {
      const topic = _topic.default.create();

      assert.strictEqual(topic.visible, undefined);
      assert.strictEqual(topic.invisible, undefined);

      const visibleTopic = _topic.default.create({
        visible: true
      });

      assert.strictEqual(visibleTopic.visible, true);
      assert.strictEqual(visibleTopic.invisible, false);

      const invisibleTopic = _topic.default.create({
        visible: false
      });

      assert.strictEqual(invisibleTopic.visible, false);
      assert.strictEqual(invisibleTopic.invisible, true);
    });
  });
});
define("discourse/tests/unit/models/topic-tracking-state-test", ["qunit", "discourse/lib/url", "@ember/object", "discourse/models/category", "message-bus-client", "discourse/tests/helpers/qunit-helpers", "discourse/lib/notification-levels", "discourse/models/topic-tracking-state", "discourse/models/user", "discourse/models/topic", "discourse/tests/helpers/create-store", "sinon"], function (_qunit, _url, _object, _category, _messageBusClient, _qunitHelpers, _notificationLevels, _topicTrackingState, _user, _topic, _createStore, _sinon) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/lib/url",0,"@ember/object",0,"discourse/models/category",0,"message-bus-client",0,"discourse/tests/helpers/qunit-helpers",0,"discourse/lib/notification-levels",0,"discourse/models/topic-tracking-state",0,"discourse/models/user",0,"discourse/models/topic",0,"discourse/tests/helpers/create-store",0,"sinon"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Model | topic-tracking-state", function (hooks) {
    hooks.beforeEach(function () {
      this.clock = (0, _qunitHelpers.fakeTime)("2012-12-31 12:00");
    });
    hooks.afterEach(function () {
      this.clock.restore();
    });
    (0, _qunit.test)("bulk loading states only calls onStateChange callback once", function (assert) {
      const trackingState = _topicTrackingState.default.create();

      let stateCallbackCalled = 0;
      trackingState.onStateChange(() => {
        stateCallbackCalled += 1;
      });
      trackingState.loadStates([{
        topic_id: 1
      }, {
        topic_id: 2
      }, {
        topic_id: 3
      }]);
      assert.strictEqual(stateCallbackCalled, 1, "callback is only called once");
    });
    (0, _qunit.test)("tag counts", function (assert) {
      const trackingState = _topicTrackingState.default.create();

      trackingState.loadStates([{
        topic_id: 1,
        last_read_post_number: null,
        tags: ["foo", "baz"],
        created_in_new_period: true
      }, {
        topic_id: 2,
        last_read_post_number: null,
        tags: ["baz"],
        created_in_new_period: true
      }, {
        topic_id: 3,
        last_read_post_number: null,
        tags: ["random"]
      }, {
        topic_id: 4,
        last_read_post_number: 1,
        highest_post_number: 7,
        tags: ["pending"],
        notification_level: _notificationLevels.NotificationLevels.TRACKING
      }, {
        topic_id: 5,
        last_read_post_number: 1,
        highest_post_number: 7,
        tags: ["bar", "pending"],
        notification_level: _notificationLevels.NotificationLevels.TRACKING
      }, {
        topic_id: 6,
        last_read_post_number: 1,
        highest_post_number: 7,
        tags: null,
        notification_level: _notificationLevels.NotificationLevels.TRACKING
      }]);
      const tagCounts = trackingState.countTags(["baz", "pending"]);
      assert.strictEqual(tagCounts["baz"].newCount, 2, "baz tag new counts");
      assert.strictEqual(tagCounts["baz"].unreadCount, 0, "baz tag unread counts");
      assert.strictEqual(tagCounts["pending"].unreadCount, 2, "pending tag unread counts");
      assert.strictEqual(tagCounts["pending"].newCount, 0, "pending tag new counts");
    });
    (0, _qunit.test)("tag counts - with total", function (assert) {
      const trackingState = _topicTrackingState.default.create();

      trackingState.loadStates([{
        topic_id: 1,
        last_read_post_number: null,
        tags: ["foo", "baz"],
        created_in_new_period: true
      }, {
        topic_id: 2,
        last_read_post_number: null,
        tags: ["baz"],
        created_in_new_period: true
      }, {
        topic_id: 3,
        last_read_post_number: null,
        tags: ["random"]
      }, {
        topic_id: 4,
        last_read_post_number: 1,
        highest_post_number: 7,
        tags: ["pending"],
        notification_level: _notificationLevels.NotificationLevels.TRACKING
      }, {
        topic_id: 5,
        last_read_post_number: 1,
        highest_post_number: 7,
        tags: ["bar", "pending"],
        notification_level: _notificationLevels.NotificationLevels.TRACKING
      }, {
        topic_id: 6,
        last_read_post_number: 1,
        highest_post_number: 7,
        tags: null,
        notification_level: _notificationLevels.NotificationLevels.TRACKING
      }, {
        topic_id: 7,
        last_read_post_number: 7,
        highest_post_number: 7,
        tags: ["foo", "baz"]
      }, {
        topic_id: 8,
        last_read_post_number: 4,
        highest_post_number: 4,
        tags: ["pending"],
        notification_level: _notificationLevels.NotificationLevels.TRACKING
      }, {
        topic_id: 9,
        last_read_post_number: 88,
        highest_post_number: 88,
        tags: ["pending"],
        notification_level: _notificationLevels.NotificationLevels.TRACKING
      }]);
      const states = trackingState.countTags(["baz", "pending"], {
        includeTotal: true
      });
      assert.strictEqual(states["baz"].newCount, 2, "baz tag new counts");
      assert.strictEqual(states["baz"].unreadCount, 0, "baz tag unread counts");
      assert.strictEqual(states["baz"].totalCount, 3, "baz tag total counts");
      assert.strictEqual(states["pending"].unreadCount, 2, "pending tag unread counts");
      assert.strictEqual(states["pending"].newCount, 0, "pending tag new counts");
      assert.strictEqual(states["pending"].totalCount, 4, "pending tag total counts");
    });
    (0, _qunit.test)("forEachTracked", function (assert) {
      const trackingState = _topicTrackingState.default.create();

      trackingState.loadStates([{
        topic_id: 1,
        last_read_post_number: null,
        tags: ["foo", "new"]
      }, {
        topic_id: 2,
        last_read_post_number: null,
        tags: ["new"]
      }, {
        topic_id: 3,
        last_read_post_number: null,
        tags: ["random"],
        created_in_new_period: true
      }, {
        topic_id: 4,
        last_read_post_number: 1,
        highest_post_number: 7,
        category_id: 7,
        tags: ["bug"],
        notification_level: _notificationLevels.NotificationLevels.TRACKING
      }, {
        topic_id: 5,
        last_read_post_number: 1,
        highest_post_number: 7,
        tags: ["bar", "bug"],
        category_id: 7,
        notification_level: _notificationLevels.NotificationLevels.TRACKING
      }, {
        topic_id: 6,
        last_read_post_number: 1,
        highest_post_number: 7,
        tags: null,
        notification_level: _notificationLevels.NotificationLevels.TRACKING
      }]);
      let randomUnread = 0,
          randomNew = 0,
          sevenUnread = 0,
          sevenNew = 0;
      trackingState.forEachTracked((topic, isNew, isUnread) => {
        if (topic.category_id === 7) {
          if (isNew) {
            sevenNew += 1;
          }

          if (isUnread) {
            sevenUnread += 1;
          }
        }

        if (topic.tags?.includes("random")) {
          if (isNew) {
            randomNew += 1;
          }

          if (isUnread) {
            randomUnread += 1;
          }
        }
      });
      assert.strictEqual(randomNew, 1, "random tag new");
      assert.strictEqual(randomUnread, 0, "random tag unread");
      assert.strictEqual(sevenNew, 0, "category seven new");
      assert.strictEqual(sevenUnread, 2, "category seven unread");
    });
    (0, _qunit.test)("sync - delayed new topics for backend list are removed", function (assert) {
      const trackingState = _topicTrackingState.default.create();

      trackingState.loadStates([{
        last_read_post_number: null,
        topic_id: 111
      }]);
      trackingState.updateSeen(111, 7);
      const list = {
        topics: [{
          highest_post_number: null,
          id: 111,
          unread_posts: 10
        }]
      };
      trackingState.sync(list, "new");
      assert.strictEqual(list.topics.length, 0, "expect new topic to be removed as it was seen");
    });
    (0, _qunit.test)("sync - delayed unread topics for backend list are marked seen", function (assert) {
      const trackingState = _topicTrackingState.default.create();

      trackingState.loadStates([{
        last_read_post_number: null,
        topic_id: 111
      }]);
      trackingState.updateSeen(111, 7);
      const list = {
        topics: [_topic.default.create({
          highest_post_number: null,
          id: 111,
          unread_posts: 10,
          unseen: true,
          prevent_sync: false
        })]
      };
      trackingState.sync(list, "unread");
      assert.strictEqual(list.topics[0].unseen, false, "expect unread topic to be marked as seen");
      assert.strictEqual(list.topics[0].prevent_sync, true, "expect unread topic to be marked as prevent_sync");
    });
    (0, _qunit.test)("sync - remove topic from state for performance if it is seen and has no unread or new posts and there are too many tracked topics in memory", function (assert) {
      const trackingState = _topicTrackingState.default.create();

      trackingState.loadStates([{
        topic_id: 111
      }, {
        topic_id: 222
      }]);
      trackingState.set("_trackedTopicLimit", 1);
      const list = {
        topics: [_topic.default.create({
          id: 111,
          unseen: false,
          seen: true,
          unread_posts: 0,
          prevent_sync: false
        })]
      };
      trackingState.sync(list, "unread");
      assert.notOk(trackingState.states.has("t111"), "expect state for topic 111 to be deleted");
      trackingState.loadStates([{
        topic_id: 111
      }, {
        topic_id: 222
      }]);
      trackingState.set("_trackedTopicLimit", 5);
      trackingState.sync(list, "unread");
      assert.ok(trackingState.states.has("t111"), "expect state for topic 111 not to be deleted");
    });
    (0, _qunit.test)("sync - no changes to state", function (assert) {
      const trackingState = _topicTrackingState.default.create();

      trackingState.loadStates([{
        topic_id: 111,
        last_read_post_number: null
      }, {
        topic_id: 222,
        last_read_post_number: null
      }]);
      let stateCallbackCalled = 0;
      trackingState.onStateChange(() => {
        stateCallbackCalled += 1;
      });
      const list = {
        topics: [_topic.default.create({
          id: 111,
          last_read_post_number: null,
          unseen: true
        }), _topic.default.create({
          id: 222,
          last_read_post_number: null,
          unseen: true
        })]
      };
      trackingState.sync(list, "unread");
      assert.strictEqual(stateCallbackCalled, 0, "callback is not called");
    });
    (0, _qunit.test)("sync - updates state to match list topic for unseen and unread/new topics", function (assert) {
      const trackingState = _topicTrackingState.default.create();

      trackingState.loadStates([{
        topic_id: 111,
        last_read_post_number: 0
      }, {
        topic_id: 222,
        last_read_post_number: 1
      }]);
      let stateCallbackCalled = 0;
      trackingState.onStateChange(() => {
        stateCallbackCalled += 1;
      });
      const list = {
        topics: [_topic.default.create({
          id: 111,
          unseen: true,
          seen: false,
          unread_posts: 0,
          highest_post_number: 20,
          category_id: 1,
          tags: ["pending"]
        }), _topic.default.create({
          id: 222,
          unseen: false,
          seen: true,
          unread_posts: 3,
          highest_post_number: 20
        })]
      };
      trackingState.sync(list, "unread");
      let state111 = trackingState.findState(111);
      let state222 = trackingState.findState(222);
      assert.strictEqual(state111.last_read_post_number, null, "unseen topics get last_read_post_number reset to null");
      assert.propEqual((0, _object.getProperties)(state111, "highest_post_number", "tags", "category_id"), {
        highest_post_number: 20,
        tags: ["pending"],
        category_id: 1
      }, "highest_post_number, category, and tags are set for a topic");
      assert.strictEqual(state222.last_read_post_number, 17, "last_read_post_number is highest_post_number - (unread + new)");
      assert.strictEqual(stateCallbackCalled, 1, "callback is only called once");
    });
    (0, _qunit.test)("sync - states missing from the topic list are updated based on the selected filter", function (assert) {
      const trackingState = _topicTrackingState.default.create();

      trackingState.loadStates([{
        topic_id: 111,
        last_read_post_number: 4,
        highest_post_number: 5,
        notification_level: _notificationLevels.NotificationLevels.TRACKING
      }, {
        topic_id: 222,
        last_read_post_number: null,
        seen: false,
        notification_level: _notificationLevels.NotificationLevels.TRACKING,
        created_in_new_period: true
      }]);
      const list = {
        topics: []
      };
      trackingState.sync(list, "unread");
      assert.strictEqual(trackingState.findState(111).last_read_post_number, 5, "last_read_post_number set to highest post number to pretend read");
      trackingState.sync(list, "new");
      assert.strictEqual(trackingState.findState(222).last_read_post_number, 1, "last_read_post_number set to 1 to pretend not new");
    });
    (0, _qunitHelpers.discourseModule)("establishChannels - /unread MessageBus channel payloads processed", function (unreadHooks) {
      let trackingState;
      let unreadTopicPayload = {
        topic_id: 111,
        message_type: "unread",
        payload: {
          category_id: 123,
          topic_tag_ids: [44],
          tags: ["pending"],
          highest_post_number: 10,
          created_at: "2012-11-31 12:00:00 UTC",
          archetype: "regular"
        }
      };
      let currentUser;
      unreadHooks.beforeEach(function () {
        currentUser = _user.default.create({
          username: "chuck"
        });

        _user.default.resetCurrent(currentUser);

        trackingState = _topicTrackingState.default.create({
          messageBus: _messageBusClient.default,
          currentUser,
          siteSettings: this.siteSettings
        });
        trackingState.establishChannels();
        trackingState.loadStates([{
          topic_id: 111,
          last_read_post_number: 4,
          highest_post_number: 4,
          notification_level: _notificationLevels.NotificationLevels.TRACKING
        }]);
      });
      (0, _qunit.test)("message count is incremented", async function (assert) {
        await (0, _qunitHelpers.publishToMessageBus)(`/unread`, unreadTopicPayload);
        assert.strictEqual(trackingState.messageCount, 1, "message count incremented");
      });
      (0, _qunit.test)("state is modified and callback is called", async function (assert) {
        let stateCallbackCalled = 0;
        trackingState.onStateChange(() => {
          stateCallbackCalled += 1;
        });
        await (0, _qunitHelpers.publishToMessageBus)(`/unread`, unreadTopicPayload);
        assert.deepEqual(trackingState.findState(111), {
          topic_id: 111,
          category_id: 123,
          topic_tag_ids: [44],
          tags: ["pending"],
          last_read_post_number: 4,
          highest_post_number: 10,
          notification_level: _notificationLevels.NotificationLevels.TRACKING,
          created_at: "2012-11-31 12:00:00 UTC",
          archetype: "regular"
        }, "topic state updated");
        assert.strictEqual(stateCallbackCalled, 1, "state change callback called");
      });
      (0, _qunit.test)("adds incoming so it is counted in topic lists", async function (assert) {
        trackingState.trackIncoming("all");
        await (0, _qunitHelpers.publishToMessageBus)(`/unread`, unreadTopicPayload);
        assert.deepEqual(trackingState.newIncoming, [111], "unread topic is incoming");
        assert.strictEqual(trackingState.incomingCount, 1, "incoming count is increased");
      });
      (0, _qunit.test)("correct tag and category filters for different lists", function (assert) {
        trackingState.trackIncoming("unread");
        assert.strictEqual(trackingState.filterCategory, undefined);
        assert.strictEqual(trackingState.filterTag, undefined);
        assert.strictEqual(trackingState.filter, "unread");
        trackingState.trackIncoming("tag/test/l/latest");
        assert.strictEqual(trackingState.filterCategory, undefined);
        assert.strictEqual(trackingState.filterTag, "test");
        assert.strictEqual(trackingState.filter, "latest");
        trackingState.trackIncoming("c/cat/subcat/6/l/latest");
        assert.strictEqual(trackingState.filterCategory.id, 6);
        assert.strictEqual(trackingState.filterTag, undefined);
        assert.strictEqual(trackingState.filter, "latest");
        trackingState.trackIncoming("tags/c/cat/subcat/6/test/l/latest");
        assert.strictEqual(trackingState.filterCategory.id, 6);
        assert.strictEqual(trackingState.filterTag, "test");
        assert.strictEqual(trackingState.filter, "latest");
      });
      (0, _qunit.test)("correctly infers missing information", async function (assert) {
        await (0, _qunitHelpers.publishToMessageBus)(`/unread`, { ...unreadTopicPayload,
          topic_id: 999
        });
        assert.deepEqual(trackingState.findState(999), {
          category_id: 123,
          topic_tag_ids: [44],
          tags: ["pending"],
          last_read_post_number: 9,
          highest_post_number: 10,
          notification_level: _notificationLevels.NotificationLevels.TRACKING,
          created_at: "2012-11-31 12:00:00 UTC",
          archetype: "regular"
        }, "topic state updated with guesses for last_read_post_number and notification_level");
      });
      (0, _qunit.test)("adds incoming in the categories latest topics list", async function (assert) {
        trackingState.trackIncoming("categories");
        const unreadCategoriesLatestTopicsPayload = { ...unreadTopicPayload,
          message_type: "latest"
        };
        await (0, _qunitHelpers.publishToMessageBus)(`/latest`, unreadCategoriesLatestTopicsPayload);
        assert.deepEqual(trackingState.newIncoming, [111], "unread topic is incoming");
        assert.strictEqual(trackingState.incomingCount, 1, "incoming count is increased");
      });
      (0, _qunit.test)("dismisses new topic", async function (assert) {
        trackingState.loadStates([{
          last_read_post_number: null,
          topic_id: 112,
          notification_level: _notificationLevels.NotificationLevels.TRACKING,
          category_id: 1,
          is_seen: false,
          tags: ["foo"]
        }]);
        await (0, _qunitHelpers.publishToMessageBus)(`/unread/${currentUser.id}`, {
          message_type: "dismiss_new",
          payload: {
            topic_ids: [112]
          }
        });
        assert.strictEqual(trackingState.findState(112).is_seen, true);
      });
      (0, _qunit.test)("marks a topic as read", async function (assert) {
        trackingState.loadStates([{
          last_read_post_number: null,
          topic_id: 112,
          notification_level: _notificationLevels.NotificationLevels.TRACKING,
          category_id: 1,
          is_seen: false,
          tags: ["foo"]
        }]);
        await (0, _qunitHelpers.publishToMessageBus)(`/unread/${currentUser.id}`, {
          message_type: "read",
          topic_id: 112,
          payload: {
            last_read_post_number: 4,
            highest_post_number: 4,
            notification_level: _notificationLevels.NotificationLevels.TRACKING
          }
        });
        assert.propEqual((0, _object.getProperties)(trackingState.findState(112), "highest_post_number", "last_read_post_number"), {
          highest_post_number: 4,
          last_read_post_number: 4
        }, "highest_post_number and last_read_post_number are set for a topic");
        assert.deepEqual(trackingState.findState(112).tags, ["foo"], "tags are not accidentally cleared");
      });
    });
    (0, _qunitHelpers.discourseModule)("establishChannels - /new MessageBus channel payloads processed", function (establishChannelsHooks) {
      let trackingState;
      let newTopicPayload = {
        topic_id: 222,
        message_type: "new_topic",
        payload: {
          category_id: 123,
          topic_tag_ids: [44],
          tags: ["pending"],
          last_read_post_number: null,
          highest_post_number: 1,
          created_at: "2012-11-31 12:00:00 UTC",
          archetype: "regular"
        }
      };
      let currentUser;
      establishChannelsHooks.beforeEach(function () {
        currentUser = _user.default.create({
          username: "chuck"
        });

        _user.default.resetCurrent(currentUser);

        trackingState = _topicTrackingState.default.create({
          messageBus: _messageBusClient.default,
          currentUser,
          siteSettings: this.siteSettings
        });
        trackingState.establishChannels();
      });
      (0, _qunit.test)("topics in muted categories do not get added to the state", async function (assert) {
        trackingState.currentUser.set("muted_category_ids", [123]);
        await (0, _qunitHelpers.publishToMessageBus)("/new", newTopicPayload);
        assert.strictEqual(trackingState.findState(222), undefined, "the new topic is not in the state");
      });
      (0, _qunit.test)("topics in indirectly muted categories do not get added to the state", async function (assert) {
        trackingState.currentUser.setProperties({
          muted_category_ids: [],
          indirectly_muted_category_ids: [123]
        });
        await (0, _qunitHelpers.publishToMessageBus)("/new", newTopicPayload);
        assert.strictEqual(trackingState.findState(222), undefined, "the new topic is not in the state");
      });
      (0, _qunit.test)("topics in muted tags do not get added to the state", async function (assert) {
        trackingState.currentUser.set("muted_tags", ["pending"]);
        await (0, _qunitHelpers.publishToMessageBus)("/new", newTopicPayload);
        assert.strictEqual(trackingState.findState(222), undefined, "the new topic is not in the state");
      });
      (0, _qunit.test)("message count is incremented", async function (assert) {
        await (0, _qunitHelpers.publishToMessageBus)("/new", newTopicPayload);
        assert.strictEqual(trackingState.messageCount, 1, "message count incremented");
      });
      (0, _qunit.test)("state is modified and callback is called", async function (assert) {
        let stateCallbackCalled = false;
        trackingState.onStateChange(() => {
          stateCallbackCalled = true;
        });
        await (0, _qunitHelpers.publishToMessageBus)("/new", newTopicPayload);
        assert.deepEqual(trackingState.findState(222), {
          category_id: 123,
          topic_tag_ids: [44],
          tags: ["pending"],
          last_read_post_number: null,
          highest_post_number: 1,
          created_at: "2012-11-31 12:00:00 UTC",
          archetype: "regular"
        }, "new topic loaded into state");
        assert.strictEqual(stateCallbackCalled, true, "state change callback called");
      });
      (0, _qunit.test)("adds incoming so it is counted in topic lists", async function (assert) {
        trackingState.trackIncoming("all");
        await (0, _qunitHelpers.publishToMessageBus)("/new", newTopicPayload);
        assert.deepEqual(trackingState.newIncoming, [222], "new topic is incoming");
        assert.strictEqual(trackingState.incomingCount, 1, "incoming count is increased");
      });
    });
    (0, _qunit.test)("establishChannels - /delete MessageBus channel payloads processed", async function (assert) {
      const trackingState = _topicTrackingState.default.create({
        messageBus: _messageBusClient.default
      });

      trackingState.establishChannels();
      trackingState.loadStates([{
        topic_id: 111,
        deleted: false
      }]);
      await (0, _qunitHelpers.publishToMessageBus)("/delete", {
        topic_id: 111
      });
      assert.strictEqual(trackingState.findState(111).deleted, true, "marks the topic as deleted");
      assert.strictEqual(trackingState.messageCount, 1, "increments message count");
    });
    (0, _qunit.test)("establishChannels - /recover MessageBus channel payloads processed", async function (assert) {
      const trackingState = _topicTrackingState.default.create({
        messageBus: _messageBusClient.default
      });

      trackingState.establishChannels();
      trackingState.loadStates([{
        topic_id: 111,
        deleted: true
      }]);
      await (0, _qunitHelpers.publishToMessageBus)("/recover", {
        topic_id: 111
      });
      assert.strictEqual(trackingState.findState(111).deleted, false, "marks the topic as not deleted");
      assert.strictEqual(trackingState.messageCount, 1, "increments message count");
    });
    (0, _qunit.test)("establishChannels - /destroy MessageBus channel payloads processed", async function (assert) {
      _sinon.default.stub(_url.default, "router").value({
        currentRoute: {
          parent: {
            name: "topic",
            params: {
              id: 111
            }
          }
        }
      });

      _sinon.default.stub(_url.default, "redirectTo");

      const trackingState = _topicTrackingState.default.create({
        messageBus: _messageBusClient.default
      });

      trackingState.establishChannels();
      trackingState.loadStates([{
        topic_id: 111,
        deleted: false
      }]);
      await (0, _qunitHelpers.publishToMessageBus)("/destroy", {
        topic_id: 111
      });
      assert.strictEqual(trackingState.messageCount, 1, "increments message count");
      assert.ok(_url.default.redirectTo.calledWith("/"), "redirect to / because topic is destroyed");
    });
    (0, _qunit.test)("subscribe to category", function (assert) {
      const trackingState = _topicTrackingState.default.create();

      trackingState.trackIncoming("c/feature/2/l/latest");
      trackingState.notifyIncoming({
        message_type: "new_topic",
        topic_id: 1,
        payload: {
          category_id: 2
        }
      });
      trackingState.notifyIncoming({
        message_type: "new_topic",
        topic_id: 2,
        payload: {
          category_id: 3
        }
      });
      trackingState.notifyIncoming({
        message_type: "new_topic",
        topic_id: 3,
        payload: {
          category_id: 26
        }
      });
      assert.strictEqual(trackingState.get("incomingCount"), 2, "expect to properly track incoming for category");
      trackingState.resetTracking();
      trackingState.trackIncoming("c/feature/spec/26/l/latest");
      trackingState.notifyIncoming({
        message_type: "new_topic",
        topic_id: 1,
        payload: {
          category_id: 2
        }
      });
      trackingState.notifyIncoming({
        message_type: "new_topic",
        topic_id: 2,
        payload: {
          category_id: 3
        }
      });
      assert.strictEqual(trackingState.get("incomingCount"), 0, "parent or other category doesn't affect subcategory");
      trackingState.notifyIncoming({
        message_type: "new_topic",
        topic_id: 3,
        payload: {
          category_id: 26
        }
      });
      assert.strictEqual(trackingState.get("incomingCount"), 1, "expect to properly track incoming for subcategory");
      trackingState.resetTracking();
      trackingState.trackIncoming("c/feature/spec/26/none/l/latest");
      trackingState.notifyIncoming({
        message_type: "new_topic",
        topic_id: 3,
        payload: {
          category_id: 26
        }
      });
      assert.strictEqual(trackingState.get("incomingCount"), 1, "expect to properly track incoming for subcategory using none tags route");
    });
    (0, _qunit.test)("getSubCategoryIds", function (assert) {
      const store = (0, _createStore.default)();
      const foo = store.createRecord("category", {
        id: 1,
        slug: "foo"
      });
      const bar = store.createRecord("category", {
        id: 2,
        slug: "bar",
        parent_category_id: foo.id
      });
      const baz = store.createRecord("category", {
        id: 3,
        slug: "baz",
        parent_category_id: bar.id
      });

      _sinon.default.stub(_category.default, "list").returns([foo, bar, baz]);

      const trackingState = _topicTrackingState.default.create();

      assert.deepEqual(Array.from(trackingState.getSubCategoryIds(1)), [1, 2, 3]);
      assert.deepEqual(Array.from(trackingState.getSubCategoryIds(2)), [2, 3]);
      assert.deepEqual(Array.from(trackingState.getSubCategoryIds(3)), [3]);
    });
    (0, _qunit.test)("countNew", function (assert) {
      const store = (0, _createStore.default)();
      const foo = store.createRecord("category", {
        id: 1,
        slug: "foo"
      });
      const bar = store.createRecord("category", {
        id: 2,
        slug: "bar",
        parent_category_id: foo.id
      });
      const baz = store.createRecord("category", {
        id: 3,
        slug: "baz",
        parent_category_id: bar.id
      });
      const qux = store.createRecord("category", {
        id: 4,
        slug: "qux"
      });

      _sinon.default.stub(_category.default, "list").returns([foo, bar, baz, qux]);

      let currentUser = _user.default.create({
        username: "chuck",
        muted_category_ids: [4]
      });

      const trackingState = _topicTrackingState.default.create({
        currentUser
      });

      assert.strictEqual(trackingState.countNew({
        categoryId: 1
      }), 0);
      assert.strictEqual(trackingState.countNew({
        categoryId: 2
      }), 0);
      assert.strictEqual(trackingState.countNew({
        categoryId: 3
      }), 0);
      trackingState.states.set("t112", {
        last_read_post_number: null,
        id: 112,
        notification_level: _notificationLevels.NotificationLevels.TRACKING,
        category_id: 2,
        created_in_new_period: true
      });
      assert.strictEqual(trackingState.countNew({
        categoryId: 1
      }), 1);
      assert.strictEqual(trackingState.countNew({
        categoryId: 1,
        noSubcategories: true
      }), 0);
      assert.strictEqual(trackingState.countNew({
        categoryId: 1,
        tagId: "missing-tag"
      }), 0);
      assert.strictEqual(trackingState.countNew({
        categoryId: 2
      }), 1);
      assert.strictEqual(trackingState.countNew({
        categoryId: 3
      }), 0);
      trackingState.states.set("t113", {
        last_read_post_number: null,
        id: 113,
        notification_level: _notificationLevels.NotificationLevels.TRACKING,
        category_id: 3,
        tags: ["amazing"],
        created_in_new_period: true
      });
      assert.strictEqual(trackingState.countNew({
        categoryId: 1
      }), 2);
      assert.strictEqual(trackingState.countNew({
        categoryId: 2
      }), 2);
      assert.strictEqual(trackingState.countNew({
        categoryId: 3
      }), 1);
      assert.strictEqual(trackingState.countNew({
        categoryId: 3,
        tagId: "amazing"
      }), 1);
      assert.strictEqual(trackingState.countNew({
        categoryId: 3,
        tagId: "missing"
      }), 0);
      trackingState.states.set("t111", {
        last_read_post_number: null,
        id: 111,
        notification_level: _notificationLevels.NotificationLevels.TRACKING,
        category_id: 1,
        created_in_new_period: true
      });
      assert.strictEqual(trackingState.countNew({
        categoryId: 1
      }), 3);
      assert.strictEqual(trackingState.countNew({
        categoryId: 2
      }), 2);
      assert.strictEqual(trackingState.countNew({
        categoryId: 3
      }), 1);
      trackingState.states.set("t115", {
        last_read_post_number: null,
        id: 115,
        category_id: 4
      });
      assert.strictEqual(trackingState.countNew({
        categoryId: 4
      }), 0);
    });
    (0, _qunit.test)("mute and unmute topic", function (assert) {
      let currentUser = _user.default.create({
        username: "chuck",
        muted_category_ids: []
      });

      const trackingState = _topicTrackingState.default.create({
        currentUser
      });

      trackingState.trackMutedOrUnmutedTopic({
        topic_id: 1,
        message_type: "muted"
      });
      assert.strictEqual(currentUser.muted_topics[0].topicId, 1);
      trackingState.trackMutedOrUnmutedTopic({
        topic_id: 2,
        message_type: "unmuted"
      });
      assert.strictEqual(currentUser.unmuted_topics[0].topicId, 2);
      trackingState.pruneOldMutedAndUnmutedTopics();
      assert.strictEqual(trackingState.isMutedTopic(1), true);
      assert.strictEqual(trackingState.isUnmutedTopic(2), true);
      this.clock.tick(60000);
      trackingState.pruneOldMutedAndUnmutedTopics();
      assert.strictEqual(trackingState.isMutedTopic(1), false);
      assert.strictEqual(trackingState.isUnmutedTopic(2), false);
    });
  });
});
define("discourse/tests/unit/models/user-action-test", ["qunit", "discourse/models/user-action"], function (_qunit, _userAction) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/models/user-action"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Model | user-action", function () {
    (0, _qunit.test)("collapsing likes", function (assert) {
      let actions = _userAction.default.collapseStream([_userAction.default.create({
        action_type: _userAction.default.TYPES.likes_given,
        topic_id: 1,
        user_id: 1,
        post_number: 1
      }), _userAction.default.create({
        action_type: _userAction.default.TYPES.edits,
        topic_id: 2,
        user_id: 1,
        post_number: 1
      }), _userAction.default.create({
        action_type: _userAction.default.TYPES.likes_given,
        topic_id: 1,
        user_id: 2,
        post_number: 1
      })]);

      assert.strictEqual(actions.length, 2);
      assert.strictEqual(actions[0].get("children.length"), 1);
      assert.strictEqual(actions[0].get("children")[0].items.length, 2);
    });
  });
});
define("discourse/tests/unit/models/user-badge-test", ["qunit", "discourse/models/user-badge", "discourse/tests/fixtures/user-badges", "discourse-common/lib/object"], function (_qunit, _userBadge, _userBadges, _object) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/models/user-badge",0,"discourse/tests/fixtures/user-badges",0,"discourse-common/lib/object"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Model | user-badge", function () {
    (0, _qunit.test)("createFromJson single", function (assert) {
      const userBadge = _userBadge.default.createFromJson((0, _object.cloneJSON)(_userBadges.default["/user_badges"]));

      assert.ok(!Array.isArray(userBadge), "does not return an array");
      assert.strictEqual(userBadge.get("badge.name"), "Badge 2", "badge reference is set");
      assert.strictEqual(userBadge.get("badge.badge_type.name"), "Silver 2", "badge.badge_type reference is set");
      assert.strictEqual(userBadge.get("granted_by.username"), "anne3", "granted_by reference is set");
    });
    (0, _qunit.test)("createFromJson array", function (assert) {
      const userBadges = _userBadge.default.createFromJson((0, _object.cloneJSON)(_userBadges.default["/user-badges/:username"]));

      assert.ok(Array.isArray(userBadges), "returns an array");
      assert.strictEqual(userBadges[0].get("granted_by"), undefined, "granted_by reference is not set when null");
    });
    (0, _qunit.test)("findByUsername", async function (assert) {
      const badges = await _userBadge.default.findByUsername("anne3");
      assert.ok(Array.isArray(badges), "returns an array");
    });
    (0, _qunit.test)("findByBadgeId", async function (assert) {
      const badges = await _userBadge.default.findByBadgeId(880);
      assert.ok(Array.isArray(badges), "returns an array");
    });
    (0, _qunit.test)("grant", async function (assert) {
      const userBadge = await _userBadge.default.grant(1, "username");
      assert.ok(!Array.isArray(userBadge), "does not return an array");
    });
    (0, _qunit.test)("revoke", async function (assert) {
      assert.expect(0);

      const userBadge = _userBadge.default.create({
        id: 1
      });

      await userBadge.revoke();
    });
    (0, _qunit.test)("favorite", async function (assert) {
      const userBadge = _userBadge.default.create({
        id: 1
      });

      assert.notOk(userBadge.is_favorite);
      await userBadge.favorite();
      assert.ok(userBadge.is_favorite);
    });
  });
});
define("discourse/tests/unit/models/user-drafts-test", ["qunit", "I18n", "discourse/models/composer", "discourse/models/user", "discourse/models/user-draft"], function (_qunit, _I18n, _composer, _user, _userDraft) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"I18n",0,"discourse/models/composer",0,"discourse/models/user",0,"discourse/models/user-draft"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Model | user-draft", function () {
    (0, _qunit.test)("stream", function (assert) {
      const user = _user.default.create({
        id: 1,
        username: "eviltrout"
      });

      const stream = user.userDraftsStream;
      assert.present(stream, "a user has a drafts stream by default");
      assert.strictEqual(stream.content.length, 0, "no items are loaded by default");
      assert.blank(stream.content, "no content by default");
    });
    (0, _qunit.test)("draft", function (assert) {
      const drafts = [_userDraft.default.create({
        draft_key: "topic_1",
        post_number: "10"
      }), _userDraft.default.create({
        draft_key: _composer.NEW_TOPIC_KEY
      })];
      assert.strictEqual(drafts.length, 2, "drafts count is right");
      assert.strictEqual(drafts[1].draftType, _I18n.default.t("drafts.new_topic"), "loads correct draftType label");
    });
  });
});
define("discourse/tests/unit/models/user-stream-test", ["qunit", "discourse/models/user", "discourse/models/user-action"], function (_qunit, _user, _userAction) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/models/user",0,"discourse/models/user-action"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Model | user-stream", function () {
    (0, _qunit.test)("basics", function (assert) {
      let user = _user.default.create({
        id: 1,
        username: "eviltrout"
      });

      let stream = user.get("stream");
      assert.present(stream, "a user has a stream by default");
      assert.strictEqual(stream.get("user"), user, "the stream points back to the user");
      assert.strictEqual(stream.get("itemsLoaded"), 0, "no items are loaded by default");
      assert.blank(stream.get("content"), "no content by default");
      assert.blank(stream.get("filter"), "no filter by default");
      assert.ok(!stream.get("loaded"), "the stream is not loaded by default");
    });
    (0, _qunit.test)("filterParam", function (assert) {
      let user = _user.default.create({
        id: 1,
        username: "eviltrout"
      });

      let stream = user.get("stream"); // defaults to posts/topics

      assert.strictEqual(stream.get("filterParam"), "4,5");
      stream.set("filter", _userAction.default.TYPES.topics);
      assert.strictEqual(stream.get("filterParam"), 4);
      stream.set("filter", _userAction.default.TYPES.likes_given);
      assert.strictEqual(stream.get("filterParam"), _userAction.default.TYPES.likes_given);
      stream.set("filter", _userAction.default.TYPES.replies);
      assert.strictEqual(stream.get("filterParam"), "6,9");
    });
  });
});
define("discourse/tests/unit/models/user-test", ["qunit", "discourse/models/group", "discourse/models/user", "discourse/lib/preload-store", "sinon", "@ember/test-helpers"], function (_qunit, _group, _user, _preloadStore, _sinon, _testHelpers) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/models/group",0,"discourse/models/user",0,"discourse/lib/preload-store",0,"sinon",0,"@ember/test-helpers"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Model | user", function () {
    (0, _qunit.test)("staff", function (assert) {
      let user = _user.default.create({
        id: 1,
        username: "eviltrout"
      });

      assert.ok(!user.get("staff"), "user is not staff");
      user.toggleProperty("moderator");
      assert.ok(user.get("staff"), "moderators are staff");
      user.setProperties({
        moderator: false,
        admin: true
      });
      assert.ok(user.get("staff"), "admins are staff");
    });
    (0, _qunit.test)("searchContext", function (assert) {
      let user = _user.default.create({
        id: 1,
        username: "EvilTrout"
      });

      assert.deepEqual(user.get("searchContext"), {
        type: "user",
        id: "eviltrout",
        user
      }, "has a search context");
    });
    (0, _qunit.test)("isAllowedToUploadAFile", function (assert) {
      let user = _user.default.create({
        trust_level: 0,
        admin: true
      });

      assert.ok(user.isAllowedToUploadAFile("image"), "admin can always upload a file");
      user.setProperties({
        admin: false,
        moderator: true
      });
      assert.ok(user.isAllowedToUploadAFile("image"), "moderator can always upload a file");
    });
    (0, _qunit.test)("canMangeGroup", function (assert) {
      let user = _user.default.create({
        admin: true
      });

      let group = _group.default.create({
        automatic: true
      });

      assert.strictEqual(user.canManageGroup(group), false, "automatic groups cannot be managed.");
      group.set("automatic", false);
      group.setProperties({
        can_admin_group: true
      });
      assert.strictEqual(user.canManageGroup(group), true, "an admin should be able to manage the group");
      user.set("admin", false);
      group.setProperties({
        is_group_owner: true
      });
      assert.strictEqual(user.canManageGroup(group), true, "a group owner should be able to manage the group");
    });
    (0, _qunit.test)("muted ids", function (assert) {
      let user = _user.default.create({
        username: "chuck",
        muted_category_ids: []
      });

      assert.deepEqual(user.calculateMutedIds(0, 1, "muted_category_ids"), [1]);
      assert.deepEqual(user.calculateMutedIds(1, 1, "muted_category_ids"), []);
    });
    (0, _qunit.test)("createCurrent() guesses timezone if user doesn't have it set", async function (assert) {
      _preloadStore.default.store("currentUser", {
        username: "eviltrout",
        timezone: null
      });

      const expectedTimezone = "Africa/Casablanca";

      _sinon.default.stub(moment.tz, "guess").returns(expectedTimezone);

      const currentUser = _user.default.createCurrent();

      assert.deepEqual(currentUser.timezone, expectedTimezone);
      await (0, _testHelpers.settled)(); // `User` sends a request to save the timezone
    });
    (0, _qunit.test)("createCurrent() doesn't guess timezone if user has it already set", function (assert) {
      const timezone = "Africa/Casablanca";

      _preloadStore.default.store("currentUser", {
        username: "eviltrout",
        timezone
      });

      const spyMomentGuess = _sinon.default.spy(moment.tz, "guess");

      _user.default.createCurrent();

      assert.ok(spyMomentGuess.notCalled);
    });
    (0, _qunit.test)("subsequent calls to trackStatus and stopTrackingStatus increase and decrease subscribers counter", function (assert) {
      const user = _user.default.create();

      assert.equal(user._subscribersCount, 0);
      user.trackStatus();
      assert.equal(user._subscribersCount, 1);
      user.trackStatus();
      assert.equal(user._subscribersCount, 2);
      user.stopTrackingStatus();
      assert.equal(user._subscribersCount, 1);
      user.stopTrackingStatus();
      assert.equal(user._subscribersCount, 0);
    });
    (0, _qunit.test)("attempt to stop tracking status if status wasn't tracked doesn't throw", function (assert) {
      const user = _user.default.create();

      user.stopTrackingStatus();
      assert.ok(true);
    });
    (0, _qunit.test)("clears statuses of several users correctly when receiving status updates via appEvents", function (assert) {
      const status1 = {
        description: "user1 status",
        emoji: "mega"
      };
      const status2 = {
        description: "user2 status",
        emoji: "speech_balloon"
      };

      const user1 = _user.default.create({
        id: 1,
        status: status1
      });

      const user2 = _user.default.create({
        id: 2,
        status: status2
      });

      const appEvents = user1.appEvents;

      try {
        user1.trackStatus();
        user2.trackStatus();
        assert.equal(user1.status, status1);
        assert.equal(user2.status, status2);
        appEvents.trigger("user-status:changed", {
          [user1.id]: null
        });
        assert.equal(user1.status, null);
        assert.equal(user2.status, status2);
        appEvents.trigger("user-status:changed", {
          [user2.id]: null
        });
        assert.equal(user1.status, null);
        assert.equal(user2.status, null);
      } finally {
        user1.stopTrackingStatus();
        user2.stopTrackingStatus();
      }
    });
    (0, _qunit.test)("create() doesn't set internal status tracking fields", function (assert) {
      const user = _user.default.create({
        _subscribersCount: 10,
        _clearStatusTimerId: 100
      });

      assert.notOk(user.hasOwnProperty("_subscribersCount"), "_subscribersCount wasn't set");
      assert.notOk(user.hasOwnProperty("_clearStatusTimerId"), "_clearStatusTimerId wasn't set");
    });
  });
});
define("discourse/tests/unit/models/wizard-field-test", ["qunit", "wizard/models/wizard-field"], function (_qunit, _wizardField) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"wizard/models/wizard-field"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Model | Wizard | wizard-field", function () {
    (0, _qunit.test)("basic state", function (assert) {
      const w = _wizardField.default.create({
        type: "text"
      });

      assert.ok(w.unchecked);
      assert.ok(!w.valid);
      assert.ok(!w.invalid);
    });
    (0, _qunit.test)("text - required - validation", function (assert) {
      const w = _wizardField.default.create({
        type: "text",
        required: true
      });

      assert.ok(w.unchecked);
      w.check();
      assert.ok(!w.unchecked);
      assert.ok(!w.valid);
      assert.ok(w.invalid);
      w.set("value", "a value");
      w.check();
      assert.ok(!w.unchecked);
      assert.ok(w.valid);
      assert.ok(!w.invalid);
    });
    (0, _qunit.test)("text - optional - validation", function (assert) {
      const f = _wizardField.default.create({
        type: "text"
      });

      assert.ok(f.unchecked);
      f.check();
      assert.ok(f.valid);
    });
  });
});
define("discourse/tests/unit/services/current-user-test", ["discourse/tests/helpers/qunit-helpers", "qunit"], function (_qunitHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.acceptance)("current-user", function (needs) {
    needs.user();
    (0, _qunit.test)("currentUser has appEvents", function (assert) {
      let currentUser = this.container.lookup("service:current-user");
      assert.ok(currentUser.appEvents);
    });
  });
});
define("discourse/tests/unit/services/document-title-test", ["discourse/tests/helpers/qunit-helpers", "discourse/services/document-title", "discourse/services/app-events", "discourse/models/session", "qunit"], function (_qunitHelpers, _documentTitle, _appEvents, _session, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"discourse/services/document-title",0,"discourse/services/app-events",0,"discourse/models/session",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Service | document-title", function (hooks) {
    hooks.beforeEach(function () {
      const session = _session.default.current();

      session.hasFocus = true;
      this.documentTitle = _documentTitle.default.create({
        session,
        appEvents: _appEvents.default.create()
      });
      this.documentTitle.currentUser = null;
    });
    hooks.afterEach(function () {
      this.documentTitle.reset();
    });
    (0, _qunit.test)("it updates the document title", function (assert) {
      this.documentTitle.setTitle("Test Title");
      assert.strictEqual(document.title, "Test Title", "title is correct");
    });
    (0, _qunit.test)("it doesn't display notification counts for anonymous users", function (assert) {
      this.documentTitle.setTitle("test notifications");
      this.documentTitle.updateNotificationCount(5);
      assert.strictEqual(document.title, "test notifications");
      this.documentTitle.setFocus(false);
      this.documentTitle.updateNotificationCount(6);
      assert.strictEqual(document.title, "test notifications");
    });
    (0, _qunit.test)("it displays notification counts for logged in users", function (assert) {
      this.documentTitle.currentUser = (0, _qunitHelpers.currentUser)();
      this.documentTitle.currentUser.dynamic_favicon = false;
      this.documentTitle.setTitle("test notifications");
      this.documentTitle.updateNotificationCount(5);
      assert.strictEqual(document.title, "test notifications");
      this.documentTitle.setFocus(false);
      this.documentTitle.updateNotificationCount(6);
      assert.strictEqual(document.title, "(6) test notifications");
      this.documentTitle.setFocus(true);
      assert.strictEqual(document.title, "test notifications");
    });
    (0, _qunit.test)("it doesn't display notification counts for users in do not disturb", function (assert) {
      this.documentTitle.currentUser = (0, _qunitHelpers.currentUser)();
      const date = new Date();
      date.setHours(date.getHours() + 1);
      this.documentTitle.currentUser.do_not_disturb_until = date.toUTCString();
      this.documentTitle.currentUser.dynamic_favicon = false;
      this.documentTitle.setTitle("test notifications");
      this.documentTitle.updateNotificationCount(5);
      assert.strictEqual(document.title, "test notifications");
      this.documentTitle.setFocus(false);
      this.documentTitle.updateNotificationCount(6);
      assert.strictEqual(document.title, "test notifications");
    });
    (0, _qunit.test)("it doesn't increment background context counts when focused", function (assert) {
      this.documentTitle.setTitle("background context");
      this.documentTitle.setFocus(true);
      this.documentTitle.incrementBackgroundContextCount();
      assert.strictEqual(document.title, "background context");
    });
    (0, _qunit.test)("it increments background context counts when not focused", function (assert) {
      this.documentTitle.setTitle("background context");
      this.documentTitle.setFocus(false);
      this.documentTitle.incrementBackgroundContextCount();
      assert.strictEqual(document.title, "(1) background context");
      this.documentTitle.setFocus(true);
      assert.strictEqual(document.title, "background context");
    });
  });
});
define("discourse/tests/unit/services/emoji-store-test", ["discourse/tests/helpers/qunit-helpers", "qunit"], function (_qunitHelpers, _qunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("Unit | Service | emoji-store", function (hooks) {
    hooks.beforeEach(function () {
      this.emojiStore = this.container.lookup("service:emoji-store");
      this.emojiStore.reset();
    });
    hooks.afterEach(function () {
      this.emojiStore.reset();
    });
    (0, _qunit.test)("defaults", function (assert) {
      assert.deepEqual(this.emojiStore.favorites, []);
      assert.strictEqual(this.emojiStore.diversity, 1);
    });
    (0, _qunit.test)("diversity", function (assert) {
      this.emojiStore.diversity = 2;
      assert.strictEqual(this.emojiStore.diversity, 2);
    });
    (0, _qunit.test)("favorites", function (assert) {
      this.emojiStore.favorites = ["smile"];
      assert.deepEqual(this.emojiStore.favorites, ["smile"]);
    });
    (0, _qunit.test)("track", function (assert) {
      this.emojiStore.track("woman:t4");
      assert.deepEqual(this.emojiStore.favorites, ["woman:t4"]);
      this.emojiStore.track("otter");
      this.emojiStore.track(":otter:");
      assert.deepEqual(this.emojiStore.favorites, ["otter", "woman:t4"]);
    });
  });
});
define("discourse/tests/unit/services/presence-test", ["discourse/tests/helpers/qunit-helpers", "qunit", "discourse/services/presence", "discourse/lib/user-presence", "sinon"], function (_qunitHelpers, _qunit, _presence, _userPresence, _sinon) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/qunit-helpers",0,"qunit",0,"discourse/services/presence",0,"discourse/lib/user-presence",0,"sinon"eaimeta@70e063a35619d71f

  function usersFixture() {
    return [{
      id: 1,
      username: "bruce0",
      name: "Bruce Wayne",
      avatar_template: "/letter_avatar_proxy/v4/letter/b/90ced4/{size}.png"
    }, {
      id: 2,
      username: "bruce1",
      name: "Bruce Wayne",
      avatar_template: "/letter_avatar_proxy/v4/letter/b/9de053/{size}.png"
    }, {
      id: 3,
      username: "bruce2",
      name: "Bruce Wayne",
      avatar_template: "/letter_avatar_proxy/v4/letter/b/35a633/{size}.png"
    }];
  }

  (0, _qunitHelpers.acceptance)("Presence - Subscribing", function (needs) {
    needs.pretender((server, helper) => {
      server.get("/presence/get", request => {
        const channels = request.queryParams.channels;
        const response = {};
        channels.forEach(c => {
          if (c.startsWith("/test/")) {
            response[c] = {
              count: 3,
              last_message_id: 1,
              users: usersFixture()
            };
          } else if (c.startsWith("/count-only/")) {
            response[c] = {
              count: 3,
              last_message_id: 1
            };
          } else {
            response[c] = null;
          }
        });
        return helper.response(200, response);
      });
    });
    (0, _qunit.test)("subscribing and receiving updates", async function (assert) {
      let presenceService = this.container.lookup("service:presence");
      let channel = presenceService.getChannel("/test/ch1");
      let changes = 0;

      const countChanges = () => changes++;

      channel.on("change", countChanges);
      assert.strictEqual(channel.name, "/test/ch1");
      await channel.subscribe({
        users: usersFixture(),
        last_message_id: 1
      });
      assert.strictEqual(changes, 1);
      assert.strictEqual(channel.users.length, 3, "it starts with three users");
      await (0, _qunitHelpers.publishToMessageBus)("/presence/test/ch1", {
        leaving_user_ids: [1]
      }, 0, 2);
      assert.strictEqual(channel.users.length, 2, "one user is removed");
      assert.strictEqual(changes, 2);
      await (0, _qunitHelpers.publishToMessageBus)("/presence/test/ch1", {
        entering_users: [usersFixture()[0]]
      }, 0, 3);
      assert.strictEqual(channel.users.length, 3, "one user is added");
      assert.strictEqual(changes, 3);
      channel.off("change", countChanges);
    });
    (0, _qunit.test)("fetches data when no initial state", async function (assert) {
      let presenceService = this.container.lookup("service:presence");
      let channel = presenceService.getChannel("/test/ch1");
      await channel.subscribe();
      assert.strictEqual(channel.users.length, 3, "loads initial state");
      await (0, _qunitHelpers.publishToMessageBus)("/presence/test/ch1", {
        leaving_user_ids: [1]
      }, 0, 2);
      assert.strictEqual(channel.users.length, 2, "updates following messagebus message");

      const stub = _sinon.default.stub(console, "log").withArgs("PresenceChannel '/test/ch1' dropped message (received 99, expecting 3), resyncing...");

      await (0, _qunitHelpers.publishToMessageBus)("/presence/test/ch1", {
        leaving_user_ids: [2]
      }, 0, 99);

      _sinon.default.assert.calledOnce(stub);

      assert.strictEqual(channel.users.length, 3, "detects missed messagebus message, fetches data from server");
    });
    (0, _qunit.test)("raises error when subscribing to nonexistent channel", async function (assert) {
      let presenceService = this.container.lookup("service:presence");
      let channel = presenceService.getChannel("/nonexistent/ch1");
      assert.rejects(channel.subscribe(), _presence.PresenceChannelNotFound, "raises not found");
    });
    (0, _qunit.test)("can subscribe to count_only channel", async function (assert) {
      let presenceService = this.container.lookup("service:presence");
      let channel = presenceService.getChannel("/count-only/ch1");
      await channel.subscribe();
      assert.strictEqual(channel.count, 3, "has the correct count");
      assert.strictEqual(channel.countOnly, true, "identifies as countOnly");
      assert.strictEqual(channel.users, null, "has null users list");
      await (0, _qunitHelpers.publishToMessageBus)("/presence/count-only/ch1", {
        count_delta: 1
      }, 0, 2);
      assert.strictEqual(channel.count, 4, "updates the count via messagebus");
      await (0, _qunitHelpers.publishToMessageBus)("/presence/count-only/ch1", {
        leaving_user_ids: [2]
      }, 0, 3);
      assert.strictEqual(channel.count, 3, "resubscribes when receiving a non-count-only message");
    });
    (0, _qunit.test)("can share data between multiple PresenceChannel objects", async function (assert) {
      let presenceService = this.container.lookup("service:presence");
      let channel = presenceService.getChannel("/test/ch1");
      let channelDup = presenceService.getChannel("/test/ch1");
      await channel.subscribe();
      assert.strictEqual(channel.subscribed, true, "channel is subscribed");
      assert.strictEqual(channel.count, 3, "channel has the correct count");
      assert.strictEqual(channel.users.length, 3, "channel has users");
      assert.strictEqual(channelDup.subscribed, false, "channelDup is not subscribed");
      assert.strictEqual(channelDup.count, undefined, "channelDup has no count");
      assert.strictEqual(channelDup.users, undefined, "channelDup has users");
      await channelDup.subscribe();
      assert.strictEqual(channelDup.subscribed, true, "channelDup can subscribe");
      assert.ok(channelDup._presenceState, "channelDup has a valid internal state");
      assert.strictEqual(channelDup._presenceState, channel._presenceState, "internal state is shared");
      await channel.unsubscribe();
      assert.strictEqual(channel.subscribed, false, "channel can unsubscribe");
      assert.strictEqual(channelDup._presenceState, presenceService._presenceChannelStates.get(channel.name), "state is maintained in the subscribed channel");
      await channelDup.unsubscribe();
      assert.strictEqual(channel.subscribed, false, "channelDup can unsubscribe");
      assert.strictEqual(presenceService._presenceChannelStates.get(channel.name), undefined, "state is cleared");
    });
  });
  (0, _qunitHelpers.acceptance)("Presence - Entering and Leaving", function (needs) {
    needs.user();
    const requests = [];
    needs.hooks.afterEach(() => requests.clear());
    needs.pretender((server, helper) => {
      server.post("/presence/update", request => {
        const body = new URLSearchParams(request.requestBody);
        requests.push(body);
        const response = {};
        const channelsRequested = body.getAll("present_channels[]");
        channelsRequested.forEach(c => {
          if (c.startsWith("/test/")) {
            response[c] = true;
          } else {
            response[c] = false;
          }
        });
        return helper.response(response);
      });
    });
    (0, _qunit.test)("can join and leave channels", async function (assert) {
      const presenceService = this.container.lookup("service:presence");
      const channel = presenceService.getChannel("/test/ch1");
      await channel.enter();
      assert.strictEqual(requests.length, 1, "updated the server for enter");
      let presentChannels = requests.pop().getAll("present_channels[]");
      assert.deepEqual(presentChannels, ["/test/ch1"], "included the correct present channel");
      await channel.leave();
      assert.strictEqual(requests.length, 1, "updated the server for leave");
      const request = requests.pop();
      presentChannels = request.getAll("present_channels[]");
      const leaveChannels = request.getAll("leave_channels[]");
      assert.deepEqual(presentChannels, [], "included no present channels");
      assert.deepEqual(leaveChannels, ["/test/ch1"], "included the correct leave channel");
    });
    (0, _qunit.test)("raises an error when entering a non-existent channel", async function (assert) {
      const presenceService = this.container.lookup("service:presence");
      const channel = presenceService.getChannel("/blah/does-not-exist");
      await assert.rejects(channel.enter(), _presence.PresenceChannelNotFound, "raises a not found error");
    });
    (0, _qunit.test)("deduplicates calls from multiple PresenceChannel instances", async function (assert) {
      const presenceService = this.container.lookup("service:presence");
      const channel = presenceService.getChannel("/test/ch1");
      const channelDup = presenceService.getChannel("/test/ch1");
      await channel.enter();
      assert.strictEqual(channel.present, true, "channel is present");
      assert.strictEqual(channelDup.present, false, "channelDup is absent");
      assert.ok(presenceService._presentChannels.has("/test/ch1"), "service shows present");
      await channelDup.enter();
      assert.strictEqual(channel.present, true, "channel is present");
      assert.strictEqual(channelDup.present, true, "channelDup is present");
      assert.ok(presenceService._presentChannels.has("/test/ch1"), "service shows present");
      await channel.leave();
      assert.strictEqual(channel.present, false, "channel is absent");
      assert.strictEqual(channelDup.present, true, "channelDup is present");
      assert.ok(presenceService._presentChannels.has("/test/ch1"), "service shows present");
      await channelDup.leave();
      assert.strictEqual(channel.present, false, "channel is absent");
      assert.strictEqual(channel.present, false, "channelDup is absent");
      assert.notOk(presenceService._presentChannels.has("/test/ch1"), "service shows absent");
    });
    (0, _qunit.test)("handles the onlyWhileActive flag", async function (assert) {
      const presenceService = this.container.lookup("service:presence");
      const channel = presenceService.getChannel("/test/ch1");
      await channel.enter();
      requests.pop(); // Throw away this request

      const channel2 = presenceService.getChannel("/test/ch2");
      await channel2.enter({
        onlyWhileActive: false
      });
      assert.strictEqual(requests.length, 1, "updated the server");
      let presentChannels = requests.pop().getAll("present_channels[]");
      assert.deepEqual(presentChannels, ["/test/ch1", "/test/ch2"], "included both channels when active");
      (0, _userPresence.setTestPresence)(false);
      await presenceService._updateServer();
      assert.strictEqual(requests.length, 1, "updated the server after going idle");
      let request = requests.pop();
      assert.deepEqual(request.getAll("present_channels[]"), ["/test/ch2"], "ch2 remained present");
      assert.ok(request.getAll("leave_channels[]").includes("/test/ch1"), "left ch1");
      await channel2.leave();
      assert.strictEqual(requests.length, 1, "updated the server");
      request = requests.pop();
      assert.ok(request.getAll("leave_channels[]").includes("/test/ch2"), "left ch2");
      await presenceService._updateServer();
      assert.strictEqual(requests.length, 0, "skips sending empty updates to the server");
    });
  });
});
define("discourse/tests/unit/services/screen-track-test", ["qunit", "ember-qunit"], function (_qunit, _emberQunit) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"ember-qunit"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Service | screen-track", function (hooks) {
    (0, _emberQunit.setupTest)(hooks);
    (0, _qunit.test)("consolidateTimings", async function (assert) {
      const tracker = this.owner.lookup("service:screen-track");
      tracker.consolidateTimings({
        1: 10,
        2: 5
      }, 10, 1);
      tracker.consolidateTimings({
        1: 5,
        3: 1
      }, 3, 1);
      const consolidated = tracker.consolidateTimings({
        1: 5,
        3: 1,
        4: 5
      }, 3, 2);
      assert.deepEqual(consolidated, [{
        timings: {
          1: 15,
          2: 5,
          3: 1
        },
        topicTime: 13,
        topicId: 1
      }, {
        timings: {
          1: 5,
          3: 1,
          4: 5
        },
        topicTime: 3,
        topicId: 2
      }], "expecting consolidated timings to match correctly");
      await tracker.sendNextConsolidatedTiming();
      assert.equal(tracker.highestReadFromCache(2), 4, "caches highest read post number for second topic");
    });
    (0, _qunit.test)("ScreenTrack has appEvents", async function (assert) {
      const tracker = this.owner.lookup("service:screen-track");
      assert.ok(tracker.appEvents);
    });
    (0, _qunit.test)("appEvent topic:timings-sent is triggered after posting consolidated timings", async function (assert) {
      assert.timeout(1000);
      const tracker = this.owner.lookup("service:screen-track");
      const appEvents = this.owner.lookup("service:app-events");
      const done = assert.async();
      appEvents.on("topic:timings-sent", () => {
        assert.ok(true);
        done();
      });
      tracker.consolidateTimings({
        1: 10,
        2: 5
      }, 10, 1);
      await tracker.sendNextConsolidatedTiming();
    });
  });
});
define("discourse/tests/unit/services/store-test", ["qunit", "discourse/tests/helpers/create-store"], function (_qunit, _createStore) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/create-store"eaimeta@70e063a35619d71f

  (0, _qunit.module)("Unit | Service | store", function () {
    (0, _qunit.test)("createRecord", function (assert) {
      const store = (0, _createStore.default)();
      const widget = store.createRecord("widget", {
        id: 111,
        name: "hello"
      });
      assert.ok(!widget.get("isNew"), "it is not a new record");
      assert.strictEqual(widget.get("name"), "hello");
      assert.strictEqual(widget.get("id"), 111);
    });
    (0, _qunit.test)("createRecord without an `id`", function (assert) {
      const store = (0, _createStore.default)();
      const widget = store.createRecord("widget", {
        name: "hello"
      });
      assert.ok(widget.get("isNew"), "it is a new record");
      assert.ok(!widget.get("id"), "there is no id");
    });
    (0, _qunit.test)("createRecord doesn't modify the input `id` field", function (assert) {
      const store = (0, _createStore.default)();
      const widget = store.createRecord("widget", {
        id: 1,
        name: "hello"
      });
      const obj = {
        id: 1,
        name: "something"
      };
      const other = store.createRecord("widget", obj);
      assert.strictEqual(widget, other, "returns the same record");
      assert.strictEqual(widget.name, "something", "it updates the properties");
      assert.strictEqual(obj.id, 1, "it does not remove the id from the input");
    });
    (0, _qunit.test)("createRecord without attributes", function (assert) {
      const store = (0, _createStore.default)();
      const widget = store.createRecord("widget");
      assert.ok(!widget.get("id"), "there is no id");
      assert.ok(widget.get("isNew"), "it is a new record");
    });
    (0, _qunit.test)("createRecord with a record as attributes returns that record from the map", function (assert) {
      const store = (0, _createStore.default)();
      const widget = store.createRecord("widget", {
        id: 33
      });
      const secondWidget = store.createRecord("widget", {
        id: 33
      });
      assert.strictEqual(widget, secondWidget, "they should be the same");
    });
    (0, _qunit.test)("find", async function (assert) {
      const store = (0, _createStore.default)();
      const widget = await store.find("widget", 123);
      assert.strictEqual(widget.get("name"), "Trout Lure");
      assert.strictEqual(widget.get("id"), 123);
      assert.ok(!widget.get("isNew"), "found records are not new");
      assert.strictEqual(widget.get("extras.hello"), "world", "extra attributes are set"); // A second find by id returns the same object

      const widget2 = await store.find("widget", 123);
      assert.strictEqual(widget, widget2);
      assert.strictEqual(widget.get("extras.hello"), "world", "extra attributes are set");
    });
    (0, _qunit.test)("find with object id", async function (assert) {
      const store = (0, _createStore.default)();
      const widget = await store.find("widget", {
        id: 123
      });
      assert.strictEqual(widget.get("firstObject.name"), "Trout Lure");
    });
    (0, _qunit.test)("find with query param", async function (assert) {
      const store = (0, _createStore.default)();
      const widget = await store.find("widget", {
        name: "Trout Lure"
      });
      assert.strictEqual(widget.get("firstObject.id"), 123);
    });
    (0, _qunit.test)("findStale with no stale results", async function (assert) {
      const store = (0, _createStore.default)();
      const stale = store.findStale("widget", {
        name: "Trout Lure"
      });
      assert.ok(!stale.hasResults, "there are no stale results");
      assert.ok(!stale.results, "results are present");
      const widget = await stale.refresh();
      assert.strictEqual(widget.get("firstObject.id"), 123, "a `refresh()` method provides results for stale");
    });
    (0, _qunit.test)("rehydrating stale results with implicit injections", async function (assert) {
      const store = (0, _createStore.default)();
      const cat = (await store.find("cached-cat", {
        name: "souna"
      })).content[0];
      assert.strictEqual(cat.name, "souna");
      const stale = store.findStale("cached-cat", {
        name: "souna"
      });
      const refreshed = await stale.refresh();
      assert.strictEqual(refreshed.content[0].name, "souna");
    });
    (0, _qunit.test)("update", async function (assert) {
      const store = (0, _createStore.default)();
      const result = await store.update("widget", 123, {
        name: "hello"
      });
      assert.ok(result);
    });
    (0, _qunit.test)("update with a multi world name", async function (assert) {
      const store = (0, _createStore.default)();
      const result = await store.update("cool-thing", 123, {
        name: "hello"
      });
      assert.ok(result);
      assert.strictEqual(result.payload.name, "hello");
    });
    (0, _qunit.test)("findAll", async function (assert) {
      const store = (0, _createStore.default)();
      const result = await store.findAll("widget");
      assert.strictEqual(result.get("length"), 2);
      const widget = result.findBy("id", 124);
      assert.ok(!widget.get("isNew"), "found records are not new");
      assert.strictEqual(widget.get("name"), "Evil Repellant");
    });
    (0, _qunit.test)("destroyRecord", async function (assert) {
      const store = (0, _createStore.default)();
      const widget = await store.find("widget", 123);
      assert.ok(await store.destroyRecord("widget", widget));
    });
    (0, _qunit.test)("destroyRecord when new", async function (assert) {
      const store = (0, _createStore.default)();
      const widget = store.createRecord("widget", {
        name: "hello"
      });
      assert.ok(await store.destroyRecord("widget", widget));
    });
    (0, _qunit.test)("find embedded", async function (assert) {
      const store = (0, _createStore.default)();
      const fruit = await store.find("fruit", 1);
      assert.ok(fruit.get("farmer"), "it has the embedded object");
      const fruitCols = fruit.get("colors");
      assert.strictEqual(fruitCols.length, 2);
      assert.strictEqual(fruitCols[0].get("id"), 1);
      assert.strictEqual(fruitCols[1].get("id"), 2);
    });
    (0, _qunit.test)("embedded records can be cleared", async function (assert) {
      const store = (0, _createStore.default)();
      let fruit = await store.find("fruit", 4);
      fruit.set("farmer", {
        dummy: "object"
      });
      fruit = await store.find("fruit", 4);
      assert.ok(!fruit.get("farmer"));
    });
    (0, _qunit.test)("meta types", async function (assert) {
      const store = (0, _createStore.default)();
      const barn = await store.find("barn", 1);
      assert.strictEqual(barn.get("owner.name"), "Old MacDonald", "it has the embedded farmer");
    });
    (0, _qunit.test)("findAll embedded", async function (assert) {
      const store = (0, _createStore.default)();
      const fruits = await store.findAll("fruit");
      assert.strictEqual(fruits.objectAt(0).get("farmer.name"), "Old MacDonald");
      assert.strictEqual(fruits.objectAt(0).get("farmer"), fruits.objectAt(1).get("farmer"), "points at the same object");
      assert.strictEqual(fruits.get("extras.hello"), "world", "it can supply extra information");
      const fruitCols = fruits.objectAt(0).get("colors");
      assert.strictEqual(fruitCols.length, 2);
      assert.strictEqual(fruitCols[0].get("id"), 1);
      assert.strictEqual(fruitCols[1].get("id"), 2);
      assert.strictEqual(fruits.objectAt(2).get("farmer.name"), "Luke Skywalker");
    });
    (0, _qunit.test)("custom primaryKey", async function (assert) {
      const store = (0, _createStore.default)();
      const cats = await store.findAll("cat");
      assert.strictEqual(cats.objectAt(0).name, "souna");
    });
  });
});
define("discourse/tests/unit/utils/decorators-test", ["@ember/template-factory", "qunit", "discourse/tests/helpers/component-test", "@ember/component", "@ember/test-helpers", "discourse-common/utils/decorators", "discourse/tests/helpers/qunit-helpers"], function (_templateFactory, _qunit, _componentTest, _component, _testHelpers, _decorators, _qunitHelpers) {
  "use strict";

  var _obj, _dec, _obj2, _dec2, _class;

  0; //eaimeta@70e063a35619d71f0,"qunit",0,"discourse/tests/helpers/component-test",0,"@ember/component",0,"@ember/test-helpers",0,"discourse-common/utils/decorators",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars"eaimeta@70e063a35619d71f

  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }

  const fooComponent = _component.default.extend((_obj = {
    classNames: ["foo-component"],
    baz: null,

    didInsertElement() {
      this._super(...arguments);

      this.setBaz(1);
    },

    willDestroyElement() {
      this._super(...arguments);

      this.setBaz(2);
    },

    setBaz(baz) {
      this.set("baz", baz);
    }

  }, (_applyDecoratedDescriptor(_obj, "setBaz", [_decorators.afterRender], Object.getOwnPropertyDescriptor(_obj, "setBaz"), _obj)), _obj));

  const EmberObjectComponent = _component.default.extend((_dec = (0, _decorators.default)("name"), (_obj2 = {
    name: "",
    layout: (0, _templateFactory.createTemplateFactory)(
    /*
      <span class="ember-object-component">{{this.text}}</span>
    */
    {
      "id": "qAdsP+Ty",
      "block": "[[[10,1],[14,0,\"ember-object-component\"],[12],[1,[30,0,[\"text\"]]],[13]],[],false,[]]",
      "moduleName": "(unknown template module)",
      "isStrictMode": false
    }),

    text(name) {
      return `hello, ${name}`;
    }

  }, (_applyDecoratedDescriptor(_obj2, "text", [_dec], Object.getOwnPropertyDescriptor(_obj2, "text"), _obj2)), _obj2)));

  let NativeComponent = (_dec2 = (0, _decorators.default)("name"), (_class = class NativeComponent extends _component.default {
    constructor() {
      super(...arguments);

      _defineProperty(this, "name", "");

      _defineProperty(this, "layout", (0, _templateFactory.createTemplateFactory)(
      /*
        <span class="native-component">{{this.text}}</span>
      */
      {
        "id": "KQcGLBIA",
        "block": "[[[10,1],[14,0,\"native-component\"],[12],[1,[30,0,[\"text\"]]],[13]],[],false,[]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
    }

    text(name) {
      return `hello, ${name}`;
    }

  }, (_applyDecoratedDescriptor(_class.prototype, "text", [_dec2], Object.getOwnPropertyDescriptor(_class.prototype, "text"), _class.prototype)), _class));
  (0, _qunit.module)("Unit | Utils | decorators", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _qunit.test)("afterRender", async function (assert) {
      this.registry.register("component:foo-component", fooComponent);
      this.set("baz", 0);
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        {{foo-component baz=baz}}
      */
      {
        "id": "gRYjmgfI",
        "block": "[[[1,[28,[35,0],null,[[\"baz\"],[[33,1]]]]]],[],false,[\"foo-component\",\"baz\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.ok((0, _qunitHelpers.exists)(document.querySelector(".foo-component")));
      assert.strictEqual(this.baz, 1);
      await (0, _testHelpers.clearRender)();
      assert.ok(!(0, _qunitHelpers.exists)(document.querySelector(".foo-component")));
      assert.strictEqual(this.baz, 1);
    });
    (0, _qunit.test)("discourseComputed works in EmberObject classes", async function (assert) {
      this.registry.register("component:ember-object-component", EmberObjectComponent);
      this.set("name", "Jarek");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <EmberObjectComponent @name={{this.name}} />
      */
      {
        "id": "bO+8bcS5",
        "block": "[[[8,[39,0],null,[[\"@name\"],[[30,0,[\"name\"]]]],null]],[],false,[\"ember-object-component\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(document.querySelector(".ember-object-component").textContent, "hello, Jarek");
      this.set("name", "Joffrey");
      assert.strictEqual(document.querySelector(".ember-object-component").textContent, "hello, Joffrey", "rerenders the component when arguments change");
    });
    (0, _qunit.test)("discourseComputed works in native classes", async function (assert) {
      this.registry.register("component:native-component", NativeComponent);
      this.set("name", "Jarek");
      await (0, _testHelpers.render)((0, _templateFactory.createTemplateFactory)(
      /*
        <NativeComponent @name={{this.name}} />
      */
      {
        "id": "KdDQUyFp",
        "block": "[[[8,[39,0],null,[[\"@name\"],[[30,0,[\"name\"]]]],null]],[],false,[\"native-component\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }));
      assert.strictEqual(document.querySelector(".native-component").textContent, "hello, Jarek");
      this.set("name", "Joffrey");
      assert.strictEqual(document.querySelector(".native-component").textContent, "hello, Joffrey", "rerenders the component when arguments change");
    });
  });
});
define("discourse/tests/unit/utils/dom-utils-test", ["@ember/template-factory", "discourse/tests/helpers/component-test", "discourse/tests/helpers/qunit-helpers", "discourse-common/utils/dom-utils"], function (_templateFactory, _componentTest, _qunitHelpers, _domUtils) {
  "use strict";

  0; //eaimeta@70e063a35619d71f0,"discourse/tests/helpers/component-test",0,"discourse/tests/helpers/qunit-helpers",0,"ember-cli-htmlbars",0,"discourse-common/utils/dom-utils"eaimeta@70e063a35619d71f

  (0, _qunitHelpers.discourseModule)("utils:dom-utils", function (hooks) {
    (0, _componentTest.setupRenderingTest)(hooks);
    (0, _componentTest.default)("offset", {
      template: (0, _templateFactory.createTemplateFactory)(
      /*
        {{d-button translatedLabel="baz"}}
      */
      {
        "id": "uVfv7Bur",
        "block": "[[[1,[28,[35,0],null,[[\"translatedLabel\"],[\"baz\"]]]]],[],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }),

      async test(assert) {
        const element = document.querySelector(".btn");

        const offset = _domUtils.default.offset(element);

        const rect = element.getBoundingClientRect();
        assert.deepEqual(offset, {
          top: rect.top + window.scrollY,
          left: rect.left + window.scrollX
        });
      }

    });
    (0, _componentTest.default)("position", {
      template: (0, _templateFactory.createTemplateFactory)(
      /*
        {{d-button translatedLabel="baz"}}
      */
      {
        "id": "uVfv7Bur",
        "block": "[[[1,[28,[35,0],null,[[\"translatedLabel\"],[\"baz\"]]]]],[],false,[\"d-button\"]]",
        "moduleName": "(unknown template module)",
        "isStrictMode": false
      }),

      async test(assert) {
        const element = document.querySelector(".btn");

        const position = _domUtils.default.position(element);

        assert.deepEqual(position, {
          top: element.offsetTop,
          left: element.offsetLeft
        });
      }

    });
  });
});
define('discourse/config/environment', [], function() {
  var prefix = 'discourse';
try {
  var metaName = prefix + '/config/environment';
  var rawConfig = document.querySelector('meta[name="' + metaName + '"]').getAttribute('content');
  var config = JSON.parse(decodeURIComponent(rawConfig));

  var exports = { 'default': config };

  Object.defineProperty(exports, '__esModule', { value: true });

  return exports;
}
catch(err) {
  throw new Error('Could not read config from meta tag with name "' + metaName + '".');
}

});
//# sourceMappingURL=core-tests.map
